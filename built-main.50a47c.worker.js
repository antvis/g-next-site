/*! For license information please see built-main.50a47c.worker.js.LICENSE.txt */
!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=129)}([function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,n(30))},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e){t.exports=function(t){return"function"==typeof t}},function(t,e,n){var r=n(31),i=Function.prototype,o=i.bind,a=i.call,s=r&&o.bind(a,a);t.exports=r?function(t){return t&&s(t)}:function(t){return t&&function(){return a.apply(t,arguments)}}},function(t,e,n){var r=n(1);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(68),a=n(11),s=n(100),u=n(18),c=n(1),l=r.RangeError,f=r.Int8Array,h=f&&f.prototype,d=h&&h.set,p=o.aTypedArray,v=o.exportTypedArrayMethod,g=!c((function(){var t=new Uint8ClampedArray(2);return i(d,t,{length:1,0:3},1),3!==t[1]})),m=g&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var t=new f(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));v("set",(function(t){p(this);var e=s(arguments.length>1?arguments[1]:void 0,1),n=u(t);if(g)return i(d,this,n,e);var r=this.length,o=a(n),c=0;if(o+e>r)throw l("Wrong length");for(;c<o;)this[e+c]=n[c++]}),!g||m)},function(t,e,n){"use strict";var r=n(0),i=n(3),o=n(1),a=n(17),s=n(62),u=n(68),c=n(65),l=n(66),f=n(25),h=n(67),d=u.aTypedArray,p=u.exportTypedArrayMethod,v=r.Uint16Array,g=v&&i(v.prototype.sort),m=!(!g||o((function(){g(new v(2),null)}))&&o((function(){g(new v(2),{})}))),y=!!g&&!o((function(){if(f)return f<74;if(c)return c<67;if(l)return!0;if(h)return h<602;var t,e,n=new v(516),r=Array(516);for(t=0;t<516;t++)e=t%4,n[t]=515-t,r[t]=t-2*e+3;for(g(n,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(n[t]!==r[t])return!0}));p("sort",(function(t){return void 0!==t&&a(t),y?g(this,t):s(d(this),function(t){return function(e,n){return void 0!==t?+t(e,n)||0:n!=n?-1:e!=e?1:0===e&&0===n?1/e>0&&1/n<0?1:-1:e>n}}(t))}),!y||m)},function(t,e,n){var r=n(3),i=n(18),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(i(t),e)}},function(t,e,n){var r=n(15),i=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw o(i(t)+" is not an object")}},function(t,e,n){var r=n(0),i=n(52),o=n(7),a=n(39),s=n(51),u=n(50),c=i("wks"),l=r.Symbol,f=l&&l.for,h=u?l:l&&l.withoutSetter||a;t.exports=function(t){if(!o(c,t)||!s&&"string"!=typeof c[t]){var e="Symbol."+t;s&&o(l,t)?c[t]=l[t]:c[t]=u&&f?f(e):h(e)}return c[t]}},function(t,e,n){var r=n(4),i=n(53),o=n(55),a=n(8),s=n(34),u=TypeError,c=Object.defineProperty,l=Object.getOwnPropertyDescriptor;e.f=r?o?function(t,e,n){if(a(t),e=s(e),a(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var r=l(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return c(t,e,n)}:c:function(t,e,n){if(a(t),e=s(e),a(n),i)try{return c(t,e,n)}catch(r){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(88);t.exports=function(t){return r(t.length)}},function(t,e,n){var r=n(16),i=Math.hypot,o=Math.abs,a=Math.sqrt;r({target:"Math",stat:!0,arity:2,forced:!!i&&i(1/0,NaN)!==1/0},{hypot:function(t,e){for(var n,r,i=0,s=0,u=arguments.length,c=0;s<u;)c<(n=o(arguments[s++]))?(i=i*(r=c/n)*r+1,c=n):i+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*a(i)}})},function(t,e,n){n(22),self,t.exports=function(){var t={748:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},850:function(t,e,n){var r=n(748);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},461:function(t){function e(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}t.exports=function(t){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=t.apply(n,r);function s(t){e(a,i,o,s,u,"next",t)}function u(t){e(a,i,o,s,u,"throw",t)}s(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},100:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},419:function(t,e,n){var r=n(560),i=n(28);function o(e,n,a){return i()?(t.exports=o=Reflect.construct.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},t.exports.__esModule=!0,t.exports.default=t.exports),o.apply(null,arguments)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},870:function(t){function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},636:function(t,e,n){var r=n(121);t.exports=function(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,a=t},f:function(){try{!s&&null!=n.return&&n.return()}finally{if(u)throw a}}}},t.exports.__esModule=!0,t.exports.default=t.exports},290:function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},28:function(t){t.exports=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},912:function(t){t.exports=function(t){if(typeof Symbol<"u"&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},96:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},814:function(t,e,n){var r=n(290);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t},t.exports.__esModule=!0,t.exports.default=t.exports},609:function(t,e,n){var r=n(425).default;function i(){"use strict";t.exports=i=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(C){l=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i,o,a,s,u=e&&e.prototype instanceof p?e:p,c=Object.create(u.prototype),l=new x(r||[]);return c._invoke=(i=t,o=n,a=l,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return{value:void 0,done:!0}}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){var r=A(n,a);if(r){if(r===d)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s="executing";var u=h(i,o,a);if("normal"===u.type){if(s=a.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(s="completed",a.method="throw",a.arg=u.arg)}}),c}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}e.wrap=f;var d={};function p(){}function v(){}function g(){}var m={};l(m,s,(function(){return this}));var y=Object.getPrototypeOf,_=y&&y(y(M([])));_&&_!==n&&o.call(_,s)&&(m=_);var E=g.prototype=p.prototype=Object.create(m);function T(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){var n;this._invoke=function(i,a){function s(){return new e((function(n,s){!function n(i,a,s,u){var c=h(t[i],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==r(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,u)}),(function(t){n("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,u)}))}u(c.arg)}(i,a,n,s)}))}return n=n?n.then(s,s):s()}}function A(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=h(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function M(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:O}}function O(){return{value:void 0,done:!0}}return v.prototype=g,l(E,"constructor",g),l(g,"constructor",v),v.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},T(R.prototype),l(R.prototype,u,(function(){return this})),e.AsyncIterator=R,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new R(f(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(E),l(E,c,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=M,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;b(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:M(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},560:function(t){function e(n,r){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},408:function(t,e,n){var r=n(850),i=n(912),o=n(121),a=n(96);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},425:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},121:function(t,e,n){var r=n(748);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return function(){"use strict";n.r(r),n.d(r,{Container:function(){return gn},Contribution:function(){return pn},DefaultContributionProvider:function(){return un},GlobalContainer:function(){return mn},Module:function(){return dn},OptionSymbol:function(){return rn},Provider:function(){return sn},Syringe:function(){return Ve},SyringeModule:function(){return fn},Utils:function(){return je},contrib:function(){return _n},decorate:function(){return Z},defineMetadata:function(){return J},deleteMetadata:function(){return ot},getMetadata:function(){return et},getMetadataKeys:function(){return rt},getOwnMetadata:function(){return nt},getOwnMetadataKeys:function(){return it},hasMetadata:function(){return $},hasOwnMetadata:function(){return tt},inject:function(){return en},injectable:function(){return Je},isSyringeModule:function(){return hn},metadata:function(){return Q},named:function(){return nn},register:function(){return yn},registerSideOption:function(){return on},singleton:function(){return $e},transient:function(){return tn}});var t=n(814),e=n.n(t),i="named",o="name",a="unmanaged",s="optional",u="inject",c="multi_inject",l="inversify:tagged",f="inversify:tagged_props",h="inversify:paramtypes",d="post_construct",p="pre_destroy",v=[u,c,o,a,i,s],g=n(636),m=n.n(g),y=n(609),_=n.n(y),E=n(461),T=n.n(E),R=n(425),A=n.n(R),S=n(100),b=n.n(S),x=n(870),M=n.n(x),O=n(290),C=n.n(O),N="Request",P="Singleton",I="Transient",w="ConstantValue",D="Constructor",L="DynamicValue",B="Factory",F="Function",k="Instance",U="Invalid",G="Provider",V="ClassProperty",j="ConstructorArgument",W="Variable",X=0;function H(){return X++}var Y=function(){function t(e,n){b()(this,t),C()(this,"id",void 0),C()(this,"moduleId",void 0),C()(this,"activated",void 0),C()(this,"serviceIdentifier",void 0),C()(this,"implementationType",void 0),C()(this,"cache",void 0),C()(this,"dynamicValue",void 0),C()(this,"scope",void 0),C()(this,"type",void 0),C()(this,"factory",void 0),C()(this,"provider",void 0),C()(this,"constraint",void 0),C()(this,"onActivation",void 0),C()(this,"onDeactivation",void 0),this.id=H(),this.activated=!1,this.serviceIdentifier=e,this.scope=n,this.type=U,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return M()(t,[{key:"clone",value:function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===P&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e}}]),t}(),z=1003,K=Object.getPrototypeOf(Function),q=new WeakMap;function Z(t,e,n,r){return ft(n)?function(t,e){return t.forEach((function(t){var n=t(e);if(!ft(n)&&!ht(n)){if(!function(t){return"function"==typeof t}(n))throw new TypeError;e=n}})),e}(t,e):function(t,e,n,r){return t.forEach((function(t){var i=t(e,n,r);if(!ft(i)&&!ht(i)){if(!dt(i))throw new TypeError;r=i}})),r}(t,e,n,r||void 0)}function Q(t,e){return function(n,r){ct(t,e,n,r)}}function J(t,e,n,r){return ct(t,e,n,r)}function $(t,e,n){return function t(e,n,r){if(st(e,n,r))return!0;var i=yt(n);return!ht(i)&&t(e,i,r)}(t,e,n)}function tt(t,e,n){return st(t,e,n)}function et(t,e,n){return function t(e,n,r){if(st(e,n,r))return ut(e,n,r);var i=yt(n);return ht(i)?void 0:t(e,i,r)}(t,e,n)}function nt(t,e,n){return ut(t,e,n)}function rt(t,e){return function t(e,n){var r=lt(e,n),i=yt(e);if(null===i)return r;var o=t(i,n);if(o.length<=0)return r;if(r.length<=0)return o;for(var a=new Set,s=[],u=0,c=r;u<c.length;u++){var l=c[u];a.has(l)||(a.add(l),s.push(l))}var f,h=m()(o);try{for(h.s();!(f=h.n()).done;){var d=f.value;a.has(d)||(a.add(d),s.push(d))}}catch(p){h.e(p)}finally{h.f()}return s}(t,e)}function it(t,e){return lt(t,e)}function ot(t,e,n){var r=at(e,n,!1);if(ft(r)||!r.delete(t))return!1;if(r.size>0)return!0;var i=q.get(e);return!i||(i.delete(n),i.size>0)||q.delete(e),!0}function at(t,e,n){var r=q.get(t);if(ft(r)){if(!n)return;r=new Map,q.set(t,r)}var i=r.get(e);if(ft(i)){if(!n)return;i=new Map,r.set(e,i)}return i}function st(t,e,n){var r=at(e,n,!1);return!ft(r)&&function(t){return!!t}(r.has(t))}function ut(t,e,n){var r=at(e,n,!1);if(!ft(r))return r.get(t)}function ct(t,e,n,r){at(n,r,!0).set(t,e)}function lt(t,e){var n=[],r=at(t,e,!1);if(ft(r))return n;for(var i=function(t){var e=function(t,e){var n=t[e];if(null!=n){if(!pt(n))throw new TypeError;return n}}(t,Symbol.iterator);if(!pt(e))throw new TypeError;var n=e.call(t);if(!dt(n))throw new TypeError;return n}(r.keys()),o=0;;){var a=gt(i);if(!a)return n.length=o,n;var s=vt(a);try{n[o]=s}catch(u){try{mt(i)}finally{throw u}}o++}}function ft(t){return void 0===t}function ht(t){return null===t}function dt(t){return"object"===A()(t)?null!==t:"function"==typeof t}function pt(t){return"function"==typeof t}function vt(t){return t.value}function gt(t){var e=t.next();return!e.done&&e}function mt(t){var e=t.return;e&&e.call(t)}function yt(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===K||e!==K)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!=typeof i||i===t?e:i}var _t=function(){function t(){b()(this,t)}return M()(t,[{key:"getConstructorMetadata",value:function(t){return{compilerGeneratedMetadata:et(h,t),userGeneratedMetadata:et(l,t)||{}}}},{key:"getPropertiesMetadata",value:function(t){return et(f,t)||[]}}]),t}(),Et=2,Tt=0,Rt=1;function At(t){return t instanceof RangeError||t.message===1032..toString()}function St(t){return"function"==typeof t?t.name:"symbol"===A()(t)?t.toString():t}function bt(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(t){var e="Object";null!==t.implementationType&&(e=Mt(t.implementationType)),r="".concat(r,"\n ").concat(e),t.constraint.metaData&&(r="".concat(r," - ").concat(t.constraint.metaData))}))),r}function xt(t){t.childRequests.forEach((function(t){if(function t(e,n){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===n||t(e.parentRequest,n))}(t,t.serviceIdentifier)){var e=function(t){return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=St(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}(t);throw new Error("".concat(1011," ").concat(e))}xt(t)}))}function Mt(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: ".concat(e)}var Ot=function(){function t(e){b()(this,t),C()(this,"id",void 0),C()(this,"container",void 0),C()(this,"plan",void 0),C()(this,"currentRequest",void 0),this.id=H(),this.container=e}return M()(t,[{key:"addPlan",value:function(t){this.plan=t}},{key:"setCurrentRequest",value:function(t){this.currentRequest=t}}]),t}(),Ct=function(){function t(e,n){b()(this,t),C()(this,"key",void 0),C()(this,"value",void 0),this.key=e,this.value=n}return M()(t,[{key:"toString",value:function(){return this.key===i?"named: ".concat(String(this.value).toString()," "):"tagged: { key:".concat(this.key.toString(),", value: ").concat(String(this.value)," }")}}]),t}(),Nt=M()((function t(e,n){b()(this,t),C()(this,"parentContext",void 0),C()(this,"rootRequest",void 0),this.parentContext=e,this.rootRequest=n})),Pt=n(408),It=n.n(Pt),wt=function(){function t(e){b()(this,t),C()(this,"_cb",void 0),this._cb=e}return M()(t,[{key:"unwrap",value:function(){return this._cb()}}]),t}(),Dt=function(){function t(e){b()(this,t),C()(this,"str",void 0),this.str=e}return M()(t,[{key:"startsWith",value:function(t){return 0===this.str.indexOf(t)}},{key:"endsWith",value:function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)}},{key:"contains",value:function(t){return-1!==this.str.indexOf(t)}},{key:"equals",value:function(t){return this.str===t}},{key:"value",value:function(){return this.str}}]),t}(),Lt=function(){function t(e,n,r,o){b()(this,t),C()(this,"id",void 0),C()(this,"type",void 0),C()(this,"serviceIdentifier",void 0),C()(this,"name",void 0),C()(this,"identifier",void 0),C()(this,"key",void 0),C()(this,"metadata",void 0),this.id=H(),this.type=e,this.serviceIdentifier=r;var a="symbol"===A()(n)?function(t){return t.toString().slice(7,-1)}(n):n;this.name=new Dt(a||""),this.identifier=n,this.metadata=new Array;var s=null;"string"==typeof o?s=new Ct(i,o):o instanceof Ct&&(s=o),null!==s&&this.metadata.push(s)}return M()(t,[{key:"hasTag",value:function(t){var e,n=m()(this.metadata);try{for(n.s();!(e=n.n()).done;)if(e.value.key===t)return!0}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isArray",value:function(){return this.hasTag(c)}},{key:"matchesArray",value:function(t){return this.matchesTag(c)(t)}},{key:"isNamed",value:function(){return this.hasTag(i)}},{key:"isTagged",value:function(){return this.metadata.some((function(t){return v.every((function(e){return t.key!==e}))}))}},{key:"isOptional",value:function(){return this.matchesTag(s)(!0)}},{key:"getNamedTag",value:function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===i}))[0]:null}},{key:"getCustomTags",value:function(){return this.isTagged()?this.metadata.filter((function(t){return v.every((function(e){return t.key!==e}))})):null}},{key:"matchesNamedTag",value:function(t){return this.matchesTag(i)(t)}},{key:"matchesTag",value:function(t){var e=this;return function(n){var r,i=m()(e.metadata);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.key===t&&o.value===n)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}}}]),t}();function Bt(t,e,n,r){var i=t.getConstructorMetadata(n).userGeneratedMetadata,o=Object.keys(i),a=0===n.length&&o.length>0,s=o.length>n.length,u=function(t,e,n,r){for(var i=[],o=0;o<r;o++){var a=Ft(o,t,e,n);null!==a&&i.push(a)}return i}(r,e,i,a||s?o.length:n.length),c=function t(e,n,r){var i,o=e.getPropertiesMetadata(n),a=[],s=Object.getOwnPropertySymbols(o),u=Object.keys(o).concat(s),c=m()(u);try{for(c.s();!(i=c.n()).done;){var l=i.value,f=o[l],h=Ut(f),d=h.targetName||l,p=kt(h.inject,h.multiInject,l,r),v=new Lt(V,d,p);v.metadata=f,a.push(v)}}catch(_){c.e(_)}finally{c.f()}var g=Object.getPrototypeOf(n.prototype).constructor;if(g!==Object){var y=t(e,g,r);a=[].concat(It()(a),It()(y))}return a}(t,n,e);return[].concat(u,It()(c))}function Ft(t,e,n,r){var i=r[t.toString()]||[],o=Ut(i),a=!0!==o.unmanaged,s=void 0;if((s=o.inject||o.multiInject||s)instanceof wt&&(s=s.unwrap()),a){if(!e&&(s===Object||s===Function||void 0===s)){var u="".concat(1009," argument ").concat(t," in class ").concat(n,".");throw new Error(u)}var c=new Lt(j,o.targetName,s);return c.metadata=i,c}return null}function kt(t,e,n,r){var i=t||e;if(void 0===i){var o="".concat(1008," for property ").concat(String(n)," in class ").concat(r,".");throw new Error(o)}return i}function Ut(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[u],multiInject:e[c],targetName:e[o],unmanaged:e[a]}}var Gt=function(){function t(e,n,r,i,o){b()(this,t),C()(this,"id",void 0),C()(this,"serviceIdentifier",void 0),C()(this,"parentContext",void 0),C()(this,"parentRequest",void 0),C()(this,"bindings",void 0),C()(this,"childRequests",void 0),C()(this,"target",void 0),C()(this,"requestScope",void 0),this.id=H(),this.serviceIdentifier=e,this.parentContext=n,this.parentRequest=r,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===r?new Map:null}return M()(t,[{key:"addChildRequest",value:function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i}}]),t}();function Vt(t){return t._bindingDictionary}function jt(t,e,n,r,i,o){var a=new Ct(t?c:u,n),s=new Lt(e,r,n,a);if(void 0!==i){var l=new Ct(i,o);s.metadata.push(l)}return s}function Wt(t,e,n,r,i){var o=Ht(n.container,i.serviceIdentifier),a=[];return a=e?o:o.filter((function(t){var e=new Gt(t.serviceIdentifier,n,r,t,i);return t.constraint(e)})),function(t,e,n,r){switch(e.length){case Tt:if(n.isOptional())return e;var i=St(t),o=1007..toString();throw o+=function(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(t){n+=t.toString()+"\n"}))," ".concat(t,"\n ").concat(t," - ").concat(n)}return" ".concat(t)}(i,n),o+=bt(r,i,Ht),new Error(o);case Rt:return e;case Et:default:if(n.isArray())return e;var a=St(t),s="".concat(1005," ").concat(a);throw s+=bt(r,a,Ht),new Error(s)}}(i.serviceIdentifier,a,i,n.container),a}function Xt(t,e,n,r,i,o){var s,u;if(null===i){s=Wt(0,e,r,null,o),u=new Gt(n,r,null,s,o);var c=new Nt(r,u);r.addPlan(c)}else s=Wt(0,e,r,i,o),u=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(e){var n=null;if(o.isArray())n=u.addChildRequest(e.serviceIdentifier,e,o);else{if(e.cache)return;n=u}if(e.type===k&&null!==e.implementationType){var i=function(t,e){return Bt(t,Mt(e),e,!1)}(t,e.implementationType);if(!r.container.options.skipBaseClassChecks){var s=function t(e,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=Bt(e,Mt(r),r,!0),o=i.map((function(t){return t.metadata.filter((function(t){return t.key===a}))})),s=[].concat.apply([],o).length,u=i.length-s;return u>0?u:t(e,r)}return 0}(t,e.implementationType);if(i.length<s){var c="".concat(1020," ").concat(Mt(e.implementationType));throw new Error(c)}}i.forEach((function(e){Xt(t,!1,e.serviceIdentifier,r,n,e)}))}}))}function Ht(t,e){var n=[],r=Vt(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=Ht(t.parent,e)),n}function Yt(t){return("object"===A()(t)&&null!==t||"function"==typeof t)&&"function"==typeof t.then}function zt(t){return!!Yt(t)||Array.isArray(t)&&t.some(Yt)}var Kt,qt,Zt=function(t,e,n){t.has(e.id)||t.set(e.id,n)},Qt=function(t,e){t.cache=e,t.activated=!0,Yt(e)&&Jt(t,e)},Jt=(qt=T()(_()().mark((function t(e,n){var r;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n;case 3:r=t.sent,e.cache=r,t.next=12;break;case 7:throw t.prev=7,t.t0=t.catch(0),e.cache=null,e.activated=!1,t.t0;case 12:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t,e){return qt.apply(this,arguments)});!function(t){t.DynamicValue="toDynamicValue",t.Factory="toFactory",t.Provider="toProvider"}(Kt||(Kt={}));var $t=n(419),te=n.n($t);function ee(t,n,r){var i;if(n.length>0){var o=function(t,e){return t.reduce((function(t,n){var r=e(n);return n.target.type===j?t.constructorInjections.push(r):(t.propertyRequests.push(n),t.propertyInjections.push(r)),t.isAsync||(t.isAsync=zt(r)),t}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(n,r),a=e()(e()({},o),{},{constr:t});i=o.isAsync?function(t){return re.apply(this,arguments)}(a):ne(a)}else i=new t;return i}function ne(t){var e=te()(t.constr,It()(t.constructorInjections));return t.propertyRequests.forEach((function(n,r){var i=n.target.identifier,o=t.propertyInjections[r];e[i]=o})),e}function re(){return(re=T()(_()().mark((function t(n){var r,i;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ie(n.constructorInjections);case 2:return r=t.sent,t.next=5,ie(n.propertyInjections);case 5:return i=t.sent,t.abrupt("return",ne(e()(e()({},n),{},{constructorInjections:r,propertyInjections:i})));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ie(t){return oe.apply(this,arguments)}function oe(){return(oe=T()(_()().mark((function t(e){var n,r,i,o;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=m()(e);try{for(r.s();!(i=r.n()).done;)o=i.value,Array.isArray(o)?n.push(Promise.all(o)):n.push(o)}catch(a){r.e(a)}finally{r.f()}return t.abrupt("return",Promise.all(n));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ae(t,e){var n=function(t,e){if($(d,t)){var n=et(d,t);try{var r,i;return null===(r=(i=e)[n.value])||void 0===r?void 0:r.call(i)}catch(o){throw new Error("".concat(1028," ").concat(t.name))}}}(t,e);return Yt(n)?n.then((function(){return e})):e}function se(t,e){t.scope!==P&&function(t,e){var n=t.scope===N?"request":"transient";if("function"==typeof t.onDeactivation)throw new Error("".concat(1030," ").concat(e.name));if($(p,e))throw new Error("".concat(1029," ").concat(e.name," ").concat(n))}(t,e)}var ue=function t(e){return function(n){n.parentContext.setCurrentRequest(n);var r=n.bindings,i=n.childRequests,o=n.target&&n.target.isArray(),a=!(n.parentRequest&&n.parentRequest.target&&n.target&&n.parentRequest.target.matchesArray(n.target.serviceIdentifier));if(o&&a)return i.map((function(n){return t(e)(n)}));if(!n.target.isOptional()||0!==r.length){var s=r[0];return he(e,n,s)}}},ce=function(t,e){var n=function(t){switch(t.type){case B:return{factory:t.factory,factoryType:Kt.Factory};case G:return{factory:t.provider,factoryType:Kt.Provider};case L:return{factory:t.dynamicValue,factoryType:Kt.DynamicValue};default:throw new Error("Unexpected factory type ".concat(t.type))}}(t);return function(t,e){try{return t()}catch(n){throw At(n)&&(n=e()),n}}((function(){return n.factory.bind(t)(e)}),(function(){return new Error("".concat(1031," ").concat(n.factoryType," ").concat(e.currentRequest.serviceIdentifier.toString()))}))},le=function(t,e,n){var r,i=e.childRequests;switch(function(t){var e=null;switch(t.type){case w:case F:e=t.cache;break;case D:case k:e=t.implementationType;break;case L:e=t.dynamicValue;break;case G:e=t.provider;break;case B:e=t.factory}if(null===e){var n=St(t.serviceIdentifier);throw new Error("".concat(1013," ").concat(n))}}(n),n.type){case w:case F:r=n.cache;break;case D:r=n.implementationType;break;case k:r=function(t,e,n,r){se(t,e);var i=ee(e,n,r);return Yt(i)?i.then((function(t){return ae(e,t)})):ae(e,i)}(n,n.implementationType,i,ue(t));break;default:r=ce(n,e.parentContext)}return r},fe=function(t,e,n){var r=function(t,e){return e.scope===P&&e.activated?e.cache:e.scope===N&&t.has(e.id)?t.get(e.id):null}(t,e);return null!==r||function(t,e,n){e.scope===P&&Qt(e,n),e.scope===N&&Zt(t,e,n)}(t,e,r=n()),r},he=function(t,e,n){return fe(t,n,(function(){var r=le(t,e,n);return r=Yt(r)?r.then((function(t){return de(e,n,t)})):de(e,n,r)}))};function de(t,e,n){var r,i=pe(t.parentContext,e,n),o=ye(t.parentContext.container),a=o.next();do{r=a.value;var s=t.parentContext,u=t.serviceIdentifier,c=me(r,u);i=Yt(i)?ge(c,s,i):ve(c,s,i),a=o.next()}while(!0!==a.done&&!Vt(r).hasKey(t.serviceIdentifier));return i}var pe=function(t,e,n){return"function"==typeof e.onActivation?e.onActivation(t,n):n},ve=function(t,e,n){for(var r=t.next();!r.done;){if(Yt(n=r.value(e,n)))return ge(t,e,n);r=t.next()}return n},ge=function(){var t=T()(_()().mark((function t(e,n,r){var i,o;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r;case 2:i=t.sent,o=e.next();case 4:if(o.done){t.next=11;break}return t.next=7,o.value(n,i);case 7:i=t.sent,o=e.next(),t.next=4;break;case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),me=function(t,e){var n=t._activations;return n.hasKey(e)?n.get(e).values():[].values()},ye=function(t){for(var e=[t],n=t.parent;null!==n;)e.push(n),n=n.parent;return{next:function(){var t=e.pop();return void 0!==t?{done:!1,value:t}:{done:!0,value:void 0}}}},_e=function t(e,n){var r=e.parentRequest;return null!==r&&(!!n(r)||t(r,n))},Ee=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new Ct(t,e),n}},Te=Ee(i),Re=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"==typeof t)return n.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}},Ae=function(){function t(e){b()(this,t),C()(this,"_binding",void 0),this._binding=e}return M()(t,[{key:"when",value:function(t){return this._binding.constraint=t,new Se(this._binding)}},{key:"whenTargetNamed",value:function(t){return this._binding.constraint=Te(t),new Se(this._binding)}},{key:"whenTargetIsDefault",value:function(){return this._binding.constraint=function(t){return null!==t&&null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new Se(this._binding)}},{key:"whenTargetTagged",value:function(t,e){return this._binding.constraint=Ee(t)(e),new Se(this._binding)}},{key:"whenInjectedInto",value:function(t){return this._binding.constraint=function(e){return null!==e&&Re(t)(e.parentRequest)},new Se(this._binding)}},{key:"whenParentNamed",value:function(t){return this._binding.constraint=function(e){return null!==e&&Te(t)(e.parentRequest)},new Se(this._binding)}},{key:"whenParentTagged",value:function(t,e){return this._binding.constraint=function(n){return null!==n&&Ee(t)(e)(n.parentRequest)},new Se(this._binding)}},{key:"whenAnyAncestorIs",value:function(t){return this._binding.constraint=function(e){return null!==e&&_e(e,Re(t))},new Se(this._binding)}},{key:"whenNoAncestorIs",value:function(t){return this._binding.constraint=function(e){return null!==e&&!_e(e,Re(t))},new Se(this._binding)}},{key:"whenAnyAncestorNamed",value:function(t){return this._binding.constraint=function(e){return null!==e&&_e(e,Te(t))},new Se(this._binding)}},{key:"whenNoAncestorNamed",value:function(t){return this._binding.constraint=function(e){return null!==e&&!_e(e,Te(t))},new Se(this._binding)}},{key:"whenAnyAncestorTagged",value:function(t,e){return this._binding.constraint=function(n){return null!==n&&_e(n,Ee(t)(e))},new Se(this._binding)}},{key:"whenNoAncestorTagged",value:function(t,e){return this._binding.constraint=function(n){return null!==n&&!_e(n,Ee(t)(e))},new Se(this._binding)}},{key:"whenAnyAncestorMatches",value:function(t){return this._binding.constraint=function(e){return null!==e&&_e(e,t)},new Se(this._binding)}},{key:"whenNoAncestorMatches",value:function(t){return this._binding.constraint=function(e){return null!==e&&!_e(e,t)},new Se(this._binding)}}]),t}(),Se=function(){function t(e){b()(this,t),C()(this,"_binding",void 0),this._binding=e}return M()(t,[{key:"onActivation",value:function(t){return this._binding.onActivation=t,new Ae(this._binding)}},{key:"onDeactivation",value:function(t){return this._binding.onDeactivation=t,new Ae(this._binding)}}]),t}(),be=function(){function t(e){b()(this,t),C()(this,"_bindingWhenSyntax",void 0),C()(this,"_bindingOnSyntax",void 0),C()(this,"_binding",void 0),this._binding=e,this._bindingWhenSyntax=new Ae(this._binding),this._bindingOnSyntax=new Se(this._binding)}return M()(t,[{key:"when",value:function(t){return this._bindingWhenSyntax.when(t)}},{key:"whenTargetNamed",value:function(t){return this._bindingWhenSyntax.whenTargetNamed(t)}},{key:"whenTargetIsDefault",value:function(){return this._bindingWhenSyntax.whenTargetIsDefault()}},{key:"whenTargetTagged",value:function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)}},{key:"whenInjectedInto",value:function(t){return this._bindingWhenSyntax.whenInjectedInto(t)}},{key:"whenParentNamed",value:function(t){return this._bindingWhenSyntax.whenParentNamed(t)}},{key:"whenParentTagged",value:function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)}},{key:"whenAnyAncestorIs",value:function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)}},{key:"whenNoAncestorIs",value:function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)}},{key:"whenAnyAncestorNamed",value:function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)}},{key:"whenAnyAncestorTagged",value:function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)}},{key:"whenNoAncestorNamed",value:function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)}},{key:"whenNoAncestorTagged",value:function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)}},{key:"whenAnyAncestorMatches",value:function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)}},{key:"whenNoAncestorMatches",value:function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)}},{key:"onActivation",value:function(t){return this._bindingOnSyntax.onActivation(t)}},{key:"onDeactivation",value:function(t){return this._bindingOnSyntax.onDeactivation(t)}}]),t}(),xe=function(){function t(e){b()(this,t),C()(this,"_binding",void 0),this._binding=e}return M()(t,[{key:"inRequestScope",value:function(){return this._binding.scope=N,new be(this._binding)}},{key:"inSingletonScope",value:function(){return this._binding.scope=P,new be(this._binding)}},{key:"inTransientScope",value:function(){return this._binding.scope=I,new be(this._binding)}}]),t}(),Me=function(){function t(e){b()(this,t),C()(this,"_bindingInSyntax",void 0),C()(this,"_bindingWhenSyntax",void 0),C()(this,"_bindingOnSyntax",void 0),C()(this,"_binding",void 0),this._binding=e,this._bindingWhenSyntax=new Ae(this._binding),this._bindingOnSyntax=new Se(this._binding),this._bindingInSyntax=new xe(e)}return M()(t,[{key:"inRequestScope",value:function(){return this._bindingInSyntax.inRequestScope()}},{key:"inSingletonScope",value:function(){return this._bindingInSyntax.inSingletonScope()}},{key:"inTransientScope",value:function(){return this._bindingInSyntax.inTransientScope()}},{key:"when",value:function(t){return this._bindingWhenSyntax.when(t)}},{key:"whenTargetNamed",value:function(t){return this._bindingWhenSyntax.whenTargetNamed(t)}},{key:"whenTargetIsDefault",value:function(){return this._bindingWhenSyntax.whenTargetIsDefault()}},{key:"whenTargetTagged",value:function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)}},{key:"whenInjectedInto",value:function(t){return this._bindingWhenSyntax.whenInjectedInto(t)}},{key:"whenParentNamed",value:function(t){return this._bindingWhenSyntax.whenParentNamed(t)}},{key:"whenParentTagged",value:function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)}},{key:"whenAnyAncestorIs",value:function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)}},{key:"whenNoAncestorIs",value:function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)}},{key:"whenAnyAncestorNamed",value:function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)}},{key:"whenAnyAncestorTagged",value:function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)}},{key:"whenNoAncestorNamed",value:function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)}},{key:"whenNoAncestorTagged",value:function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)}},{key:"whenAnyAncestorMatches",value:function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)}},{key:"whenNoAncestorMatches",value:function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)}},{key:"onActivation",value:function(t){return this._bindingOnSyntax.onActivation(t)}},{key:"onDeactivation",value:function(t){return this._bindingOnSyntax.onDeactivation(t)}}]),t}(),Oe=function(){function t(e){b()(this,t),C()(this,"_binding",void 0),this._binding=e}return M()(t,[{key:"to",value:function(t){return this._binding.type=k,this._binding.implementationType=t,new Me(this._binding)}},{key:"toSelf",value:function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error("".concat(1018));var t=this._binding.serviceIdentifier;return this.to(t)}},{key:"toConstantValue",value:function(t){return this._binding.type=w,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=P,new be(this._binding)}},{key:"toDynamicValue",value:function(t){return this._binding.type=L,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Me(this._binding)}},{key:"toConstructor",value:function(t){return this._binding.type=D,this._binding.implementationType=t,this._binding.scope=P,new be(this._binding)}},{key:"toFactory",value:function(t){return this._binding.type=B,this._binding.factory=t,this._binding.scope=P,new be(this._binding)}},{key:"toFunction",value:function(t){if("function"!=typeof t)throw new Error("".concat(1016));var e=this.toConstantValue(t);return this._binding.type=F,this._binding.scope=P,e}},{key:"toAutoFactory",value:function(t){return this._binding.type=B,this._binding.factory=function(e){return function(){return e.container.get(t)}},this._binding.scope=P,new be(this._binding)}},{key:"toAutoNamedFactory",value:function(t){return this._binding.type=B,this._binding.factory=function(e){return function(n){return e.container.getNamed(t,n)}},new be(this._binding)}},{key:"toProvider",value:function(t){return this._binding.type=G,this._binding.provider=t,this._binding.scope=P,new be(this._binding)}},{key:"toService",value:function(t){this.toDynamicValue((function(e){return e.container.get(t)}))}}]),t}(),Ce=function(){function t(){b()(this,t),C()(this,"bindings",void 0),C()(this,"activations",void 0),C()(this,"deactivations",void 0),C()(this,"middleware",void 0),C()(this,"moduleActivationStore",void 0)}return M()(t,null,[{key:"of",value:function(e,n,r,i,o){var a=new t;return a.bindings=e,a.middleware=n,a.deactivations=i,a.activations=r,a.moduleActivationStore=o,a}}]),t}(),Ne=function(){function t(){b()(this,t),C()(this,"_map",void 0),this._map=new Map}return M()(t,[{key:"getMap",value:function(){return this._map}},{key:"add",value:function(t,e){if(null==t)throw new Error(z.toString());if(null==e)throw new Error(z.toString());var n=this._map.get(t);void 0!==n?n.push(e):this._map.set(t,[e])}},{key:"get",value:function(t){if(null==t)throw new Error(z.toString());var e=this._map.get(t);if(void 0!==e)return e;throw new Error(1004..toString())}},{key:"remove",value:function(t){if(null==t)throw new Error(z.toString());if(!this._map.delete(t))throw new Error(1004..toString())}},{key:"removeIntersection",value:function(t){var e=this;this.traverse((function(n,r){var i=t.hasKey(n)?t.get(n):void 0;if(void 0!==i){var o=r.filter((function(t){return!i.some((function(e){return t===e}))}));e._setValue(n,o)}}))}},{key:"removeByCondition",value:function(t){var e=this,n=[];return this._map.forEach((function(r,i){var o,a=[],s=m()(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;t(u)?n.push(u):a.push(u)}}catch(c){s.e(c)}finally{s.f()}e._setValue(i,a)})),n}},{key:"hasKey",value:function(t){if(null==t)throw new Error(z.toString());return this._map.has(t)}},{key:"clone",value:function(){var e=new t;return this._map.forEach((function(t,n){t.forEach((function(t){return e.add(n,function(t){return"object"===A()(t)&&null!==t&&"clone"in t&&"function"==typeof t.clone}(t)?t.clone():t)}))})),e}},{key:"traverse",value:function(t){this._map.forEach((function(e,n){t(n,e)}))}},{key:"_setValue",value:function(t,e){e.length>0?this._map.set(t,e):this._map.delete(t)}}]),t}(),Pe=function(){function t(){b()(this,t),C()(this,"_map",new Map)}return M()(t,[{key:"remove",value:function(t){if(this._map.has(t)){var e=this._map.get(t);return this._map.delete(t),e}return this._getEmptyHandlersStore()}},{key:"addDeactivation",value:function(t,e,n){this._getModuleActivationHandlers(t).onDeactivations.add(e,n)}},{key:"addActivation",value:function(t,e,n){this._getModuleActivationHandlers(t).onActivations.add(e,n)}},{key:"clone",value:function(){var e=new t;return this._map.forEach((function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})})),e}},{key:"_getModuleActivationHandlers",value:function(t){var e=this._map.get(t);return void 0===e&&(e=this._getEmptyHandlersStore(),this._map.set(t,e)),e}},{key:"_getEmptyHandlersStore",value:function(){return{onActivations:new Ne,onDeactivations:new Ne}}}]),t}(),Ie=function(){function t(e){b()(this,t),C()(this,"id",void 0),C()(this,"parent",void 0),C()(this,"options",void 0),C()(this,"_middleware",void 0),C()(this,"_bindingDictionary",void 0),C()(this,"_activations",void 0),C()(this,"_deactivations",void 0),C()(this,"_snapshots",void 0),C()(this,"_metadataReader",void 0),C()(this,"_moduleActivationStore",void 0);var n=e||{};if("object"!==A()(n))throw new Error("".concat(1021));if(void 0===n.defaultScope)n.defaultScope=I;else if(n.defaultScope!==P&&n.defaultScope!==I&&n.defaultScope!==N)throw new Error("".concat(1022));if(void 0===n.skipBaseClassChecks)n.skipBaseClassChecks=!1;else if("boolean"!=typeof n.skipBaseClassChecks)throw new Error("".concat(1024));this.options={defaultScope:n.defaultScope,skipBaseClassChecks:n.skipBaseClassChecks},this.id=H(),this._bindingDictionary=new Ne,this._snapshots=[],this._middleware=null,this._activations=new Ne,this._deactivations=new Ne,this.parent=null,this._metadataReader=new _t,this._moduleActivationStore=new Pe}return M()(t,[{key:"load",value:function(){for(var t=this._getContainerModuleHelpersFactory(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i],s=t(a.id);a.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction,s.unbindAsyncFunction,s.onActivationFunction,s.onDeactivationFunction)}}},{key:"loadAsync",value:(n=T()(_()().mark((function t(){var e,n,r,i,o,a,s,u,c=arguments;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=this._getContainerModuleHelpersFactory(),n=c.length,r=new Array(n),i=0;i<n;i++)r[i]=c[i];o=0,a=r;case 3:if(!(o<a.length)){t.next=11;break}return s=a[o],u=e(s.id),t.next=8,s.registry(u.bindFunction,u.unbindFunction,u.isboundFunction,u.rebindFunction,u.unbindAsyncFunction,u.onActivationFunction,u.onDeactivationFunction);case 8:o++,t.next=3;break;case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"unload",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){var n=t._removeModuleBindings(e.id);t._deactivateSingletons(n),t._removeModuleHandlers(e.id)}))}},{key:"unloadAsync",value:function(){var t=T()(_()().mark((function t(){var e,n,r,i,o,a,s,u=arguments;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=u.length,n=new Array(e),r=0;r<e;r++)n[r]=u[r];i=0,o=n;case 2:if(!(i<o.length)){t.next=11;break}return a=o[i],s=this._removeModuleBindings(a.id),t.next=7,this._deactivateSingletonsAsync(s);case 7:this._removeModuleHandlers(a.id);case 8:i++,t.next=2;break;case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"bind",value:function(t){var e=this.options.defaultScope||I,n=new Y(t,e);return this._bindingDictionary.add(t,n),new Oe(n)}},{key:"rebind",value:function(t){return this.unbind(t),this.bind(t)}},{key:"rebindAsync",value:function(){var t=T()(_()().mark((function t(e){return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.unbindAsync(e);case 2:return t.abrupt("return",this.bind(e));case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"unbind",value:function(t){if(this._bindingDictionary.hasKey(t)){var e=this._bindingDictionary.get(t);this._deactivateSingletons(e)}this._removeServiceFromDictionary(t)}},{key:"unbindAsync",value:function(){var t=T()(_()().mark((function t(e){var n;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._bindingDictionary.hasKey(e)){t.next=4;break}return n=this._bindingDictionary.get(e),t.next=4,this._deactivateSingletonsAsync(n);case 4:this._removeServiceFromDictionary(e);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"unbindAll",value:function(){var t=this;this._bindingDictionary.traverse((function(e,n){t._deactivateSingletons(n)})),this._bindingDictionary=new Ne}},{key:"unbindAllAsync",value:function(){var t=T()(_()().mark((function t(){var e,n=this;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[],this._bindingDictionary.traverse((function(t,r){e.push(n._deactivateSingletonsAsync(r))})),t.next=4,Promise.all(e);case 4:this._bindingDictionary=new Ne;case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onActivation",value:function(t,e){this._activations.add(t,e)}},{key:"onDeactivation",value:function(t,e){this._deactivations.add(t,e)}},{key:"isBound",value:function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e}},{key:"isCurrentBound",value:function(t){return this._bindingDictionary.hasKey(t)}},{key:"isBoundNamed",value:function(t,e){return this.isBoundTagged(t,i,e)}},{key:"isBoundTagged",value:function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=function(t,e,n,r){var i=new Lt(W,"",e,new Ct(n,r)),o=new Ot(t);return new Gt(e,o,null,[],i)}(this,t,e,n);r=i.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r}},{key:"snapshot",value:function(){this._snapshots.push(Ce.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}},{key:"restore",value:function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(1014..toString());this._bindingDictionary=t.bindings,this._activations=t.activations,this._deactivations=t.deactivations,this._middleware=t.middleware,this._moduleActivationStore=t.moduleActivationStore}},{key:"createChild",value:function(e){var n=new t(e||this.options);return n.parent=this,n}},{key:"applyMiddleware",value:function(){for(var t=this._middleware?this._middleware:this._planAndResolve(),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._middleware=n.reduce((function(t,e){return e(t)}),t)}},{key:"applyCustomMetadataReader",value:function(t){this._metadataReader=t}},{key:"get",value:function(t){var e=this._getNotAllArgs(t,!1);return this._getButThrowIfAsync(e)}},{key:"getAsync",value:function(){var t=T()(_()().mark((function t(e){var n;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getNotAllArgs(e,!1),t.abrupt("return",this._get(n));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getTagged",value:function(t,e,n){var r=this._getNotAllArgs(t,!1,e,n);return this._getButThrowIfAsync(r)}},{key:"getTaggedAsync",value:function(){var t=T()(_()().mark((function t(e,n,r){var i;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getNotAllArgs(e,!1,n,r),t.abrupt("return",this._get(i));case 2:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"getNamed",value:function(t,e){return this.getTagged(t,i,e)}},{key:"getNamedAsync",value:function(t,e){return this.getTaggedAsync(t,i,e)}},{key:"getAll",value:function(t){var e=this._getAllArgs(t);return this._getButThrowIfAsync(e)}},{key:"getAllAsync",value:function(t){var e=this._getAllArgs(t);return this._getAll(e)}},{key:"getAllTagged",value:function(t,e,n){var r=this._getNotAllArgs(t,!0,e,n);return this._getButThrowIfAsync(r)}},{key:"getAllTaggedAsync",value:function(t,e,n){var r=this._getNotAllArgs(t,!0,e,n);return this._getAll(r)}},{key:"getAllNamed",value:function(t,e){return this.getAllTagged(t,i,e)}},{key:"getAllNamedAsync",value:function(t,e){return this.getAllTaggedAsync(t,i,e)}},{key:"resolve",value:function(t){var e=this.isBound(t);e||this.bind(t).toSelf();var n=this.get(t);return e||this.unbind(t),n}},{key:"_preDestroy",value:function(t,e){if($(p,t))return e[et(p,t).value]()}},{key:"_removeModuleHandlers",value:function(t){var e=this._moduleActivationStore.remove(t);this._activations.removeIntersection(e.onActivations),this._deactivations.removeIntersection(e.onDeactivations)}},{key:"_removeModuleBindings",value:function(t){return this._bindingDictionary.removeByCondition((function(e){return e.moduleId===t}))}},{key:"_deactivate",value:function(t,e){var n=this,r=Object.getPrototypeOf(e).constructor;try{if(this._deactivations.hasKey(t.serviceIdentifier)){var i=this._deactivateContainer(e,this._deactivations.get(t.serviceIdentifier).values());if(Yt(i))return this._handleDeactivationError(i.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(t,e,r)})),r)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(t,e,r);if(Yt(o))return this._handleDeactivationError(o,r)}catch(a){throw new Error("".concat(1030," ").concat(r.name))}}},{key:"_handleDeactivationError",value:function(){var t=T()(_()().mark((function t(e,n){return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),new Error("".concat(1030," ").concat(n.name));case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"_deactivateContainer",value:function(t,e){for(var n=this,r=e.next();r.value;){var i=r.value(t);if(Yt(i))return i.then((function(){return n._deactivateContainerAsync(t,e)}));r=e.next()}}},{key:"_deactivateContainerAsync",value:function(){var t=T()(_()().mark((function t(e,n){var r;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.next();case 1:if(!r.value){t.next=7;break}return t.next=4,r.value(e);case 4:r=n.next(),t.next=1;break;case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"_getContainerModuleHelpersFactory",value:function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.rebind(r);return e(i,n),i}},r=function(e){return function(n,r){t._moduleActivationStore.addActivation(e,n,r),t.onActivation(n,r)}},i=function(e){return function(n,r){t._moduleActivationStore.addDeactivation(e,n,r),t.onDeactivation(n,r)}};return function(o){return{bindFunction:(a=o,function(n){var r=t.bind(n);return e(r,a),r}),isboundFunction:function(e){return t.isBound(e)},onActivationFunction:r(o),onDeactivationFunction:i(o),rebindFunction:n(o),unbindFunction:function(e){return t.unbind(e)},unbindAsyncFunction:function(e){return t.unbindAsync(e)}};var a}}},{key:"_getAll",value:function(t){return Promise.all(this._get(t))}},{key:"_get",value:function(t){var n=e()(e()({},t),{},{contextInterceptor:function(t){return t},targetType:W});if(this._middleware){var r=this._middleware(n);if(null==r)throw new Error(1015..toString());return r}return this._planAndResolve()(n)}},{key:"_getButThrowIfAsync",value:function(t){var e=this._get(t);if(zt(e))throw new Error("".concat(1017," ").concat(t.serviceIdentifier.toString()));return e}},{key:"_getAllArgs",value:function(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}},{key:"_getNotAllArgs",value:function(t,e,n,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:n,value:r}}},{key:"_planAndResolve",value:function(){var t=this;return function(e){var n=function(t,e,n,r,i,o,a){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=new Ot(e),c=jt(n,r,i,"",o,a);try{return Xt(t,s,i,u,null,c),u}catch(l){throw At(l)&&xt(u.plan.rootRequest),l}}(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return function(t){return ue(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}(n=e.contextInterceptor(n))}}},{key:"_deactivateIfSingleton",value:function(t){var e=this;if(t.activated)return Yt(t.cache)?t.cache.then((function(n){return e._deactivate(t,n)})):this._deactivate(t,t.cache)}},{key:"_deactivateSingletons",value:function(t){var e,n=m()(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(Yt(this._deactivateIfSingleton(r)))throw new Error(1027..toString())}}catch(i){n.e(i)}finally{n.f()}}},{key:"_deactivateSingletonsAsync",value:function(){var t=T()(_()().mark((function t(e){var n=this;return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map((function(t){return n._deactivateIfSingleton(t)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"_propagateContainerDeactivationThenBindingAndPreDestroy",value:function(t,e,n){return this.parent?this._deactivate.bind(this.parent)(t,e):this._bindingDeactivationAndPreDestroy(t,e,n)}},{key:"_propagateContainerDeactivationThenBindingAndPreDestroyAsync",value:function(){var t=T()(_()().mark((function t(e,n,r){return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.parent){t.next=5;break}return t.next=3,this._deactivate.bind(this.parent)(e,n);case 3:t.next=7;break;case 5:return t.next=7,this._bindingDeactivationAndPreDestroyAsync(e,n,r);case 7:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_removeServiceFromDictionary",value:function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error("".concat(1006..toString()," ").concat(St(t)))}}},{key:"_bindingDeactivationAndPreDestroy",value:function(t,e,n){var r=this;if("function"==typeof t.onDeactivation){var i=t.onDeactivation(e);if(Yt(i))return i.then((function(){return r._preDestroy(n,e)}))}return this._preDestroy(n,e)}},{key:"_bindingDeactivationAndPreDestroyAsync",value:function(){var t=T()(_()().mark((function t(e,n,r){return _()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!=typeof e.onDeactivation){t.next=3;break}return t.next=3,e.onDeactivation(n);case 3:return t.next=5,this._preDestroy(r,n);case 5:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()}],[{key:"merge",value:function(e,n){for(var r=new t,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var s=[e,n].concat(o).map((function(t){return Vt(t)})),u=Vt(r);function c(t,e){t.traverse((function(t,n){n.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return s.forEach((function(t){c(t,u)})),r}}]),t;var n}(),we=M()((function t(e){b()(this,t),C()(this,"id",void 0),C()(this,"registry",void 0),this.id=H(),this.registry=e}));function De(t,e,n,r){(function(t){if(void 0!==t)throw new Error(1019..toString())})(e),Be(l,t,n.toString(),r)}function Le(t){var e=[];if(Array.isArray(t)){var n=function(t){var e,n=new Set,r=m()(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(n.has(i))return i;n.add(i)}}catch(o){r.e(o)}finally{r.f()}}((e=t).map((function(t){return t.key})));if(void 0!==n)throw new Error("".concat(1002," ").concat(n.toString()))}else e=[t];return e}function Be(t,e,n,r){var i,o=Le(r),a={};tt(t,e)&&(a=et(t,e));var s=a[n];if(void 0===s)s=[];else{var u,c=m()(s);try{var l=function(){var t=u.value;if(o.some((function(e){return e.key===t.key})))throw new Error("".concat(1002," ").concat(t.key.toString()))};for(c.s();!(u=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}(i=s).push.apply(i,It()(o)),a[n]=s,J(t,a,e)}function Fe(t){return function(e,n,r){"number"==typeof r?De(e,n,r,t):function(t,e,n){if(function(t){return void 0!==t.prototype}(t))throw new Error(1019..toString());Be(f,t.constructor,e,n)}(e,n,t)}}function ke(){return function(t){if(!tt(h,t))return J(h,[],t),t}}function Ue(t){return function(e){return function(n,r,i){if(void 0===e){var o="function"==typeof n?n.name:n.constructor.name;throw new Error("".concat(1010," ").concat(o))}return Fe(new Ct(t,e))(n,r,i)}}}var Ge,Ve,je,We=Ue(u);function Xe(t,e){return function(){return function(n,r){var i=new Ct(t,r);if(tt(t,n.constructor))throw new Error(e);J(t,i,n.constructor)}}}function He(t,e){return e.lifecycle===Ve.Lifecycle.singleton?function(t){return t.inSingletonScope()}(t):function(t){return t.inTransientScope()}(t)}function Ye(t,e){t.whenTargetNamed(qe(e))}function ze(t,e){return e.bind(Ze(t))}function Ke(t,e){if(e.isBound(Ze(t)))try{return e.rebind(Ze(t))}catch(n){return e.bind(Ze(t))}return e.bind(Ze(t))}function qe(t){return je.isDefinedToken(t)?t.symbol:t}function Ze(t){return je.isDefinedToken(t)?t.symbol:t}Ue(c),Xe(d,1026..toString()),Xe(p,1025..toString()),Ge||(Ge={}),function(t){t.defineToken=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new Ve.DefinedToken(t,e)};var e,n,r=M()((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b()(this,t),C()(this,"prototype",{}),C()(this,"name",void 0),C()(this,"multiple",void 0),C()(this,"symbol",void 0);var r=n.multiple,i=void 0!==r&&r;this.name=e,this.symbol=Symbol(this.name),this.multiple=i}));t.DefinedToken=r,t.isModule=function(t){return!!t&&"object"===A()(t)&&"id"in t},(n=e||(e={})).singleton="singleton",n.transient="transient",t.Lifecycle=e,t.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),t.DefaultOption={lifecycle:e.transient}}(Ve||(Ve={})),function(t){t.toArray=function(t){return Array.isArray(t)?t:void 0===t?[]:[t]},t.isClass=function(t){return!(!t||"function"!=typeof t||!("prototype"in t))},t.isDefinedToken=function(t){return!!(t&&"object"===A()(t)&&"symbol"in t&&"multiple"in t)},t.isInjectOption=function(t){return!(!t||"object"!==A()(t)||!("token"in t))},t.isNamedToken=function(t){return!!(t&&"object"===A()(t)&&"token"in t&&"named"in t)},t.isMultipleEnabled=function(t){return je.isDefinedToken(t)&&t.multiple}}(je||(je={}));var Qe=new Ie;function Je(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=ke();return function(r){J(Ve.ClassOptionSymbol,e()(e()({},t),{},{target:r}),r),n(r)}}function $e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Je(e()(e()({},t),{},{lifecycle:Ve.Lifecycle.singleton}))}function tn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Je(e()(e()({},t),{},{lifecycle:Ve.Lifecycle.transient}))}function en(t){return We(Ze(t))}function nn(t){return function(t){return Fe(new Ct(i,t))}(qe(t))}var rn=Symbol("SyringeOptionSymbol"),on=function(t,e){J(rn,t,e)},an=function(){function t(e,n,r){b()(this,t),C()(this,"token",void 0),C()(this,"rawToken",void 0),C()(this,"named",void 0),C()(this,"generalToken",void 0),C()(this,"option",void 0),C()(this,"register",void 0),C()(this,"mutiple",void 0),this.register=e,this.token=n,this.option=r,this.rawToken=je.isNamedToken(n)?n.token:n,this.named=je.isNamedToken(n)?n.named:void 0,this.mutiple=!!this.named||je.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return M()(t,[{key:"resolve",value:function(){var t=this,e=this.register;!function(t){return t&&"object"===A()(t)&&"bind"in t&&"unbind"in t&&"rebind"in t&&"isBound"in t}(e)||(this.mutiple?this.resolveMutilple(e):(this.resolveMono(e),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(n){je.isMultipleEnabled(n)?ze(n,e).toService(t.generalToken):Ke(n,e).toService(t.generalToken)}))))}},{key:"resolveMono",value:function(t){if("useValue"in this.option)return Ke(this.generalToken,t).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var e=this.option.useDynamic[this.option.useDynamic.length-1];return He(Ke(this.generalToken,t).toDynamicValue((function(t){var n=gn.getContainer(t.container);return e({container:n})})),this.option)}if(this.option.useFactory.length>0){var n=this.option.useFactory[this.option.useFactory.length-1];return Ke(this.generalToken,t).toFactory((function(t){var e=gn.getContainer(t.container);return n({container:e})}))}if(this.option.useClass.length>0){var r=this.option.useClass[this.option.useClass.length-1];return He(Ke(this.generalToken,t).to(r),this.option)}}},{key:"resolveMutilple",value:function(t){var e=this,n=this.option.useClass.map((function(n){return He(ze(e.generalToken,t).to(n),e.option)})),r=this.option.useDynamic.map((function(n){return He(ze(e.generalToken,t).toDynamicValue((function(t){var e=gn.getContainer(t.container);return n({container:e})})),e.option)})),i=this.option.useFactory.map((function(n){return ze(e.generalToken,t).toFactory((function(t){var e=gn.getContainer(t.container);return n({container:e})}))})),o="useValue"in this.option?ze(this.generalToken,t).toConstantValue(this.option.useValue):void 0;this.named&&(n.forEach((function(t){return e.named&&Ye(t,e.named)})),r.forEach((function(t){return e.named&&Ye(t,e.named)})),i.forEach((function(t){return e.named&&Ye(t,e.named)})),o&&Ye(o,this.named))}}],[{key:"resolveTarget",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var o=et(rn,r);o&&t.resolveOption(n,o)}catch(c){}if(je.isClass(r))if(i.useClass){var a=je.toArray(i.useClass);a.unshift(r),i.useClass=a}else i.useClass=[r];var s;try{s=et(Ve.ClassOptionSymbol,r)}catch(l){}if((s=e()(e()({},s||{}),i)).token){var u=je.toArray(s.token);u.unshift(r),s.token=u}else s.token=[r];t.resolveOption(n,s)}catch(f){}}},{key:"resolveOption",value:function(n,r){var i=function(t){var e=je.toArray(t.token),n=je.toArray(t.useClass),r=je.toArray(t.useDynamic),i=je.toArray(t.useFactory),o=je.toArray(t.contrib),a=t.lifecycle||Ve.Lifecycle.transient,s={token:e,useClass:n,lifecycle:o.length>0?Ve.Lifecycle.singleton:a,contrib:o,useDynamic:r,useFactory:i};return"useValue"in t&&(s.useValue=t.useValue),s}(e()(e()({},t.globalConfig),r));0===i.useClass.length&&0===i.useDynamic.length&&0===i.useFactory.length&&!("useValue"in i)||i.token.forEach((function(r){new t(n,r,e()({},i)).resolve()}))}}]),t}();C()(an,"globalConfig",Ve.DefaultOption);var sn=Ve.defineToken("ContributionProvider"),un=function(){function t(n,r,i){b()(this,t),C()(this,"option",{recursive:!1,cache:!0}),C()(this,"services",void 0),C()(this,"serviceIdentifier",void 0),C()(this,"container",void 0),this.container=r,this.serviceIdentifier=n,i&&(this.option=e()(e()({},this.option),i))}return M()(t,[{key:"setServices",value:function(t){for(var e=[],n=this.container;n;){if(n.isBound(this.serviceIdentifier)){var r=n.getAll(this.serviceIdentifier);e.push.apply(e,It()(r))}n=t?n.parent:void 0}return e}},{key:"getContributions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e()(e()({},this.option),t),r=n.cache,i=n.recursive;return(!r||void 0===this.services)&&(this.services=this.setServices(!!i)),this.services}}]),t}();function cn(t,e){return{token:{token:sn,named:t},useDynamic:function(n){return new un(t,n.container,e)},lifecycle:Ve.Lifecycle.singleton}}function ln(t,e,n){t({token:{token:sn,named:e},useDynamic:function(t){return new un(e,t.container,n)},lifecycle:Ve.Lifecycle.singleton})}var fn=function(){function t(e){var n=this;b()(this,t),C()(this,"id",void 0),C()(this,"inversifyModule",void 0),C()(this,"baseRegistry",void 0),C()(this,"optionCollection",void 0),C()(this,"inversifyRegister",(function(t,e,r,i){var o={bind:t,unbind:e,isBound:r,rebind:i},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};je.isInjectOption(t)?an.resolveOption(o,t):an.resolveTarget(o,t,e)};n.baseRegistry&&n.baseRegistry(a),n.optionCollection&&n.optionCollection.forEach((function(t){return a(t)}))})),this.baseRegistry=e,this.inversifyModule=new we(this.inversifyRegister),this.id=this.inversifyModule.id}return M()(t,[{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.options.push(e)})),this}},{key:"contribution",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.options.push(cn(e))})),this}}]),t}();function hn(t){return t&&"inversifyModule"in t}function dn(t){return new fn(t)}var pn,vn=new Map,gn=function(){function t(e){b()(this,t),C()(this,"loadedModules",[]),C()(this,"container",void 0),C()(this,"inversify",!0),C()(this,"parent",void 0),this.container=e||new Ie,t.setContainer(this.container,this)}return M()(t,[{key:"load",value:function(t,e){var n=this;return e||!this.loadedModules.includes(t.id)?(hn(t)?this.container.load(t.inversifyModule):console.warn("Unsupported module.",t),this.loadedModules.push(t.id),{dispose:function(){n.unload(t)}}):{dispose:function(){}}}},{key:"unload",value:function(t){hn(t)&&(this.container.unload(t.inversifyModule),this.loadedModules=this.loadedModules.filter((function(e){return e!==t.id})))}},{key:"remove",value:function(t){return this.container.unbind(Ze(t))}},{key:"get",value:function(t){return this.container.get(Ze(t))}},{key:"getNamed",value:function(t,e){return this.container.getNamed(Ze(t),qe(e))}},{key:"getAll",value:function(t){return this.container.getAll(Ze(t))}},{key:"getAllNamed",value:function(t,e){return this.container.getAllNamed(Ze(t),qe(e))}},{key:"isBound",value:function(t){return this.container.isBound(Ze(t))}},{key:"isBoundNamed",value:function(t,e){return this.container.isBoundNamed(Ze(t),qe(e))}},{key:"createChild",value:function(){var e=new t(this.container.createChild());return e.parent=this,e}},{key:"register",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};je.isInjectOption(t)?an.resolveOption(this.container,t):an.resolveTarget(this.container,t,e)}}],[{key:"setContainer",value:function(t,e){return vn.set(t.id,e)}},{key:"getContainer",value:function(e){var n=vn.get(e.id);if(!n){var r=new t(e);return t.setContainer(e,r),r}return n}},{key:"config",value:function(t){an.globalConfig=t}}]),t}(),mn=new gn(Qe),yn=mn.register.bind(mn),_n=function(t){return function(e,n,r){nn(t)(e,n,r),en(sn)(e,n,r)}};!function(t){t.Provider=sn,t.register=ln}(pn||(pn={}))}(),r}()},function(t,e,n){var r=n(31),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},function(t,e,n){var r=n(2),i="object"==typeof document&&document.all,o=void 0===i&&void 0!==i;t.exports=o?function(t){return"object"==typeof t?null!==t:r(t)||t===i}:function(t){return"object"==typeof t?null!==t:r(t)}},function(t,e,n){var r=n(0),i=n(46).f,o=n(40),a=n(56),s=n(38),u=n(83),c=n(90);t.exports=function(t,e){var n,l,f,h,d,p=t.target,v=t.global,g=t.stat;if(n=v?r:g?r[p]||s(p,{}):(r[p]||{}).prototype)for(l in e){if(h=e[l],f=t.dontCallGetSet?(d=i(n,l))&&d.value:n[l],!c(v?l:p+(g?".":"#")+l,t.forced)&&void 0!==f){if(typeof h==typeof f)continue;u(h,f)}(t.sham||f&&f.sham)&&o(h,"sham",!0),a(n,l,h,t)}}},function(t,e,n){var r=n(2),i=n(21),o=TypeError;t.exports=function(t){if(r(t))return t;throw o(i(t)+" is not a function")}},function(t,e,n){var r=n(48),i=Object;t.exports=function(t){return i(r(t))}},function(t,e,n){"use strict";var r=n(16),i=n(3),o=n(17),a=n(18),s=n(11),u=n(91),c=n(92),l=n(1),f=n(62),h=n(64),d=n(65),p=n(66),v=n(25),g=n(67),m=[],y=i(m.sort),_=i(m.push),E=l((function(){m.sort(void 0)})),T=l((function(){m.sort(null)})),R=h("sort"),A=!l((function(){if(v)return v<70;if(!(d&&d>3)){if(p)return!0;if(g)return g<603;var t,e,n,r,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)m.push({k:e+r,v:n})}for(m.sort((function(t,e){return e.v-t.v})),r=0;r<m.length;r++)e=m[r].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:E||!T||!R||!A},{sort:function(t){void 0!==t&&o(t);var e=a(this);if(A)return void 0===t?y(e):y(e,t);var n,r,i=[],l=s(e);for(r=0;r<l;r++)r in e&&_(i,e[r]);for(f(i,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:c(e)>c(n)?1:-1}}(t)),n=s(i),r=0;r<n;)e[r]=i[r++];for(;r<l;)u(e,r++);return e}})},function(t,e,n){var r=n(0),i=n(2),o=function(t){return i(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t]):r[t]&&r[t][e]}},function(t,e){var n=String;t.exports=function(t){try{return n(t)}catch(e){return"Object"}}},function(t,e,n){"use strict";var r=n(16),i=n(110).left,o=n(64),a=n(25),s=n(111);r({target:"Array",proto:!0,forced:!o("reduce")||!s&&a>79&&a<83},{reduce:function(t){var e=arguments.length;return i(this,t,e,e>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(47),i=n(48);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(3),i=r({}.toString),o=r("".slice);t.exports=function(t){return o(i(t),8,-1)}},function(t,e,n){var r,i,o=n(0),a=n(26),s=o.process,u=o.Deno,c=s&&s.versions||u&&u.version,l=c&&c.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),t.exports=i},function(t,e,n){var r=n(20);t.exports=r("navigator","userAgent")||""},function(t,e,n){var r=n(87);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},function(t,e,n){var r=n(93),i=n(2),o=n(24),a=n(9)("toStringTag"),s=Object,u="Arguments"==o(function(){return arguments}());t.exports=r?o:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=s(t),a))?n:u?o(e):"Object"==(r=o(e))&&i(e.callee)?"Arguments":r}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return r}));r();function r(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}}).call(this,n(30))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(1);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports=function(t){return null==t}},function(t,e,n){var r=n(78),i=n(49);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},function(t,e,n){var r=n(3);t.exports=r({}.isPrototypeOf)},function(t,e,n){var r=n(17),i=n(33);t.exports=function(t,e){var n=t[e];return i(n)?void 0:r(n)}},function(t,e,n){var r=n(0),i=n(38),o=r["__core-js_shared__"]||i("__core-js_shared__",{});t.exports=o},function(t,e,n){var r=n(0),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},function(t,e,n){var r=n(3),i=0,o=Math.random(),a=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++i+o,36)}},function(t,e,n){var r=n(4),i=n(10),o=n(32);t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(52),i=n(39),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports={}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,r,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,o),!0;case 6:return l.fn.call(l.context,e,n,r,o,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,r);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==e||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,t.exports=c},function(t,e,n){n(19),t.exports=function(){"use strict";function t(t,r,i,o,a){!function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-u*l/s+f)),Math.min(o,Math.floor(r+(s-u)*l/s+f)),a)}var h=n[r],d=i,p=o;for(e(n,i,r),a(n[o],h)>0&&e(n,i,o);d<p;){for(e(n,d,p),d++,p--;a(n[d],h)<0;)d++;for(;a(n[p],h)>0;)p--}0===a(n[i],h)?e(n,i,p):e(n,++p,o),p<=r&&(i=p+1),r<=p&&(o=p-1)}}(t,r,i||0,o||t.length-1,a||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];s(i,t.leaf?r(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;d(t,s)&&(e.leaf?n.push(a):h(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(d(t,o)){if(e.leaf||h(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,a=this.data,s=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),r=u[u.length-1],n=c.pop(),o=!0),a.leaf){var l=i(t,a.children,e);if(-1!==l)return a.children.splice(l,1),u.push(a),this._condense(u),this}o||a.leaf||!h(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(u.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return o(i=p(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=p([])).leaf=!1,i.height=r;var u=Math.ceil(a/s),c=u*Math.ceil(Math.sqrt(s));v(t,e,n,c,this.compareMinX);for(var l=e;l<=n;l+=c){var f=Math.min(l+c-1,n);v(t,l,f,u,this.compareMinY);for(var h=l;h<=f;h+=u){var d=Math.min(h+u-1,f);i.children.push(this._build(t,h,d,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=l(u),f=(h=t,d=u,(Math.max(d.maxX,h.maxX)-Math.min(d.minX,h.minX))*(Math.max(d.maxY,h.maxY)-Math.min(d.minY,h.minY))-c);f<o?(o=f,i=c<i?c:i,a=u):f===o&&c<i&&(i=c,a=u)}e=a||e.children[0]}var h,d;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),s(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=p(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,s,u,c,f,h=1/0,d=1/0,p=e;p<=n-e;p++){var v=a(t,0,p,this.toBBox),g=a(t,p,n,this.toBBox),m=(i=v,o=g,s=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),f=Math.min(i.maxY,o.maxY),Math.max(0,c-s)*Math.max(0,f-u)),y=l(v)+l(g);m<h?(h=m,r=p,d=y<d?y:d):m===h&&y<d&&(d=y,r=p)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),u=a(t,n-e,n,i),c=f(o)+f(u),l=e;l<n-e;l++){var h=t.children[l];s(o,t.leaf?i(h):h),c+=f(o)}for(var d=n-e-1;d>=e;d--){var p=t.children[d];s(u,t.leaf?i(p):p),c+=f(u)}return c},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)s(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},function(t,e,n){var r=n(4),i=n(14),o=n(77),a=n(32),s=n(23),u=n(34),c=n(7),l=n(53),f=Object.getOwnPropertyDescriptor;e.f=r?f:function(t,e){if(t=s(t),e=u(e),l)try{return f(t,e)}catch(n){}if(c(t,e))return a(!i(o.f,t,e),t[e])}},function(t,e,n){var r=n(3),i=n(1),o=n(24),a=Object,s=r("".split);t.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"==o(t)?s(t,""):a(t)}:a},function(t,e,n){var r=n(33),i=TypeError;t.exports=function(t){if(r(t))throw i("Can't call method on "+t);return t}},function(t,e,n){var r=n(20),i=n(2),o=n(35),a=n(50),s=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&o(e.prototype,s(t))}},function(t,e,n){var r=n(51);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,n){var r=n(25),i=n(1);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(t,e,n){var r=n(80),i=n(37);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.1",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,e,n){var r=n(4),i=n(1),o=n(54);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(0),i=n(15),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},function(t,e,n){var r=n(4),i=n(1);t.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(t,e,n){var r=n(2),i=n(10),o=n(57),a=n(38);t.exports=function(t,e,n,s){s||(s={});var u=s.enumerable,c=void 0!==s.name?s.name:e;if(r(n)&&o(n,c,s),s.global)u?t[e]=n:a(e,n);else{try{s.unsafe?t[e]&&(u=!0):delete t[e]}catch(l){}u?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return t}},function(t,e,n){var r=n(1),i=n(2),o=n(7),a=n(4),s=n(81).CONFIGURABLE,u=n(58),c=n(59),l=c.enforce,f=c.get,h=Object.defineProperty,d=a&&!r((function(){return 8!==h((function(){}),"length",{value:8}).length})),p=String(String).split("String"),v=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!o(t,"name")||s&&t.name!==e)&&(a?h(t,"name",{value:e,configurable:!0}):t.name=e),d&&n&&o(n,"arity")&&t.length!==n.arity&&h(t,"length",{value:n.arity});try{n&&o(n,"constructor")&&n.constructor?a&&h(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(i){}var r=l(t);return o(r,"source")||(r.source=p.join("string"==typeof e?e:"")),t};Function.prototype.toString=v((function(){return i(this)&&f(this).source||u(this)}),"toString")},function(t,e,n){var r=n(3),i=n(2),o=n(37),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(t){return a(t)}),t.exports=o.inspectSource},function(t,e,n){var r,i,o,a=n(82),s=n(0),u=n(3),c=n(15),l=n(40),f=n(7),h=n(37),d=n(41),p=n(42),v=s.TypeError,g=s.WeakMap;if(a||h.state){var m=h.state||(h.state=new g),y=u(m.get),_=u(m.has),E=u(m.set);r=function(t,e){if(_(m,t))throw v("Object already initialized");return e.facade=t,E(m,t,e),e},i=function(t){return y(m,t)||{}},o=function(t){return _(m,t)}}else{var T=d("state");p[T]=!0,r=function(t,e){if(f(t,T))throw v("Object already initialized");return e.facade=t,l(t,T,e),e},i=function(t){return f(t,T)?t[T]:{}},o=function(t){return f(t,T)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw v("Incompatible receiver, "+t+" required");return n}}}},function(t,e,n){var r=n(3),i=n(7),o=n(23),a=n(86).indexOf,s=n(42),u=r([].push);t.exports=function(t,e){var n,r=o(t),c=0,l=[];for(n in r)!i(s,n)&&i(r,n)&&u(l,n);for(;e.length>c;)i(r,n=e[c++])&&(~a(l,n)||u(l,n));return l}},function(t,e,n){var r=n(27),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},function(t,e,n){var r=n(94),i=Math.floor,o=function(t,e){var n=t.length,u=i(n/2);return n<8?a(t,e):s(t,o(r(t,0,u),e),o(r(t,u),e),e)},a=function(t,e){for(var n,r,i=t.length,o=1;o<i;){for(r=o,n=t[o];r&&e(t[r-1],n)>0;)t[r]=t[--r];r!==o++&&(t[r]=n)}return t},s=function(t,e,n,r){for(var i=e.length,o=n.length,a=0,s=0;a<i||s<o;)t[a+s]=a<i&&s<o?r(e[a],n[s])<=0?e[a++]:n[s++]:a<i?e[a++]:n[s++];return t};t.exports=o},function(t,e,n){"use strict";var r=n(34),i=n(10),o=n(32);t.exports=function(t,e,n){var a=r(e);a in t?i.f(t,a,o(0,n)):t[a]=n}},function(t,e,n){"use strict";var r=n(1);t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){return 1},1)}))}},function(t,e,n){var r=n(26).match(/firefox\/(\d+)/i);t.exports=!!r&&+r[1]},function(t,e,n){var r=n(26);t.exports=/MSIE|Trident/.test(r)},function(t,e,n){var r=n(26).match(/AppleWebKit\/(\d+)\./);t.exports=!!r&&+r[1]},function(t,e,n){"use strict";var r,i,o,a=n(95),s=n(4),u=n(0),c=n(2),l=n(15),f=n(7),h=n(28),d=n(21),p=n(40),v=n(56),g=n(10).f,m=n(35),y=n(96),_=n(98),E=n(9),T=n(39),R=n(59),A=R.enforce,S=R.get,b=u.Int8Array,x=b&&b.prototype,M=u.Uint8ClampedArray,O=M&&M.prototype,C=b&&y(b),N=x&&y(x),P=Object.prototype,I=u.TypeError,w=E("toStringTag"),D=T("TYPED_ARRAY_TAG"),L=a&&!!_&&"Opera"!==h(u.opera),B=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},k={BigInt64Array:8,BigUint64Array:8},U=function(t){var e=y(t);if(l(e)){var n=S(e);return n&&f(n,"TypedArrayConstructor")?n.TypedArrayConstructor:U(e)}},G=function(t){if(!l(t))return!1;var e=h(t);return f(F,e)||f(k,e)};for(r in F)(o=(i=u[r])&&i.prototype)?A(o).TypedArrayConstructor=i:L=!1;for(r in k)(o=(i=u[r])&&i.prototype)&&(A(o).TypedArrayConstructor=i);if((!L||!c(C)||C===Function.prototype)&&(C=function(){throw I("Incorrect invocation")},L))for(r in F)u[r]&&_(u[r],C);if((!L||!N||N===P)&&(N=C.prototype,L))for(r in F)u[r]&&_(u[r].prototype,N);if(L&&y(O)!==N&&_(O,N),s&&!f(N,w))for(r in B=!0,g(N,w,{get:function(){return l(this)?this[D]:void 0}}),F)u[r]&&p(u[r],D,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:L,TYPED_ARRAY_TAG:B&&D,aTypedArray:function(t){if(G(t))return t;throw I("Target is not a typed array")},aTypedArrayConstructor:function(t){if(c(t)&&(!_||m(C,t)))return t;throw I(d(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,r){if(s){if(n)for(var i in F){var o=u[i];if(o&&f(o.prototype,t))try{delete o.prototype[t]}catch(a){try{o.prototype[t]=e}catch(c){}}}N[t]&&!n||v(N,t,n?e:L&&x[t]||e,r)}},exportTypedArrayStaticMethod:function(t,e,n){var r,i;if(s){if(_){if(n)for(r in F)if((i=u[r])&&f(i,t))try{delete i[t]}catch(o){}if(C[t]&&!n)return;try{return v(C,t,n?e:L&&C[t]||e)}catch(o){}}for(r in F)!(i=u[r])||i[t]&&!n||v(i,t,e)}},getTypedArrayConstructor:U,isView:function(t){if(!l(t))return!1;var e=h(t);return"DataView"===e||f(F,e)||f(k,e)},isTypedArray:G,TypedArray:C,TypedArrayPrototype:N}},function(t,e,n){var r=n(3),i=n(17),o=n(31),a=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:o?a(t,e):function(){return t.apply(e,arguments)}}},function(t,e){t.exports={}},function(t,e,n){var r=n(28),i=n(36),o=n(33),a=n(70),s=n(9)("iterator");t.exports=function(t){if(!o(t))return i(t,s)||i(t,"@@iterator")||a[r(t)]}},function(t,e,n){n(113)},function(t,e,n){var r=n(24);t.exports=Array.isArray||function(t){return"Array"==r(t)}},,,,function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},function(t,e,n){var r=n(14),i=n(15),o=n(49),a=n(36),s=n(79),u=n(9),c=TypeError,l=u("toPrimitive");t.exports=function(t,e){if(!i(t)||o(t))return t;var n,u=a(t,l);if(u){if(void 0===e&&(e="default"),n=r(u,t,e),!i(n)||o(n))return n;throw c("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(t,e)}},function(t,e,n){var r=n(14),i=n(2),o=n(15),a=TypeError;t.exports=function(t,e){var n,s;if("string"===e&&i(n=t.toString)&&!o(s=r(n,t)))return s;if(i(n=t.valueOf)&&!o(s=r(n,t)))return s;if("string"!==e&&i(n=t.toString)&&!o(s=r(n,t)))return s;throw a("Can't convert object to primitive value")}},function(t,e){t.exports=!1},function(t,e,n){var r=n(4),i=n(7),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),u=s&&"something"===function(){}.name,c=s&&(!r||r&&a(o,"name").configurable);t.exports={EXISTS:s,PROPER:u,CONFIGURABLE:c}},function(t,e,n){var r=n(0),i=n(2),o=r.WeakMap;t.exports=i(o)&&/native code/.test(String(o))},function(t,e,n){var r=n(7),i=n(84),o=n(46),a=n(10);t.exports=function(t,e,n){for(var s=i(e),u=a.f,c=o.f,l=0;l<s.length;l++){var f=s[l];r(t,f)||n&&r(n,f)||u(t,f,c(e,f))}}},function(t,e,n){var r=n(20),i=n(3),o=n(85),a=n(89),s=n(8),u=i([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(s(t)),n=a.f;return n?u(e,n(t)):e}},function(t,e,n){var r=n(60),i=n(43).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(23),i=n(61),o=n(11),a=function(t){return function(e,n,a){var s,u=r(e),c=o(u),l=i(a,c);if(t&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(t){var e=+t;return(e>0?r:n)(e)}},function(t,e,n){var r=n(27),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(1),i=n(2),o=/#|\.prototype\./,a=function(t,e){var n=u[s(t)];return n==l||n!=c&&(i(e)?r(e):!!e)},s=a.normalize=function(t){return String(t).replace(o,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";t.exports=a},function(t,e,n){"use strict";var r=n(21),i=TypeError;t.exports=function(t,e){if(!delete t[e])throw i("Cannot delete property "+r(e)+" of "+r(t))}},function(t,e,n){var r=n(28),i=String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return i(t)}},function(t,e,n){var r={};r[n(9)("toStringTag")]="z",t.exports="[object z]"===String(r)},function(t,e,n){var r=n(61),i=n(11),o=n(63),a=Array,s=Math.max;t.exports=function(t,e,n){for(var u=i(t),c=r(e,u),l=r(void 0===n?u:n,u),f=a(s(l-c,0)),h=0;c<l;c++,h++)o(f,h,t[c]);return f.length=h,f}},function(t,e){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(t,e,n){var r=n(7),i=n(2),o=n(18),a=n(41),s=n(97),u=a("IE_PROTO"),c=Object,l=c.prototype;t.exports=s?c.getPrototypeOf:function(t){var e=o(t);if(r(e,u))return e[u];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof c?l:null}},function(t,e,n){var r=n(1);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,n){var r=n(3),i=n(8),o=n(99);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(a){}return function(n,r){return i(n),o(r),e?t(n,r):n.__proto__=r,n}}():void 0)},function(t,e,n){var r=n(2),i=String,o=TypeError;t.exports=function(t){if("object"==typeof t||r(t))return t;throw o("Can't set "+i(t)+" as a prototype")}},function(t,e,n){var r=n(101),i=RangeError;t.exports=function(t,e){var n=r(t);if(n%e)throw i("Wrong offset");return n}},function(t,e,n){var r=n(27),i=RangeError;t.exports=function(t){var e=r(t);if(e<0)throw i("The argument can't be less than 0");return e}},function(t,e,n){var r=n(0),i=n(4),o=n(103),a=n(104),s=n(1),u=r.RegExp,c=u.prototype;i&&s((function(){var t=!0;try{u(".","d")}catch(s){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var a in t&&(o.hasIndices="d"),o)i(a,o[a]);return Object.getOwnPropertyDescriptor(c,"flags").get.call(e)!==r||n!==r}))&&o(c,"flags",{configurable:!0,get:a})},function(t,e,n){var r=n(57),i=n(10);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),i.f(t,e,n)}},function(t,e,n){"use strict";var r=n(8);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},function(t,e,n){var r=n(16),i=n(106),o=n(63);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,(function(t,n){o(e,t,n)}),{AS_ENTRIES:!0}),e}})},function(t,e,n){var r=n(69),i=n(14),o=n(8),a=n(21),s=n(107),u=n(11),c=n(35),l=n(108),f=n(71),h=n(109),d=TypeError,p=function(t,e){this.stopped=t,this.result=e},v=p.prototype;t.exports=function(t,e,n){var g,m,y,_,E,T,R,A=n&&n.that,S=!(!n||!n.AS_ENTRIES),b=!(!n||!n.IS_RECORD),x=!(!n||!n.IS_ITERATOR),M=!(!n||!n.INTERRUPTED),O=r(e,A),C=function(t){return g&&h(g,"normal",t),new p(!0,t)},N=function(t){return S?(o(t),M?O(t[0],t[1],C):O(t[0],t[1])):M?O(t,C):O(t)};if(b)g=t.iterator;else if(x)g=t;else{if(!(m=f(t)))throw d(a(t)+" is not iterable");if(s(m)){for(y=0,_=u(t);_>y;y++)if((E=N(t[y]))&&c(v,E))return E;return new p(!1)}g=l(t,m)}for(T=b?t.next:g.next;!(R=i(T,g)).done;){try{E=N(R.value)}catch(P){h(g,"throw",P)}if("object"==typeof E&&E&&c(v,E))return E}return new p(!1)}},function(t,e,n){var r=n(9),i=n(70),o=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},function(t,e,n){var r=n(14),i=n(17),o=n(8),a=n(21),s=n(71),u=TypeError;t.exports=function(t,e){var n=arguments.length<2?s(t):e;if(i(n))return o(r(n,t));throw u(a(t)+" is not iterable")}},function(t,e,n){var r=n(14),i=n(8),o=n(36);t.exports=function(t,e,n){var a,s;i(t);try{if(!(a=o(t,"return"))){if("throw"===e)throw n;return n}a=r(a,t)}catch(u){s=!0,a=u}if("throw"===e)throw n;if(s)throw a;return i(a),n}},function(t,e,n){var r=n(17),i=n(18),o=n(47),a=n(11),s=TypeError,u=function(t){return function(e,n,u,c){r(n);var l=i(e),f=o(l),h=a(l),d=t?h-1:0,p=t?-1:1;if(u<2)for(;;){if(d in f){c=f[d],d+=p;break}if(d+=p,t?d<0:h<=d)throw s("Reduce of empty array with no initial value")}for(;t?d>=0:h>d;d+=p)d in f&&(c=n(c,f[d],d,l));return c}};t.exports={left:u(!1),right:u(!0)}},function(t,e,n){var r=n(24),i=n(0);t.exports="process"==r(i.process)},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=r}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){var r=n(16),i=n(0);r({global:!0,forced:i.globalThis!==i},{globalThis:i})},function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return p}));var i,o=1,a="object"==typeof self&&self.self==self?self:"object"==typeof t&&t.global==t?t:{},s=Date.now(),u={},c=Date.now(),l=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");var e=Date.now(),n=e-c,r=n>16?0:16-n,i=o++;return u[i]=t,Object.keys(u).length>1||setTimeout((function(){c=e;var t=u;u={},Object.keys(t).forEach((function(e){return t[e](a.performance&&"function"==typeof a.performance.now?a.performance.now():Date.now()-s)}))}),r),i},f=function(t){delete u[t]},h=function(t){return"string"!=typeof t?l:""===t?a.requestAnimationFrame:a[t+"RequestAnimationFrame"]},d=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],(function(t){return!!h(t)})),p=h(d),v="string"!=typeof(i=d)?f:""===i?a.cancelAnimationFrame:a[i+"CancelAnimationFrame"]||a[i+"CancelRequestAnimationFrame"];a.requestAnimationFrame=p,a.cancelAnimationFrame=v,r.exports&&(r.exports={requestAnimationFrame:p,cancelAnimationFrame:v})}).call(this,n(30),n(115)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){"use strict";var r=n(16),i=n(117),o=n(18),a=n(11),s=n(27),u=n(119);r({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=o(this),n=a(e),r=u(e,0);return r.length=i(r,e,e,n,0,void 0===t?1:s(t)),r}})},function(t,e,n){"use strict";var r=n(73),i=n(11),o=n(118),a=n(69),s=function(t,e,n,u,c,l,f,h){for(var d,p,v=c,g=0,m=!!f&&a(f,h);g<u;)g in n&&(d=m?m(n[g],g,e):n[g],l>0&&r(d)?(p=i(d),v=s(t,e,d,p,v,l-1)-1):(o(v+1),t[v]=d),v++),g++;return v};t.exports=s},function(t,e){var n=TypeError;t.exports=function(t){if(t>9007199254740991)throw n("Maximum allowed index exceeded");return t}},function(t,e,n){var r=n(120);t.exports=function(t,e){return new(r(t))(0===e?0:e)}},function(t,e,n){var r=n(73),i=n(121),o=n(15),a=n(9)("species"),s=Array;t.exports=function(t){var e;return r(t)&&(e=t.constructor,(i(e)&&(e===s||r(e.prototype))||o(e)&&null===(e=e[a]))&&(e=void 0)),void 0===e?s:e}},function(t,e,n){var r=n(3),i=n(1),o=n(2),a=n(28),s=n(20),u=n(58),c=function(){},l=[],f=s("Reflect","construct"),h=/^\s*(?:class|function)\b/,d=r(h.exec),p=!h.exec(c),v=function(t){if(!o(t))return!1;try{return f(c,l,t),!0}catch(e){return!1}},g=function(t){if(!o(t))return!1;switch(a(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!d(h,u(t))}catch(e){return!0}};g.sham=!0,t.exports=!f||i((function(){var t;return v(v.call)||!v(Object)||!v((function(){t=!0}))||t}))?g:v},function(t,e,n){n(123)("flat")},function(t,e,n){var r=n(9),i=n(124),o=n(10).f,a=r("unscopables"),s=Array.prototype;null==s[a]&&o(s,a,{configurable:!0,value:i(null)}),t.exports=function(t){s[a][t]=!0}},function(t,e,n){var r,i=n(8),o=n(125),a=n(43),s=n(42),u=n(127),c=n(54),l=n(41),f=l("IE_PROTO"),h=function(){},d=function(t){return"<script>"+t+"<\/script>"},p=function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e},v=function(){try{r=new ActiveXObject("htmlfile")}catch(i){}var t,e;v="undefined"!=typeof document?document.domain&&r?p(r):((e=c("iframe")).style.display="none",u.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F):p(r);for(var n=a.length;n--;)delete v.prototype[a[n]];return v()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(h.prototype=i(t),n=new h,h.prototype=null,n[f]=t):n=v(),void 0===e?n:o.f(n,e)}},function(t,e,n){var r=n(4),i=n(55),o=n(10),a=n(8),s=n(23),u=n(126);e.f=r&&!i?Object.defineProperties:function(t,e){a(t);for(var n,r=s(e),i=u(e),c=i.length,l=0;c>l;)o.f(t,n=i[l++],r[n]);return t}},function(t,e,n){var r=n(60),i=n(43);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(20);t.exports=r("document","documentElement")},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,o,s,u,c,l,d,p=e&&e.length,g=p?e[0]*n:t.length,m=i(t,0,g,n,!0),y=[];if(!m||m.next===m.prev)return y;if(p&&(m=function(t,e,n,r){var o,a,s,u,c,l=[];for(o=0,a=e.length;o<a;o++)s=e[o]*r,u=o<a-1?e[o+1]*r:t.length,(c=i(t,s,u,r,!1))===c.next&&(c.steiner=!0),l.push(v(c));for(l.sort(f),o=0;o<l.length;o++)n=h(l[o],n);return n}(t,e,m,n)),t.length>80*n){r=s=t[0],o=u=t[1];for(var _=n;_<g;_+=n)(c=t[_])<r&&(r=c),(l=t[_+1])<o&&(o=l),c>s&&(s=c),l>u&&(u=l);d=0!==(d=Math.max(s-r,u-o))?32767/d:0}return a(m,y,n,r,o,d,0),y}function i(t,e,n,r,i){var o,a;if(i===O(t,e,n,r)>0)for(o=e;o<n;o+=r)a=b(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=b(o,t[o],t[o+1],a);return a&&_(a,a.next)&&(x(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!_(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(x(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,h){if(t){!h&&f&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=p(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,f);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,f?u(t,r,i,f):s(t))e.push(d.i/n|0),e.push(t.i/n|0),e.push(v.i/n|0),x(t),t=v.next,g=v.next;else if((t=v)===g){h?1===h?a(t=c(o(t),e,n),e,n,r,i,f,2):2===h&&l(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(y(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,a=r.x,s=e.y,u=n.y,c=r.y,l=i<o?i<a?i:a:o<a?o:a,f=s<u?s<c?s:c:u<c?u:c,h=i>o?i>a?i:a:o>a?o:a,d=s>u?s>c?s:c:u>c?u:c,p=r.next;p!==e;){if(p.x>=l&&p.x<=h&&p.y>=f&&p.y<=d&&g(i,s,o,u,a,c,p.x,p.y)&&y(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(y(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,c=a.x,l=i.y,f=o.y,h=a.y,d=s<u?s<c?s:c:u<c?u:c,v=l<f?l<h?l:h:f<h?f:h,m=s>u?s>c?s:c:u>c?u:c,_=l>f?l>h?l:h:f>h?f:h,E=p(d,v,e,n,r),T=p(m,_,e,n,r),R=t.prevZ,A=t.nextZ;R&&R.z>=E&&A&&A.z<=T;){if(R.x>=d&&R.x<=m&&R.y>=v&&R.y<=_&&R!==i&&R!==a&&g(s,l,u,f,c,h,R.x,R.y)&&y(R.prev,R,R.next)>=0)return!1;if(R=R.prevZ,A.x>=d&&A.x<=m&&A.y>=v&&A.y<=_&&A!==i&&A!==a&&g(s,l,u,f,c,h,A.x,A.y)&&y(A.prev,A,A.next)>=0)return!1;A=A.nextZ}for(;R&&R.z>=E;){if(R.x>=d&&R.x<=m&&R.y>=v&&R.y<=_&&R!==i&&R!==a&&g(s,l,u,f,c,h,R.x,R.y)&&y(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;A&&A.z<=T;){if(A.x>=d&&A.x<=m&&A.y>=v&&A.y<=_&&A!==i&&A!==a&&g(s,l,u,f,c,h,A.x,A.y)&&y(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!_(i,a)&&E(i,r,r.next,a)&&A(i,a)&&A(a,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(a.i/n|0),x(r),x(r.next),r=t=a),r=r.next}while(r!==t);return o(r)}function l(t,e,n,r,i,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&m(u,c)){var l=S(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,e,n,r,i,s,0),void a(l,e,n,r,i,s,0)}c=c.next}u=u.next}while(u!==t)}function f(t,e){return t.x-e.x}function h(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a&&(a=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var u,c=n,l=n.x,f=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&g(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),A(r,t)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&d(n,r)))&&(n=r,h=u)),r=r.next}while(r!==c);return n}(t,e);if(!n)return e;var r=S(n,t);return o(r,r.next),o(n,n.next)}function d(t,e){return y(t.prev,t,e.prev)<0&&y(e.next,t,t.next)<0}function p(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(A(t,e)&&A(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(y(t.prev,t,e.prev)||y(t,e.prev,e))||_(t,e)&&y(t.prev,t,t.next)>0&&y(e.prev,e,e.next)>0)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,r){var i=R(y(t,e,n)),o=R(y(t,e,r)),a=R(y(n,r,t)),s=R(y(n,r,e));return i!==o&&a!==s||(!(0!==i||!T(t,n,e))||(!(0!==o||!T(t,r,e))||(!(0!==a||!T(n,t,r))||!(0!==s||!T(n,e,r)))))}function T(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function R(t){return t>0?1:t<0?-1:0}function A(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function S(t,e){var n=new M(t.i,t.x,t.y),r=new M(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function b(t,e,n,r){var i=new M(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}n(19),t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(O(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(O(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;f+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){"use strict";n.r(e),n.d(e,"render",(function(){return _y})),n.d(e,"triggerEvent",(function(){return Ey}));var r={};n.r(r),n.d(r,"create",(function(){return Ut})),n.d(r,"fromMat4",(function(){return Gt})),n.d(r,"clone",(function(){return Vt})),n.d(r,"copy",(function(){return jt})),n.d(r,"fromValues",(function(){return Wt})),n.d(r,"set",(function(){return Xt})),n.d(r,"identity",(function(){return Ht})),n.d(r,"transpose",(function(){return Yt})),n.d(r,"invert",(function(){return zt})),n.d(r,"adjoint",(function(){return Kt})),n.d(r,"determinant",(function(){return qt})),n.d(r,"multiply",(function(){return Zt})),n.d(r,"translate",(function(){return Qt})),n.d(r,"rotate",(function(){return Jt})),n.d(r,"scale",(function(){return $t})),n.d(r,"fromTranslation",(function(){return te})),n.d(r,"fromRotation",(function(){return ee})),n.d(r,"fromScaling",(function(){return ne})),n.d(r,"fromMat2d",(function(){return re})),n.d(r,"fromQuat",(function(){return ie})),n.d(r,"normalFromMat4",(function(){return oe})),n.d(r,"projection",(function(){return ae})),n.d(r,"str",(function(){return se})),n.d(r,"frob",(function(){return ue})),n.d(r,"add",(function(){return ce})),n.d(r,"subtract",(function(){return le})),n.d(r,"multiplyScalar",(function(){return fe})),n.d(r,"multiplyScalarAndAdd",(function(){return he})),n.d(r,"exactEquals",(function(){return de})),n.d(r,"equals",(function(){return pe})),n.d(r,"mul",(function(){return ve})),n.d(r,"sub",(function(){return ge}));var i={};n.r(i),n.d(i,"create",(function(){return me})),n.d(i,"clone",(function(){return ye})),n.d(i,"copy",(function(){return _e})),n.d(i,"fromValues",(function(){return Ee})),n.d(i,"set",(function(){return Te})),n.d(i,"identity",(function(){return Re})),n.d(i,"transpose",(function(){return Ae})),n.d(i,"invert",(function(){return Se})),n.d(i,"adjoint",(function(){return be})),n.d(i,"determinant",(function(){return xe})),n.d(i,"multiply",(function(){return Me})),n.d(i,"translate",(function(){return Oe})),n.d(i,"scale",(function(){return Ce})),n.d(i,"rotate",(function(){return Ne})),n.d(i,"rotateX",(function(){return Pe})),n.d(i,"rotateY",(function(){return Ie})),n.d(i,"rotateZ",(function(){return we})),n.d(i,"fromTranslation",(function(){return De})),n.d(i,"fromScaling",(function(){return Le})),n.d(i,"fromRotation",(function(){return Be})),n.d(i,"fromXRotation",(function(){return Fe})),n.d(i,"fromYRotation",(function(){return ke})),n.d(i,"fromZRotation",(function(){return Ue})),n.d(i,"fromRotationTranslation",(function(){return Ge})),n.d(i,"fromQuat2",(function(){return Ve})),n.d(i,"getTranslation",(function(){return je})),n.d(i,"getScaling",(function(){return We})),n.d(i,"getRotation",(function(){return Xe})),n.d(i,"fromRotationTranslationScale",(function(){return He})),n.d(i,"fromRotationTranslationScaleOrigin",(function(){return Ye})),n.d(i,"fromQuat",(function(){return ze})),n.d(i,"frustum",(function(){return Ke})),n.d(i,"perspectiveNO",(function(){return qe})),n.d(i,"perspective",(function(){return Ze})),n.d(i,"perspectiveZO",(function(){return Qe})),n.d(i,"perspectiveFromFieldOfView",(function(){return Je})),n.d(i,"orthoNO",(function(){return $e})),n.d(i,"ortho",(function(){return tn})),n.d(i,"orthoZO",(function(){return en})),n.d(i,"lookAt",(function(){return nn})),n.d(i,"targetTo",(function(){return rn})),n.d(i,"str",(function(){return on})),n.d(i,"frob",(function(){return an})),n.d(i,"add",(function(){return sn})),n.d(i,"subtract",(function(){return un})),n.d(i,"multiplyScalar",(function(){return cn})),n.d(i,"multiplyScalarAndAdd",(function(){return ln})),n.d(i,"exactEquals",(function(){return fn})),n.d(i,"equals",(function(){return hn})),n.d(i,"mul",(function(){return dn})),n.d(i,"sub",(function(){return pn}));var o={};n.r(o),n.d(o,"create",(function(){return vn})),n.d(o,"clone",(function(){return gn})),n.d(o,"length",(function(){return mn})),n.d(o,"fromValues",(function(){return yn})),n.d(o,"copy",(function(){return _n})),n.d(o,"set",(function(){return En})),n.d(o,"add",(function(){return Tn})),n.d(o,"subtract",(function(){return Rn})),n.d(o,"multiply",(function(){return An})),n.d(o,"divide",(function(){return Sn})),n.d(o,"ceil",(function(){return bn})),n.d(o,"floor",(function(){return xn})),n.d(o,"min",(function(){return Mn})),n.d(o,"max",(function(){return On})),n.d(o,"round",(function(){return Cn})),n.d(o,"scale",(function(){return Nn})),n.d(o,"scaleAndAdd",(function(){return Pn})),n.d(o,"distance",(function(){return In})),n.d(o,"squaredDistance",(function(){return wn})),n.d(o,"squaredLength",(function(){return Dn})),n.d(o,"negate",(function(){return Ln})),n.d(o,"inverse",(function(){return Bn})),n.d(o,"normalize",(function(){return Fn})),n.d(o,"dot",(function(){return kn})),n.d(o,"cross",(function(){return Un})),n.d(o,"lerp",(function(){return Gn})),n.d(o,"hermite",(function(){return Vn})),n.d(o,"bezier",(function(){return jn})),n.d(o,"random",(function(){return Wn})),n.d(o,"transformMat4",(function(){return Xn})),n.d(o,"transformMat3",(function(){return Hn})),n.d(o,"transformQuat",(function(){return Yn})),n.d(o,"rotateX",(function(){return zn})),n.d(o,"rotateY",(function(){return Kn})),n.d(o,"rotateZ",(function(){return qn})),n.d(o,"angle",(function(){return Zn})),n.d(o,"zero",(function(){return Qn})),n.d(o,"str",(function(){return Jn})),n.d(o,"exactEquals",(function(){return $n})),n.d(o,"equals",(function(){return tr})),n.d(o,"sub",(function(){return nr})),n.d(o,"mul",(function(){return rr})),n.d(o,"div",(function(){return ir})),n.d(o,"dist",(function(){return or})),n.d(o,"sqrDist",(function(){return ar})),n.d(o,"len",(function(){return sr})),n.d(o,"sqrLen",(function(){return ur})),n.d(o,"forEach",(function(){return cr}));var a={};n.r(a),n.d(a,"create",(function(){return lr})),n.d(a,"clone",(function(){return fr})),n.d(a,"fromValues",(function(){return hr})),n.d(a,"copy",(function(){return dr})),n.d(a,"set",(function(){return pr})),n.d(a,"add",(function(){return vr})),n.d(a,"subtract",(function(){return gr})),n.d(a,"multiply",(function(){return mr})),n.d(a,"divide",(function(){return yr})),n.d(a,"ceil",(function(){return _r})),n.d(a,"floor",(function(){return Er})),n.d(a,"min",(function(){return Tr})),n.d(a,"max",(function(){return Rr})),n.d(a,"round",(function(){return Ar})),n.d(a,"scale",(function(){return Sr})),n.d(a,"scaleAndAdd",(function(){return br})),n.d(a,"distance",(function(){return xr})),n.d(a,"squaredDistance",(function(){return Mr})),n.d(a,"length",(function(){return Or})),n.d(a,"squaredLength",(function(){return Cr})),n.d(a,"negate",(function(){return Nr})),n.d(a,"inverse",(function(){return Pr})),n.d(a,"normalize",(function(){return Ir})),n.d(a,"dot",(function(){return wr})),n.d(a,"cross",(function(){return Dr})),n.d(a,"lerp",(function(){return Lr})),n.d(a,"random",(function(){return Br})),n.d(a,"transformMat4",(function(){return Fr})),n.d(a,"transformQuat",(function(){return kr})),n.d(a,"zero",(function(){return Ur})),n.d(a,"str",(function(){return Gr})),n.d(a,"exactEquals",(function(){return Vr})),n.d(a,"equals",(function(){return jr})),n.d(a,"sub",(function(){return Wr})),n.d(a,"mul",(function(){return Xr})),n.d(a,"div",(function(){return Hr})),n.d(a,"dist",(function(){return Yr})),n.d(a,"sqrDist",(function(){return zr})),n.d(a,"len",(function(){return Kr})),n.d(a,"sqrLen",(function(){return qr})),n.d(a,"forEach",(function(){return Zr}));var s={};n.r(s),n.d(s,"create",(function(){return Qr})),n.d(s,"identity",(function(){return Jr})),n.d(s,"setAxisAngle",(function(){return $r})),n.d(s,"getAxisAngle",(function(){return ti})),n.d(s,"getAngle",(function(){return ei})),n.d(s,"multiply",(function(){return ni})),n.d(s,"rotateX",(function(){return ri})),n.d(s,"rotateY",(function(){return ii})),n.d(s,"rotateZ",(function(){return oi})),n.d(s,"calculateW",(function(){return ai})),n.d(s,"exp",(function(){return si})),n.d(s,"ln",(function(){return ui})),n.d(s,"pow",(function(){return ci})),n.d(s,"slerp",(function(){return li})),n.d(s,"random",(function(){return fi})),n.d(s,"invert",(function(){return hi})),n.d(s,"conjugate",(function(){return di})),n.d(s,"fromMat3",(function(){return pi})),n.d(s,"fromEuler",(function(){return vi})),n.d(s,"str",(function(){return gi})),n.d(s,"clone",(function(){return Ai})),n.d(s,"fromValues",(function(){return Si})),n.d(s,"copy",(function(){return bi})),n.d(s,"set",(function(){return xi})),n.d(s,"add",(function(){return Mi})),n.d(s,"mul",(function(){return Oi})),n.d(s,"scale",(function(){return Ci})),n.d(s,"dot",(function(){return Ni})),n.d(s,"lerp",(function(){return Pi})),n.d(s,"length",(function(){return Ii})),n.d(s,"len",(function(){return wi})),n.d(s,"squaredLength",(function(){return Di})),n.d(s,"sqrLen",(function(){return Li})),n.d(s,"normalize",(function(){return Bi})),n.d(s,"exactEquals",(function(){return Fi})),n.d(s,"equals",(function(){return ki})),n.d(s,"rotationTo",(function(){return Ui})),n.d(s,"sqlerp",(function(){return Gi})),n.d(s,"setAxes",(function(){return Vi}));var u={};n.r(u),n.d(u,"create",(function(){return ji})),n.d(u,"clone",(function(){return Wi})),n.d(u,"fromValues",(function(){return Xi})),n.d(u,"copy",(function(){return Hi})),n.d(u,"set",(function(){return Yi})),n.d(u,"add",(function(){return zi})),n.d(u,"subtract",(function(){return Ki})),n.d(u,"multiply",(function(){return qi})),n.d(u,"divide",(function(){return Zi})),n.d(u,"ceil",(function(){return Qi})),n.d(u,"floor",(function(){return Ji})),n.d(u,"min",(function(){return $i})),n.d(u,"max",(function(){return to})),n.d(u,"round",(function(){return eo})),n.d(u,"scale",(function(){return no})),n.d(u,"scaleAndAdd",(function(){return ro})),n.d(u,"distance",(function(){return io})),n.d(u,"squaredDistance",(function(){return oo})),n.d(u,"length",(function(){return ao})),n.d(u,"squaredLength",(function(){return so})),n.d(u,"negate",(function(){return uo})),n.d(u,"inverse",(function(){return co})),n.d(u,"normalize",(function(){return lo})),n.d(u,"dot",(function(){return fo})),n.d(u,"cross",(function(){return ho})),n.d(u,"lerp",(function(){return po})),n.d(u,"random",(function(){return vo})),n.d(u,"transformMat2",(function(){return go})),n.d(u,"transformMat2d",(function(){return mo})),n.d(u,"transformMat3",(function(){return yo})),n.d(u,"transformMat4",(function(){return _o})),n.d(u,"rotate",(function(){return Eo})),n.d(u,"angle",(function(){return To})),n.d(u,"zero",(function(){return Ro})),n.d(u,"str",(function(){return Ao})),n.d(u,"exactEquals",(function(){return So})),n.d(u,"equals",(function(){return bo})),n.d(u,"len",(function(){return xo})),n.d(u,"sub",(function(){return Mo})),n.d(u,"mul",(function(){return Oo})),n.d(u,"div",(function(){return Co})),n.d(u,"dist",(function(){return No})),n.d(u,"sqrDist",(function(){return Po})),n.d(u,"sqrLen",(function(){return Io})),n.d(u,"forEach",(function(){return wo}));n(19),n(22),n(72);var c=n(13),l=n(45),f=n.n(l),h={}.toString,d=function(t,e){return h.call(t)==="[object "+e+"]"},p=function(t){return d(t,"Function")},v=function(t,e){if(!p(t))throw new TypeError("Expected a function");var n=function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};return n.cache=new Map,n},g=function(t){return d(t,"String")},m=function(t){return d(t,"Number")};var y=function(){return(y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function _(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function E(t,e){return function(n,r){e(n,r,t)}}Object.create;function T(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}Object.create;var R={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function A(t){return Array.isArray(t)&&t.every((function(t){var e=t[0].toLowerCase();return R[e]===t.length-1&&"achlmqstvz".includes(e)}))}function S(t){return A(t)&&t.every((function(t){var e=t[0];return e===e.toUpperCase()}))}function b(t){return S(t)&&t.every((function(t){var e=t[0];return"ACLMQZ".includes(e)}))}var x={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function M(t){return t.map((function(t){return Array.isArray(t)?[].concat(t):t}))}function O(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),r=t.data;r.length>=R[n]&&("m"===n&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(r.splice(0,R[n]))),R[n]););}function C(t){var e=t.index,n=t.pathValue,r=n.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err='[path-util]: invalid Arc flag "'+n[e]+'", expecting 0 or 1 at index '+e)}function N(t){return t>=48&&t<=57||43===t||45===t||46===t}function P(t){return t>=48&&t<=57}function I(t){var e,n=t.max,r=t.pathValue,i=t.index,o=i,a=!1,s=!1,u=!1,c=!1;if(o>=n)t.err="[path-util]: Invalid path value at index "+o+', "pathValue" is missing param';else if(43!==(e=r.charCodeAt(o))&&45!==e||(o+=1,e=r.charCodeAt(o)),P(e)||46===e){if(46!==e){if(a=48===e,o+=1,e=r.charCodeAt(o),a&&o<n&&e&&P(e))return void(t.err="[path-util]: Invalid path value at index "+i+', "'+r[i]+'" illegal number');for(;o<n&&P(r.charCodeAt(o));)o+=1,s=!0;e=r.charCodeAt(o)}if(46===e){for(c=!0,o+=1;P(r.charCodeAt(o));)o+=1,u=!0;e=r.charCodeAt(o)}if(101===e||69===e){if(c&&!s&&!u)return void(t.err="[path-util]: Invalid path value at index "+o+', "'+r[o]+'" invalid float exponent');if(o+=1,43!==(e=r.charCodeAt(o))&&45!==e||(o+=1),!(o<n&&P(r.charCodeAt(o))))return void(t.err="[path-util]: Invalid path value at index "+o+', "'+r[o]+'" invalid integer exponent');for(;o<n&&P(r.charCodeAt(o));)o+=1}t.index=o,t.param=+t.pathValue.slice(i,o)}else t.err="[path-util]: Invalid path value at index "+o+', "'+r[o]+'" is not a number'}function w(t){for(var e,n=t.pathValue,r=t.max;t.index<r&&(10===(e=n.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e));)t.index+=1}function D(t){var e=t.max,n=t.pathValue,r=t.index,i=n.charCodeAt(r),o=R[n[r].toLowerCase()];if(t.segmentStart=r,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(i))if(t.index+=1,w(t),t.data=[],o){for(;;){for(var a=o;a>0;a-=1){if(97!=(32|i)||3!==a&&4!==a?I(t):C(t),t.err.length)return;t.data.push(t.param),w(t),t.index<e&&44===n.charCodeAt(t.index)&&(t.index+=1,w(t))}if(t.index>=t.max)break;if(!N(n.charCodeAt(t.index)))break}O(t)}else O(t);else t.err='[path-util]: Invalid path value "'+n[r]+'" is not a path command'}var L=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function B(t){if(S(t))return M(t);var e=function(t){if(A(t))return M(t);var e=new L(t);for(w(e);e.index<e.max&&!e.err.length;)D(e);return e.err?e.err:e.segments}(t),n=0,r=0,i=0,o=0;return e.map((function(t){var e,a=t.slice(1).map(Number),s=t[0],u=s.toUpperCase();if("M"===s)return n=a[0],r=a[1],i=n,o=r,["M",n,r];if(s!==u)switch(u){case"A":e=[u,a[0],a[1],a[2],a[3],a[4],a[5]+n,a[6]+r];break;case"V":e=[u,a[0]+r];break;case"H":e=[u,a[0]+n];break;default:var c=a.map((function(t,e){return t+(e%2?r:n)}));e=[u].concat(c)}else e=[u].concat(a);var l=e.length;switch(u){case"Z":n=i,r=o;break;case"H":n=e[1];break;case"V":r=e[1];break;default:n=e[l-2],r=e[l-1],"M"===u&&(i=n,o=r)}return e}))}function F(t,e){var n=t[0],r=e.x1,i=e.y1,o=e.x2,a=e.y2,s=t.slice(1).map(Number),u=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),"H"===n)u=["L",t[1],i];else if("V"===n)u=["L",r,t[1]];else if("S"===n){var c=2*r-o,l=2*i-a;e.x1=c,e.y1=l,u=["C",c,l].concat(s)}else if("T"===n){var f=2*r-e.qx,h=2*i-e.qy;e.qx=f,e.qy=h,u=["Q",f,h].concat(s)}else if("Q"===n){var d=s[0],p=s[1];e.qx=d,e.qy=p}return u}function k(t){if(b(t))return M(t);for(var e=B(t),n=y({},x),r=0;r<e.length;r+=1){e[r]=F(e[r],n);var i=e[r],o=i.length;n.x1=+i[o-2],n.y1=+i[o-1],n.x2=+i[o-4]||n.x1,n.y2=+i[o-3]||n.y1}return e}function U(t,e,n){var r=t[0],i=t[1];return[r+(e[0]-r)*n,i+(e[1]-i)*n]}function G(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function V(t,e,n,r,i){var o=G([t,e],[n,r]),a={x:0,y:0};if("number"==typeof i)if(i<=0)a={x:t,y:e};else if(i>=o)a={x:n,y:r};else{var s=U([t,e],[n,r],i/o);a={x:s[0],y:s[1]}}return{length:o,point:a,min:{x:Math.min(t,n),y:Math.min(e,r)},max:{x:Math.max(t,n),y:Math.max(e,r)}}}function j(t,e){var n=t.x,r=t.y,i=e.x,o=e.y,a=n*i+r*o,s=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(o,2)));return(n*o-r*i<0?-1:1)*Math.acos(a/s)}function W(t,e,n,r,i,o,a,s,u,c){var l=Math.abs,f=Math.sin,h=Math.cos,d=Math.sqrt,p=Math.PI,v=l(n),g=l(r),m=(i%360+360)%360*(p/180);if(t===s&&e===u)return{x:t,y:e};if(0===v||0===g)return V(t,e,s,u,c).point;var y=(t-s)/2,_=(e-u)/2,E={x:h(m)*y+f(m)*_,y:-f(m)*y+h(m)*_},T=Math.pow(E.x,2)/Math.pow(v,2)+Math.pow(E.y,2)/Math.pow(g,2);T>1&&(v*=d(T),g*=d(T));var R=(Math.pow(v,2)*Math.pow(g,2)-Math.pow(v,2)*Math.pow(E.y,2)-Math.pow(g,2)*Math.pow(E.x,2))/(Math.pow(v,2)*Math.pow(E.y,2)+Math.pow(g,2)*Math.pow(E.x,2)),A=(o!==a?1:-1)*d(R=R<0?0:R),S=A*(v*E.y/g),b=A*(-g*E.x/v),x=h(m)*S-f(m)*b+(t+s)/2,M=f(m)*S+h(m)*b+(e+u)/2,O={x:(E.x-S)/v,y:(E.y-b)/g},C=j({x:1,y:0},O),N=j(O,{x:(-E.x-S)/v,y:(-E.y-b)/g});!a&&N>0?N-=2*p:a&&N<0&&(N+=2*p);var P=C+(N%=2*p)*c,I=v*h(P),w=g*f(P);return{x:h(m)*I-f(m)*w+x,y:f(m)*I+h(m)*w+M}}function X(t,e,n,r,i,o,a,s,u,c,l){var f,h=l.bbox,d=void 0===h||h,p=l.length,v=void 0===p||p,g=l.sampleSize,m=void 0===g?30:g,y="number"==typeof c,_=t,E=e,T=0,R=[_,E,T],A=[_,E],S={x:0,y:0},b=[{x:_,y:E}];y&&c<=0&&(S={x:_,y:E});for(var x=0;x<=m;x+=1){if(_=(f=W(t,e,n,r,i,o,a,s,u,x/m)).x,E=f.y,d&&b.push({x:_,y:E}),v&&(T+=G(A,[_,E])),A=[_,E],y&&T>=c&&c>R[2]){var M=(T-c)/(T-R[2]);S={x:A[0]*(1-M)+R[0]*M,y:A[1]*(1-M)+R[1]*M}}R=[_,E,T]}return y&&c>=T&&(S={x:s,y:u}),{length:T,point:S,min:{x:Math.min.apply(null,b.map((function(t){return t.x}))),y:Math.min.apply(null,b.map((function(t){return t.y})))},max:{x:Math.max.apply(null,b.map((function(t){return t.x}))),y:Math.max.apply(null,b.map((function(t){return t.y})))}}}function H(t,e,n,r,i,o,a,s,u){var c=1-u;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*u*n+3*c*Math.pow(u,2)*i+Math.pow(u,3)*a,y:Math.pow(c,3)*e+3*Math.pow(c,2)*u*r+3*c*Math.pow(u,2)*o+Math.pow(u,3)*s}}function Y(t,e,n,r,i,o,a,s,u,c){var l,f=c.bbox,h=void 0===f||f,d=c.length,p=void 0===d||d,v=c.sampleSize,g=void 0===v?10:v,m="number"==typeof u,y=t,_=e,E=0,T=[y,_,E],R=[y,_],A={x:0,y:0},S=[{x:y,y:_}];m&&u<=0&&(A={x:y,y:_});for(var b=0;b<=g;b+=1){if(y=(l=H(t,e,n,r,i,o,a,s,b/g)).x,_=l.y,h&&S.push({x:y,y:_}),p&&(E+=G(R,[y,_])),R=[y,_],m&&E>=u&&u>T[2]){var x=(E-u)/(E-T[2]);A={x:R[0]*(1-x)+T[0]*x,y:R[1]*(1-x)+T[1]*x}}T=[y,_,E]}return m&&u>=E&&(A={x:a,y:s}),{length:E,point:A,min:{x:Math.min.apply(null,S.map((function(t){return t.x}))),y:Math.min.apply(null,S.map((function(t){return t.y})))},max:{x:Math.max.apply(null,S.map((function(t){return t.x}))),y:Math.max.apply(null,S.map((function(t){return t.y})))}}}function z(t,e,n,r,i,o,a){var s=1-a;return{x:Math.pow(s,2)*t+2*s*a*n+Math.pow(a,2)*i,y:Math.pow(s,2)*e+2*s*a*r+Math.pow(a,2)*o}}function K(t,e,n,r,i,o,a,s){var u,c=s.bbox,l=void 0===c||c,f=s.length,h=void 0===f||f,d=s.sampleSize,p=void 0===d?10:d,v="number"==typeof a,g=t,m=e,y=0,_=[g,m,y],E=[g,m],T={x:0,y:0},R=[{x:g,y:m}];v&&a<=0&&(T={x:g,y:m});for(var A=0;A<=p;A+=1){if(g=(u=z(t,e,n,r,i,o,A/p)).x,m=u.y,l&&R.push({x:g,y:m}),h&&(y+=G(E,[g,m])),E=[g,m],v&&y>=a&&a>_[2]){var S=(y-a)/(y-_[2]);T={x:E[0]*(1-S)+_[0]*S,y:E[1]*(1-S)+_[1]*S}}_=[g,m,y]}return v&&a>=y&&(T={x:i,y:o}),{length:y,point:T,min:{x:Math.min.apply(null,R.map((function(t){return t.x}))),y:Math.min.apply(null,R.map((function(t){return t.y})))},max:{x:Math.max.apply(null,R.map((function(t){return t.x}))),y:Math.max.apply(null,R.map((function(t){return t.y})))}}}function q(t,e,n){for(var r,i,o,a,s,u,c,l,f,h=k(t),d="number"==typeof e,p=[],v=0,g=0,m=0,y=0,_=[],E=[],T=0,R={x:0,y:0},A=R,S=R,b=R,x=0,M=0,O=h.length;M<O;M+=1)p=(c="M"===(l=(f=h[M])[0]))?p:[v,g].concat(f.slice(1)),c?(A=R={x:m=f[1],y:y=f[2]},T=0,d&&e<.001&&(b=R)):"L"===l?(T=(r=V(p[0],p[1],p[2],p[3],(e||0)-x)).length,R=r.min,A=r.max,S=r.point):"A"===l?(T=(i=X(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],(e||0)-x,n||{})).length,R=i.min,A=i.max,S=i.point):"C"===l?(T=(o=Y(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],(e||0)-x,n||{})).length,R=o.min,A=o.max,S=o.point):"Q"===l?(T=(a=K(p[0],p[1],p[2],p[3],p[4],p[5],(e||0)-x,n||{})).length,R=a.min,A=a.max,S=a.point):"Z"===l&&(T=(s=V((p=[v,g,m,y])[0],p[1],p[2],p[3],(e||0)-x)).length,R=s.min,A=s.max,S=s.point),d&&x<e&&x+T>=e&&(b=S),E.push(A),_.push(R),x+=T,v=(u="Z"!==l?f.slice(-2):[m,y])[0],g=u[1];return d&&e>=x&&(b={x:v,y:g}),{length:x,point:b,min:{x:Math.min.apply(null,_.map((function(t){return t.x}))),y:Math.min.apply(null,_.map((function(t){return t.y})))},max:{x:Math.max.apply(null,E.map((function(t){return t.x}))),y:Math.max.apply(null,E.map((function(t){return t.y})))}}}var Z=function(t,e,n){return t<e?e:t>n?n:t},Q=function(t){return null==t},J=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function $(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}function tt(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function et(t,e,n,r){var i=.5,o=[t,e],a=[n,r],s=U(o,a,i),u=U(a,s,i),c=U(s,u,i),l=U(u,c,i),f=U(c,l,i),h=V(o[0],o[1],s[0],s[1],c[0]).point,d=V(f[0],f[1],l[0],l[1],u[0]).point;return[h.x,h.y,d.x,d.y,n,r]}function nt(t,e){var n,r,i,o,a,s,u,c=t[0],l=t.slice(1).map(Number),f=l[0],h=l[1],d=e.x1,p=e.y1,v=e.x,g=e.y;switch("TQ".includes(c)||(e.qx=null,e.qy=null),c){case"M":return e.x=f,e.y=h,t;case"A":return n=[d,p].concat(l),["C"].concat(function t(e,n,r,i,o,a,s,u,c,l){var f,h,d,p,v,g=e,m=n,y=r,_=i,E=u,T=c,R=120*Math.PI/180,A=Math.PI/180*(+o||0),S=[];if(l)h=l[0],d=l[1],p=l[2],v=l[3];else{g=(f=tt(g,m,-A)).x,m=f.y;var b=(g-(E=(f=tt(E,T,-A)).x))/2,x=(m-(T=f.y))/2,M=b*b/(y*y)+x*x/(_*_);M>1&&(y*=M=Math.sqrt(M),_*=M);var O=y*y,C=_*_,N=(a===s?-1:1)*Math.sqrt(Math.abs((O*C-O*x*x-C*b*b)/(O*x*x+C*b*b)));p=N*y*x/_+(g+E)/2,v=N*-_*b/y+(m+T)/2,h=Math.asin(((m-v)/_*Math.pow(10,9)>>0)/Math.pow(10,9)),d=Math.asin(((T-v)/_*Math.pow(10,9)>>0)/Math.pow(10,9)),h=g<p?Math.PI-h:h,d=E<p?Math.PI-d:d,h<0&&(h=2*Math.PI+h),d<0&&(d=2*Math.PI+d),s&&h>d&&(h-=2*Math.PI),!s&&d>h&&(d-=2*Math.PI)}var P=d-h;if(Math.abs(P)>R){var I=d,w=E,D=T;d=h+R*(s&&d>h?1:-1),S=t(E=p+y*Math.cos(d),T=v+_*Math.sin(d),y,_,o,0,s,w,D,[d,I,p,v])}P=d-h;var L=Math.cos(h),B=Math.sin(h),F=Math.cos(d),k=Math.sin(d),U=Math.tan(P/4),G=4/3*y*U,V=4/3*_*U,j=[g,m],W=[g+G*B,m-V*L],X=[E+G*k,T-V*F],H=[E,T];if(W[0]=2*j[0]-W[0],W[1]=2*j[1]-W[1],l)return W.concat(X,H,S);for(var Y=[],z=0,K=(S=W.concat(X,H,S)).length;z<K;z+=1)Y[z]=z%2?tt(S[z-1],S[z],A).y:tt(S[z],S[z+1],A).x;return Y}(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=f,e.qy=h,n=[d,p].concat(l),["C"].concat((r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],[1/3*r+2/3*o,1/3*i+2/3*a,1/3*s+2/3*o,1/3*u+2/3*a,s,u]));case"L":return["C"].concat(et(d,p,f,h));case"Z":return d===v&&p===g?["C",d,p,v,g,v,g]:["C"].concat(et(d,p,v,g))}return t}function rt(t,e){if(void 0===e&&(e=!1),function(t){return b(t)&&t.every((function(t){var e=t[0];return"MC".includes(e)}))}(t)){var n=M(t);return e?[n,[]]:n}for(var r,i,o=k(t),a=y({},x),s=[],u="",c=o.length,l=[],f=0;f<c;f+=1){o[f]&&(u=o[f][0]),s[f]=u;var h=nt(o[f],a);o[f]=h,$(o,s,f),c=o.length,"Z"===u&&l.push(f),i=(r=o[f]).length,a.x1=+r[i-2],a.y1=+r[i-1],a.x2=+r[i-4]||a.x1,a.y2=+r[i-3]||a.y1}return e?[o,l]:o}n(116),n(122);function it(t){return t.map((function(t,e,n){var r=e&&n[e-1].slice(-2).concat(t.slice(1)),i=e?Y(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],{bbox:!1}).length:0;return{s:t,ss:e?i?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),o=t.slice(6,8),a=U(n,r,e),s=U(r,i,e),u=U(i,o,e),c=U(a,s,e),l=U(s,u,e),f=U(c,l,e);return[["C"].concat(a,c,f),["C"].concat(l,u,o)]}(r):[t,t]:[t],l:i}}))}function ot(t){return e=0,n=0,r=0,rt(t).map((function(t){var i;switch(t[0]){case"M":return e=t[1],n=t[2],0;default:var o=t.slice(1),a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],f=o[5];return r=function(t,e,n,r,i,o,a,s){return 3*((s-e)*(n+i)-(a-t)*(r+o)+r*(t-i)-n*(e-o)+s*(i+t/3)-a*(o+e/3))/20}(e,n,a,s,u,c,l,f),i=t.slice(-2),e=i[0],n=i[1],r}})).reduce((function(t,e){return t+e}),0)>=0;var e,n,r}var at=function(t){return d(t,"Boolean")},st=function(t){return void 0===t};var ut=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function ct(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function lt(){}var ft="\\s*([+-]?\\d+)\\s*",ht="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",dt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pt=/^#([0-9a-f]{3,8})$/,vt=new RegExp("^rgb\\("+[ft,ft,ft]+"\\)$"),gt=new RegExp("^rgb\\("+[dt,dt,dt]+"\\)$"),mt=new RegExp("^rgba\\("+[ft,ft,ft,ht]+"\\)$"),yt=new RegExp("^rgba\\("+[dt,dt,dt,ht]+"\\)$"),_t=new RegExp("^hsl\\("+[ht,dt,dt]+"\\)$"),Et=new RegExp("^hsla\\("+[ht,dt,dt,ht]+"\\)$"),Tt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Rt(){return this.rgb().formatHex()}function At(){return this.rgb().formatRgb()}function St(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=pt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?bt(e):3===n?new Ot(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?xt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?xt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=vt.exec(t))?new Ot(e[1],e[2],e[3],1):(e=gt.exec(t))?new Ot(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=mt.exec(t))?xt(e[1],e[2],e[3],e[4]):(e=yt.exec(t))?xt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=_t.exec(t))?It(e[1],e[2]/100,e[3]/100,1):(e=Et.exec(t))?It(e[1],e[2]/100,e[3]/100,e[4]):Tt.hasOwnProperty(t)?bt(Tt[t]):"transparent"===t?new Ot(NaN,NaN,NaN,0):null}function bt(t){return new Ot(t>>16&255,t>>8&255,255&t,1)}function xt(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ot(t,e,n,r)}function Mt(t){return t instanceof lt||(t=St(t)),t?new Ot((t=t.rgb()).r,t.g,t.b,t.opacity):new Ot}function Ot(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ct(){return"#"+Pt(this.r)+Pt(this.g)+Pt(this.b)}function Nt(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Pt(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function It(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Dt(t,e,n,r)}function wt(t){if(t instanceof Dt)return new Dt(t.h,t.s,t.l,t.opacity);if(t instanceof lt||(t=St(t)),!t)return new Dt;if(t instanceof Dt)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Dt(a,s,u,t.opacity)}function Dt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Lt(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}ut(lt,St,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Rt,formatHex:Rt,formatHsl:function(){return wt(this).formatHsl()},formatRgb:At,toString:At}),ut(Ot,(function(t,e,n,r){return 1===arguments.length?Mt(t):new Ot(t,e,n,null==r?1:r)}),ct(lt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ot(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ot(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ct,formatHex:Ct,formatRgb:Nt,toString:Nt})),ut(Dt,(function(t,e,n,r){return 1===arguments.length?wt(t):new Dt(t,e,n,null==r?1:r)}),ct(lt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Dt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Dt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ot(Lt(t>=240?t-240:t+120,i,r),Lt(t,i,r),Lt(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));n(5),n(6),n(12);var Bt=1e-6,Ft="undefined"!=typeof Float32Array?Float32Array:Array,kt=Math.random;Math.PI;function Ut(){var t=new Ft(9);return Ft!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Vt(t){var e=new Ft(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function jt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Wt(t,e,n,r,i,o,a,s,u){var c=new Ft(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function Xt(t,e,n,r,i,o,a,s,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t}function Ht(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Yt(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function zt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=l*a-s*c,h=-l*o+s*u,d=c*o-a*u,p=n*f+r*h+i*d;return p?(p=1/p,t[0]=f*p,t[1]=(-l*r+i*c)*p,t[2]=(s*r-i*a)*p,t[3]=h*p,t[4]=(l*n-i*u)*p,t[5]=(-s*n+i*o)*p,t[6]=d*p,t[7]=(-c*n+r*u)*p,t[8]=(a*n-r*o)*p,t):null}function Kt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8];return t[0]=a*l-s*c,t[1]=i*c-r*l,t[2]=r*s-i*a,t[3]=s*u-o*l,t[4]=n*l-i*u,t[5]=i*o-n*s,t[6]=o*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*o,t}function qt(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)}function Zt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1],p=n[2],v=n[3],g=n[4],m=n[5],y=n[6],_=n[7],E=n[8];return t[0]=h*r+d*a+p*c,t[1]=h*i+d*s+p*l,t[2]=h*o+d*u+p*f,t[3]=v*r+g*a+m*c,t[4]=v*i+g*s+m*l,t[5]=v*o+g*u+m*f,t[6]=y*r+_*a+E*c,t[7]=y*i+_*s+E*l,t[8]=y*o+_*u+E*f,t}function Qt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+d*a+c,t[7]=h*i+d*s+l,t[8]=h*o+d*u+f,t}function Jt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*a,t[1]=d*i+h*s,t[2]=d*o+h*u,t[3]=d*a-h*r,t[4]=d*s-h*i,t[5]=d*u-h*o,t[6]=c,t[7]=l,t[8]=f,t}function $t(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function te(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function ee(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ne(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function re(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function ie(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,g=o*s,m=o*u;return t[0]=1-f-p,t[3]=l-m,t[6]=h+g,t[1]=l+m,t[4]=1-c-p,t[7]=d-v,t[2]=h-g,t[5]=d+v,t[8]=1-c-f,t}function oe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=n*s-r*a,_=n*u-i*a,E=n*c-o*a,T=r*u-i*s,R=r*c-o*s,A=i*c-o*u,S=l*v-f*p,b=l*g-h*p,x=l*m-d*p,M=f*g-h*v,O=f*m-d*v,C=h*m-d*g,N=y*C-_*O+E*M+T*x-R*b+A*S;return N?(N=1/N,t[0]=(s*C-u*O+c*M)*N,t[1]=(u*x-a*C-c*b)*N,t[2]=(a*O-s*x+c*S)*N,t[3]=(i*O-r*C-o*M)*N,t[4]=(n*C-i*x+o*b)*N,t[5]=(r*x-n*O-o*S)*N,t[6]=(v*A-g*R+m*T)*N,t[7]=(g*E-p*A-m*_)*N,t[8]=(p*R-v*E+m*y)*N,t):null}function ae(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function se(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function ue(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function ce(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function le(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function fe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function he(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function de(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function pe(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=e[0],h=e[1],d=e[2],p=e[3],v=e[4],g=e[5],m=e[6],y=e[7],_=e[8];return Math.abs(n-f)<=Bt*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-h)<=Bt*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=Bt*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=Bt*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-v)<=Bt*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-g)<=Bt*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-m)<=Bt*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-y)<=Bt*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(l-_)<=Bt*Math.max(1,Math.abs(l),Math.abs(_))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ve=Zt,ge=le;function me(){var t=new Ft(16);return Ft!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function ye(t){var e=new Ft(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function _e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ee(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v){var g=new Ft(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=u,g[9]=c,g[10]=l,g[11]=f,g[12]=h,g[13]=d,g[14]=p,g[15]=v,g}function Te(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v,g){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=f,t[11]=h,t[12]=d,t[13]=p,t[14]=v,t[15]=g,t}function Re(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ae(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Se(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=n*s-r*a,_=n*u-i*a,E=n*c-o*a,T=r*u-i*s,R=r*c-o*s,A=i*c-o*u,S=l*v-f*p,b=l*g-h*p,x=l*m-d*p,M=f*g-h*v,O=f*m-d*v,C=h*m-d*g,N=y*C-_*O+E*M+T*x-R*b+A*S;return N?(N=1/N,t[0]=(s*C-u*O+c*M)*N,t[1]=(i*O-r*C-o*M)*N,t[2]=(v*A-g*R+m*T)*N,t[3]=(h*R-f*A-d*T)*N,t[4]=(u*x-a*C-c*b)*N,t[5]=(n*C-i*x+o*b)*N,t[6]=(g*E-p*A-m*_)*N,t[7]=(l*A-h*E+d*_)*N,t[8]=(a*O-s*x+c*S)*N,t[9]=(r*x-n*O-o*S)*N,t[10]=(p*R-v*E+m*y)*N,t[11]=(f*E-l*R-d*y)*N,t[12]=(s*b-a*M-u*S)*N,t[13]=(n*M-r*b+i*S)*N,t[14]=(v*_-p*T-g*y)*N,t[15]=(l*T-f*_+h*y)*N,t):null}function be(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15];return t[0]=s*(h*m-d*g)-f*(u*m-c*g)+v*(u*d-c*h),t[1]=-(r*(h*m-d*g)-f*(i*m-o*g)+v*(i*d-o*h)),t[2]=r*(u*m-c*g)-s*(i*m-o*g)+v*(i*c-o*u),t[3]=-(r*(u*d-c*h)-s*(i*d-o*h)+f*(i*c-o*u)),t[4]=-(a*(h*m-d*g)-l*(u*m-c*g)+p*(u*d-c*h)),t[5]=n*(h*m-d*g)-l*(i*m-o*g)+p*(i*d-o*h),t[6]=-(n*(u*m-c*g)-a*(i*m-o*g)+p*(i*c-o*u)),t[7]=n*(u*d-c*h)-a*(i*d-o*h)+l*(i*c-o*u),t[8]=a*(f*m-d*v)-l*(s*m-c*v)+p*(s*d-c*f),t[9]=-(n*(f*m-d*v)-l*(r*m-o*v)+p*(r*d-o*f)),t[10]=n*(s*m-c*v)-a*(r*m-o*v)+p*(r*c-o*s),t[11]=-(n*(s*d-c*f)-a*(r*d-o*f)+l*(r*c-o*s)),t[12]=-(a*(f*g-h*v)-l*(s*g-u*v)+p*(s*h-u*f)),t[13]=n*(f*g-h*v)-l*(r*g-i*v)+p*(r*h-i*f),t[14]=-(n*(s*g-u*v)-a*(r*g-i*v)+p*(r*u-i*s)),t[15]=n*(s*h-u*f)-a*(r*h-i*f)+l*(r*u-i*s),t}function xe(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],v=t[14],g=t[15];return(e*a-n*o)*(f*g-h*v)-(e*s-r*o)*(l*g-h*p)+(e*u-i*o)*(l*v-f*p)+(n*s-r*a)*(c*g-h*d)-(n*u-i*a)*(c*v-f*d)+(r*u-i*s)*(c*p-l*d)}function Me(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],v=e[12],g=e[13],m=e[14],y=e[15],_=n[0],E=n[1],T=n[2],R=n[3];return t[0]=_*r+E*s+T*f+R*v,t[1]=_*i+E*u+T*h+R*g,t[2]=_*o+E*c+T*d+R*m,t[3]=_*a+E*l+T*p+R*y,_=n[4],E=n[5],T=n[6],R=n[7],t[4]=_*r+E*s+T*f+R*v,t[5]=_*i+E*u+T*h+R*g,t[6]=_*o+E*c+T*d+R*m,t[7]=_*a+E*l+T*p+R*y,_=n[8],E=n[9],T=n[10],R=n[11],t[8]=_*r+E*s+T*f+R*v,t[9]=_*i+E*u+T*h+R*g,t[10]=_*o+E*c+T*d+R*m,t[11]=_*a+E*l+T*p+R*y,_=n[12],E=n[13],T=n[14],R=n[15],t[12]=_*r+E*s+T*f+R*v,t[13]=_*i+E*u+T*h+R*g,t[14]=_*o+E*c+T*d+R*m,t[15]=_*a+E*l+T*p+R*y,t}function Oe(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,v=n[0],g=n[1],m=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*m+e[12],t[13]=e[1]*v+e[5]*g+e[9]*m+e[13],t[14]=e[2]*v+e[6]*g+e[10]*m+e[14],t[15]=e[3]*v+e[7]*g+e[11]*m+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*v+s*g+f*m+e[12],t[13]=i*v+u*g+h*m+e[13],t[14]=o*v+c*g+d*m+e[14],t[15]=a*v+l*g+p*m+e[15]),t}function Ce(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ne(t,e,n,r){var i,o,a,s,u,c,l,f,h,d,p,v,g,m,y,_,E,T,R,A,S,b,x,M,O=r[0],C=r[1],N=r[2],P=Math.hypot(O,C,N);return P<Bt?null:(O*=P=1/P,C*=P,N*=P,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],d=e[6],p=e[7],v=e[8],g=e[9],m=e[10],y=e[11],_=O*O*a+o,E=C*O*a+N*i,T=N*O*a-C*i,R=O*C*a-N*i,A=C*C*a+o,S=N*C*a+O*i,b=O*N*a+C*i,x=C*N*a-O*i,M=N*N*a+o,t[0]=s*_+f*E+v*T,t[1]=u*_+h*E+g*T,t[2]=c*_+d*E+m*T,t[3]=l*_+p*E+y*T,t[4]=s*R+f*A+v*S,t[5]=u*R+h*A+g*S,t[6]=c*R+d*A+m*S,t[7]=l*R+p*A+y*S,t[8]=s*b+f*x+v*M,t[9]=u*b+h*x+g*M,t[10]=c*b+d*x+m*M,t[11]=l*b+p*x+y*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Pe(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t}function Ie(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i,t}function we(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t}function De(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Le(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Be(t,e,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.hypot(a,s,u);return c<Bt?null:(a*=c=1/c,s*=c,u*=c,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+u*r,t[2]=u*a*o-s*r,t[3]=0,t[4]=a*s*o-u*r,t[5]=s*s*o+i,t[6]=u*s*o+a*r,t[7]=0,t[8]=a*u*o+s*r,t[9]=s*u*o-a*r,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Fe(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ke(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ue(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ge(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,h=r*c,d=i*u,p=i*c,v=o*c,g=a*s,m=a*u,y=a*c;return t[0]=1-(d+v),t[1]=f+y,t[2]=h-m,t[3]=0,t[4]=f-y,t[5]=1-(l+v),t[6]=p+g,t[7]=0,t[8]=h+m,t[9]=p-g,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ve(t,e){var n=new Ft(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=r*r+i*i+o*o+a*a;return f>0?(n[0]=2*(s*a+l*r+u*o-c*i)/f,n[1]=2*(u*a+l*i+c*r-s*o)/f,n[2]=2*(c*a+l*o+s*i-u*r)/f):(n[0]=2*(s*a+l*r+u*o-c*i),n[1]=2*(u*a+l*i+c*r-s*o),n[2]=2*(c*a+l*o+s*i-u*r)),Ge(t,e,n),t}function je(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function We(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function Xe(t,e){var n=new Ft(3);We(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,u=e[2]*o,c=e[4]*r,l=e[5]*i,f=e[6]*o,h=e[8]*r,d=e[9]*i,p=e[10]*o,v=a+l+p,g=0;return v>0?(g=2*Math.sqrt(v+1),t[3]=.25*g,t[0]=(f-d)/g,t[1]=(h-u)/g,t[2]=(s-c)/g):a>l&&a>p?(g=2*Math.sqrt(1+a-l-p),t[3]=(f-d)/g,t[0]=.25*g,t[1]=(s+c)/g,t[2]=(h+u)/g):l>p?(g=2*Math.sqrt(1+l-a-p),t[3]=(h-u)/g,t[0]=(s+c)/g,t[1]=.25*g,t[2]=(f+d)/g):(g=2*Math.sqrt(1+p-a-l),t[3]=(s-c)/g,t[0]=(h+u)/g,t[1]=(f+d)/g,t[2]=.25*g),t}function He(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,l=a+a,f=i*u,h=i*c,d=i*l,p=o*c,v=o*l,g=a*l,m=s*u,y=s*c,_=s*l,E=r[0],T=r[1],R=r[2];return t[0]=(1-(p+g))*E,t[1]=(h+_)*E,t[2]=(d-y)*E,t[3]=0,t[4]=(h-_)*T,t[5]=(1-(f+g))*T,t[6]=(v+m)*T,t[7]=0,t[8]=(d+y)*R,t[9]=(v-m)*R,t[10]=(1-(f+p))*R,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ye(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,l=a+a,f=s+s,h=o*c,d=o*l,p=o*f,v=a*l,g=a*f,m=s*f,y=u*c,_=u*l,E=u*f,T=r[0],R=r[1],A=r[2],S=i[0],b=i[1],x=i[2],M=(1-(v+m))*T,O=(d+E)*T,C=(p-_)*T,N=(d-E)*R,P=(1-(h+m))*R,I=(g+y)*R,w=(p+_)*A,D=(g-y)*A,L=(1-(h+v))*A;return t[0]=M,t[1]=O,t[2]=C,t[3]=0,t[4]=N,t[5]=P,t[6]=I,t[7]=0,t[8]=w,t[9]=D,t[10]=L,t[11]=0,t[12]=n[0]+S-(M*S+N*b+w*x),t[13]=n[1]+b-(O*S+P*b+D*x),t[14]=n[2]+x-(C*S+I*b+L*x),t[15]=1,t}function ze(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,g=o*s,m=o*u;return t[0]=1-f-p,t[1]=l+m,t[2]=h-g,t[3]=0,t[4]=l-m,t[5]=1-c-p,t[6]=d+v,t[7]=0,t[8]=h+g,t[9]=d-v,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ke(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function qe(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var Ze=qe;function Qe(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t}function Je(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function $e(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}var tn=$e;function en(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=o*c,t[15]=1,t}function nn(t,e,n,r){var i,o,a,s,u,c,l,f,h,d,p=e[0],v=e[1],g=e[2],m=r[0],y=r[1],_=r[2],E=n[0],T=n[1],R=n[2];return Math.abs(p-E)<Bt&&Math.abs(v-T)<Bt&&Math.abs(g-R)<Bt?Re(t):(l=p-E,f=v-T,h=g-R,i=y*(h*=d=1/Math.hypot(l,f,h))-_*(f*=d),o=_*(l*=d)-m*h,a=m*f-y*l,(d=Math.hypot(i,o,a))?(i*=d=1/d,o*=d,a*=d):(i=0,o=0,a=0),s=f*a-h*o,u=h*i-l*a,c=l*o-f*i,(d=Math.hypot(s,u,c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+o*v+a*g),t[13]=-(s*p+u*v+c*g),t[14]=-(l*p+f*v+h*g),t[15]=1,t)}function rn(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],l=i-n[0],f=o-n[1],h=a-n[2],d=l*l+f*f+h*h;d>0&&(l*=d=1/Math.sqrt(d),f*=d,h*=d);var p=u*h-c*f,v=c*l-s*h,g=s*f-u*l;return(d=p*p+v*v+g*g)>0&&(p*=d=1/Math.sqrt(d),v*=d,g*=d),t[0]=p,t[1]=v,t[2]=g,t[3]=0,t[4]=f*g-h*v,t[5]=h*p-l*g,t[6]=l*v-f*p,t[7]=0,t[8]=l,t[9]=f,t[10]=h,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function on(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function an(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function sn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function un(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function cn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function ln(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function fn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function hn(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],g=t[14],m=t[15],y=e[0],_=e[1],E=e[2],T=e[3],R=e[4],A=e[5],S=e[6],b=e[7],x=e[8],M=e[9],O=e[10],C=e[11],N=e[12],P=e[13],I=e[14],w=e[15];return Math.abs(n-y)<=Bt*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-_)<=Bt*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-E)<=Bt*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(o-T)<=Bt*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(a-R)<=Bt*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(s-A)<=Bt*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(u-S)<=Bt*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-b)<=Bt*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-x)<=Bt*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(f-M)<=Bt*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(h-O)<=Bt*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(d-C)<=Bt*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-N)<=Bt*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(v-P)<=Bt*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(g-I)<=Bt*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(m-w)<=Bt*Math.max(1,Math.abs(m),Math.abs(w))}var dn=Me,pn=un;function vn(){var t=new Ft(3);return Ft!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function gn(t){var e=new Ft(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function mn(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function yn(t,e,n){var r=new Ft(3);return r[0]=t,r[1]=e,r[2]=n,r}function _n(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function En(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Tn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Rn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function An(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Sn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function bn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function xn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Mn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function On(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Cn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Nn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Pn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function In(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function wn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Dn(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Ln(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Bn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Fn(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function kn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Un(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function Gn(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function Vn(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*l,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*l,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*l,t}function jn(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,f=3*u*a,h=u*o;return t[0]=e[0]*c+n[0]*l+r[0]*f+i[0]*h,t[1]=e[1]*c+n[1]*l+r[1]*f+i[1]*h,t[2]=e[2]*c+n[2]*l+r[2]*f+i[2]*h,t}function Wn(t,e){e=e||1;var n=2*kt()*Math.PI,r=2*kt()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Xn(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function Hn(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function Yn(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,f=o*s-r*c,h=r*u-i*s,d=i*h-o*f,p=o*l-r*h,v=r*f-i*l,g=2*a;return l*=g,f*=g,h*=g,d*=2,p*=2,v*=2,t[0]=s+l+d,t[1]=u+f+p,t[2]=c+h+v,t}function zn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Kn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function qn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Zn(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&kn(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Qn(t){return t[0]=0,t[1]=0,t[2]=0,t}function Jn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function $n(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function tr(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=Bt*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=Bt*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=Bt*Math.max(1,Math.abs(i),Math.abs(s))}var er,nr=Rn,rr=An,ir=Sn,or=In,ar=wn,sr=mn,ur=Dn,cr=(er=vn(),function(t,e,n,r,i,o){var a,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,a=n;a<s;a+=e)er[0]=t[a],er[1]=t[a+1],er[2]=t[a+2],i(er,er,o),t[a]=er[0],t[a+1]=er[1],t[a+2]=er[2];return t});function lr(){var t=new Ft(4);return Ft!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function fr(t){var e=new Ft(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function hr(t,e,n,r){var i=new Ft(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function dr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function pr(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function vr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function gr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function mr(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function yr(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function _r(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Er(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Tr(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Rr(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Ar(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Sr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function br(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function xr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,r,i,o)}function Mr(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function Or(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function Cr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function Nr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Pr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function Ir(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function wr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Dr(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],l=e[0],f=e[1],h=e[2],d=e[3];return t[0]=f*c-h*u+d*s,t[1]=-l*c+h*a-d*o,t[2]=l*u-f*a+d*i,t[3]=-l*s+f*o-h*i,t}function Lr(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function Br(t,e){var n,r,i,o,a,s;e=e||1;do{a=(n=2*kt()-1)*n+(r=2*kt()-1)*r}while(a>=1);do{s=(i=2*kt()-1)*i+(o=2*kt()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*o*u,t}function Fr(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function kr(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=l*c+d*-a+f*-u-h*-s,t[1]=f*c+d*-s+h*-a-l*-u,t[2]=h*c+d*-u+l*-s-f*-a,t[3]=e[3],t}function Ur(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Gr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Vr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function jr(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=Bt*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=Bt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=Bt*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=Bt*Math.max(1,Math.abs(o),Math.abs(c))}var Wr=gr,Xr=mr,Hr=yr,Yr=xr,zr=Mr,Kr=Or,qr=Cr,Zr=function(){var t=lr();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function Qr(){var t=new Ft(4);return Ft!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Jr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function $r(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ti(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>Bt?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function ei(t,e){var n=Ni(t,e);return Math.acos(2*n*n-1)}function ni(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t}function ri(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function ii(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function oi(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function ai(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function si(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),s=Math.exp(o),u=a>0?s*Math.sin(a)/a:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(a),t}function ui(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function ci(t,e,n){return ui(t,e),Ci(t,t,n),si(t,t),t}function li(t,e,n,r){var i,o,a,s,u,c=e[0],l=e[1],f=e[2],h=e[3],d=n[0],p=n[1],v=n[2],g=n[3];return(o=c*d+l*p+f*v+h*g)<0&&(o=-o,d=-d,p=-p,v=-v,g=-g),1-o>Bt?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*c+u*d,t[1]=s*l+u*p,t[2]=s*f+u*v,t[3]=s*h+u*g,t}function fi(t){var e=kt(),n=kt(),r=kt(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function hi(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function di(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function pi(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}function vi(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r);return t[0]=o*u*l-a*s*c,t[1]=a*s*l+o*u*c,t[2]=a*u*c-o*s*l,t[3]=a*u*l+o*s*c,t}function gi(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var mi,yi,_i,Ei,Ti,Ri,Ai=fr,Si=hr,bi=dr,xi=pr,Mi=vr,Oi=ni,Ci=Sr,Ni=wr,Pi=Lr,Ii=Or,wi=Ii,Di=Cr,Li=Di,Bi=Ir,Fi=Vr,ki=jr,Ui=(mi=vn(),yi=yn(1,0,0),_i=yn(0,1,0),function(t,e,n){var r=kn(e,n);return r<-.999999?(Un(mi,yi,e),sr(mi)<1e-6&&Un(mi,_i,e),Fn(mi,mi),$r(t,mi,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Un(mi,e,n),t[0]=mi[0],t[1]=mi[1],t[2]=mi[2],t[3]=1+r,Bi(t,t))}),Gi=(Ei=Qr(),Ti=Qr(),function(t,e,n,r,i,o){return li(Ei,e,i,o),li(Ti,n,r,o),li(t,Ei,Ti,2*o*(1-o)),t}),Vi=(Ri=Ut(),function(t,e,n,r){return Ri[0]=n[0],Ri[3]=n[1],Ri[6]=n[2],Ri[1]=r[0],Ri[4]=r[1],Ri[7]=r[2],Ri[2]=-e[0],Ri[5]=-e[1],Ri[8]=-e[2],Bi(t,pi(t,Ri))});function ji(){var t=new Ft(2);return Ft!=Float32Array&&(t[0]=0,t[1]=0),t}function Wi(t){var e=new Ft(2);return e[0]=t[0],e[1]=t[1],e}function Xi(t,e){var n=new Ft(2);return n[0]=t,n[1]=e,n}function Hi(t,e){return t[0]=e[0],t[1]=e[1],t}function Yi(t,e,n){return t[0]=e,t[1]=n,t}function zi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ki(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function qi(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Zi(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function Qi(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Ji(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function $i(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function to(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function eo(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function no(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function ro(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function io(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function oo(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ao(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function so(t){var e=t[0],n=t[1];return e*e+n*n}function uo(t,e){return t[0]=-e[0],t[1]=-e[1],t}function co(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function lo(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function fo(t,e){return t[0]*e[0]+t[1]*e[1]}function ho(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function po(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function vo(t,e){e=e||1;var n=2*kt()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function go(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function mo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function yo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function _o(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function Eo(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+n[0],t[1]=i*a+o*s+n[1],t}function To(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),s=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function Ro(t){return t[0]=0,t[1]=0,t}function Ao(t){return"vec2("+t[0]+", "+t[1]+")"}function So(t,e){return t[0]===e[0]&&t[1]===e[1]}function bo(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=Bt*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=Bt*Math.max(1,Math.abs(r),Math.abs(o))}var xo=ao,Mo=Ki,Oo=qi,Co=Zi,No=io,Po=oo,Io=so,wo=function(){var t=ji();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}();function Do(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Lo(t,e){var n=Math.min.apply(Math,t),r=Math.min.apply(Math,e);return{x:n,y:r,width:Math.max.apply(Math,t)-n,height:Math.max.apply(Math,e)-r}}var Bo={box:function(t,e,n,r){return Lo([t,n],[e,r])},length:function(t,e,n,r){return Do(t,e,n,r)},pointAt:function(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}},pointDistance:function(t,e,n,r,i,o){var a=(n-t)*(i-t)+(r-e)*(o-e);return a<0?Do(t,e,i,o):a>(n-t)*(n-t)+(r-e)*(r-e)?Do(n,r,i,o):this.pointToLine(t,e,n,r,i,o)},pointToLine:function(t,e,n,r,i,o){var a=[n-t,r-e];if(u.exactEquals(a,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e));var s=[-a[1],a[0]];u.normalize(s,s);var c=[i-t,o-e];return Math.abs(u.dot(c,s))},tangentAngle:function(t,e,n,r){return Math.atan2(r-e,n-t)}};function Fo(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=Do(r[0],r[1],i[0],i[1])}return e}var ko=function(t){return Fo(t)};var Uo,Go,Vo,jo,Wo,Xo=n(44),Ho=n(114);function Yo(){Yo=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function zo(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Ko(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){zo(o,r,i,a,s,"next",t)}function s(t){zo(o,r,i,a,s,"throw",t)}a(void 0)}))}}function qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zo(t,e,n){return e&&qo(t.prototype,e),n&&qo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qo(){return(Qo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Jo(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,$o(t,e)}function $o(t,e){return($o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ta(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}function ea(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function na(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ra(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return na(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?na(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}!function(t){t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger"}(Uo||(Uo={})),function(t){t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther"}(Go||(Go={})),function(t){t[t.kAll=0]="kAll",t[t.kNonNegative=1]="kNonNegative",t[t.kInteger=2]="kInteger",t[t.kNonNegativeInteger=3]="kNonNegativeInteger",t[t.kPositiveInteger=4]="kPositiveInteger"}(Vo||(Vo={})),function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"}(jo||(jo={})),function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"}(Wo||(Wo={}));var ia,oa=[{name:"em",unit_type:Uo.kEms},{name:"px",unit_type:Uo.kPixels},{name:"deg",unit_type:Uo.kDegrees},{name:"rad",unit_type:Uo.kRadians},{name:"grad",unit_type:Uo.kGradians},{name:"ms",unit_type:Uo.kMilliseconds},{name:"s",unit_type:Uo.kSeconds},{name:"rem",unit_type:Uo.kRems},{name:"turn",unit_type:Uo.kTurns}];!function(t){t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType"}(ia||(ia={}));var aa,sa=function(t){return t?"number"===t?Uo.kNumber:"percent"===t||"%"===t?Uo.kPercentage:function(t){return oa.find((function(e){return e.name===t})).unit_type}(t):Uo.kUnknown},ua=function(t){var e=1;switch(t){case Uo.kPixels:case Uo.kDegrees:case Uo.kSeconds:break;case Uo.kMilliseconds:e=.001;break;case Uo.kRadians:e=180/Math.PI;break;case Uo.kGradians:e=.9;break;case Uo.kTurns:e=360}return e},ca=function(t){switch(t){case Uo.kNumber:case Uo.kInteger:return"";case Uo.kPercentage:return"%";case Uo.kEms:return"em";case Uo.kRems:return"rem";case Uo.kPixels:return"px";case Uo.kDegrees:return"deg";case Uo.kRadians:return"rad";case Uo.kGradians:return"grad";case Uo.kMilliseconds:return"ms";case Uo.kSeconds:return"s";case Uo.kTurns:return"turn"}return""},la=function(){function t(){}t.isAngle=function(t){return t===Uo.kDegrees||t===Uo.kRadians||t===Uo.kGradians||t===Uo.kTurns},t.isLength=function(t){return t>=Uo.kEms&&t<Uo.kDegrees},t.isRelativeUnit=function(t){return t===Uo.kPercentage||t===Uo.kEms||t===Uo.kRems},t.isTime=function(t){return t===Uo.kSeconds||t===Uo.kMilliseconds};var e=t.prototype;return e.toString=function(){return this.buildCSSText(jo.kNo,Wo.kNo,"")},e.isNumericValue=function(){return this.getType()>=ia.kUnitType&&this.getType()<=ia.kClampType},t}(),fa=function(t){function e(e){var n;return(n=t.call(this)||this).colorSpace=void 0,n.colorSpace=e,n}Jo(e,t);var n=e.prototype;return n.getType=function(){return ia.kColorType},n.to=function(t){return this},e}(la);!function(t){t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient"}(aa||(aa={}));var ha=function(t){function e(e,n){var r;return(r=t.call(this)||this).type=void 0,r.value=void 0,r.type=e,r.value=n,r}Jo(e,t);var n=e.prototype;return n.clone=function(){return new e(this.type,this.value)},n.buildCSSText=function(t,e,n){return n},n.getType=function(){return ia.kColorType},e}(la),da=function(t){function e(e){var n;return(n=t.call(this)||this).value=void 0,n.value=e,n}Jo(e,t);var n=e.prototype;return n.clone=function(){return new e(this.value)},n.getType=function(){return ia.kKeywordType},n.buildCSSText=function(t,e,n){return n+this.value},e}(la),pa=v((function(t){return void 0===t&&(t=""),t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))}));function va(t){if(!t)throw new Error}function ga(t,e){if(t===e)throw new Error}var ma,ya,_a={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign",values:{middle:"center"}},src:{alias:"img"}},Ea=v((function(t){var e=pa(t),n=_a[e];return[e=(null==n?void 0:n.alias)||e,n]}));function Ta(t,e){var n,r=Ea(t),i=r[0],o=r[1];return[i,g(e)&&(null==o||null===(n=o.values)||void 0===n?void 0:n[e])||e]}!function(t){t.kAdd="+",t.kSubtract="-",t.kMultiply="*",t.kDivide="/",t.kMin="min",t.kMax="max",t.kClamp="clamp",t.kInvalid=""}(ma||(ma={})),function(t){t[t.kLength=0]="kLength",t[t.kAngle=1]="kAngle",t[t.kTime=2]="kTime",t[t.kFrequency=3]="kFrequency",t[t.kResolution=4]="kResolution",t[t.kFlex=5]="kFlex",t[t.kPercent=6]="kPercent",t[t.kNumBaseTypes=7]="kNumBaseTypes"}(ya||(ya={}));var Ra=function(){function t(t,e){void 0===t&&(t=Uo.kNumber),void 0===e&&(e=1),this.exponents=[],this.numNonZeroEntries=0,this.percentHint=ya.kPercent,this.hasPercentHint=!1,this.exponents=new Array(ya.kNumBaseTypes).fill(0),t!==Uo.kNumber&&this.setExponent(function(t){switch(ga(t,Uo.kNumber),t){case Uo.kEms:case Uo.kPixels:case Uo.kRems:return ya.kLength;case Uo.kMilliseconds:case Uo.kSeconds:return ya.kTime;case Uo.kDegrees:case Uo.kRadians:case Uo.kGradians:case Uo.kTurns:return ya.kAngle;case Uo.kPercentage:return ya.kPercent;default:return ya.kLength}}(t),e)}var e=t.prototype;return e.applyPercentHint=function(t){ga(t,ya.kPercent),this.setExponent(t,this.exponent(t)+this.exponent(ya.kPercent)),this.setExponent(ya.kPercent,0),this.percentHint=t,this.hasPercentHint=!0},e.hasNonZeroEntries=function(){return this.numNonZeroEntries>0},e.isOnlyNonZeroEntry=function(t,e){return ga(e,0),1===this.numNonZeroEntries&&this.exponent(t)===e},e.exponent=function(t){return this.exponents[t]},e.setExponent=function(t,e){var n=this.exponents[t];0==n&&0!==e?this.numNonZeroEntries++:0!==n&&0==e&&this.numNonZeroEntries--,this.exponents[t]=e},t.negateExponents=function(t){return t.exponents.forEach((function(t){return-1*t})),t},e.matchesBaseType=function(t){return ga(t,ya.kPercent),this.isOnlyNonZeroEntry(t,1)&&!this.hasPercentHint},e.matchesPercentage=function(){return this.isOnlyNonZeroEntry(ya.kPercent,1)},e.matchesBaseTypePercentage=function(t){return ga(t,ya.kPercent),this.isOnlyNonZeroEntry(t,1)||this.isOnlyNonZeroEntry(ya.kPercent,1)},e.matchesNumber=function(){return!this.hasNonZeroEntries()&&!this.hasPercentHint},e.matchesNumberPercentage=function(){return!this.hasNonZeroEntries()||this.isOnlyNonZeroEntry(ya.kPercent,1)},t.add=function(t,e,n){if(t.hasPercentHint&&e.hasPercentHint&&t.percentHint!=e.percentHint)return t;t.hasPercentHint?e.applyPercentHint(t.percentHint):e.hasPercentHint&&t.applyPercentHint(e.percentHint),function(t,e){if(t!==e)throw new Error}(t.percentHint,e.percentHint);for(var r=0;r<ya.kNumBaseTypes;++r){var i=r;if(t.exponents[r]!==e.exponents[r]&&(i!==ya.kPercent&&(t.applyPercentHint(i),e.applyPercentHint(i)),t.exponents[r]!==e.exponents[r]))return t}return t},t.multiply=function(t,e,n){if(t.hasPercentHint&&e.hasPercentHint&&t.percentHint!=e.percentHint)return t;t.hasPercentHint?e.applyPercentHint(t.percentHint):e.hasPercentHint&&t.applyPercentHint(e.percentHint);for(var r=0;r<ya.kNumBaseTypes;++r){var i=r;t.setExponent(i,t.exponent(i)+e.exponent(i))}return t},t}(),Aa=function(t){return"number"==typeof t?new Pa(t,Uo.kNumber):t},Sa=function(t){function e(e){var n;return(n=t.call(this)||this).type_=void 0,n.type_=e,n}Jo(e,t);var n=e.prototype;return n.getType=function(){return ia.kUnknownType},n.equals=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=ba(n);return i.every((function(e){return t.equals(e)}))},n.add=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ba(e);xa(ia.kSumType,r,this);var i=Oa(r,ma.kAdd);return i||Ga.create(r)},n.sub=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ba(e);r=r.map((function(t){return t.negate()})),xa(ia.kSumType,r,this);var i=Oa(r,ma.kAdd);return i||Ga.create(r)},n.mul=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ba(e);xa(ia.kProductType,r,this);var i=Ca(r);return i||Va.create(r)},n.div=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ba(e);r=r.map((function(t){return t.invert()})),xa(ia.kProductType,r,this);var i=Ca(r);return i||Va.create(r)},n.min=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ba(e);xa(ia.kMinType,r,this);var i=Oa(r,ma.kMin);return i||ka.create(r)},n.max=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=ba(e);xa(ia.kMaxType,r,this);var i=Oa(r,ma.kMax);return i||Ua.create(r)},n.to=function(t){var e=this.sumValue();if(0===e.length||1!==e.length)return null;var n,r=Ma(e[0]);return r?(n="string"==typeof t?sa(t):t,r.convertTo(n)):null},n.toSum=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if(!e.isValidUnit(sa(a)))return null}var s=this.sumValue();if(!s.length)return null;for(var u,c=[],l=ra(s);!(u=l()).done;){var f=u.value,h=Ma(f);if(!h)return null;c.push(h)}if(0===n.length){c.sort((function(t,e){return t.unit-e.unit}));var d=Ga.create(c);return va(!!d),d}for(var p=[],v=function(){var t=m[g],n=sa(t);va(e.isValidUnit(n));var r=c.reduce((function(t,e,r){if(e){var i=e.convertTo(n);i&&(t+=i.value,c[r]=null)}return t}),0);p.push(new Pa(r,n))},g=0,m=n;g<m.length;g++)v();if(c.some((function(t){return!!t})))throw new Error("There were leftover terms that were not converted");return Ga.create(p)},n.type=function(){var t={length:0,angle:0,time:0,frequency:0,resolution:0,flex:0,percent:0,percentHint:"length"},e=this.type_.exponent(ya.kLength);return e&&(t.length=e),(e=this.type_.exponent(ya.kAngle))&&(t.angle=e),(e=this.type_.exponent(ya.kTime))&&(t.time=e),(e=this.type_.exponent(ya.kFrequency))&&(t.frequency=e),(e=this.type_.exponent(ya.kResolution))&&(t.resolution=e),(e=this.type_.exponent(ya.kFlex))&&(t.flex=e),(e=this.type_.exponent(ya.kPercent))&&(t.percent=e),this.type_.hasPercentHint&&(t.percentHint=function(t){switch(t){case ya.kLength:return"length";case ya.kAngle:return"angle";case ya.kTime:return"time";case ya.kFrequency:return"frequency";case ya.kResolution:return"resolution";case ya.kFlex:return"flex";case ya.kPercent:return"percent"}return""}(this.type_.percentHint)),t},e.isValidUnit=function(t){return!!(t===Uo.kNumber||t==Uo.kPercentage||this.isLength(t)||this.isAngle(t)||this.isTime(t))},n.negate=function(){return Da.create(this)},n.invert=function(){return wa.create(this)},e}(la);function ba(t){return t.map(Aa)}function xa(t,e,n){va(!!n),n.getType()===t?e.unshift.apply(e,n.numericValues()):e.unshift(n)}function Ma(t){return 0===Object.keys(t.units).length?new Pa(t.value):1===Object.keys(t.units).length&&1===t.units[Object.keys(t.units)[0]]?new Pa(t.value,Number(Object.keys(t.units)[0])):null}function Oa(t,e){va(!!t.length);var n=t[0]instanceof Pa?t[0]:null;if(!n)return null;for(var r=n.value,i=1;i<t.length;i++){var o=t[i]instanceof Pa?t[i]:null;if(!o||o.unit!==n.unit)return null;e===ma.kAdd?r+=o.value:e===ma.kMax?r=Math.max(r,o.value):e===ma.kMin&&(r=Math.min(r,o.value))}return new Pa(r,n.unit)}function Ca(t){va(!!t.length);for(var e=Uo.kNumber,n=1,r=0;r<t.length;r++){var i=t[r]instanceof Pa?t[r]:null;if(!i)return null;if(i.unit!==Uo.kNumber){if(e!==Uo.kNumber)return null;e=i.unit}n*=i.value}return new Pa(n,e)}var Na=function(t){return function(t){switch(t){case Go.kUNumber:return Uo.kNumber;case Go.kULength:return Uo.kPixels;case Go.kUPercent:return Uo.kPercentage;case Go.kUTime:return Uo.kSeconds;case Go.kUAngle:return Uo.kDegrees;default:return Uo.kUnknown}}(function(t){switch(t){case Uo.kNumber:case Uo.kInteger:return Go.kUNumber;case Uo.kPercentage:return Go.kUPercent;case Uo.kPixels:return Go.kULength;case Uo.kMilliseconds:case Uo.kSeconds:return Go.kUTime;case Uo.kDegrees:case Uo.kRadians:case Uo.kGradians:case Uo.kTurns:return Go.kUAngle;default:return Go.kUOther}}(t))},Pa=function(t){function e(e,n){var r,i;return void 0===n&&(n=Uo.kNumber),i="string"==typeof n?sa(n):n,(r=t.call(this,new Ra(i))||this).unit=void 0,r.value=void 0,r.unit=i,r.value=e,r}Jo(e,t);var n=e.prototype;return n.clone=function(){return new e(this.value,this.unit)},n.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var n=Na(this.unit);if(n!==Na(t)||n===Uo.kUnknown)return null;var r=ua(this.unit)/ua(t);return new e(this.value*r,t)},n.equals=function(t){var e=t;return this.value===e.value&&this.unit===e.unit},n.getType=function(){return ia.kUnitType},n.sumValue=function(){var t,e,n=[],r={};return this.unit!==Uo.kNumber&&(r[(t=this.unit,e=Na(t),e===Uo.kUnknown?t:e)]=1),n.push({value:this.value*ua(this.unit),units:r}),n},n.negate=function(){return new e(-this.value,this.unit)},n.invert=function(){return this.unit===Uo.kNumber?0===this.value?null:new e(1/this.value,this.unit):wa.create(this)},n.buildCSSText=function(t,e,n){var r;switch(this.unit){case Uo.kUnknown:break;case Uo.kInteger:r=Number(this.value).toFixed(0);break;case Uo.kNumber:case Uo.kPercentage:case Uo.kEms:case Uo.kRems:case Uo.kPixels:case Uo.kDegrees:case Uo.kRadians:case Uo.kGradians:case Uo.kMilliseconds:case Uo.kSeconds:case Uo.kTurns:var i=this.value,o=ca(this.unit);if(i<-999999||i>999999){var a=ca(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?function(t,e){void 0===e&&(e="");var n="";return Number.isFinite(t)?(va(Number.isNaN(t)),n="NaN"):n=t>0?"infinity":"-infinity",n+e}(i,a):i+(a||"")}else r=""+i+o}return n+=r},e}(Sa),Ia=function(t){function e(){return t.apply(this,arguments)||this}return Jo(e,t),e.prototype.isUnitValue=function(){return!1},e}(Sa),wa=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).value=void 0,r.operator="invert",r.value=e,r}Jo(e,t),e.create=function(t){return new e(t,Ra.negateExponents(t.type_))};var n=e.prototype;return n.clone=function(){return new e(this.value,this.type_)},n.getType=function(){return ia.kInvertType},n.equals=function(t){if(t.getType()!==ia.kInvertType)return!1;var e=t;return this.value.equals(e.value)},n.sumValue=function(){var t=this.value.sumValue();return 0===t.length||1!==t.length||0===t[0].value?null:(Object.keys(t[0].units).forEach((function(e){t[0].units[e]*=-1})),t[0].value=1/t[0].value,t)},n.buildCSSText=function(t,e,n){return e==Wo.kNo&&(n+=t===jo.kYes?"(":"calc("),n+="1 / ",n=this.value.buildCSSText(jo.kYes,Wo.kNo,n),e===Wo.kNo&&(n+=")"),n},e}(Ia),Da=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).value=void 0,r.operator="negate",r.value=e,r}Jo(e,t),e.create=function(t){return new e(t,t.type_)};var n=e.prototype;return n.clone=function(){return new e(this.value,this.type_)},n.getType=function(){return ia.kNegateType},n.equals=function(t){if(t.getType()!==ia.kNegateType)return!1;var e=t;return this.value.equals(e.value)},n.sumValue=function(){var t=this.value.sumValue();return 0===t.length?null:(t.forEach((function(t){t.value*=-1})),t)},n.buildCSSText=function(t,e,n){return e==Wo.kNo&&(n+=t===jo.kYes?"(":"calc("),n+="-",n=this.value.buildCSSText(jo.kYes,Wo.kNo,n),e===Wo.kNo&&(n+=")"),n},e}(Ia);function La(t,e,n){for(var r=t[0].type_,i=1;i<t.length;i++)r=e(r,t[i].type_,!1);return r}var Ba,Fa=function(t){function e(e,n){var r;return(r=t.call(this,n)||this).values=void 0,r.values=e,r}Jo(e,t);var n=e.prototype;return n.numericValues=function(){return this.values},n.equals=function(t){return this.getType()===t.getType()&&this.values.every((function(e,n){return e.equals(t.values[n])}))},e}(Ia),ka=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="min",e}Jo(e,t),e.create=function(t){return new e(t,La(t,Ra.add))};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ia.kMinType},n.sumValue=function(){var t=this.numericValues()[0].sumValue();if(!t.length)return null;for(var e,n=ra(this.numericValues());!(e=n()).done;){var r=e.value.sumValue();if(!r.length||JSON.stringify(r[0].units)!==JSON.stringify(t[0].units))return null;r[0].value<t[0].value&&(t=r)}return t},n.buildCSSText=function(t,e,n){n+="min(";for(var r,i=!0,o=ra(this.numericValues());!(r=o()).done;){i||(n+=", "),i=!1,n=r.value.buildCSSText(jo.kYes,Wo.kYes,n)}return n+=")"},e}(Fa),Ua=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="max",e}Jo(e,t),e.create=function(t){return new e(t,La(t,Ra.add))};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ia.kMaxType},n.sumValue=function(){var t=this.numericValues()[0].sumValue();if(!t.length)return null;for(var e,n=ra(this.numericValues());!(e=n()).done;){var r=e.value.sumValue();if(!r.length||JSON.stringify(r[0].units)!==JSON.stringify(t[0].units))return null;r[0].value<t[0].value&&(t=r)}return t},n.buildCSSText=function(t,e,n){n+="max(";for(var r,i=!0,o=ra(this.numericValues());!(r=o()).done;){i||(n+=", "),i=!1,n=r.value.buildCSSText(jo.kYes,Wo.kYes,n)}return n+=")"},e}(Fa),Ga=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="sum",e}Jo(e,t),e.create=function(t){return new e(t,La(t,Ra.add))},e.numericTypeFromUnitMap=function(t){var e=new Ra;return Object.keys(t).forEach((function(n){var r=t[n];e=Ra.multiply(e,new Ra(Number(n),r),!1),va(!0)})),e},e.canCreateNumericTypeFromSumValue=function(t){var e=this;va(!!t.length);var n=this.numericTypeFromUnitMap(t[0].units);return t.every((function(t){return Ra.add(n,e.numericTypeFromUnitMap(t.units),!1),!0}))};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ia.kSumType},n.sumValue=function(){var t=[];return this.numericValues().forEach((function(e){var n=e.sumValue();if(!n.length)return null;n.forEach((function(e){var n=t.findIndex((function(t){return JSON.stringify(t.units)===JSON.stringify(e.units)}));-1===n?t.push(Qo({},e)):t[n].value+=e.value}))})),e.canCreateNumericTypeFromSumValue(t)?t:null},n.buildCSSText=function(t,e,n){e==Wo.kNo&&(n+=t===jo.kYes?"(":"calc(");var r=this.numericValues();n=r[0].buildCSSText(jo.kYes,Wo.kNo,n);for(var i=1;i<r.length;i++){var o=r[i];o.getType()===ia.kNegateType?(n+=" - ",n=o.value.buildCSSText(jo.kYes,Wo.kNo,n)):(n+=" + ",n=o.buildCSSText(jo.kYes,Wo.kNo,n))}return e===Wo.kNo&&(n+=")"),n},e}(Fa),Va=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).operator="product",e}Jo(e,t),e.create=function(t){return new e(t,La(t,Ra.multiply))},e.multiplyUnitMaps=function(t,e){return Object.keys(e).forEach((function(n){ga(e[n].value,0);var r=n in t?t[n].value:0;r+e[n].value===0?delete t[n]:t[n]=r+e[n].value})),t};var n=e.prototype;return n.clone=function(){return new e(this.values,this.type_)},n.getType=function(){return ia.kProductType},n.sumValue=function(){var t=[{value:1,units:{}}];return this.numericValues().forEach((function(n){var r=n.sumValue();if(!r.length)return null;var i=[];t.forEach((function(t){r.forEach((function(n){i.push({value:t.value*n.value,units:e.multiplyUnitMaps(t.units,n.units)})}))})),t=i})),t},n.buildCSSText=function(t,e,n){e==Wo.kNo&&(n+=t===jo.kYes?"(":"calc(");var r=this.numericValues();n=r[0].buildCSSText(jo.kYes,Wo.kNo,n);for(var i=1;i<r.length;i++){var o=r[i];o.getType()===ia.kInvertType?(n+=" / ",n=o.value.buildCSSText(jo.kYes,Wo.kNo,n)):(n+=" * ",n=o.buildCSSText(jo.kYes,Wo.kNo,n))}return e===Wo.kNo&&(n+=")"),n},e}(Fa),ja=new Pa(0,"px"),Wa=new Pa(0,"deg"),Xa=function(t){function e(e,n,r,i,o){var a;return void 0===i&&(i=1),void 0===o&&(o=!1),(a=t.call(this,"rgb")||this).r=void 0,a.g=void 0,a.b=void 0,a.alpha=void 0,a.isNone=void 0,a.r=e,a.g=n,a.b=r,a.alpha=i,a.isNone=o,a}Jo(e,t);var n=e.prototype;return n.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},n.buildCSSText=function(t,e,n){return n+"rgba("+this.r+","+this.g+","+this.b+","+this.alpha+")"},e}(fa);!function(t){t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_PATH="<offset-path>",t.OFFSET_DISTANCE="<offset-distance>",t.CLIP_PATH="<clip-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>"}(Ba||(Ba={}));var Ha=c.Syringe.defineToken(""),Ya=(c.Syringe.defineToken(""),function(t){return new Pa(t)}),za=c.Syringe.defineToken(""),Ka=c.Syringe.defineToken(""),qa=new da("unset"),Za=new da("initial"),Qa=new da("inherit"),Ja={"":qa,unset:qa,initial:Za,inherit:Qa},$a=function(t){return Ja[t]||(Ja[t]=new da(t)),Ja[t]},ts=new Xa(0,0,0,0,!0),es=new Xa(0,0,0,0),ns=v((function(t,e,n,r){return new Xa(t,e,n,r)}),(function(t,e,n,r){return"rgba("+t+","+e+","+n+","+r+")"})),rs=v((function(t,e){return void 0===e&&(e=Uo.kNumber),new Pa(t,e)}),(function(t,e){return void 0===e&&(e=Uo.kNumber),""+t+e})),is={},os=0;var as="undefined"!=typeof window&&void 0!==window.document;function ss(t,e){var n=Number(t.style.zIndex),r=Number(e.style.zIndex);if(n===r){var i=t.parentNode;if(i){var o=i.childNodes||[];return o.indexOf(t)-o.indexOf(e)}}return n-r}function us(t,e){if(as)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var cs={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};function ls(t){var e=t.type,n=t.value;return"hex"===e?"#"+n:"literal"===e?n:"rgb"===e?"rgb("+n.join(",")+")":"rgba("+n.join(",")+")"}var fs=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,r=/^(repeating\-radial\-gradient)/i,i=/^(conic\-gradient)/i,o=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,a=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,f=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,h=/^\(/,d=/^\)/,p=/^,/,v=/^\#([0-9a-fA-F]+)/,g=/^([a-zA-Z]+)/,m=/^rgb/i,y=/^rgba/i,_=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,E="";function T(t){throw new Error(E+": "+t)}function R(){var t=I(A);return E.length>0&&T("Invalid input not EOF"),t}function A(){return S("linear-gradient",t,x)||S("repeating-linear-gradient",e,x)||S("radial-gradient",n,M)||S("repeating-radial-gradient",r,M)||S("conic-gradient",i,M)}function S(t,e,n){return b(e,(function(e){var r=n();return r&&(k(p)||T("Missing comma before color stops")),{type:t,orientation:r,colorStops:I(w)}}))}function b(t,e){var n=k(t);if(n){k(h)||T("Missing (");var r=e(n);return k(d)||T("Missing )"),r}}function x(){return F("directional",o,1)||F("angular",f,1)}function M(){var t,e,n=O();return n&&((t=[]).push(n),e=E,k(p)&&((n=O())?t.push(n):E=e)),t}function O(){var t=function(){var t=F("shape",/^(circle)/i,0);t&&(t.style=B()||C());return t}()||function(){var t=F("shape",/^(ellipse)/i,0);t&&(t.style=L()||C());return t}();if(t)t.at=N();else{var e=C();if(e){t=e;var n=N();n&&(t.at=n)}else{var r=P();r&&(t={type:"default-radial",at:r})}}return t}function C(){return F("extent-keyword",a,1)}function N(){if(F("position",/^at/,0)){var t=P();return t||T("Missing positioning value"),t}}function P(){var t={x:L(),y:L()};if(t.x||t.y)return{type:"position",value:t}}function I(t){var e=t(),n=[];if(e)for(n.push(e);k(p);)(e=t())?n.push(e):T("One extra comma");return n}function w(){var t=F("hex",v,1)||b(y,(function(){return{type:"rgba",value:I(D)}}))||b(m,(function(){return{type:"rgb",value:I(D)}}))||F("literal",g,0);return t||T("Expected color definition"),t.length=L(),t}function D(){return k(_)[1]}function L(){return F("%",c,1)||F("position-keyword",s,1)||B()}function B(){return F("px",u,1)||F("em",l,1)}function F(t,e,n){var r=k(e);if(r)return{type:t,value:r[n]}}function k(t){var e=/^[\n\r\t\s]+/.exec(E);e&&U(e[0].length);var n=t.exec(E);return n&&U(n[0].length),n}function U(t){E=E.substring(t)}return function(t){return E=t,R()}}();function hs(t){return void 0===t?0:t>360||t<-360?t%360:t}function ds(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),m(t)?o.fromValues(t,e,n):Array.isArray(t)&&3===t.length?o.clone(t):o.fromValues(t[0],t[1]||e,t[2]||n)}function ps(t){return t*(Math.PI/180)}function vs(t){return t*(180/Math.PI)}function gs(t,e){return 16===e.length?function(t,e){var n,r,a=.5*Math.PI,s=i.getScaling(o.create(),e),u=s[0],c=s[1],l=s[2],f=Math.asin(-e[2]/u);return f<a?f>-a?(n=Math.atan2(e[6]/c,e[10]/l),r=Math.atan2(e[1]/u,e[0]/u)):(r=0,n=-Math.atan2(e[4]/c,e[5]/c)):(r=0,n=Math.atan2(e[4]/c,e[5]/c)),t[0]=n,t[1]=f,t[2]=r,t}(t,e):function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=r*r,s=i*i,u=o*o,c=n*n+a+s+u,l=n*o-r*i;return l>.499995*c?(t[0]=Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):l<-.499995*c?(t[0]=-Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-o*r)),t[1]=Math.atan2(2*(n*o+r*i),1-2*(s+u)),t[2]=Math.atan2(2*(n*r+i*o),1-2*(a+s))),t}(t,e)}function ms(t){var e=t[0],n=t[1],r=t[3],i=t[4],o=Math.sqrt(e*e+n*n),a=Math.sqrt(r*r+i*i);e*i-n*r<0&&(e<i?o=-o:a=-a),o&&(e*=1/o,n*=1/o),a&&(r*=1/a,i*=1/a);var s=vs(Math.atan2(n,e));return[t[6],t[7],o,a,s]}var ys,_s=i.create(),Es=i.create(),Ts=a.create(),Rs=[o.create(),o.create(),o.create()],As=o.create();function Ss(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i}!function(t){t.GROUP="g",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh"}(ys||(ys={}));var bs=c.Syringe.defineToken(""),xs=c.Syringe.defineToken("");c.Syringe.defineToken("");function Ms(t){var e;return 0===t.parsedStyle.path.totalLength&&(t.parsedStyle.path.totalLength=q(t.parsedStyle.path.absolutePath,void 0,y(y({},e),{bbox:!1,length:!0})).length),t.parsedStyle.path.totalLength}function Os(t,e,n,r){var i=(-1+Math.sqrt(2))/3*4,o=t*i,a=e*i,s=n-t,u=n+t,c=r-e,l=r+e;return[["M",s,r],["C",s,r-a,n-o,c,n,c],["C",n+o,c,u,r-a,u,r],["C",u,r+a,n+o,l,n,l],["C",n-o,l,s,r+a,s,r],["Z"]]}function Cs(t,e){void 0===e&&(e=!0);var n=[];switch(t.nodeName){case ys.LINE:var r=t.parsedStyle,i=r.x1,a=r.y1,s=r.x2,u=r.y2;n=function(t,e,n,r){return[["M",t,e],["L",n,r]]}(i,a,s,u);break;case ys.CIRCLE:var c=t.parsedStyle,l=c.r,f=c.cx,h=c.cy;n=Os(l,l,f,h);break;case ys.ELLIPSE:var d=t.parsedStyle,p=d.rx,v=d.ry,g=d.cx,m=d.cy;n=Os(p,v,g,m);break;case ys.POLYLINE:case ys.POLYGON:var y=t.parsedStyle.points;n=function(t,e){var n=t.map((function(t,e){return[0===e?"M":"L",t[0],t[1]]}));return e&&n.push(["Z"]),n}(y.points,t.nodeName===ys.POLYGON);break;case ys.RECT:var _=t.parsedStyle,E=_.width,T=_.height,R=_.x,A=_.y,S=_.radius,b=S&&S.some((function(t){return 0!==t}));n=function(t,e,n,r,i){if(i){var o=i[0],a=i[1],s=i[2],u=i[3],c=t>0?1:-1,l=e>0?1:-1,f=c+l!==0?1:0;return[["M",c*o+n,r],["L",t-c*a+n,r],a?["A",a,a,0,0,f,t+n,l*a+r]:null,["L",t+n,e-l*s+r],s?["A",s,s,0,0,f,t+n-c*s,e+r]:null,["L",n+c*u,e+r],u?["A",u,u,0,0,f,n,e+r-l*u]:null,["L",n,l*o+r],o?["A",o,o,0,0,f,c*o+n,r]:null,["Z"]].filter((function(t){return t}))}return[["M",n,r],["L",n+t,r],["L",n+t,r+e],["L",n,r+e],["Z"]]}(E,T,R,A,b&&S.map((function(t){return Z(t,0,Math.min(Math.abs(E)/2,Math.abs(T)/2))})));break;case ys.PATH:var x=t.parsedStyle.path,M=x.curve,O=x.zCommandIndexes;n=[].concat(M),O.forEach((function(t,e){n.splice(t+e,1,["Z"])}))}if(n.length)return function(t,e,n){var r;void 0===n&&(n=!0),n&&(r=e.getLocalTransform());var i=e.parsedStyle,a=i.defX,s=void 0===a?0:a,u=i.defY,c=void 0===u?0:u;return t.reduce((function(t,e){var i="";if("M"===e[0]||"L"===e[0]){var a=o.fromValues(e[1]-s,e[2]-c,0);n&&o.transformMat4(a,a,r),i=""+e[0]+a[0]+","+a[1]}else if("Z"===e[0])i=e[0];else if("C"===e[0]){var u=o.fromValues(e[1]-s,e[2]-c,0),l=o.fromValues(e[3]-s,e[4]-c,0),f=o.fromValues(e[5]-s,e[6]-c,0);n&&(o.transformMat4(u,u,r),o.transformMat4(l,l,r),o.transformMat4(f,f,r)),i=""+e[0]+u[0]+","+u[1]+","+l[0]+","+l[1]+","+f[0]+","+f[1]}else if("A"===e[0]){var h=o.fromValues(e[6]-s,e[7]-c,0);n&&o.transformMat4(h,h,r),i=""+e[0]+e[1]+","+e[2]+","+e[3]+","+e[4]+","+e[5]+","+h[0]+","+h[1]}return t+i}),"")}(n,t,e)}var Ns=function(){return this.call=this._createCall("sync"),this.call.apply(this,arguments)},Ps=function(){return this.callAsync=this._createCall("async"),this.callAsync.apply(this,arguments)},Is=function(){return this.promise=this._createCall("promise"),this.promise.apply(this,arguments)},ws=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e=void 0),this.name=void 0,this.taps=void 0,this.promise=void 0,this._promise=void 0,this._args=t,this.name=e,this.taps=[],this.interceptors=[],this._call=Ns,this.call=Ns,this._callAsync=Ps,this.callAsync=Ps,this._promise=Is,this.promise=Is,this._x=void 0}var e=t.prototype;return e.compile=function(t){throw new Error("Abstract: should be overridden")},e._createCall=function(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})},e._tap=function(t,e,n){if("string"==typeof e)e={name:e.trim()};else if("object"!=typeof e||null===e)throw new Error("Invalid tap options");if("string"!=typeof e.name||""===e.name)throw new Error("Missing name for tap");e=Object.assign({type:t,fn:n},e),e=this._runRegisterInterceptors(e),this._insert(e)},e.tap=function(t,e){this._tap("sync",t,e)},e.tapAsync=function(t,e){this._tap("async",t,e)},e.tapPromise=function(t,e){this._tap("promise",t,e)},e._runRegisterInterceptors=function(t){for(var e,n=ra(this.interceptors);!(e=n()).done;){var r=e.value;if(r.register){var i=r.register(t);void 0!==i&&(t=i)}}return t},e.withOptions=function(t){var e=this,n=function(e){return Object.assign({},t,"string"==typeof e?{name:e}:e)};return{name:this.name,tap:function(t,r){return e.tap(n(t),r)},tapAsync:function(t,r){return e.tapAsync(n(t),r)},tapPromise:function(t,r){return e.tapPromise(n(t),r)},isUsed:function(){return e.isUsed()},withOptions:function(t){return e.withOptions(n(t))}}},e.isUsed=function(){return this.taps.length>0||this.interceptors.length>0},e._resetCompilation=function(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise},e._insert=function(t){var e;this._resetCompilation(),"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var n=0;"number"==typeof t.stage&&(n=t.stage);for(var r=this.taps.length;r>0;){r--;var i=this.taps[r];this.taps[r+1]=i;var o=i.stage||0;if(e){if(e.has(i.name)){e.delete(i.name);continue}if(e.size>0)continue}if(!(o>n)){r++;break}}this.taps[r]=t},t}(),Ds=function(){function t(t){this.config=t,this.options=void 0,this._args=void 0}var e=t.prototype;return e.create=function(t){var e;switch(this.init(t),this.options.type){case"sync":e=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"throw "+t+";\n"},onResult:function(t){return"return "+t+";\n"},resultReturns:!0,onDone:function(){return""},rethrowIfPossible:!0}));break;case"async":e=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"_callback("+t+");\n"},onResult:function(t){return"_callback(null, "+t+");\n"},onDone:function(){return"_callback();\n"}}));break;case"promise":var n=!1,r=this.contentWithInterceptors({onError:function(t){return n=!0,"_error("+t+");\n"},onResult:function(t){return"_resolve("+t+");\n"},onDone:function(){return"_resolve();\n"}}),i="";i+='"use strict";\n',i+=this.header(),i+="return new Promise((function(_resolve, _reject) {\n",n&&(i+="var _sync = true;\n",i+="function _error(_err) {\n",i+="if(_sync)\n",i+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",i+="else\n",i+="_reject(_err);\n",i+="};\n"),i+=r,n&&(i+="_sync = false;\n"),i+="}));\n",e=new Function(this.args(),i)}return this.deinit(),e},e.setup=function(t,e){t._x=e.taps.map((function(t){return t.fn}))},e.init=function(t){this.options=t,this._args=t.args.slice()},e.deinit=function(){this.options=void 0,this._args=void 0},e.contentWithInterceptors=function(t){var e=this;if(this.options.interceptors.length>0){for(var n=t.onError,r=t.onResult,i=t.onDone,o="",a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.call&&(o+=this.getInterceptor(a)+".call("+this.args({before:s.context?"_context":void 0})+");\n")}return o+=this.content(Object.assign(t,{onError:n&&function(t){for(var r="",i=0;i<e.options.interceptors.length;i++){e.options.interceptors[i].error&&(r+=e.getInterceptor(i)+".error("+t+");\n")}return r+=n(t)},onResult:r&&function(t){for(var n="",i=0;i<e.options.interceptors.length;i++){e.options.interceptors[i].result&&(n+=e.getInterceptor(i)+".result("+t+");\n")}return n+=r(t)},onDone:i&&function(){for(var t="",n=0;n<e.options.interceptors.length;n++){e.options.interceptors[n].done&&(t+=e.getInterceptor(n)+".done();\n")}return t+=i()}}))}return this.content(t)},e.header=function(){var t="";return this.needContext()?t+="var _context = {};\n":t+="var _context;\n",t+="var _x = this._x;\n",this.options.interceptors.length>0&&(t+="var _taps = this.taps;\n",t+="var _interceptors = this.interceptors;\n"),t},e.needContext=function(){for(var t,e=ra(this.options.taps);!(t=e()).done;){if(t.value.context)return!0}return!1},e.callTap=function(t,e){for(var n=e.onError,r=e.onResult,i=e.onDone,o=e.rethrowIfPossible,a="",s=!1,u=0;u<this.options.interceptors.length;u++){var c=this.options.interceptors[u];c.tap&&(s||(a+="var _tap"+t+" = "+this.getTap(t)+";\n",s=!0),a+=this.getInterceptor(u)+".tap("+(c.context?"_context, ":"")+"_tap"+t+");\n")}a+="var _fn"+t+" = "+this.getTapFn(t)+";\n";var l=this.options.taps[t];switch(l.type){case"sync":o||(a+="var _hasError"+t+" = false;\n",a+="try {\n"),a+=r?"var _result"+t+" = _fn"+t+"("+this.args({before:l.context?"_context":void 0})+");\n":"_fn"+t+"("+this.args({before:l.context?"_context":void 0})+");\n",o||(a+="} catch(_err) {\n",a+="_hasError"+t+" = true;\n",a+=n("_err"),a+="}\n",a+="if(!_hasError"+t+") {\n"),r&&(a+=r("_result"+t)),i&&(a+=i()),o||(a+="}\n");break;case"async":var f="";f+=r?"(function(_err"+t+", _result"+t+") {\n":"(function(_err"+t+") {\n",f+="if(_err"+t+") {\n",f+=n("_err"+t),f+="} else {\n",r&&(f+=r("_result"+t)),i&&(f+=i()),f+="}\n",f+="})",a+="_fn"+t+"("+this.args({before:l.context?"_context":void 0,after:f})+");\n";break;case"promise":a+="var _hasResult"+t+" = false;\n",a+="var _promise"+t+" = _fn"+t+"("+this.args({before:l.context?"_context":void 0})+");\n",a+="if (!_promise"+t+" || !_promise"+t+".then)\n",a+="  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise"+t+" + ')');\n",a+="_promise"+t+".then((function(_result"+t+") {\n",a+="_hasResult"+t+" = true;\n",r&&(a+=r("_result"+t)),i&&(a+=i()),a+="}), function(_err"+t+") {\n",a+="if(_hasResult"+t+") throw _err"+t+";\n",a+=n("_err"+t),a+="});\n"}return a},e.callTapsSeries=function(t){var e=this,n=t.onError,r=t.onResult,i=t.resultReturns,o=t.onDone,a=t.doneReturns,s=t.rethrowIfPossible;if(0===this.options.taps.length)return o();for(var u=this.options.taps.findIndex((function(t){return"sync"!==t.type})),c=i||a,l="",f=o,h=0,d=function(t){var i=t;f!==o&&("sync"!==e.options.taps[i].type||h++>20)&&(h=0,l+="function _next"+i+"() {\n",l+=f(),l+="}\n",f=function(){return(c?"return ":"")+"_next"+i+"();\n"});var a=f,d=function(t){return t?"":o()},p=e.callTap(i,{onError:function(t){return n(i,t,a,d)},onResult:r&&function(t){return r(i,t,a,d)},onDone:!r&&a,rethrowIfPossible:s&&(u<0||i<u)});f=function(){return p}},p=this.options.taps.length-1;p>=0;p--)d(p);return l+=f()},e.callTapsLooping=function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;if(0===this.options.taps.length)return n();var i=this.options.taps.every((function(t){return"sync"===t.type})),o="";i||(o+="var _looper = (function() {\n",o+="var _loopAsync = false;\n"),o+="var _loop;\n",o+="do {\n",o+="_loop = false;\n";for(var a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.loop&&(o+=this.getInterceptor(a)+".loop("+this.args({before:s.context?"_context":void 0})+");\n")}return o+=this.callTapsSeries({onError:e,onResult:function(t,e,n,r){var o="";return o+="if("+e+" !== undefined) {\n",o+="_loop = true;\n",i||(o+="if(_loopAsync) _looper();\n"),o+=r(!0),o+="} else {\n",o+=n(),o+="}\n"},onDone:n&&function(){var t="";return t+="if(!_loop) {\n",t+=n(),t+="}\n"},rethrowIfPossible:r&&i}),o+="} while(_loop);\n",i||(o+="_loopAsync = true;\n",o+="});\n",o+="_looper();\n"),o},e.callTapsParallel=function(t){var e=this,n=t.onError,r=t.onResult,i=t.onDone,o=t.rethrowIfPossible,a=t.onTap,s=void 0===a?function(t,e){return e()}:a;if(this.options.taps.length<=1)return this.callTapsSeries({onError:n,onResult:r,onDone:i,rethrowIfPossible:o});var u="";u+="do {\n",u+="var _counter = "+this.options.taps.length+";\n",i&&(u+="var _done = (function() {\n",u+=i(),u+="});\n");for(var c=function(t){var a=function(){return i?"if(--_counter === 0) _done();\n":"--_counter;"},c=function(t){return t||!i?"_counter = 0;\n":"_counter = 0;\n_done();\n"};u+="if(_counter <= 0) break;\n",u+=s(t,(function(){return e.callTap(t,{onError:function(e){var r="";return r+="if(_counter > 0) {\n",r+=n(t,e,a,c),r+="}\n"},onResult:r&&function(e){var n="";return n+="if(_counter > 0) {\n",n+=r(t,e,a,c),n+="}\n"},onDone:!r&&function(){return a()},rethrowIfPossible:o})}),a,c)},l=0;l<this.options.taps.length;l++)c(l);return u+="} while(false);\n"},e.args=function(t){var e=void 0===t?{}:t,n=e.before,r=e.after,i=this._args;return n&&(i=[n].concat(i)),r&&(i=i.concat(r)),0===i.length?"":i.join(", ")},e.getTapFn=function(t){return"_x["+t+"]"},e.getTap=function(t){return"_taps["+t+"]"},e.getInterceptor=function(t){return"_interceptors["+t+"]"},t}(),Ls=new(function(t){function e(){return t.apply(this,arguments)||this}return Jo(e,t),e.prototype.content=function(t){var e=t.onError,n=t.onDone;return this.callTapsParallel({onError:function(t,n,r,i){return e(n)+i(!0)},onDone:n})},e}(Ds)),Bs=function(t){return Ls.setup(this,t),Ls.create(t)},Fs=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).compile=Bs,r._call=void 0,r.call=void 0,r}return Jo(e,t),e}(ws),ks=new(function(t){function e(){return t.apply(this,arguments)||this}return Jo(e,t),e.prototype.content=function(t){var e=this,n=t.onError,r=t.onResult;t.onDone;return this.callTapsSeries({onError:function(t,e,r,i){return n(e)+i(!0)},onResult:function(t,n,r){var i="";return i+="if("+n+" !== undefined) {\n",i+=e._args[0]+" = "+n+";\n",i+="}\n",i+=r()},onDone:function(){return r(e._args[0])}})},e}(Ds)),Us=function(t){return ks.setup(this,t),ks.create(t)},Gs=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).compile=Us,r._call=void 0,r.call=void 0,r}return Jo(e,t),e}(ws),Vs=new(function(t){function e(){return t.apply(this,arguments)||this}return Jo(e,t),e.prototype.content=function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,n){return e(n)},onDone:n,rethrowIfPossible:r})},e}(Ds)),js=function(){throw new Error("tapAsync is not supported on a SyncHook")},Ws=function(){throw new Error("tapPromise is not supported on a SyncHook")},Xs=function(t){return Vs.setup(this,t),Vs.create(t)},Hs=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).tapAsync=js,r.tapPromise=Ws,r.compile=Xs,r}return Jo(e,t),e}(ws),Ys=new(function(t){function e(){return t.apply(this,arguments)||this}return Jo(e,t),e.prototype.content=function(t){var e=this,n=t.onError,r=t.onResult,i=t.resultReturns,o=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,e){return n(e)},onResult:function(t,n,r){var i="";return i+="if("+n+" !== undefined) {\n",i+=e._args[0]+" = "+n+";\n",i+="}\n",i+=r()},onDone:function(){return r(e._args[0])},doneReturns:i,rethrowIfPossible:o})},e}(Ds)),zs=function(){throw new Error("tapAsync is not supported on a SyncWaterfallHook")},Ks=function(){throw new Error("tapPromise is not supported on a SyncWaterfallHook")},qs=function(t){return Ys.setup(this,t),Ys.create(t)},Zs=function(t){function e(e,n){var r;return void 0===e&&(e=[]),void 0===n&&(n=void 0),(r=t.call(this,e,n)||this).tapAsync=zs,r.tapPromise=Ks,r.compile=qs,r}return Jo(e,t),e}(Hs),Qs=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];var Js=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,$s=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,tu=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,eu=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;var nu={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},ru=v((function(t){return"angular"===t.type?Number(t.value):nu[t.value]||0})),iu=v((function(t){var e=.5,n=.5;if("position"===(null==t?void 0:t.type)){var r=t.value,i=r.x,o=r.y;"position-keyword"===(null==i?void 0:i.type)&&("left"===i.value?e=0:"center"===i.value?e=.5:"right"===i.value?e=1:"top"===i.value?n=0:"bottom"===i.value&&(n=1)),"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?n=.5:"right"===o.value?e=1:"top"===o.value?n=0:"bottom"===o.value&&(n=1)),"%"===(null==i?void 0:i.type)&&(e=Number(i.value)/100),"%"===(null==o?void 0:o.type)&&(n=Number(i.value)/100)}return{cx:e,cy:n}})),ou=v((function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return fs(t).map((function(e){var n=e.type,r=e.orientation,i=e.colorStops;!function(t){var e,n,r=t.length;t[r-1].length=null!==(e=t[r-1].length)&&void 0!==e?e:{type:"%",value:"100"},r>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var i=0,o=Number(t[0].length.value),a=1;a<r;a++){var s,u=null===(s=t[a].length)||void 0===s?void 0:s.value;if(!Q(u)&&!Q(o)){for(var c=1;c<a-i;c++)t[i+c].length={type:"%",value:""+(o+(Number(u)-o)*c/(a-i))};i=a,o=Number(u)}}}(i);var o=i.map((function(t){return[Number(t.length.value)/100,ls(t)]}));if("linear-gradient"===n)return new ha(aa.LinearGradient,{angle:r?ru(r):0,steps:o,hash:t});if("radial-gradient"===n&&(r||(r=[{type:"shape",value:"circle"}]),"shape"===r[0].type&&"circle"===r[0].value)){var a=iu(r[0].at),s=a.cx,u=a.cy;return new ha(aa.RadialGradient,{cx:s,cy:u,steps:o,hash:t})}}));var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=Js.exec(t);if(n){var r,i=(null===(r=n[2].match(eu))||void 0===r?void 0:r.map((function(t){return t.split(":")})))||[];return[new ha(aa.LinearGradient,{angle:parseFloat(n[1]),steps:i.map((function(t){var e=t[0],n=t[1];return[Number(e),n]})),hash:t})]}}else if("r"===e){var o=function(t){var e=$s.exec(t);if(e){var n;return{cx:.5,cy:.5,steps:((null===(n=e[4].match(eu))||void 0===n?void 0:n.map((function(t){return t.split(":")})))||[]).map((function(t){var e=t[0],n=t[1];return[Number(e),n]})),hash:t}}return null}(t);if(o){if(!g(o))return[new ha(aa.RadialGradient,o)];t=o}}else if("p"===e)return function(t){var e=tu.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;case"n":n="no-repeat";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}(t)}));function au(t){return J(t)&&!!t.image}var su=v((function(t){if(au(t))return Qo({repetition:"repeat"},t);if(Q(t)&&(t=""),"transparent"===t)return es;"currentColor"===t&&(t="black");var e=ou(t);if(e)return e;var n=St(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),ns.apply(void 0,r)}));function uu(t,e){if(t instanceof Xa&&e instanceof Xa)return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(Z(e[n],0,255));return e[3]=Z(e[3],0,1),"rgba("+e.join(",")+")"}]}var cu,lu=function(){function t(t,e){this.center=o.create(),this.halfExtents=o.create(),this.min=o.create(),this.max=o.create(),this.update(t,e)}t.isEmpty=function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]};var e=t.prototype;return e.update=function(t,e){t&&o.copy(this.center,t),e&&o.copy(this.halfExtents,e||o.fromValues(0,0,0)),this.min=o.sub(this.min,this.center,this.halfExtents),this.max=o.add(this.max,this.center,this.halfExtents)},e.setMinMax=function(t,e){o.add(this.center,e,t),o.scale(this.center,this.center,.5),o.sub(this.halfExtents,e,t),o.scale(this.halfExtents,this.halfExtents,.5),o.copy(this.min,t),o.copy(this.max,e)},e.getMin=function(){return this.min},e.getMax=function(){return this.max},e.add=function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,r=n[0],i=n[1],o=n[2],a=this.halfExtents,s=a[0],u=a[1],c=a[2],l=r-s,f=r+s,h=i-u,d=i+u,p=o-c,v=o+c,g=e.center,m=g[0],y=g[1],_=g[2],E=e.halfExtents,T=E[0],R=E[1],A=E[2],S=m-T,b=m+T,x=y-R,M=y+R,O=_-A,C=_+A;S<l&&(l=S),b>f&&(f=b),x<h&&(h=x),M>d&&(d=M),O<p&&(p=O),C>v&&(v=C),n[0]=.5*(l+f),n[1]=.5*(h+d),n[2]=.5*(p+v),a[0]=.5*(f-l),a[1]=.5*(d-h),a[2]=.5*(v-p),this.min[0]=l,this.min[1]=h,this.min[2]=p,this.max[0]=f,this.max[1]=d,this.max[2]=v}},e.setFromTransformedAABB=function(t,e){var n=this.center,r=this.halfExtents,i=t.center,a=t.halfExtents,s=e[0],u=e[4],c=e[8],l=e[1],f=e[5],h=e[9],d=e[2],p=e[6],v=e[10],g=Math.abs(s),m=Math.abs(u),y=Math.abs(c),_=Math.abs(l),E=Math.abs(f),T=Math.abs(h),R=Math.abs(d),A=Math.abs(p),S=Math.abs(v);o.set(n,e[12]+s*i[0]+u*i[1]+c*i[2],e[13]+l*i[0]+f*i[1]+h*i[2],e[14]+d*i[0]+p*i[1]+v*i[2]),o.set(r,g*a[0]+m*a[1]+y*a[2],_*a[0]+E*a[1]+T*a[2],R*a[0]+A*a[1]+S*a[2]),this.min=o.sub(this.min,n,r),this.max=o.add(this.max,n,r)},e.intersects=function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]},e.intersection=function(e){if(!this.intersects(e))return null;var n=new t,r=o.max(o.create(),this.getMin(),e.getMin()),i=o.min(o.create(),this.getMax(),e.getMax());return n.setMinMax(r,i),n},e.containsPoint=function(t){var e=this.getMin(),n=this.getMax();return!(t[0]<e[0]||t[0]>n[0]||t[1]<e[1]||t[1]>n[1]||t[2]<e[2]||t[2]>n[2])},e.getNegativeFarPoint=function(t){return 273===t.pnVertexFlag?o.copy(o.create(),this.min):272===t.pnVertexFlag?o.fromValues(this.min[0],this.min[1],this.max[2]):257===t.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.min[2]):256===t.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.max[2]):17===t.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.min[2]):16===t.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.max[2]):1===t.pnVertexFlag?o.fromValues(this.max[0],this.max[1],this.min[2]):o.fromValues(this.max[0],this.max[1],this.max[2])},e.getPositiveFarPoint=function(t){return 273===t.pnVertexFlag?o.copy(o.create(),this.max):272===t.pnVertexFlag?o.fromValues(this.max[0],this.max[1],this.min[2]):257===t.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.max[2]):256===t.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.min[2]):17===t.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.max[2]):16===t.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.min[2]):1===t.pnVertexFlag?o.fromValues(this.min[0],this.min[1],this.max[2]):o.fromValues(this.min[0],this.min[1],this.min[2])},t}(),fu=function(){function t(t,e){this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=t||0,this.normal=e||o.fromValues(0,1,0),this.updatePNVertexFlag()}var e=t.prototype;return e.updatePNVertexFlag=function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)},e.distanceToPoint=function(t){return o.dot(t,this.normal)-this.distance},e.normalize=function(){var t=1/o.len(this.normal);o.scale(this.normal,this.normal,t),this.distance*=t},e.intersectsLine=function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),a=i>=0&&i<=1;return a&&n&&o.lerp(n,t,e,i),a},t}();!function(t){t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE"}(cu||(cu={}));var hu=function(){function t(t){if(this.planes=[],t)this.planes=t;else for(var e=0;e<6;e++)this.planes.push(new fu)}return t.prototype.extractFromVPMatrix=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],g=t[14],m=t[15];o.set(this.planes[0].normal,i-e,c-a,d-l),this.planes[0].distance=m-p,o.set(this.planes[1].normal,i+e,c+a,d+l),this.planes[1].distance=m+p,o.set(this.planes[2].normal,i+n,c+s,d+f),this.planes[2].distance=m+v,o.set(this.planes[3].normal,i-n,c-s,d-f),this.planes[3].distance=m-v,o.set(this.planes[4].normal,i-r,c-u,d-h),this.planes[4].distance=m-g,o.set(this.planes[5].normal,i+r,c+u,d+h),this.planes[5].distance=m+g,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))},t}(),du=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}var e=t.prototype;return e.clone=function(){return new t(this.x,this.y)},e.copyFrom=function(t){this.x=t.x,this.y=t.y},t}(),pu=function(){function t(t,e,n,r){this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0,this.x=t,this.y=e,this.width=n,this.height=r,this.left=t,this.right=t+n,this.top=e,this.bottom=e+r}return t.prototype.toJSON=function(){},t}();function vu(t,e){if(Q(e))return rs(0,"px");if(e=(""+e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return rs(Number(e),"px");if("deg".search(t)>=0)return rs(Number(e),"deg")}var n=[];e=e.replace(t,(function(t){return n.push(t),"U"+t}));var r="U("+t.source+")";return n.map((function(t){return rs(Number(e.replace(new RegExp("U"+t,"g"),"").replace(new RegExp(r,"g"),"*0")),t)}))[0]}var gu=v((function(t){return vu(new RegExp("px","g"),t)})),mu=(v((function(t){return vu(new RegExp("%","g"),t)})),v((function(t){return m(t)||isFinite(Number(t))?rs(Number(t),"px"):vu(new RegExp("px|%|em|rem","g"),t)}))),yu=v((function(t){return vu(new RegExp("deg|rad|grad|turn","g"),t)}));function _u(t,e,n,r,i){void 0===i&&(i=0);var o="",a=t.value||0,s=e.value||0,u=Na(t.unit),c=t.convertTo(u),l=e.convertTo(u);return c&&l?(a=c.value,s=l.value,o=ca(t.unit)):(Pa.isLength(t.unit)||Pa.isLength(e.unit))&&(a=Ru(t,i,n),s=Ru(e,i,n),o="px"),[a,s,function(t){return r&&(t=Math.max(t,0)),t+o}]}function Eu(t){var e=0;return t.unit===Uo.kDegrees?e=t.value:t.unit===Uo.kRadians?e=vs(Number(t.value)):t.unit===Uo.kTurns&&(e=360*Number(t.value)),e}function Tu(t){return g(t)?t.split(" ").map((function(t){return mu(t)})):t.map((function(t){return mu(t.toString())}))}function Ru(t,e,n){if(t.unit===Uo.kPixels)return Number(t.value);if(t.unit===Uo.kPercentage&&n){var r=n.nodeName===ys.GROUP?n.getLocalBounds():n.getGeometryBounds(),i=0;return lu.isEmpty(r)||(i=2*r.halfExtents[e]),Number(t.value)/100*i}return 0}var Au=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function Su(t){if(void 0===t&&(t=""),"none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];if(i=e.index+e[0].length,Au.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map((function(t){return vu(/deg|rad|grad|turn|px|%/g,t)||su(t)}))}),n.lastIndex===t.length)return r}return[]}function bu(t){return t.toString()}var xu=v((function(t){return"number"==typeof t?rs(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?rs(Number(t)):rs(0)}));v((function(t){return g(t)?t.split(" ").map(xu):t.map(xu)}));function Mu(t,e){return[t,e,bu]}function Ou(t,e){return function(n,r){return[n,r,function(n){return bu(Z(n,t,e))}]}}function Cu(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}var Nu=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:[],totalLength:0,zCommandIndexes:[],rect:{x:0,y:0,width:0,height:0}};var e;try{e=k(t)}catch(v){e=k(""),console.error("[g]: Invalid SVG Path definition: "+t)}var n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var o=t[i],a=o[0];"M"===a?(r.length&&(n.push(r),r=[]),r.push([o[1],o[2]])):"Z"===a?r.length&&(e.push(r),r=[]):r.push([o[1],o[2]])}return r.length>0&&n.push(r),{polygons:e,polylines:n}}(e),i=r.polygons,o=r.polylines,a=rt(e,!0),s=a[0],u=a[1],c=function(t){for(var e,n,r=[],i=null,o=null,a=0,s=t.length,u=0;u<s;u++){var c=t[u];o=t[u+1];var l=c[0],f={command:l,prePoint:i,params:c,startTangent:null,endTangent:null};switch(l){case"M":a=u}var h=c.length;i=[c[h-2],c[h-1]],f.currentPoint=i,r[a]&&(e=i,n=r[a].currentPoint,e[0]===n[0]&&e[1]===n[1])&&(r[a].prePoint=f.prePoint);var d=o?[o[o.length-2],o[o.length-1]]:null;f.nextPoint=d;var p=f.prePoint;if("C"===l){var v=[c[1],c[2]],g=[c[3],c[4]];f.startTangent=[p[0]-v[0],p[1]-v[1]],f.endTangent=[i[0]-g[0],i[1]-g[1]],0===f.startTangent[0]&&0===f.startTangent[1]&&(f.startTangent=[v[0]-g[0],v[1]-g[1]]),0===f.endTangent[0]&&0===f.endTangent[1]&&(f.endTangent=[g[0]-v[0],g[1]-v[1]])}r.push(f)}return r}(s),l=function(t,e){if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var n=q(t,void 0,y(y({},e),{length:!1})),r=n.min,i=r.x,o=r.y,a=n.max,s=a.x,u=a.y,c=s-i,l=u-o;return{width:c,height:l,x:i,y:o,x2:s,y2:u,cx:i+c/2,cy:o+l/2,cz:Math.max(c,l)+Math.min(c,l)/2}}(e),f=l.x,h=l.y,d=l.width,p=l.height;return{absolutePath:e,hasArc:n,segments:c,polygons:i,polylines:o,curve:s,totalLength:0,zCommandIndexes:u,rect:{x:Number.isFinite(f)?f:0,y:Number.isFinite(h)?h:0,width:Number.isFinite(d)?d:0,height:Number.isFinite(p)?p:0}}},Pu=v(Nu);function Iu(t,e){var n=g(t)?Pu(t):Nu(t);return e&&(e.parsedStyle.defX=n.rect.x,e.parsedStyle.defY=n.rect.y),n}function wu(t,e,n){var r=t.curve,i=e.curve,o=[r,i];r.length!==i.length&&(o=function t(e,n,r){var i=it(e),o=it(n),a=i.length,s=o.length,u=i.filter((function(t){return t.l})).length,c=o.filter((function(t){return t.l})).length,l=i.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/u||0,f=o.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/c||0,h=r||Math.max(a,s),d=[l,f],p=[h-a,h-s],v=0,g=[i,o].map((function(t,e){return t.l===h?t.map((function(t){return t.s})):t.map((function(t,n){return v=n&&p[e]&&t.l>=d[e],p[e]-=v?1:0,v?t.ss:[t.s]})).flat()}));return g[0].length===g[1].length?g:t(g[0],g[1],h)}(r,i));var a,s,u,c,l,f,h,d,p=ot(o[0])!==ot(o[1])?(a=o[0],s=a.slice(1).map((function(t,e,n){return e?n[e-1].slice(-2).concat(t.slice(1)):a[0].slice(1).concat(t.slice(1))})).map((function(t){return t.map((function(e,n){return t[t.length-n-2*(1-n%2)]}))})).reverse(),[["M"].concat(s[0].slice(0,2))].concat(s.map((function(t){return["C"].concat(t.slice(2))})))):M(o[0]);return[p,(u=o[1],c=p,l=u.length-1,f=[],h=0,d=function(t){var e=t.length,n=e-1;return t.map((function(r,i){return t.map((function(r,o){var a,s=i+o;return 0===o||t[s]&&"M"===t[s][0]?(a=t[s],["M"].concat(a.slice(-2))):(s>=e&&(s-=n),t[s])}))}))}(u),d.forEach((function(t,e){u.slice(1).forEach((function(t,n){h+=G(u[(e+n)%l].slice(-2),c[n%l].slice(-2))})),f[e]=h,h=0})),d[f.indexOf(Math.min.apply(null,f))]),function(t){return t}]}function Du(t,e){var n;n=g(t)?t.split(" ").map((function(t){var e=t.split(","),n=e[0],r=e[1];return[Number(n),Number(r)]})):t;var r,i,o=[],a=0,s=ko(n);n.forEach((function(t,e){n[e+1]&&((r=[0,0])[0]=a/s,i=Bo.length(t[0],t[1],n[e+1][0],n[e+1][1]),a+=i,r[1]=a/s,o.push(r))}));var u=Math.min.apply(Math,n.map((function(t){return t[0]}))),c=Math.min.apply(Math,n.map((function(t){return t[1]})));return e&&(e.parsedStyle.defX=u,e.parsedStyle.defY=c),{points:n,totalLength:s,segments:o}}var Lu=null;function Bu(t){return function(e){var n=0;return t.map((function(t){return t===Lu?e[n++]:t}))}}function Fu(t){return t}var ku={matrix:["NNNNNN",[Lu,Lu,0,0,Lu,Lu,0,0,0,0,1,0,Lu,Lu,0,1],Fu],matrix3d:["NNNNNNNNNNNNNNNN",Fu],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Bu([Lu,Lu,Ya(1)]),Fu],scalex:["N",Bu([Lu,Ya(1),Ya(1)]),Bu([Lu,Ya(1)])],scaley:["N",Bu([Ya(1),Lu,Ya(1)]),Bu([Ya(1),Lu])],scalez:["N",Bu([Ya(1),Ya(1),Lu])],scale3d:["NNN",Fu],skew:["Aa",null,Fu],skewx:["A",null,Bu([Lu,Wa])],skewy:["A",null,Bu([Wa,Lu])],translate:["Tt",Bu([Lu,Lu,ja]),Fu],translatex:["T",Bu([Lu,ja,ja]),Bu([Lu,ja])],translatey:["T",Bu([ja,Lu,ja]),Bu([ja,Lu])],translatez:["L",Bu([ja,ja,Lu])],translate3d:["TTL",Fu]};function Uu(t){if("none"===(t=(t||"none").toLowerCase().trim()))return[];for(var e,n=/\s*(\w+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var o=e[1],a=ku[o];if(!a)return[];var s=e[2].split(","),u=a[0];if(u.length<s.length)return[];for(var c=[],l=0;l<u.length;l++){var f=s[l],h=u[l],d=void 0;if(void 0===(d=f?{A:function(t){return"0"===t.trim()?Wa:yu(t)},N:xu,T:mu,L:gu}[h.toUpperCase()](f):{a:Wa,n:c[0],t:ja}[h]))return[];c.push(d)}if(r.push({t:o,d:c}),n.lastIndex===t.length)return r}return[]}function Gu(t){var e,n,r,i;switch(t.t){case"rotatex":return i=ps(Eu(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=ps(Eu(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=ps(Eu(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=ps(Eu(t.d[3]));var o=e*e+n*n+r*r;if(0===o)e=1,n=0,r=0;else if(1!==o){var a=Math.sqrt(o);e/=a,n/=a,r/=a}var s=Math.sin(i/2),u=s*Math.cos(i/2),c=s*s;return[1-2*(n*n+r*r)*c,2*(e*n*c+r*u),2*(e*r*c-n*u),0,2*(e*n*c-r*u),1-2*(e*e+r*r)*c,2*(n*r*c+e*u),0,2*(e*r*c+n*u),2*(n*r*c-e*u),1-2*(e*e+n*n)*c,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var l=ps(Eu(t.d[0])),f=ps(Eu(t.d[1]));return[1,Math.tan(f),0,0,Math.tan(l),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=ps(Eu(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=ps(Eu(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=Ru(t.d[0],0,null)||0,n=Ru(t.d[1],0,null)||0,0,1];case"translatex":return[1,0,0,0,0,1,0,0,0,0,1,0,e=Ru(t.d[0],0,null)||0,0,0,1];case"translatey":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=Ru(t.d[0],0,null)||0,0,1];case"translatez":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=Ru(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=Ru(t.d[0],0,null)||0,n=Ru(t.d[1],0,null)||0,r=Ru(t.d[2],0,null)||0,1];case"perspective":var h=Ru(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map((function(t){return t.value}))}}function Vu(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function ju(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],s=[0,0,0,1],u=[0,0,0,1];return function(t,e,n,r,s,u){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0}(_s,t))return!1;if(i.copy(Es,_s),Es[3]=0,Es[7]=0,Es[11]=0,Es[15]=1,Math.abs(i.determinant(Es))<1e-8)return!1;var c,l,f=_s[3],h=_s[7],d=_s[11],p=_s[12],v=_s[13],g=_s[14],m=_s[15];if(0!==f||0!==h||0!==d){if(Ts[0]=f,Ts[1]=h,Ts[2]=d,Ts[3]=m,!i.invert(Es,Es))return!1;i.transpose(Es,Es),a.transformMat4(s,Ts,Es)}else s[0]=s[1]=s[2]=0,s[3]=1;if(e[0]=p,e[1]=v,e[2]=g,l=_s,(c=Rs)[0][0]=l[0],c[0][1]=l[1],c[0][2]=l[2],c[1][0]=l[4],c[1][1]=l[5],c[1][2]=l[6],c[2][0]=l[8],c[2][1]=l[9],c[2][2]=l[10],n[0]=o.length(Rs[0]),o.normalize(Rs[0],Rs[0]),r[0]=o.dot(Rs[0],Rs[1]),Ss(Rs[1],Rs[1],Rs[0],1,-r[0]),n[1]=o.length(Rs[1]),o.normalize(Rs[1],Rs[1]),r[0]/=n[1],r[1]=o.dot(Rs[0],Rs[2]),Ss(Rs[2],Rs[2],Rs[0],1,-r[1]),r[2]=o.dot(Rs[1],Rs[2]),Ss(Rs[2],Rs[2],Rs[1],1,-r[2]),n[2]=o.length(Rs[2]),o.normalize(Rs[2],Rs[2]),r[1]/=n[2],r[2]/=n[2],o.cross(As,Rs[1],Rs[2]),o.dot(Rs[0],As)<0)for(var y=0;y<3;y++)n[y]*=-1,Rs[y][0]*=-1,Rs[y][1]*=-1,Rs[y][2]*=-1;u[0]=.5*Math.sqrt(Math.max(1+Rs[0][0]-Rs[1][1]-Rs[2][2],0)),u[1]=.5*Math.sqrt(Math.max(1-Rs[0][0]+Rs[1][1]-Rs[2][2],0)),u[2]=.5*Math.sqrt(Math.max(1-Rs[0][0]-Rs[1][1]+Rs[2][2],0)),u[3]=.5*Math.sqrt(Math.max(1+Rs[0][0]+Rs[1][1]+Rs[2][2],0)),Rs[2][1]>Rs[1][2]&&(u[0]=-u[0]),Rs[0][2]>Rs[2][0]&&(u[1]=-u[1]),Rs[1][0]>Rs[0][1]&&(u[2]=-u[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(Gu).reduce(Vu)}(t),e,n,r,s,u),[[e,n,r,u,s]]}var Wu=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var o=0;o<4;o++)n[r][i]+=e[r][o]*t[o][i];return n}return function(e,n,r,i,o){for(var a=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)a[s][3]=o[s];for(var u=0;u<3;u++)for(var c=0;c<3;c++)a[3][u]+=e[c]*a[c][u];var l=i[0],f=i[1],h=i[2],d=i[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(f*f+h*h),p[0][1]=2*(l*f-h*d),p[0][2]=2*(l*h+f*d),p[1][0]=2*(l*f+h*d),p[1][1]=1-2*(l*l+h*h),p[1][2]=2*(f*h-l*d),p[2][0]=2*(l*h-f*d),p[2][1]=2*(f*h+l*d),p[2][2]=1-2*(l*l+f*f),a=t(a,p);var v,g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],a=t(a,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],a=t(a,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],a=t(a,g));for(var m=0;m<3;m++)for(var y=0;y<3;y++)a[m][y]*=n[m];return 0==(v=a)[0][2]&&0==v[0][3]&&0==v[1][2]&&0==v[1][3]&&0==v[2][0]&&0==v[2][1]&&1==v[2][2]&&0==v[2][3]&&0==v[3][2]&&1==v[3][3]?[a[0][0],a[0][1],a[1][0],a[1][1],a[3][0],a[3][1]]:a[0].concat(a[1],a[2],a[3])}}();function Xu(t){return t.toFixed(6).replace(".000000","")}function Hu(t,e){var n,r;return t.decompositionPair!==e&&(t.decompositionPair=e,n=ju(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=ju(e)),null===n[0]||null===r[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}(t,e);r=Z(r,-1,1);var i=[];if(1===r)i=t;else for(var o=Math.acos(r),a=1*Math.sin(n*o)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*o)-r*a)+e[s]*a);return i}(n[0][3],r[0][3],t[5]);return Wu(t[0],t[1],t[2],e,t[4]).map(Xu).join(",")}])}function Yu(t){return t.replace(/[xy]/,"")}function zu(t){return t.replace(/(x|y|z|3d)?$/,"3d")}function Ku(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function(n){var r=t[n],i=r.t,o=r.d,a="scale"===i.substring(0,5)?1:0;e.push({t:i,d:o.map((function(t){return"number"==typeof t?rs(a):rs(a,t.unit)}))})},o=0;o<t.length;o++)i(o)}var a,s,u=[],c=[],l=[];if(t.length!==e.length){var f=Hu(t,e);u=[f[0]],c=[f[1]],l=[["matrix",[f[2]]]]}else for(var h=0;h<t.length;h++){var d=t[h].t,p=e[h].t,v=t[h].d,g=e[h].d,m=ku[d],y=ku[p],_=void 0;if(s=p,"perspective"===(a=d)&&"perspective"===s||!("matrix"!==a&&"matrix3d"!==a||"matrix"!==s&&"matrix3d"!==s)){var E=Hu([t[h]],[e[h]]);u.push(E[0]),c.push(E[1]),l.push(["matrix",[E[2]]])}else{if(d===p)_=d;else if(m[2]&&y[2]&&Yu(d)===Yu(p))_=Yu(d),v=m[2](v),g=y[2](g);else{if(!m[1]||!y[1]||zu(d)!==zu(p)){var T=Hu(t,e);u=[T[0]],c=[T[1]],l=[["matrix",[T[2]]]];break}_=zu(d),v=m[1](v),g=y[1](g)}for(var R=[],A=[],S=[],b=0;b<v.length;b++){var x=_u(v[b],g[b],n,!1,b);R[b]=x[0],A[b]=x[1],S.push(x[2])}u.push(R),c.push(A),l.push([_,S])}}if(r){var M=u;u=c,c=M}return[u,c,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return l[e][1][n](t)})).join(",");return"matrix"===l[e][0]&&16===n.split(",").length&&(l[e][0]="matrix3d"),"matrix3d"===l[e][0]&&6===n.split(",").length&&(l[e][0]="matrix"),l[e][0]+"("+n+")"})).join(" ")}]}var qu=v((function(t){if(g(t)){if("text-anchor"===t)return[rs(0,"px"),rs(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[mu(Zu(e[0])),mu(Zu(e[1]))]}return[rs(t[0]||0,"px"),rs(t[1]||0,"px")]}));function Zu(t){return"center"===t?"50%":"left"===t||"top"===t?"0":"right"===t||"bottom"===t?"100%":t}var Qu=function(){function t(){this.parser=yu,this.mixer=Mu}return t.prototype.calculator=function(t,e,n,r){return Eu(n)},t}();Qu=_([Object(c.singleton)({token:{token:Ka,named:Ba.ANGLE}})],Qu);var Ju=c.Syringe.defineToken(""),$u=c.Syringe.defineToken(""),tc=function(){function t(){}return t.prototype.update=function(t,e){var n=t.r;return{width:2*n,height:2*n}},t}();tc=_([Object(c.singleton)({token:{token:$u,named:ys.CIRCLE}})],tc);var ec=function(){function t(){}return t.prototype.update=function(t,e){return{width:2*t.rx,height:2*t.ry}},t}();ec=_([Object(c.singleton)({token:{token:$u,named:ys.ELLIPSE}})],ec);var nc=function(){function t(){}return t.prototype.update=function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=Math.min(e,r),a=Math.max(e,r),s=Math.min(n,i);return{width:a-o,height:Math.max(n,i)-s}},t}();nc=_([Object(c.singleton)({token:{token:$u,named:ys.LINE}})],nc);var rc=function(){function t(){}return t.prototype.update=function(t){var e=t.path.rect;return{width:e.width,height:e.height}},t}();rc=_([Object(c.singleton)({token:{token:$u,named:ys.PATH}})],rc);var ic=function(){function t(){}return t.prototype.update=function(t){var e=t.points.points,n=Math.min.apply(Math,e.map((function(t){return t[0]}))),r=Math.max.apply(Math,e.map((function(t){return t[0]}))),i=Math.min.apply(Math,e.map((function(t){return t[1]})));return{width:r-n,height:Math.max.apply(Math,e.map((function(t){return t[1]})))-i}},t}();ic=_([Object(c.singleton)({token:[{token:$u,named:ys.POLYLINE},{token:$u,named:ys.POLYGON}]})],ic);var oc=function(){function t(){}return t.prototype.update=function(t,e){var n=t.img,r=t.width,i=void 0===r?0:r,o=t.height,a=i,s=void 0===o?0:o;return n&&!g(n)&&(a||(a=n.width,t.width=a),s||(s=n.height,t.height=s)),{width:a,height:s}},t}();oc=_([Object(c.singleton)({token:[{token:$u,named:ys.RECT},{token:$u,named:ys.IMAGE},{token:$u,named:ys.GROUP}]})],oc);var ac=function(){function t(){this.canvas=void 0,this.context=void 0}var e=t.prototype;return e.getOrCreateCanvas=function(t){if(this.canvas)return this.canvas;if(t)this.canvas=t,this.context=this.canvas.getContext("2d");else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d"),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")}return this.canvas.width=10,this.canvas.height=10,this.canvas},e.getOrCreateContext=function(t){return this.context||this.getOrCreateCanvas(t),this.context},t}();ac=_([Object(c.singleton)()],ac);var sc={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},uc=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,cc=new RegExp(/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/.source+"|"+/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/.source+"|"+/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/.source+"|"+/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/.source),lc=new RegExp(/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/.source+"|"+/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/.source+"|"+/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/.source+"|"+/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/.source),fc=function(){function t(t){var e=this;this.offscreenCanvas=void 0,this.cache={},this.shouldBreakByKinsokuShorui=function(t,n){return!e.isBreakingSpace(n)&&!(!t||!lc.exec(n)&&!cc.exec(t))},this.trimByKinsokuShorui=function(t){var e=[].concat(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e},this.offscreenCanvas=t}var e=t.prototype;return e.measureFont=function(t,e){if(this.cache[t])return this.cache[t];var n={ascent:0,descent:0,fontSize:0},r=this.offscreenCanvas.getOrCreateCanvas(e),i=this.offscreenCanvas.getOrCreateContext(e);i.font=t;var o=sc.MetricsString+sc.BaselineSymbol,a=Math.ceil(i.measureText(o).width),s=Math.ceil(i.measureText(sc.BaselineSymbol).width),u=sc.HeightMultiplier*s;s=s*sc.BaselineMultiplier|0,r.width=a,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);var c=i.getImageData(0,0,a||1,u||1).data,l=c.length,f=4*a,h=0,d=0,p=!1;for(h=0;h<s;++h){for(var v=0;v<f;v+=4)if(255!==c[d+v]){p=!0;break}if(p)break;d+=f}for(n.ascent=s-h,d=l-f,p=!1,h=u;h>s;--h){for(var g=0;g<f;g+=4)if(255!==c[d+g]){p=!0;break}if(p)break;d-=f}return n.descent=h-s,n.fontSize=n.ascent+n.descent,this.cache[t]=n,n},e.measureText=function(t,e,n){var r=e.fontSize,i=e.wordWrap,o=e.lineHeight,a=e.lineWidth,s=e.textBaseline,u=e.textAlign,c=e.letterSpacing,l=e.leading,f=void 0===l?0:l,h=function(t){for(var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,o=t.fontWeight,a=m(e)&&e+"px"||"16px",s=g(n)?n.split(","):[n],u=s.length-1;u>=0;u--){var c=s[u].trim();!/([\"\'])[^\'\"]+\1/.test(c)&&Qs.indexOf(c)<0&&(c='"'+c+'"'),s[u]=c}return r+" "+i+" "+o+" "+a+" "+s.join(",")}(e),d=this.measureFont(h,n);0===d.fontSize&&(d.fontSize=r,d.ascent=r);var p=this.offscreenCanvas.getOrCreateContext(n);p.font=h;for(var v=(i?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),y=new Array(v.length),_=0,E=0;E<v.length;E++){var T=p.measureText(v[E]).width+(v[E].length-1)*c;y[E]=T,_=Math.max(_,T)}var R=_+a,A=o||d.fontSize+a,S=Math.max(A,d.fontSize+a)+(v.length-1)*(A+f),b=0;return"middle"===s?b=-S/2:"bottom"===s||"alphabetic"===s||"ideographic"===s?b=-S:"top"!==s&&"hanging"!==s||(b=0),{font:h,width:R,height:S,lines:v,lineWidths:y,lineHeight:A+=f,maxLineWidth:_,fontProperties:d,lineMetrics:y.map((function(t,e){var n=0;return"center"===u?n-=t/2:"right"!==u&&"end"!==u||(n-=t),new pu(n-a/2,b+e*A,t+a,A)}))}},e.wordWrap=function(t,e,n){var r=this,i=e.wordWrapWidth,o=void 0===i?0:i,a=e.letterSpacing,s=this.offscreenCanvas.getOrCreateContext(n),u=o+a,c=[],l=0,f=0,h={},d=function(t){return r.getFromCache(t,a,h,s)};return Array.from(t).forEach((function(e,n){var i=t[n-1],o=t[n+1],a=d(e);if(r.isNewline(e))return l++,f=0,void(c[l]="");if(f>0&&f+a>u){if(l++,f=0,c[l]="",r.isBreakingSpace(e))return;r.canBreakInLastChar(e)||(c=r.trimToBreakable(c),f=r.sumTextWidthByCache(c[l]||"",h)),r.shouldBreakByKinsokuShorui(e,o)&&(c=r.trimByKinsokuShorui(c),f+=d(i||""))}f+=a,c[l]=(c[l]||"")+e})),c.join("\n")},e.isBreakingSpace=function(t){return"string"==typeof t&&sc.BreakingSpaces.indexOf(t.charCodeAt(0))>=0},e.isNewline=function(t){return"string"==typeof t&&sc.Newlines.indexOf(t.charCodeAt(0))>=0},e.trimToBreakable=function(t){var e=[].concat(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),o=r+1,a=r+(this.isBreakingSpace(i)?0:1);return e[e.length-1]+=n.slice(o,n.length),e[e.length-2]=n.slice(0,a),e},e.canBreakInLastChar=function(t){return!t||!uc.test(t)},e.sumTextWidthByCache=function(t,e){return t.split("").reduce((function(t,n){if(!e[n])throw Error("cannot count the word without cache");return t+e[n]}),0)},e.findBreakableIndex=function(t){for(var e=t.length-1;e>=0;e--)if(!uc.test(t[e]))return e;return-1},e.getFromCache=function(t,e,n,r){var i=n[t];if("number"!=typeof i){var o=t.length*e;i=r.measureText(t).width+o,n[t]=i}return i},t}();fc=_([Object(c.singleton)(),E(0,Object(c.inject)(ac))],fc);var hc=function(){function t(t){this.textService=void 0,this.textService=t}var e=t.prototype;return e.isReadyToMeasure=function(t,e){var n=t.text,r=t.textAlign,i=t.textBaseline,o=t.fontSize,a=t.fontStyle,s=t.fontWeight,u=t.fontVariant,c=t.lineWidth;return n&&o&&a&&s&&u&&r&&i&&!Q(c)},e.update=function(t,e){var n,r,i=t.text,o=t.textAlign,a=t.lineWidth,s=t.textBaseline,u=t.dx,c=t.dy,l=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(r=n.defaultView)||void 0===r?void 0:r.getConfig())||{}).offscreenCanvas;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{width:0,height:0,x:0,y:0,offsetX:0,offsetY:0};var f=this.textService.measureText(i,t,l);t.metrics=f;var h=f.width,d=f.height,p=f.lineHeight,v=f.fontProperties,g=[h/2,d/2,0],m=[0,1],y=0;"center"===o?(y=a/2,m=[.5,1]):"right"!==o&&"end"!==o||(y=a,m=[1,1]);var _=0;return"middle"===s?_=g[1]:"top"===s||"hanging"===s?_=2*g[1]:"alphabetic"===s?_=p-v.ascent:"bottom"!==s&&"ideographic"!==s||(_=0),u&&(y+=u),c&&(_+=c),t.anchor=[m[0],m[1],0],{width:2*g[0],height:2*g[1],offsetX:y,offsetY:_}},t}();hc=_([Object(c.singleton)({token:{token:$u,named:ys.TEXT}}),E(0,Object(c.inject)(fc))],hc);var dc=c.Syringe.defineToken("",{multiple:!1}),pc=function(){function t(){this.registry={},this.define(ys.CIRCLE,jc),this.define(ys.ELLIPSE,Yc),this.define(ys.RECT,ul),this.define(ys.IMAGE,Jc),this.define(ys.LINE,tl),this.define(ys.GROUP,Kc),this.define(ys.PATH,nl),this.define(ys.POLYGON,il),this.define(ys.POLYLINE,al),this.define(ys.TEXT,ll),this.define(ys.HTML,Zc)}var e=t.prototype;return e.define=function(t,e){this.registry[t]=e},e.get=function(t){return this.registry[t]},t}(),vc=function(){function t(e){this.type=void 0,this.eventPhase=t.prototype.NONE,this.target=void 0,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.currentTarget=void 0,this.defaultPrevented=!1,this.timeStamp=void 0,this.nativeEvent=void 0,this.originalEvent=void 0,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.manager=void 0,this.detail=void 0,this.layer=new du,this.page=new du,this.canvas=new du,this.viewport=new du,this.path=void 0,this.view=void 0,this.which=void 0,this.returnValue=void 0,this.srcElement=void 0,this.composed=!1,this.isTrusted=void 0,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}var e=t.prototype;return e.composedPath=function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},e.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},e.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},e.stopPropagation=function(){this.propagationStopped=!0},e.initEvent=function(){},e.initUIEvent=function(){},e.clone=function(){throw new Error("Method not implemented.")},Zo(t,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"propagationPath",get:function(){return this.composedPath()}}]),t}(),gc=function(t){function e(e,n){var r;return(r=t.call(this,null)||this).type=e,r.detail=n,Object.assign(ea(r),n),r}return Jo(e,t),e}(vc),mc=function(){function t(){this.emitter=new Xo.EventEmitter}var e=t.prototype;return e.on=function(t,e,n){return this.addEventListener(t,e,n),this},e.addEventListener=function(t,e,n){var r=at(n)&&n||J(n)&&n.capture,i=J(n)&&n.once,o=p(e)?void 0:e,a=!1,s="";if(t.indexOf(":")>-1){var u=t.split(":"),c=u[0];t=u[1],s=c,a=!0}if(t=r?t+"capture":t,e=p(e)?e:e.handleEvent,a){var l=e;e=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(null===(t=n[0].target)||void 0===t?void 0:t.name)===s&&l.apply(void 0,n)}}return i?this.emitter.once(t,e,o):this.emitter.on(t,e,o),this},e.off=function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this},e.removeAllEventListeners=function(){this.emitter.removeAllListeners()},e.removeEventListener=function(t,e,n){var r,i=at(n)&&n||J(n)&&n.capture,o=p(e)?void 0:e;return t=i?t+"capture":t,e=p(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent,this.emitter.off(t,e,o),this},e.emit=function(t,e){this.dispatchEvent(new gc(t,e))},e.dispatchEvent=function(t){if(!(t instanceof vc))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var e;if(this.document)e=this;else if(this.defaultView)e=this.defaultView;else{var n;e=null===(n=this.ownerDocument)||void 0===n?void 0:n.defaultView}if(e){var r;if(t.manager=e.getEventService()||null,!t.manager)return!1;t.defaultPrevented=!1,t.path=[],t.target=this,null===(r=t.manager)||void 0===r||r.dispatchEvent(t)}return!t.defaultPrevented},t}(),yc=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e}Jo(e,t),e.isNode=function(t){return!!t.childNodes};var n=e.prototype;return n.getRootNode=function(t){return void 0===t&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},n.hasChildNodes=function(){return this.childNodes.length>0},n.isDefaultNamespace=function(t){throw new Error("Method not implemented.")},n.lookupNamespaceURI=function(t){throw new Error("Method not implemented.")},n.lookupPrefix=function(t){throw new Error("Method not implemented.")},n.normalize=function(){throw new Error("Method not implemented.")},n.isEqualNode=function(t){return this===t},n.isSameNode=function(t){return this.isEqualNode(t)},n.compareDocumentPosition=function(t){if(t===this)return 0;if(!(t instanceof e))throw new TypeError("Node.compareDocumentPosition: Argument 1 does not implement interface Node.");for(var n=t,r=this,i=[n],o=[r];null!==(a=n.parentNode)&&void 0!==a?a:r.parentNode;){var a;n=n.parentNode?(i.push(n.parentNode),n.parentNode):n,r=r.parentNode?(o.push(r.parentNode),r.parentNode):r}if(n!==r)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=i.length>o.length?i:o,u=s===i?o:i;if(s[s.length-u.length]===u[0])return s===i?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var c=s.length-u.length,l=u.length-1;l>=0;l--){var f=u[l],h=s[c+l];if(h!==f){var d=f.parentNode.childNodes;return d.indexOf(f)<d.indexOf(h)?u===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},n.contain=function(t){return this.contains(t)},n.contains=function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e},n.getAncestor=function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e},n.forEach=function(t){t(this)||this.childNodes.forEach((function(e){e.forEach(t)}))},Zo(e,[{key:"textContent",get:function(){var t="";this.nodeName===ys.TEXT&&(t+=this.style.text);for(var e,n=ra(this.childNodes);!(e=n()).done;){var r=e.value;r.nodeName===ys.TEXT?t+=r.nodeValue:t+=r.textContent}return t},set:function(t){var e=this;this.childNodes.slice().forEach((function(t){e.removeChild(t)})),this.nodeName===ys.TEXT&&(this.style.text=""+t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}}]),e}(mc);yc.DOCUMENT_POSITION_DISCONNECTED=1,yc.DOCUMENT_POSITION_PRECEDING=2,yc.DOCUMENT_POSITION_FOLLOWING=4,yc.DOCUMENT_POSITION_CONTAINS=8,yc.DOCUMENT_POSITION_CONTAINED_BY=16,yc.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var _c,Ec=function(t){function e(){var e;(e=t.call(this)||this).defaultView=null,e.documentElement=void 0,e.timeline=void 0,e.ownerDocument=null,e.nodeName="document";try{e.timeline=c.GlobalContainer.get(xs),e.timeline.attach(ea(e))}catch(r){}var n={};return Kl.forEach((function(t){var e=t.n,r=t.inh,i=t.d;r&&i&&(n[e]=p(i)?i(ys.GROUP):i)})),e.documentElement=new Kc({id:"g-root",style:n}),e.documentElement.ownerDocument=ea(e),e.documentElement.parentNode=ea(e),e.childNodes=[e.documentElement],e}Jo(e,t);var n=e.prototype;return n.createElement=function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?ll:Kc);var r=new n(e);return r.ownerDocument=this,r},n.createElementNS=function(t,e,n){return this.createElement(e,n)},n.cloneNode=function(t){throw new Error("Method not implemented.")},n.destroy=function(){try{this.documentElement.destroy(),this.timeline.destroy()}catch(t){}},n.elementFromPoint=function(){var t=Ko(Yo().mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,o=r.y,a=this.defaultView.getConfig(),s=a.width,u=a.height,!(i<0||o<0||i>s||o>u)){t.next=4;break}return t.abrupt("return",null);case 4:return c=this.defaultView.viewport2Client({x:i,y:o}),l=c.x,f=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:o,clientX:l,clientY:f},picked:[]});case 7:return h=t.sent,d=h.picked,t.abrupt("return",d&&d[0]||this.documentElement);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.elementsFromPoint=function(){var t=Ko(Yo().mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,o=r.y,a=this.defaultView.getConfig(),s=a.width,u=a.height,!(i<0||o<0||i>s||o>u)){t.next=4;break}return t.abrupt("return",[]);case 4:return c=this.defaultView.viewport2Client({x:i,y:o}),l=c.x,f=c.y,t.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:o,clientX:l,clientY:f},picked:[]});case 7:return h=t.sent,(d=h.picked)[d.length-1]!==this.documentElement&&d.push(this.documentElement),t.abrupt("return",d);case 11:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),n.appendChild=function(t,e){throw new Error("Use document.documentElement instead.")},n.insertBefore=function(t,e){throw new Error("Use document.documentElement instead.")},n.removeChild=function(t,e){throw new Error("Use document.documentElement instead.")},n.replaceChild=function(t,e,n){throw new Error("Use document.documentElement instead.")},n.append=function(){throw new Error("Use document.documentElement instead.")},n.prepend=function(){throw new Error("Use document.documentElement instead.")},n.getElementById=function(t){return this.documentElement.getElementById(t)},n.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},n.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},n.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},n.querySelector=function(t){return this.documentElement.querySelector(t)},n.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},n.find=function(t){return this.documentElement.find(t)},n.findAll=function(t){return this.documentElement.findAll(t)},Zo(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}}]),e}(yc);!function(t){t[t.Standard=0]="Standard"}(_c||(_c={}));var Tc,Rc=c.Syringe.defineToken(""),Ac=c.Syringe.defineToken("");!function(t){t.DESTROY="destroy",t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.CHILD_INSERTED="child-inserted",t.REMOVED="removed",t.CHILD_REMOVED="child-removed",t.MOUNTED="DOMNodeInsertedIntoDocument",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.BOUNDS_CHANGED="bounds-changed",t.RENDER_ORDER_CHANGED="render-order-changed",t.CULLED="culled"}(Tc||(Tc={}));var Sc=function(t){function e(e,n,r,i,o,a,s,u){var c;return(c=t.call(this,null)||this).relatedNode=void 0,c.prevValue=void 0,c.newValue=void 0,c.attrName=void 0,c.attrChange=void 0,c.prevParsedValue=void 0,c.newParsedValue=void 0,c.relatedNode=n,c.prevValue=r,c.newValue=i,c.attrName=o,c.attrChange=a,c.prevParsedValue=s,c.newParsedValue=u,c.type=e,c}return Jo(e,t),e}(vc);Sc.ADDITION=2,Sc.MODIFICATION=1,Sc.REMOVAL=3;var bc,xc=0,Mc=new gc(Tc.CHILD_INSERTED,{child:null}),Oc=new Sc(Tc.INSERTED,null,"","","",0,"",""),Cc=new Sc(Tc.REMOVED,null,"","","",0,"",""),Nc=new gc(Tc.DESTROY),Pc=new gc(Tc.CHILD_REMOVED,{child:null}),Ic=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).sceneGraphService=c.GlobalContainer.get(Ac),e.entity=xc++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1,proxyNodeName:void 0},e.cullable={strategy:_c.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:o.fromValues(0,0,0),localRotation:s.fromValues(0,0,0,1),localScale:o.fromValues(1,1,1),localTransform:i.create(),localSkew:u.fromValues(0,0),position:o.fromValues(0,0,0),rotation:s.fromValues(0,0,0,1),scaling:o.fromValues(1,1,1),worldTransform:i.create(),origin:o.fromValues(0,0,0)},e.sortable={dirty:!1,sorted:void 0,lastSortedIndex:void 0,renderOrder:0},e.geometry={contentBounds:void 0,renderBounds:void 0},e.rBushNode={aabb:void 0},e.id=void 0,e.name=void 0,e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle={anchor:qa,opacity:qa,fillOpacity:qa,strokeOpacity:qa,fill:qa,stroke:qa,transform:qa,transformOrigin:qa,visibility:qa,pointerEvents:qa,lineWidth:qa,lineCap:qa,lineJoin:qa,increasedLineWidthForHitTesting:qa,fontSize:qa,fontFamily:qa,fontStyle:qa,fontWeight:qa,fontVariant:qa,textAlign:qa,textBaseline:qa,textTransform:qa,zIndex:qa,filter:qa,shadowType:qa},e.parsedStyle={},e.attributes={},e}Jo(e,t),e.isElement=function(t){return!!t.getAttribute};var n=e.prototype;return n.cloneNode=function(t){throw new Error("Method not implemented.")},n.appendChild=function(t,e){return this.sceneGraphService.attach(t,this,e),Mc.detail.child=t,this.dispatchEvent(Mc),Oc.relatedNode=this,t.dispatchEvent(Oc),t},n.insertBefore=function(t,e){if(e){var n=this.childNodes.indexOf(e);this.appendChild(t,n-1)}else this.appendChild(t);return t},n.replaceChild=function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e},n.removeChild=function(t){return Cc.relatedNode=this,t.dispatchEvent(Cc),Pc.detail.child=t,this.dispatchEvent(Pc),this.sceneGraphService.detach(t),t},n.removeChildren=function(){var t=this;this.childNodes.slice().forEach((function(e){t.removeChild(e),e.destroy()}))},n.matches=function(t){return this.sceneGraphService.matches(t,this)},n.getElementById=function(t){return this.sceneGraphService.querySelector("#"+t,this)},n.getElementsByName=function(t){return this.sceneGraphService.querySelectorAll('[name="'+t+'"]',this)},n.getElementsByClassName=function(t){return this.sceneGraphService.querySelectorAll("."+t,this)},n.getElementsByTagName=function(t){return this.sceneGraphService.querySelectorAll(t,this)},n.querySelector=function(t){return this.sceneGraphService.querySelector(t,this)},n.querySelectorAll=function(t){return this.sceneGraphService.querySelectorAll(t,this)},n.closest=function(t){var e=this;do{if(this.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null},n.find=function(t){var e=this,n=null;return this.forEach((function(r){return!(r===e||!t(r))&&(n=r,!0)})),n},n.findAll=function(t){var e=this,n=[];return this.forEach((function(r){r!==e&&t(r)&&n.push(r)})),n},n.after=function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1)}))}},n.before=function(){if(this.parentNode){for(var t=this.parentNode.childNodes.indexOf(this),e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],o=n.slice(1);this.parentNode.appendChild(i,t),i.after.apply(i,o)}},n.replaceWith=function(){this.after.apply(this,arguments),this.remove()},n.append=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){return t.appendChild(e)}))},n.prepend=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e,n){return t.appendChild(e,n)}))},n.replaceChildren=function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)},n.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},n.destroy=function(){this.dispatchEvent(Nc),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},n.getGeometryBounds=function(){return this.sceneGraphService.getGeometryBounds(this)},n.getRenderBounds=function(){return this.sceneGraphService.getBounds(this,!0)},n.getBounds=function(){return this.sceneGraphService.getBounds(this)},n.getLocalBounds=function(){return this.sceneGraphService.getLocalBounds(this)},n.getBoundingClientRect=function(){return this.sceneGraphService.getBoundingClientRect(this)},n.getClientRects=function(){return[this.getBoundingClientRect()]},n.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},n.getAttributeNames=function(){return Object.keys(this.attributes)},n.getAttribute=function(t){var e=this.attributes[t];if(void 0===e){var n=Ta(t.toString(),"")[0];e=this.attributes[n]}return Q(e)?null:e},n.hasAttribute=function(t){return this.getAttributeNames().includes(t)},n.hasAttributes=function(){return!!this.getAttributeNames().length},n.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},n.setAttribute=function(t,e,n){this.attributes[t]=e},n.getAttributeNS=function(t,e){throw new Error("Method not implemented.")},n.getAttributeNode=function(t){throw new Error("Method not implemented.")},n.getAttributeNodeNS=function(t,e){throw new Error("Method not implemented.")},n.hasAttributeNS=function(t,e){throw new Error("Method not implemented.")},n.removeAttributeNS=function(t,e){throw new Error("Method not implemented.")},n.removeAttributeNode=function(t){throw new Error("Method not implemented.")},n.setAttributeNS=function(t,e,n){throw new Error("Method not implemented.")},n.setAttributeNode=function(t){throw new Error("Method not implemented.")},n.setAttributeNodeNS=function(t){throw new Error("Method not implemented.")},n.toggleAttribute=function(t,e){throw new Error("Method not implemented.")},Zo(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter((function(t){return""!==t}))}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}}]),e}(yc),wc=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).altKey=void 0,e.button=void 0,e.buttons=void 0,e.ctrlKey=void 0,e.metaKey=void 0,e.relatedTarget=void 0,e.shiftKey=void 0,e.client=new du,e.movement=new du,e.offset=new du,e.global=new du,e.screen=new du,e}Jo(e,t);var n=e.prototype;return n.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},n.initMouseEvent=function(){throw new Error("Method not implemented.")},Zo(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}}]),e}(vc),Dc=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).pointerId=void 0,e.width=0,e.height=0,e.isPrimary=!1,e.pointerType=void 0,e.pressure=void 0,e.tangentialPressure=void 0,e.tiltX=void 0,e.tiltY=void 0,e.twist=void 0,e}Jo(e,t);var n=e.prototype;return n.getCoalescedEvents=function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]},n.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},n.clone=function(){return this.manager.clonePointerEvent(this)},e}(wc),Lc=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).deltaMode=void 0,e.deltaX=void 0,e.deltaY=void 0,e.deltaZ=void 0,e.DOM_DELTA_LINE=0,e.DOM_DELTA_PAGE=1,e.DOM_DELTA_PIXEL=2,e}return Jo(e,t),e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(wc),Bc={},Fc=[],kc=function(){function t(){}var e=t.prototype;return e.getByEntity=function(t){return Bc[t]},e.getAll=function(){return Object.keys(Bc).map((function(t){return Bc[t]}))},e.add=function(t,e){Bc[t]=e,e.nodeName===ys.HTML&&Fc.push(e)},e.remove=function(t){var e=Bc[t];if(e&&(delete Bc[t],e.nodeName===ys.HTML)){var n=Fc.indexOf(e);Fc.splice(n,1)}},e.getHTMLs=function(){return Fc},t}();kc=_([Object(c.singleton)()],kc);var Uc,Gc=function(t){function e(e){var n,r;return(r=t.call(this)||this).config=void 0,r.isCustomElement=!1,r.activeAnimations=[],r.displayObjectPool=c.GlobalContainer.get(kc),r.styleValueRegistry=c.GlobalContainer.get(Ha),r.config=e,r.config.interactive=null!==(n=r.config.capture)&&void 0!==n?n:r.config.interactive,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||ys.GROUP,r.config.style=Qo({},r.config.style,r.config.attrs),null!=r.config.visible&&(r.config.style.visibility=!1===r.config.visible?"hidden":"visible"),null!=r.config.interactive&&(r.config.style.pointerEvents=!1===r.config.interactive?"none":"auto"),Object.assign(r.parsedStyle,{anchor:[0,0],fill:ts,stroke:ts,transform:[],zIndex:0,filter:[],shadowType:"outer"},r.config.initialParsedStyle),Object.assign(r.attributes,{anchor:"",opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""}),r.initAttributes(r.config.style),r.style=new Proxy({setProperty:function(t,e){r.setAttribute(t,e)},getPropertyValue:function(t){return r.getAttribute(t)},removeProperty:function(t){r.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:r.getAttribute(e)},set:function(t,e,n){return r.setAttribute(e,n),!0}}),r.displayObjectPool.add(r.entity,ea(r)),r}Jo(e,t);var n=e.prototype;return n.destroy=function(){t.prototype.destroy.call(this),this.displayObjectPool.remove(this.entity),this.getAnimations().forEach((function(t){t.cancel()}))},n.cloneNode=function(t,n){var r=Qo({},this.attributes);for(var i in r){var o=r[i];o instanceof e&&(r[i]=o.cloneNode(t)),n&&(r[i]=n(i,o))}var a=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:r});return a.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach((function(e){if(!e.style.isMarker){var n=e.cloneNode(t);a.appendChild(n)}})),a},n.initAttributes=function(t){void 0===t&&(t={});var e=this.renderable;this.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0,usedAttributes:["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting","fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"]}),e.dirty=!0},n.setAttribute=function(e,n,r){void 0===r&&(r=!1);var i=Ta(e,n),o=i[0],a=i[1];st(n)||(r||a!==this.attributes[o])&&(this.internalSetAttribute(o,a),t.prototype.setAttribute.call(this,o,a))},n.internalSetAttribute=function(t,e,n){var r,i=this;void 0===n&&(n={});var o=this.renderable,a=this.attributes[t],s=this.parsedStyle[t];this.styleValueRegistry.processProperties(this,((r={})[t]=e,r),n),this.parsedStyle.clipPathTargets&&this.parsedStyle.clipPathTargets.length&&this.parsedStyle.clipPathTargets.forEach((function(t){i.sceneGraphService.dirtifyToRoot(t),t.dispatchEvent(new Sc(Tc.ATTR_MODIFIED,t,i,i,"clipPath",Sc.MODIFICATION,i,i)),t.isCustomElement&&t.isConnected&&t.attributeChangedCallback&&t.attributeChangedCallback("clipPath",i,i)})),o.dirty=!0;var u=this.parsedStyle[t];this.isConnected&&(bc||(bc=new Sc(Tc.ATTR_MODIFIED,null,null,null,null,Sc.MODIFICATION,null,null)),bc.relatedNode=this,bc.prevValue=a,bc.newValue=e,bc.attrName=t,bc.prevParsedValue=s,bc.newParsedValue=u,this.dispatchEvent(bc)),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,a,e,s,u)},n.getBBox=function(){var t=this.getBounds(),e=t.getMin(),n=e[0],r=e[1],i=t.getMax(),o=i[0],a=i[1];return new pu(n,r,o-n,a-r)},n.setOrigin=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.setOrigin(this,ds(t,e,n)),this},n.getOrigin=function(){return this.sceneGraphService.getOrigin(this)},n.setPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.setPosition(this,ds(t,e,n)),this},n.setLocalPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.setLocalPosition(this,ds(t,e,n)),this},n.translate=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.translate(this,ds(t,e,n)),this},n.translateLocal=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.translateLocal(this,ds(t,e,n)),this},n.getPosition=function(){return this.sceneGraphService.getPosition(this)},n.getLocalPosition=function(){return this.sceneGraphService.getLocalPosition(this)},n.scale=function(t,e,n){return this.scaleLocal(t,e,n)},n.scaleLocal=function(t,e,n){return"number"==typeof t&&(t=ds(t,e=e||t,n=n||t)),this.sceneGraphService.scaleLocal(this,t),this},n.setLocalScale=function(t,e,n){return"number"==typeof t&&(t=ds(t,e=e||t,n=n||t)),this.sceneGraphService.setLocalScale(this,t),this},n.getLocalScale=function(){return this.sceneGraphService.getLocalScale(this)},n.getScale=function(){return this.sceneGraphService.getScale(this)},n.getEulerAngles=function(){var t=gs(o.create(),this.sceneGraphService.getWorldTransform(this));t[0],t[1];return vs(t[2])},n.getLocalEulerAngles=function(){var t=gs(o.create(),this.sceneGraphService.getLocalRotation(this));t[0],t[1];return vs(t[2])},n.setEulerAngles=function(t){return this.sceneGraphService.setEulerAngles(this,0,0,t),this},n.setLocalEulerAngles=function(t){return this.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},n.rotateLocal=function(t,e,n){return Q(e)&&Q(n)?this.sceneGraphService.rotateLocal(this,0,0,t):this.sceneGraphService.rotateLocal(this,t,e,n),this},n.rotate=function(t,e,n){return Q(e)&&Q(n)?this.sceneGraphService.rotate(this,0,0,t):this.sceneGraphService.rotate(this,t,e,n),this},n.setRotation=function(t,e,n,r){return this.sceneGraphService.setRotation(this,t,e,n,r),this},n.setLocalRotation=function(t,e,n,r){return this.sceneGraphService.setLocalRotation(this,t,e,n,r),this},n.setLocalSkew=function(t,e){return this.sceneGraphService.setLocalSkew(this,t,e),this},n.getRotation=function(){return this.sceneGraphService.getRotation(this)},n.getLocalRotation=function(){return this.sceneGraphService.getLocalRotation(this)},n.getLocalSkew=function(){return this.sceneGraphService.getLocalSkew(this)},n.getLocalTransform=function(){return this.sceneGraphService.getLocalTransform(this)},n.getWorldTransform=function(){return this.sceneGraphService.getWorldTransform(this)},n.setLocalTransform=function(t){return this.sceneGraphService.setLocalTransform(this,t),this},n.resetLocalTransform=function(){this.sceneGraphService.resetLocalTransform(this)},n.getAnimations=function(){return this.activeAnimations},n.animate=function(t,e){var n,r,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;this.parsedStyle.clipPathTargets&&this.parsedStyle.clipPathTargets.length&&(i=null===(r=this.parsedStyle.clipPathTargets[0].ownerDocument)||void 0===r?void 0:r.timeline);return i?i.play(this,t,e):null},n.isVisible=function(){var t;return"visible"===(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)},n.isInteractive=function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)},n.isCulled=function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)},n.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,this.parentNode.children.map((function(t){return Number(t.style.zIndex)})))+1),this},n.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,this.parentNode.children.map((function(t){return Number(t.style.zIndex)})))-1),this},n.getConfig=function(){return this.config},n.attr=function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],o=n[1];return i?J(i)?(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),this):2===n.length?(this.setAttribute(i,o),this):this.attributes[i]:this.attributes},n.getMatrix=function(t){var e=t||this.getWorldTransform(),n=i.getTranslation(o.create(),e),a=n[0],u=n[1],c=i.getScaling(o.create(),e),l=c[0],f=c[1],h=i.getRotation(s.create(),e),d=gs(o.create(),h),p=d[0],v=(d[1],d[2]);return function(t,e,n,i,o){var a=Math.cos(t),s=Math.sin(t);return r.fromValues(i*a,o*s,0,-i*s,o*a,0,e,n,1)}(p||v,a,u,l,f)},n.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},n.setMatrix=function(t){var e=ms(t),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4];this.setEulerAngles(a).setPosition(n,r).setLocalScale(i,o)},n.setLocalMatrix=function(t){var e=ms(t),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4];this.setLocalEulerAngles(a).setLocalPosition(n,r).setLocalScale(i,o)},Zo(e,[{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}}]),e}(Ic),Vc=["style"],jc=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,Vc);return t.call(this,Qo({type:ys.CIRCLE,style:Qo({cx:"",cy:"",r:""},r),initialParsedStyle:{anchor:[.5,.5]}},i))||this}return Jo(e,t),e}(Gc),Wc=["style"],Xc=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=ta(r,Wc);return(n=t.call(this,Qo({style:Qo({x:"",y:""},i)},o))||this).isCustomElement=!0,n}return Jo(e,t),e}(Gc),Hc=["style"],Yc=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,Hc);return t.call(this,Qo({type:ys.ELLIPSE,style:Qo({cx:"",cy:"",rx:"",ry:""},r),initialParsedStyle:{anchor:[.5,.5]}},i))||this}return Jo(e,t),e}(Gc),zc=["style"],Kc=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,zc);return t.call(this,Qo({type:ys.GROUP,style:Qo({x:"",y:"",width:"",height:""},r)},i))||this}return Jo(e,t),e}(Gc),qc=["style"],Zc=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=ta(r,qc);return(n=t.call(this,Qo({type:ys.HTML,style:Qo({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i)},o))||this).cullable.enable=!1,n}Jo(e,t);var n=e.prototype;return n.getDomElement=function(){return this.parsedStyle.$el},n.getBoundingClientRect=function(){return this.parsedStyle.$el.getBoundingClientRect()},n.getClientRects=function(){return[this.getBoundingClientRect()]},n.getBounds=function(){var t,e,n=this.getBoundingClientRect(),r=null===(t=this.ownerDocument)||void 0===t||null===(e=t.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(r){var i=n.left-r.left,a=n.top-r.top,s=new lu;return s.setMinMax(o.fromValues(i,a,0),o.fromValues(i+n.width,a+n.height,0)),s}return null},n.getLocalBounds=function(){if(this.parentNode){var t=i.invert(i.create(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!lu.isEmpty(e)){var n=new lu;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()},e}(Gc),Qc=["style"],Jc=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,Qc);return t.call(this,Qo({type:ys.IMAGE,style:Qo({x:"",y:"",img:"",width:"",height:""},r)},i))||this}return Jo(e,t),e}(Gc),$c=["style"],tl=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=ta(r,$c);(n=t.call(this,Qo({type:ys.LINE,style:Qo({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0,isBillboard:!1},i)},o))||this).markerStartAngle=0,n.markerEndAngle=0;var a=n.parsedStyle,s=a.markerStart,u=a.markerEnd;return s&&s instanceof Gc&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),u&&u instanceof Gc&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}Jo(e,t);var n=e.prototype;return n.attributeChangedCallback=function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&r instanceof Gc&&(this.markerStartAngle=0,r.remove()),i&&i instanceof Gc&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&r instanceof Gc&&(this.markerEndAngle=0,r.remove()),i&&i instanceof Gc&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))},n.transformMarker=function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.x1,s=e.x2,u=e.y1,c=e.y2,l=e.defX,f=e.defY,h=t?n:r;if(h&&h instanceof Gc){var d,p,v,g,m,y,_;t?(g=a-l,m=u-f,p=s-a,v=c-u,y=i||0,_=this.markerStartAngle):(g=s-l,m=c-f,p=a-s,v=u-c,y=o||0,_=this.markerEndAngle),d=Math.atan2(v,p),h.setLocalEulerAngles(180*d/Math.PI+_),h.setLocalPosition(g+Math.cos(d)*y,m+Math.sin(d)*y)}},n.getPoint=function(t){var e=this.parsedStyle,n=e.x1,r=e.y1,i=e.x2,a=e.y2,s=e.defX,u=e.defY,c=Bo.pointAt(n,r,i,a,t),l=c.x,f=c.y,h=o.transformMat4(o.create(),o.fromValues(l-s,f-u,0),this.getLocalTransform());return new du(h[0],h[1])},n.getPointAtLength=function(t){return this.getPoint(t/this.getTotalLength())},n.getTotalLength=function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return Bo.length(e,n,r,i)},e}(Gc),el=["style"],nl=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=ta(r,el);(n=t.call(this,Qo({type:ys.PATH,style:Qo({path:"",miterLimit:""},i)},o))||this).markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var a=n.parsedStyle,s=a.markerStart,u=a.markerEnd,c=a.markerMid;return s&&s instanceof Gc&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),c&&c instanceof Gc&&n.placeMarkerMid(c),u&&u instanceof Gc&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}Jo(e,t);var n=e.prototype;return n.attributeChangedCallback=function(t,e,n,r,i){"path"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&r instanceof Gc&&(this.markerStartAngle=0,r.remove()),i&&i instanceof Gc&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&r instanceof Gc&&(this.markerEndAngle=0,r.remove()),i&&i instanceof Gc&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)},n.transformMarker=function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.defX,s=e.defY,u=t?n:r;if(u&&u instanceof Gc){var c,l,f,h,d,p,v;if(t){var g=this.getStartTangent(),m=g[0],y=g[1];h=y[0]-a,d=y[1]-s,l=m[0]-y[0],f=m[1]-y[1],p=i||0,v=this.markerStartAngle}else{var _=this.getEndTangent(),E=_[0],T=_[1];h=T[0]-a,d=T[1]-s,l=E[0]-T[0],f=E[1]-T[1],p=o||0,v=this.markerEndAngle}c=Math.atan2(f,l),u.setLocalEulerAngles(180*c/Math.PI+v),u.setLocalPosition(h+Math.cos(c)*p,d+Math.sin(c)*p)}},n.placeMarkerMid=function(t){var e=this.parsedStyle,n=e.path.segments,r=e.defX,i=e.defY;if(this.markerMidList.forEach((function(t){t.remove()})),t&&t instanceof Gc)for(var o=1;o<n.length-1;o++){var a=n[o].currentPoint,s=a[0],u=a[1],c=1===o?t:t.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(s-r,u-i)}},n.getTotalLength=function(){return Ms(this)},n.getPointAtLength=function(t){var e=this.parsedStyle,n=e.defX,r=e.defY,i=function(t,e,n){return q(t,e,y(y({},n),{bbox:!1,length:!0})).point}(e.path.absolutePath,t),a=i.x,s=i.y,u=o.transformMat4(o.create(),o.fromValues(a-n,s-r,0),this.getLocalTransform());return new du(u[0],u[1])},n.getPoint=function(t){return this.getPointAtLength(t*Ms(this))},n.getStartTangent=function(){var t=this.parsedStyle.path.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?(e.push([n[0]-i[0],n[1]-i[1]]),e.push([n[0],n[1]])):(e.push([r[0],r[1]]),e.push([n[0],n[1]]))}return e},n.getEndTangent=function(){var t=this.parsedStyle.path.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,o=t[e-1].endTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n},e}(Gc),rl=["style"],il=function(t){function e(e){var n,r=void 0===e?{}:e,i=r.style,o=ta(r,rl);(n=t.call(this,Qo({type:ys.POLYGON,style:Qo({points:"",miterLimit:"",isClosed:!0},i)},o))||this).markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var a=n.parsedStyle,s=a.markerStart,u=a.markerEnd,c=a.markerMid;return s&&s instanceof Gc&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),c&&c instanceof Gc&&n.placeMarkerMid(c),u&&u instanceof Gc&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}Jo(e,t);var n=e.prototype;return n.attributeChangedCallback=function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&r instanceof Gc&&(this.markerStartAngle=0,r.remove()),i&&i instanceof Gc&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&r instanceof Gc&&(this.markerEndAngle=0,r.remove()),i&&i instanceof Gc&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)},n.transformMarker=function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,o=e.markerEndOffset,a=e.points.points,s=e.defX,u=e.defY,c=t?n:r;if(c&&c instanceof Gc){var l,f,h,d,p,v,g;if(d=a[0][0]-s,p=a[0][1]-u,t)f=a[1][0]-a[0][0],h=a[1][1]-a[0][1],v=i||0,g=this.markerStartAngle;else{var m=a.length;this.style.isClosed?(f=a[m-1][0]-a[0][0],h=a[m-1][1]-a[0][1]):(d=a[m-1][0]-s,p=a[m-1][1]-u,f=a[m-2][0]-a[m-1][0],h=a[m-2][1]-a[m-1][1]),v=o||0,g=this.markerEndAngle}l=Math.atan2(h,f),c.setLocalEulerAngles(180*l/Math.PI+g),c.setLocalPosition(d+Math.cos(l)*v,p+Math.sin(l)*v)}},n.placeMarkerMid=function(t){var e=this.parsedStyle,n=e.points.points,r=e.defX,i=e.defY;if(this.markerMidList.forEach((function(t){t.remove()})),this.markerMidList=[],t&&t instanceof Gc)for(var o=1;o<(this.style.isClosed?n.length:n.length-1);o++){var a=n[o][0]-r,s=n[o][1]-i,u=1===o?t:t.cloneNode(!0);this.markerMidList.push(u),this.appendChild(u),u.setLocalPosition(a,s)}},e}(Gc),ol=["style"],al=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,ol);return t.call(this,Qo({type:ys.POLYLINE,style:Qo({points:"",miterLimit:"",isClosed:!1},r)},i))||this}Jo(e,t);var n=e.prototype;return n.getTotalLength=function(){return this.parsedStyle.points.totalLength},n.getPointAtLength=function(t){return this.getPoint(t/this.getTotalLength())},n.getPoint=function(t){var e=this.parsedStyle,n=e.defX,r=e.defY,i=e.points,a=i.points,s=i.segments,u=0,c=0;s.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(u=(t-e[0])/(e[1]-e[0]),c=n)}));var l=Bo.pointAt(a[c][0],a[c][1],a[c+1][0],a[c+1][1],u),f=l.x,h=l.y,d=o.transformMat4(o.create(),o.fromValues(f-n,h-r,0),this.getLocalTransform());return new du(d[0],d[1])},n.getStartTangent=function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e},n.getEndTangent=function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n},e}(il),sl=["style"],ul=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,sl);return t.call(this,Qo({type:ys.RECT,style:Qo({x:"",y:"",width:"",height:"",radius:""},r)},i))||this}return Jo(e,t),e}(Gc),cl=["style"],ll=function(t){function e(e){var n=void 0===e?{}:e,r=n.style,i=ta(n,cl);return t.call(this,Qo({type:ys.TEXT,style:Qo({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",whiteSpace:"pre",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r)},i))||this}Jo(e,t);var n=e.prototype;return n.getComputedTextLength=function(){var t;return(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0},n.getLineBoundingRects=function(){var t;return(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]},e}(Gc);!function(t){t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE"}(Uc||(Uc={}));var fl=c.Syringe.defineToken(""),hl=function(){function t(t,e,n,r){var a=this;this.renderingContext=void 0,this.contextService=void 0,this.canvasConfig=void 0,this.displayObjectPool=void 0,this.rootTarget=void 0,this.emitter=new Xo.EventEmitter,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.pickHandler=void 0,this.tmpMatrix=i.create(),this.tmpVec3=o.create(),this.onPointerDown=function(){var t=Ko(Yo().mark((function t(e){var n,r;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Dc){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,a.createPointerEvent(e);case 4:n=t.sent,a.dispatchEvent(n,"pointerdown"),"touch"===n.pointerType?a.dispatchEvent(n,"touchstart"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(r=2===n.button,a.dispatchEvent(n,r?"rightdown":"mousedown")),a.trackingData(e.pointerId).pressTargetsByButton[e.button]=n.composedPath(),a.freeEvent(n);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerUp=function(){var t=Ko(Yo().mark((function t(e){var n,r,i,o,s,u,c,l,f,h,d;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Dc){t.next=2;break}return t.abrupt("return");case 2:return n=performance.now(),t.next=5,a.createPointerEvent(e);case 5:if(r=t.sent,a.dispatchEvent(r,"pointerup"),"touch"===r.pointerType?a.dispatchEvent(r,"touchend"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||(i=2===r.button,a.dispatchEvent(r,i?"rightup":"mouseup")),o=a.trackingData(e.pointerId),s=a.findMountedTarget(o.pressTargetsByButton[e.button]),u=s,s&&!r.composedPath().includes(s)){for(c=s;c&&!r.composedPath().includes(c);)r.currentTarget=c,a.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?a.notifyTarget(r,"touchendoutside"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||(l=2===r.button,a.notifyTarget(r,l?"rightupoutside":"mouseupoutside")),yc.isNode(c)&&(c=c.parentNode);delete o.pressTargetsByButton[e.button],u=c}u&&((h=a.clonePointerEvent(r,"click")).target=u,h.path=[],o.clicksByButton[e.button]||(o.clicksByButton[e.button]={clickCount:0,target:h.target,timeStamp:n}),(d=o.clicksByButton[e.button]).target===h.target&&n-d.timeStamp<200?++d.clickCount:d.clickCount=1,d.target=h.target,d.timeStamp=n,h.detail=d.clickCount,(null===(f=r.detail)||void 0===f?void 0:f.preventClick)||("mouse"===h.pointerType||"touch"===h.pointerType?a.dispatchEvent(h,"click"):a.dispatchEvent(h,"pointertap")),a.freeEvent(h)),a.freeEvent(r);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerMove=function(){var t=Ko(Yo().mark((function t(e){var n,r,i,o,s,u,c,l,f,h,d;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Dc){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,a.createPointerEvent(e);case 4:if(n=t.sent,r="mouse"===n.pointerType||"pen"===n.pointerType,i=a.trackingData(e.pointerId),o=a.findMountedTarget(i.overTargets),!i.overTargets||o===n.target){t.next=23;break}return s="mousemove"===e.type?"mouseout":"pointerout",t.next=12,a.createPointerEvent(e,s,o||void 0);case 12:if(u=t.sent,a.dispatchEvent(u,"pointerout"),r&&a.dispatchEvent(u,"mouseout"),n.composedPath().includes(o)){t.next=22;break}return t.next=18,a.createPointerEvent(e,"pointerleave",o||void 0);case 18:for((c=t.sent).eventPhase=c.AT_TARGET;c.target&&!n.composedPath().includes(c.target);)c.currentTarget=c.target,a.notifyTarget(c),r&&a.notifyTarget(c,"mouseleave"),yc.isNode(c.target)&&(c.target=c.target.parentNode);a.freeEvent(c);case 22:a.freeEvent(u);case 23:if(o===n.target){t.next=38;break}l="mousemove"===e.type?"mouseover":"pointerover",f=a.clonePointerEvent(n,l),a.dispatchEvent(f,"pointerover"),r&&a.dispatchEvent(f,"mouseover"),h=o&&yc.isNode(o)&&o.parentNode;case 29:if(!h||h===(yc.isNode(a.rootTarget)&&a.rootTarget.parentNode)){t.next=35;break}if(h!==n.target){t.next=32;break}return t.abrupt("break",35);case 32:h=h.parentNode,t.next=29;break;case 35:if(!h||h===(yc.isNode(a.rootTarget)&&a.rootTarget.parentNode)){for((d=a.clonePointerEvent(n,"pointerenter")).eventPhase=d.AT_TARGET;d.target&&d.target!==o&&d.target!==(yc.isNode(a.rootTarget)&&a.rootTarget.parentNode);)d.currentTarget=d.target,a.notifyTarget(d),r&&a.notifyTarget(d,"mouseenter"),yc.isNode(d.target)&&(d.target=d.target.parentNode);a.freeEvent(d)}a.freeEvent(f);case 38:a.dispatchEvent(n,"pointermove"),"touch"===n.pointerType&&a.dispatchEvent(n,"touchmove"),r&&(a.dispatchEvent(n,"mousemove"),a.cursor=a.getCursor(n.target)),i.overTargets=n.composedPath(),a.freeEvent(n);case 43:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerOut=function(){var t=Ko(Yo().mark((function t(e){var n,r,i,o,s;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Dc){t.next=2;break}return t.abrupt("return");case 2:if(!(n=a.trackingData(e.pointerId)).overTargets){t.next=19;break}return r="mouse"===e.pointerType||"pen"===e.pointerType,i=a.findMountedTarget(n.overTargets),t.next=8,a.createPointerEvent(e,"pointerout",i||void 0);case 8:return o=t.sent,a.dispatchEvent(o),r&&a.dispatchEvent(o,"mouseout"),t.next=13,a.createPointerEvent(e,"pointerleave",i||void 0);case 13:for((s=t.sent).eventPhase=s.AT_TARGET;s.target&&s.target!==(yc.isNode(a.rootTarget)&&a.rootTarget.parentNode);)s.currentTarget=s.target,a.notifyTarget(s),r&&a.notifyTarget(s,"mouseleave"),yc.isNode(s.target)&&(s.target=s.target.parentNode);n.overTargets=null,a.freeEvent(o),a.freeEvent(s);case 19:a.cursor=null;case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerOver=function(){var t=Ko(Yo().mark((function t(e){var n,r,i,o;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Dc){t.next=2;break}return t.abrupt("return");case 2:return n=a.trackingData(e.pointerId),t.next=5,a.createPointerEvent(e);case 5:for(r=t.sent,i="mouse"===r.pointerType||"pen"===r.pointerType,a.dispatchEvent(r,"pointerover"),i&&a.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(a.cursor=a.getCursor(r.target)),(o=a.clonePointerEvent(r,"pointerenter")).eventPhase=o.AT_TARGET;o.target&&o.target!==(yc.isNode(a.rootTarget)&&a.rootTarget.parentNode);)o.currentTarget=o.target,a.notifyTarget(o),i&&a.notifyTarget(o,"mouseenter"),yc.isNode(o.target)&&(o.target=o.target.parentNode);n.overTargets=r.composedPath(),a.freeEvent(r),a.freeEvent(o);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onPointerUpOutside=function(){var t=Ko(Yo().mark((function t(e){var n,r,i,o;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Dc){t.next=2;break}return t.abrupt("return");case 2:return n=a.trackingData(e.pointerId),r=a.findMountedTarget(n.pressTargetsByButton[e.button]),t.next=6,a.createPointerEvent(e);case 6:if(i=t.sent,r){for(o=r;o;)i.currentTarget=o,a.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||"mouse"!==i.pointerType&&"pen"!==i.pointerType||a.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),yc.isNode(o)&&(o=o.parentNode);delete n.pressTargetsByButton[e.button]}a.freeEvent(i);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.onWheel=function(){var t=Ko(Yo().mark((function t(e){var n;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e instanceof Lc){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,a.createWheelEvent(e);case 4:n=t.sent,a.dispatchEvent(n),a.freeEvent(n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.renderingContext=t,this.contextService=e,this.canvasConfig=n,this.displayObjectPool=r}var e=t.prototype;return e.init=function(){this.rootTarget=this.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)},e.client2Viewport=function(t){var e=this.contextService.getBoundingClientRect();return new du(t.x-((null==e?void 0:e.left)||0),t.y-((null==e?void 0:e.top)||0))},e.viewport2Client=function(t){var e=this.contextService.getBoundingClientRect();return new du(t.x+((null==e?void 0:e.left)||0),t.y+((null==e?void 0:e.top)||0))},e.viewport2Canvas=function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),a=this.canvasConfig,s=a.width,u=a.height,c=r.getPerspectiveInverse(),l=r.getWorldTransform(),f=i.multiply(this.tmpMatrix,l,c),h=o.set(this.tmpVec3,e/s*2-1,2*(1-n/u)-1,0);return o.transformMat4(h,h,f),new du(h[0],h[1])},e.canvas2Viewport=function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),a=i.multiply(this.tmpMatrix,n,r),s=o.set(this.tmpVec3,t.x,t.y,0);o.transformMat4(this.tmpVec3,this.tmpVec3,a);var u=this.canvasConfig,c=u.width,l=u.height;return new du((s[0]+1)/2*c,(1-(s[1]+1)/2)*l)},e.setPickHandler=function(t){this.pickHandler=t},e.addEventMapping=function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))},e.mapEvent=function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for "+t.type)}},e.dispatchEvent=function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.emitter.emit(e||t.type,t)},e.propagate=function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=i+1;o<n.length;o++)if(t.currentTarget=n[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}},e.propagationPath=function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)yc.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e},e.hitTest=function(){var t=Ko(Yo().mark((function t(e){var n,r,i,o,a;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.viewportX,r=e.viewportY,i=this.canvasConfig,o=i.width,a=i.height,!(n<0||r<0||n>o||r>a)){t.next=4;break}return t.abrupt("return",null);case 4:return t.next=6,this.pickHandler(e);case 6:if(t.t1=t.sent,t.t1){t.next=9;break}t.t1=this.rootTarget;case 9:if(t.t0=t.t1,t.t0){t.next=12;break}t.t0=null;case 12:return t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.isNativeEventFromCanvas=function(t){var e,n=this.contextService.getDomElement(),r=null===(e=t.nativeEvent)||void 0===e?void 0:e.target;if(r){if(r===n)return!0;if(n&&n.contains)return n.contains(r)}return!!t.nativeEvent.composedPath&&t.nativeEvent.composedPath().indexOf(n)>-1},e.getExistedHTML=function(t){if(t.nativeEvent.composedPath)for(var e,n=ra(this.displayObjectPool.getHTMLs());!(e=n()).done;){var r=e.value;if(t.nativeEvent.composedPath().indexOf(r)>-1)return r}return null},e.pickTarget=function(){var t=Ko(Yo().mark((function t(e){return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY}));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.createPointerEvent=function(){var t=Ko(Yo().mark((function t(e,n,r){var i,o;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.allocateEvent(Dc),this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,o=this.getExistedHTML(i),null==r){t.next=11;break}t.t0=r,t.next=20;break;case 11:if(t.t1=o,t.t1){t.next=19;break}if(t.t2=this.isNativeEventFromCanvas(i),!t.t2){t.next=18;break}return t.next=17,this.pickTarget(i);case 17:t.t2=t.sent;case 18:t.t1=t.t2;case 19:t.t0=t.t1;case 20:return i.target=t.t0,"string"==typeof n&&(i.type=n),t.abrupt("return",i);case 23:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.createWheelEvent=function(){var t=Ko(Yo().mark((function t(e){var n,r;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.allocateEvent(Lc),this.copyWheelData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,r=this.getExistedHTML(n),t.t0=r,t.t0){t.next=15;break}if(t.t1=this.isNativeEventFromCanvas(n),!t.t1){t.next=14;break}return t.next=13,this.pickTarget(n);case 13:t.t1=t.sent;case 14:t.t0=t.t1;case 15:return n.target=t.t0,t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.trackingData=function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]},e.cloneWheelEvent=function(t){var e=this.allocateEvent(Lc);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=e.type,e},e.clonePointerEvent=function(t,e){var n=this.allocateEvent(Dc);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n},e.copyPointerData=function(t,e){t instanceof Dc&&e instanceof Dc&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)},e.copyMouseData=function(t,e){t instanceof wc&&e instanceof wc&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset))},e.copyWheelData=function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ},e.copyData=function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)},e.allocateEvent=function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e},e.freeEvent=function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)},e.notifyTarget=function(t,e){var n;e=null!==(n=e)&&void 0!==n?n:t.type;var r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?e+"capture":e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)},e.notifyListeners=function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r)if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t)},e.findMountedTarget=function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(!(r===this.rootTarget||yc.isNode(r)&&r.parentNode===e))break;e=t[n]}return e},e.getCursor=function(t){for(var e=t;e;){var n=Ic.isElement(e)&&e.getAttribute("cursor");if(n)return n;e=yc.isNode(e)&&e.parentNode}},t}();hl=_([Object(c.singleton)(),E(0,Object(c.inject)(fl)),E(1,Object(c.inject)(dc)),E(2,Object(c.inject)(bs)),E(3,Object(c.inject)(kc))],hl);var dl,pl,vl,gl=c.Syringe.defineToken(""),ml=c.Syringe.defineToken("",{multiple:!1});!function(t){t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING"}(dl||(dl={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC"}(pl||(pl={})),function(t){t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE"}(vl||(vl={}));var yl="updated",_l=function(){function t(){this.canvas=void 0,this.eventEmitter=new Xo.EventEmitter,this.matrix=i.create(),this.right=o.fromValues(1,0,0),this.up=o.fromValues(0,1,0),this.forward=o.fromValues(0,0,1),this.position=o.fromValues(0,0,1),this.focalPoint=o.fromValues(0,0,0),this.distanceVector=o.fromValues(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.projectionMatrix=i.create(),this.projectionMatrixInverse=i.create(),this.jitteredProjectionMatrix=void 0,this.view=void 0,this.enableUpdate=!0,this.type=dl.EXPLORING,this.trackingMode=pl.DEFAULT,this.projectionMode=vl.PERSPECTIVE,this.frustum=new hu,this.orthoMatrix=i.create()}var e=t.prototype;return e.isOrtho=function(){return this.projectionMode===vl.ORTHOGRAPHIC},e.getProjectionMode=function(){return this.projectionMode},e.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},e.getPerspectiveInverse=function(){return this.projectionMatrixInverse},e.getFrustum=function(){return this.frustum},e.getPosition=function(){return this.position},e.getFocalPoint=function(){return this.focalPoint},e.getDollyingStep=function(){return this.dollyingStep},e.getNear=function(){return this.near},e.getFar=function(){return this.far},e.getZoom=function(){return this.zoom},e.getOrthoMatrix=function(){return this.orthoMatrix},e.getView=function(){return this.view},e.setEnableUpdate=function(t){this.enableUpdate=t},e.setType=function(t,e){return this.type=t,this.type===dl.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===dl.TRACKING&&void 0!==e&&this.setTrackingMode(e),this},e.setProjectionMode=function(t){return this.projectionMode=t,this},e.setTrackingMode=function(t){if(this.type!==dl.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this},e.setWorldRotation=function(t){return this.rotateWorld=t,this._getAngles(),this},e.getViewTransform=function(){return i.invert(i.create(),this.matrix)},e.getWorldTransform=function(){return this.matrix},e.jitterProjectionMatrix=function(t,e){var n=i.fromTranslation(i.create(),[t,e,0]);this.jitteredProjectionMatrix=i.multiply(i.create(),n,this.projectionMatrix)},e.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},e.setMatrix=function(t){return this.matrix=t,this._update(),this},e.setFov=function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this},e.setAspect=function(t){return this.setPerspective(this.near,this.far,this.fov,t),this},e.setNear=function(t){return this.projectionMode===vl.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this},e.setFar=function(t){return this.projectionMode===vl.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this},e.setViewOffset=function(t,e,n,r,i,o){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===vl.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.clearViewOffset=function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===vl.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.setZoom=function(t){return this.zoom=t,this.projectionMode===vl.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===vl.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},e.setPerspective=function(t,e,n,r){var a;this.projectionMode=vl.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var s=this.near*Math.tan(ps(.5*this.fov))/this.zoom,u=2*s,c=this.aspect*u,l=-.5*c;if(null===(a=this.view)||void 0===a?void 0:a.enabled){var f=this.view.fullWidth,h=this.view.fullHeight;l+=this.view.offsetX*c/f,s-=this.view.offsetY*u/h,c*=this.view.width/f,u*=this.view.height/h}return function(t,e,n,r,i,o,a){var s=2*o/(n-e),u=2*o/(r-i),c=(n+e)/(n-e),l=(r+i)/(r-i),f=-(a+o)/(a-o),h=-2*a*o/(a-o);t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=f,t[11]=-1,t[12]=0,t[13]=0,t[14]=h,t[15]=0}(this.projectionMatrix,l,l+c,s,s-u,t,this.far),i.scale(this.projectionMatrix,this.projectionMatrix,o.fromValues(1,-1,1)),i.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},e.setOrthographic=function(t,e,n,r,a,s){var u;this.projectionMode=vl.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=a,this.far=s;var c=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),f=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,d=f-c,p=f+c,v=h+l,g=h-l;if(null===(u=this.view)||void 0===u?void 0:u.enabled){var m=(this.rright-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;p=(d+=m*this.view.offsetX)+m*this.view.width,g=(v-=y*this.view.offsetY)-y*this.view.height}return i.ortho(this.projectionMatrix,d,p,g,v,a,s),i.scale(this.projectionMatrix,this.projectionMatrix,o.fromValues(1,-1,1)),i.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},e.setPosition=function(t,e,n){void 0===e&&(e=this.position[1]),void 0===n&&(n=this.position[2]);var r=ds(t,e,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},e.setFocalPoint=function(t,e,n){void 0===e&&(e=this.focalPoint[1]),void 0===n&&(n=this.focalPoint[2]);var r=o.fromValues(0,1,0);if(this.focalPoint=ds(t,e,n),this.trackingMode===pl.CINEMATIC){var a=o.subtract(o.create(),this.focalPoint,this.position);t=a[0],e=a[1],n=a[2];var s=o.length(a),u=vs(Math.asin(e/s)),c=90+vs(Math.atan2(n,t)),l=i.create();i.rotateY(l,l,ps(c)),i.rotateX(l,l,ps(u)),r=o.transformMat4(o.create(),[0,1,0],l)}return i.invert(this.matrix,i.lookAt(i.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},e.getDistance=function(){return this.distance},e.getDistanceVector=function(){return this.distanceVector},e.setDistance=function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=o.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this},e.setMaxDistance=function(t){return this.maxDistance=t,this},e.setMinDistance=function(t){return this.minDistance=t,this},e.setAzimuth=function(t){return this.azimuth=hs(t),this.computeMatrix(),this._getAxes(),this.type===dl.ORBITING||this.type===dl.EXPLORING?this._getPosition():this.type===dl.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.getAzimuth=function(){return this.azimuth},e.setElevation=function(t){return this.elevation=hs(t),this.computeMatrix(),this._getAxes(),this.type===dl.ORBITING||this.type===dl.EXPLORING?this._getPosition():this.type===dl.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.getElevation=function(){return this.elevation},e.setRoll=function(t){return this.roll=hs(t),this.computeMatrix(),this._getAxes(),this.type===dl.ORBITING||this.type===dl.EXPLORING?this._getPosition():this.type===dl.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},e.getRoll=function(){return this.roll},e._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},e.computeMatrix=function(){var t=s.setAxisAngle(s.create(),[0,0,1],ps(this.roll));i.identity(this.matrix);var e=s.setAxisAngle(s.create(),[1,0,0],ps((this.rotateWorld&&this.type!==dl.TRACKING||this.type===dl.TRACKING?1:-1)*this.elevation)),n=s.setAxisAngle(s.create(),[0,1,0],ps((this.rotateWorld&&this.type!==dl.TRACKING||this.type===dl.TRACKING?1:-1)*this.azimuth)),r=s.multiply(s.create(),n,e);r=s.multiply(s.create(),r,t);var o=i.fromQuat(i.create(),r);this.type===dl.ORBITING||this.type===dl.EXPLORING?(i.translate(this.matrix,this.matrix,this.focalPoint),i.multiply(this.matrix,this.matrix,o),i.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===dl.TRACKING&&(i.translate(this.matrix,this.matrix,this.position),i.multiply(this.matrix,this.matrix,o))},e._setPosition=function(t,e,n){this.position=ds(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()},e._getAxes=function(){o.copy(this.right,ds(a.transformMat4(a.create(),[1,0,0,0],this.matrix))),o.copy(this.up,ds(a.transformMat4(a.create(),[0,1,0,0],this.matrix))),o.copy(this.forward,ds(a.transformMat4(a.create(),[0,0,1,0],this.matrix))),o.normalize(this.right,this.right),o.normalize(this.up,this.up),o.normalize(this.forward,this.forward)},e._getAngles=function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=o.length(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===dl.TRACKING||this.rotateWorld?(this.elevation=vs(Math.asin(e/r)),this.azimuth=vs(Math.atan2(-t,-n))):(this.elevation=-vs(Math.asin(e/r)),this.azimuth=-vs(Math.atan2(-t,-n)))},e._getPosition=function(){o.copy(this.position,ds(a.transformMat4(a.create(),[0,0,0,1],this.matrix))),this._getDistance()},e._getFocalPoint=function(){o.transformMat3(this.distanceVector,[0,0,-this.distance],r.fromMat4(r.create(),this.matrix)),o.add(this.focalPoint,this.position,this.distanceVector),this._getDistance()},e._getDistance=function(){this.distanceVector=o.subtract(o.create(),this.focalPoint,this.position),this.distance=o.length(this.distanceVector),this.dollyingStep=this.distance/100},e._getOrthoMatrix=function(){if(this.projectionMode===vl.ORTHOGRAPHIC){var t=this.position,e=s.setAxisAngle(s.create(),[0,0,1],-this.roll*Math.PI/180);i.fromRotationTranslationScaleOrigin(this.orthoMatrix,e,o.fromValues((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),o.fromValues(this.zoom,this.zoom,1),t)}},e.triggerUpdate=function(){if(this.enableUpdate){var t=this.getViewTransform(),e=i.multiply(i.create(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(yl)}},e.rotate=function(t,e,n){throw new Error("Method not implemented.")},e.pan=function(t,e){throw new Error("Method not implemented.")},e.dolly=function(t){throw new Error("Method not implemented.")},e.createLandmark=function(t,e){throw new Error("Method not implemented.")},e.gotoLandmark=function(t,e){throw new Error("Method not implemented.")},t}();_l=_([Object(c.injectable)({token:ml})],_l);var El=c.Syringe.defineToken(""),Tl=function(){function t(t,e,n,r,i,o){this.renderingPluginProvider=void 0,this.canvasConfig=void 0,this.renderingContext=void 0,this.sceneGraphService=void 0,this.styleValueRegistry=void 0,this.camera=void 0,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.renderOrderChangedEvent=new gc(Tc.RENDER_ORDER_CHANGED),this.hooks={init:new Fs,dirtycheck:new Zs(["object"]),cull:new Zs(["object","camera"]),beginFrame:new Hs([]),beforeRender:new Hs(["objectToRender"]),render:new Hs(["objectToRender"]),afterRender:new Hs(["objectToRender"]),endFrame:new Hs([]),destroy:new Hs([]),pick:new Gs(["result"]),pointerDown:new Hs(["event"]),pointerUp:new Hs(["event"]),pointerMove:new Hs(["event"]),pointerOut:new Hs(["event"]),pointerOver:new Hs(["event"]),pointerWheel:new Hs(["event"]),pointerCancel:new Hs(["event"])},this.renderingPluginProvider=t,this.canvasConfig=e,this.renderingContext=n,this.sceneGraphService=r,this.styleValueRegistry=i,this.camera=o}var e=t.prototype;return e.init=function(){var t=Ko(Yo().mark((function t(){var e=this;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.renderingPluginProvider.getContributions({cache:!1}).forEach((function(t){t.apply(e)})),t.next=3,this.hooks.init.promise();case 3:this.inited=!0;case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getStats=function(){return this.stats},e.disableDirtyRectangleRendering=function(){return!this.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering||this.renderingContext.renderReasons.has(Uc.CAMERA_CHANGED)},e.render=function(t){var e=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.sceneGraphService.syncHierarchy(this.renderingContext.root),this.sceneGraphService.triggerPendingEvents(),this.renderingContext.renderReasons.size&&this.inited&&(this.renderDisplayObject(this.renderingContext.root,t),this.hooks.beginFrame.call(),this.renderingContext.renderListCurrentFrame.forEach((function(t){e.hooks.beforeRender.call(t),e.hooks.render.call(t),e.hooks.afterRender.call(t)})),this.hooks.endFrame.call(),this.renderingContext.renderListCurrentFrame=[],this.renderingContext.renderReasons.clear())},e.renderDisplayObject=function(t,e){var n=this,r=e.renderer.getConfig(),i=r.enableDirtyCheck,o=r.enableCulling;this.styleValueRegistry.recalc(t);var a=i?this.hooks.dirtycheck.call(t):t;if(a){var s=o?this.hooks.cull.call(a,this.camera):a;s&&(this.stats.rendered++,this.renderingContext.renderListCurrentFrame.push(s))}t.renderable.dirty=!1,t.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var u=t.sortable,c=!1;u.dirty&&(u.sorted=t.childNodes.slice().sort(ss),c=!0,u.dirty=!1),(u.sorted||t.childNodes).forEach((function(t){n.renderDisplayObject(t,e)})),c&&t.forEach((function(t){n.renderOrderChangedEvent.detail={renderOrder:t.sortable.renderOrder},t.dispatchEvent(n.renderOrderChangedEvent)}))},e.destroy=function(){this.inited=!1,this.hooks.destroy.call()},e.dirtify=function(){this.renderingContext.renderReasons.add(Uc.DISPLAY_OBJECT_CHANGED)},t}();Tl=_([Object(c.singleton)(),E(0,Object(c.contrib)(El)),E(1,Object(c.inject)(bs)),E(2,Object(c.inject)(fl)),E(3,Object(c.inject)(Ac)),E(4,Object(c.inject)(Ha)),E(5,Object(c.inject)(gl))],Tl);var Rl=c.Syringe.defineToken(""),Al=c.Syringe.defineToken("",{multiple:!1}),Sl=/\[\s*(.*)=(.*)\s*\]/,bl=function(){function t(){}var e=t.prototype;return e.selectOne=function(t,e){var n=this;if(t.startsWith("."))return e.find((function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.find((function(e){return e.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,o=r.value;return i?e.find((function(t){return e!==t&&("name"===i?t.name===o:n.attributeToString(t,i)===o)})):null}return e.find((function(n){return e!==n&&n.nodeName===t}))},e.selectAll=function(t,e){var n=this;if(t.startsWith("."))return e.findAll((function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1}));if(t.startsWith("#"))return e.findAll((function(r){return e!==r&&r.id===n.getIdOrClassname(t)}));if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,o=r.value;return i?e.findAll((function(t){return e!==t&&("name"===i?t.name===o:n.attributeToString(t,i)===o)})):[]}return e.findAll((function(n){return e!==n&&n.nodeName===t}))},e.is=function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i}return e.nodeName===t},e.getIdOrClassname=function(t){return t.substring(1)},e.getAttribute=function(t){var e=t.match(Sl),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r}},e.attributeToString=function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return Q(n)?"":n.toString?n.toString():""},t}();bl=_([Object(c.singleton)({token:Al})],bl);var xl=function(){function t(t){var e,n,r,a,u,c,l,f,h=this;this.sceneGraphSelectorFactory=void 0,this.pendingEvents=[],this.boundsChangedEvent=new gc(Tc.BOUNDS_CHANGED),this.rotate=(e=s.create(),function(t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof n&&(n=o.fromValues(n,r,i));var a=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var u=s.create();s.fromEuler(u,n[0],n[1],n[2]);var c=h.getRotation(t),l=h.getRotation(t.parentNode);s.copy(e,l),s.invert(e,e),s.multiply(u,e,u),s.multiply(a.localRotation,u,c),s.normalize(a.localRotation,a.localRotation),h.dirtifyLocal(t,a)}else h.rotateLocal(t,n)}),this.rotateLocal=(n=s.create(),function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof e&&(e=o.fromValues(e,r,i));var a=t.transformable;s.fromEuler(n,e[0],e[1],e[2]),s.mul(a.localRotation,a.localRotation,n),h.dirtifyLocal(t,a)}),this.setEulerAngles=(r=s.create(),function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),"number"==typeof e&&(e=o.fromValues(e,n,i));var a=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){s.fromEuler(a.localRotation,e[0],e[1],e[2]);var u=h.getRotation(t.parentNode);s.copy(r,s.invert(s.create(),u)),s.mul(a.localRotation,a.localRotation,r),h.dirtifyLocal(t,a)}else h.setLocalEulerAngles(t,e)}),this.translateLocal=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=o.fromValues(e,n,r));var i=t.transformable;o.equals(e,o.create())||(o.transformQuat(e,e,i.localRotation),o.add(i.localPosition,i.localPosition,e),h.dirtifyLocal(t,i))},this.setPosition=(a=i.create(),u=o.create(),function(t,e){var n=t.transformable;if(u[0]=e[0],u[1]=e[1],u[2]=e[2]||0,!o.equals(h.getPosition(t),u)){if(o.copy(n.position,u),null!==t.parentNode&&t.parentNode.transformable){var r=t.parentNode.transformable;i.copy(a,r.worldTransform),i.invert(a,a),o.transformMat4(n.localPosition,u,a)}else o.copy(n.localPosition,u);h.dirtifyLocal(t,n)}}),this.setLocalPosition=function(){var t=o.create();return function(e,n){var r=e.transformable;t[0]=n[0],t[1]=n[1],t[2]=n[2]||0,o.equals(r.localPosition,t)||(o.copy(r.localPosition,t),h.dirtifyLocal(e,r))}}(),this.translate=(c=o.create(),l=o.create(),f=o.create(),function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=o.set(l,e,n,r)),o.equals(e,c)||(o.add(f,h.getPosition(t),e),h.setPosition(t,f))}),this.setRotation=function(){var t=s.create();return function(e,n,r,i,o){var a=e.transformable;if("number"==typeof n&&(n=s.fromValues(n,r,i,o)),null!==e.parentNode&&e.parentNode.transformable){var u=h.getRotation(e.parentNode);s.copy(t,u),s.invert(t,t),s.multiply(a.localRotation,t,n),s.normalize(a.localRotation,a.localRotation),h.dirtifyLocal(e,a)}else h.setLocalRotation(e,n)}},this.calcLocalTransform=function(){var t=i.create(),e=o.create(),n=s.fromValues(0,0,0,1);return function(r){if(i.fromRotationTranslationScaleOrigin(r.localTransform,r.localRotation,r.localPosition,o.fromValues(1,1,1),r.origin),0!==r.localSkew[0]||0!==r.localSkew[1]){var a=i.identity(t);a[4]=Math.tan(r.localSkew[0]),a[1]=Math.tan(r.localSkew[1]),i.multiply(r.localTransform,r.localTransform,a)}var s=i.fromRotationTranslationScaleOrigin(t,n,e,r.localScale,r.origin);i.multiply(r.localTransform,r.localTransform,s)}}(),this.sceneGraphSelectorFactory=t}var e=t.prototype;return e.matches=function(t,e){return this.sceneGraphSelectorFactory().is(t,e)},e.querySelector=function(t,e){return this.sceneGraphSelectorFactory().selectOne(t,e)},e.querySelectorAll=function(t,e){return this.sceneGraphSelectorFactory().selectAll(t,e)},e.attach=function(t,e,n){var r,i;t.parentNode&&this.detach(t),t.parentNode=e,Q(n)?t.parentNode.childNodes.push(t):t.parentNode.childNodes.splice(n,0,t);var o=e.sortable;((null==o||null===(r=o.sorted)||void 0===r?void 0:r.length)||(null===(i=t.style)||void 0===i?void 0:i.zIndex))&&(o.dirty=!0);var a=t.transformable;a&&this.dirtifyWorld(t,a),a.frozen&&this.unfreezeParentToRoot(t)},e.detach=function(t){if(t.parentNode){var e,n,r=t.transformable,i=t.parentNode.sortable;((null==i||null===(e=i.sorted)||void 0===e?void 0:e.length)||(null===(n=t.style)||void 0===n?void 0:n.zIndex))&&(i.dirty=!0);var o=t.parentNode.childNodes.indexOf(t);o>-1&&t.parentNode.childNodes.splice(o,1),r&&this.dirtifyWorld(t,r),t.parentNode=null}},e.getOrigin=function(t){return t.transformable.origin},e.setOrigin=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=o.fromValues(e,n,r));var i=t.transformable;if(!o.equals(e,i.origin)){var a=i.origin;a[0]=e[0],a[1]=e[1],a[2]=e[2]||0,this.dirtifyLocal(t,i)}},e.setLocalEulerAngles=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=o.fromValues(e,n,r));var i=t.transformable;s.fromEuler(i.localRotation,e[0],e[1],e[2]),this.dirtifyLocal(t,i)},e.scaleLocal=function(t,e){var n=t.transformable;o.multiply(n.localScale,n.localScale,o.fromValues(e[0],e[1],e[2]||1)),this.dirtifyLocal(t,n)},e.setLocalScale=function(t,e){var n=t.transformable,r=o.fromValues(e[0],e[1],e[2]||n.localScale[2]);o.equals(r,n.localScale)||(o.copy(n.localScale,r),this.dirtifyLocal(t,n))},e.setLocalRotation=function(t,e,n,r,i){"number"==typeof e&&(e=s.fromValues(e,n,r,i));var o=t.transformable;s.copy(o.localRotation,e),this.dirtifyLocal(t,o)},e.setLocalSkew=function(t,e,n){"number"==typeof e&&(e=u.fromValues(e,n));var r=t.transformable;u.copy(r.localSkew,e),this.dirtifyLocal(t,r)},e.dirtifyLocal=function(t,e){e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))},e.dirtifyWorld=function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),this.dirtifyToRoot(t,!0)},e.triggerPendingEvents=function(){var t=this,e=new Set,n=function(n,r){e.has(n.entity)||(t.boundsChangedEvent.detail=r,n.dispatchEvent(t.boundsChangedEvent),e.add(n.entity))};this.pendingEvents.forEach((function(t){var e=t[0],r=t[1];r.affectChildren?e.forEach((function(t){n(t,r)})):n(e,r)})),this.pendingEvents=[]},e.dirtifyToRoot=function(t,e){void 0===e&&(e=!1);var n=t;for(n.renderable&&(n.renderable.dirty=!0);n;){var r=n.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0),n=n.parentNode}this.pendingEvents.push([t,{affectChildren:e}])},e.getPosition=function(t){var e=t.transformable;return i.getTranslation(e.position,this.getWorldTransform(t,e))},e.getRotation=function(t){var e=t.transformable;return i.getRotation(e.rotation,this.getWorldTransform(t,e))},e.getScale=function(t){var e=t.transformable;return i.getScaling(e.scaling,this.getWorldTransform(t,e))},e.getWorldTransform=function(t,e){return void 0===e&&(e=t.transformable),e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,e),e.worldTransform):e.worldTransform},e.getLocalPosition=function(t){return t.transformable.localPosition},e.getLocalRotation=function(t){return t.transformable.localRotation},e.getLocalScale=function(t){return t.transformable.localScale},e.getLocalSkew=function(t){return t.transformable.localSkew},e.getLocalTransform=function(t){var e=t.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform},e.setLocalTransform=function(t,e){var n=i.getTranslation(o.create(),e),r=i.getRotation(s.create(),e),a=i.getScaling(o.create(),e);this.setLocalScale(t,a),this.setLocalPosition(t,n),this.setLocalRotation(t,r)},e.resetLocalTransform=function(t){this.setLocalScale(t,[1,1,1]),this.setLocalPosition(t,[0,0,0]),this.setLocalEulerAngles(t,[0,0,0]),this.setLocalSkew(t,[0,0])},e.getTransformedGeometryBounds=function(t,e,n){void 0===e&&(e=!1);var r=this.getGeometryBounds(t,e);if(lu.isEmpty(r))return null;var i=n||new lu;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i},e.getGeometryBounds=function(t,e){void 0===e&&(e=!1);var n=t.geometry;return(e?n.renderBounds:n.contentBounds||null)||new lu},e.getBounds=function(t,e){var n=this;void 0===e&&(e=!1);var r=t.renderable;if(!r.boundsDirty&&!e&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&e&&r.renderBounds)return r.renderBounds;var i=e?r.renderBounds:r.bounds,o=this.getTransformedGeometryBounds(t,e,i);t.childNodes.forEach((function(t){var r=n.getBounds(t,e);r&&(o?o.add(r):(o=i||new lu).update(r.center,r.halfExtents))}));var a=function(t){var e=t;do{var n;if(null===(n=e.style)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}(t);if(a){var s,u=this.getTransformedGeometryBounds(a.style.clipPath,!0);u&&(s=new lu).setFromTransformedAABB(u,this.getWorldTransform(a)),o?s&&(o=s.intersection(o)):o=s}return o||(o=new lu),o&&(e?r.renderBounds=o:r.bounds=o),e?r.renderBoundsDirty=!1:r.boundsDirty=!1,o},e.getLocalBounds=function(t){if(t.parentNode){var e=i.create();t.parentNode.transformable&&(e=i.invert(i.create(),this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!lu.isEmpty(n)){var r=new lu;return r.setFromTransformedAABB(n,e),r}}return this.getBounds(t)},e.getBoundingClientRect=function(t){var e,n,r,i=this.getGeometryBounds(t);lu.isEmpty(i)||(r=new lu).setFromTransformedAABB(i,this.getWorldTransform(t));var o=null===(e=t.ownerDocument)||void 0===e||null===(n=e.defaultView)||void 0===n?void 0:n.getContextService().getBoundingClientRect();if(r){var a=r.getMin(),s=a[0],u=a[1],c=r.getMax(),l=c[0],f=c[1];return new pu(s+((null==o?void 0:o.left)||0),u+((null==o?void 0:o.top)||0),l-s,f-u)}return new pu((null==o?void 0:o.left)||0,(null==o?void 0:o.top)||0,0,0)},e.dirtifyWorldInternal=function(t,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach((function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}));var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0)}},e.syncHierarchy=function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r])}},e.sync=function(t,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=t.parentNode,r=n&&n.transformable;null!==n&&r?i.multiply(e.worldTransform,r.worldTransform,e.localTransform):i.copy(e.worldTransform,e.localTransform),e.dirtyFlag=!1}},e.unfreezeParentToRoot=function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}},t}();xl=_([Object(c.singleton)({token:Ac}),E(0,Object(c.inject)(Rl))],xl);var Ml=function(){function t(t){this.sceneGraphService=void 0,this.sceneGraphService=t}return t.prototype.calculator=function(t,e,n,r){if(n instanceof da&&(n=null),e&&e!==n&&e.parsedStyle.clipPathTargets){var i=e.parsedStyle.clipPathTargets.indexOf(r);e.parsedStyle.clipPathTargets.splice(i,1)}return n&&(n.parsedStyle.clipPathTargets||(n.parsedStyle.clipPathTargets=[]),n.parsedStyle.clipPathTargets.push(r)),this.sceneGraphService.dirtifyToRoot(r),n},t}();Ml=_([Object(c.singleton)({token:{token:Ka,named:Ba.CLIP_PATH}}),E(0,Object(c.inject)(Ac))],Ml);var Ol=function(){function t(){this.parser=su,this.mixer=uu}return t.prototype.calculator=function(t,e,n,r){return n instanceof da?"none"===n.value?ts:es:n},t}();Ol=_([Object(c.singleton)({token:[{token:Ka,named:Ba.PAINT},{token:Ka,named:Ba.COLOR}]})],Ol);var Cl=function(){function t(){this.parser=Su}return t.prototype.calculator=function(t,e,n){return n instanceof da?[]:n},t}();function Nl(t){var e=t.parsedStyle.fontSize;return Q(e)?null:e}Cl=_([Object(c.singleton)({token:{token:Ka,named:Ba.FILTER}})],Cl);var Pl=function(){function t(){this.parser=mu,this.mixer=Mu}return t.prototype.calculator=function(t,e,n,r,i){if(!Pa.isRelativeUnit(n.unit))return n.value;if(n.unit===Uo.kPercentage)return 0;if(n.unit===Uo.kEms){if(r.parentNode){var o=Nl(r.parentNode);if(o)return o*=n.value;i.addUnresolveProperty(r,t)}else i.addUnresolveProperty(r,t);return 0}if(n.unit===Uo.kRems){var a;if(null==r||null===(a=r.ownerDocument)||void 0===a?void 0:a.documentElement){var s=Nl(r.ownerDocument.documentElement);if(s)return s*=n.value;i.addUnresolveProperty(r,t)}else i.addUnresolveProperty(r,t);return 0}},t}();Pl=_([Object(c.singleton)({token:[{token:Ka,named:Ba.LENGTH_PERCENTAGE},{token:Ka,named:Ba.LENGTH}]})],Pl);var Il=function(){function t(){this.mixer=Cu}var e=t.prototype;return e.parser=function(t){var e=Tu(m(t)?[t]:t);return 1===e.length?[e[0],e[0]]:[e[0],e[1]]},e.calculator=function(t,e,n){return n.map((function(t){return t.value}))},t}();Il=_([Object(c.singleton)({token:{token:Ka,named:Ba.LENGTH_PERCENTAGE_12}})],Il);var wl=function(){function t(){this.mixer=Cu}var e=t.prototype;return e.parser=function(t){var e=Tu(m(t)?[t]:t);return 1===e.length?[e[0],e[0],e[0],e[0]]:2===e.length?[e[0],e[1],e[0],e[1]]:3===e.length?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]},e.calculator=function(t,e,n){return n.map((function(t){return t.value}))},t}();wl=_([Object(c.singleton)({token:{token:Ka,named:Ba.LENGTH_PERCENTAGE_14}})],wl);var Dl=function(t){function e(){return t.apply(this,arguments)||this}return Jo(e,t),e.prototype.postProcessor=function(t){var e,n,r;switch(t.nodeName){case ys.CIRCLE:case ys.ELLIPSE:var i=t.parsedStyle,o=i.cx,a=i.cy;Q(o)||(e=o),Q(a)||(n=a);break;case ys.LINE:var s=t.parsedStyle,u=s.x1,c=s.x2,l=s.y1,f=s.y2;e=Math.min(u,c),n=Math.min(l,f),r=0;break;case ys.RECT:case ys.IMAGE:case ys.GROUP:case ys.HTML:case ys.TEXT:case ys.MESH:Q(t.parsedStyle.x)||(e=t.parsedStyle.x),Q(t.parsedStyle.y)||(n=t.parsedStyle.y)}if(t.nodeName!==ys.PATH&&t.nodeName!==ys.POLYLINE&&t.nodeName!==ys.POLYGON&&(t.parsedStyle.defX=e||0,t.parsedStyle.defY=n||0),!Q(e)||!Q(n)||!Q(r)){var h=t.getLocalPosition(),d=h[0],p=h[1],v=h[2];t.setLocalPosition(Q(e)?d:e,Q(n)?p:n,Q(r)?v:r)}},e}(Pl);Dl=_([Object(c.singleton)({token:{token:Ka,named:Ba.COORDINATE}})],Dl);var Ll=function(){function t(){}return t.prototype.calculator=function(t,e,n,r){var i;n instanceof da&&(n=null);var o=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return o&&(o.style.isMarker=!0),o},t}();Ll=_([Object(c.singleton)({token:{token:Ka,named:Ba.MARKER}})],Ll);var Bl=function(){function t(){this.mixer=Mu,this.parser=xu}return t.prototype.calculator=function(t,e,n){return n.value},t}();Bl=_([Object(c.singleton)({token:{token:Ka,named:Ba.NUMBER}})],Bl);var Fl=function(){function t(){this.parser=xu,this.mixer=Ou(0,1)}var e=t.prototype;return e.calculator=function(t,e,n){return n.value},e.postProcessor=function(t){if(t.attributes.offsetPath){var e=t.attributes.offsetPath.nodeName;if(e===ys.LINE||e===ys.PATH||e===ys.POLYLINE){var n=t.attributes.offsetPath.getPoint(t.parsedStyle.offsetDistance);n&&t.setLocalPosition(n.x,n.y)}}},t}();Fl=_([Object(c.singleton)({token:{token:Ka,named:Ba.OFFSET_DISTANCE}})],Fl);var kl=function(){function t(){}return t.prototype.calculator=function(t,e,n,r){if(e&&e!==n&&e.style.offsetPathTargets){var i=e.style.offsetPathTargets.indexOf(r);e.style.offsetPathTargets.splice(i,1)}return n&&(n.style.offsetPathTargets||(n.style.offsetPathTargets=[]),n.style.offsetPathTargets.push(r)),n},t}();kl=_([Object(c.singleton)({token:{token:Ka,named:Ba.OFFSET_PATH}})],kl);var Ul=function(){function t(){this.parser=xu,this.mixer=Ou(0,1)}return t.prototype.calculator=function(t,e,n){return n.value},t}();Ul=_([Object(c.singleton)({token:{token:Ka,named:Ba.OPACITY_VALUE}})],Ul);var Gl=function(){function t(){this.parser=Iu,this.mixer=wu}var e=t.prototype;return e.calculator=function(t,e,n){return n instanceof da&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:[],totalLength:0,zCommandIndexes:[],rect:new pu(0,0,0,0)}:n},e.postProcessor=function(t){if(t.nodeName===ys.PATH){var e=t.parsedStyle,n=e.defX,r=void 0===n?0:n,i=e.defY,o=void 0===i?0:i;t.setLocalPosition(r,o)}},t}();Gl=_([Object(c.singleton)({token:{token:Ka,named:Ba.PATH}})],Gl);var Vl=function(){function t(){this.parser=Du}return t.prototype.postProcessor=function(t){if(t.nodeName===ys.POLYGON||t.nodeName===ys.POLYLINE){var e=t.parsedStyle,n=e.defX,r=e.defY;t.setLocalPosition(n,r)}},t}();Vl=_([Object(c.singleton)({token:{token:Ka,named:Ba.LIST_OF_POINTS}})],Vl);var jl=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).mixer=Ou(0,1/0),e}return Jo(e,t),e}(Pl);jl=_([Object(c.singleton)({token:{token:Ka,named:Ba.SHADOW_BLUR}})],jl);var Wl=function(){function t(){}var e=t.prototype;return e.calculator=function(t,e,n,r){return n instanceof da?"unset"===n.value?"":n.value:n},e.postProcessor=function(t){t.nodeValue=""+t.parsedStyle.text||""},t}();Wl=_([Object(c.singleton)({token:{token:Ka,named:Ba.TEXT}})],Wl);var Xl=function(){function t(){}return t.prototype.calculator=function(t,e,n,r){var i=r.getAttribute("text");if(i){var o=i;"capitalize"===n.value?o=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?o=i.toLowerCase():"uppercase"===n.value&&(o=i.toUpperCase()),r.parsedStyle.text=o}return n.value},t}();Xl=_([Object(c.singleton)({token:{token:Ka,named:Ba.TEXT_TRANSFORM}})],Xl);var Hl=function(){function t(){this.tmpMat4=i.create(),this.parser=Uu,this.mixer=Ku}var e=t.prototype;return e.calculator=function(t,e,n,r){return n instanceof da?[]:n},e.postProcessor=function(t){var e=this,n=t.parsedStyle,r=n.transform,o=n.defX,a=n.defY;r&&r.length&&(t.resetLocalTransform(),t.setLocalPosition(o,a),r.forEach((function(n){var r=n.t,s=n.d;if("scale"===r){var u=(null==s?void 0:s.map((function(t){return t.value})))||[1,1];t.scaleLocal(u[0],u[1],1)}else if("scalex"===r){var c=(null==s?void 0:s.map((function(t){return t.value})))||[1];t.scaleLocal(c[0],1,1)}else if("scaley"===r){var l=(null==s?void 0:s.map((function(t){return t.value})))||[1];t.scaleLocal(1,l[0],1)}else if("scalez"===r){var f=(null==s?void 0:s.map((function(t){return t.value})))||[1];t.scaleLocal(1,1,f[0])}else if("scale3d"===r){var h=(null==s?void 0:s.map((function(t){return t.value})))||[1,1,1];t.scaleLocal(h[0],h[1],h[2])}else if("translate"===r){var d=s||[ja,ja];t.translateLocal(d[0].value,d[1].value,0)}else if("translatex"===r){var p=s||[ja];t.translateLocal(p[0].value,0,0)}else if("translatey"===r){var v=s||[ja];t.translateLocal(0,v[0].value,0)}else if("translatez"===r){var g=s||[ja];t.translateLocal(0,0,g[0].value)}else if("translate3d"===r){var m=s||[ja,ja,ja];t.translateLocal(m[0].value,m[1].value,m[2].value)}else if("rotate"===r){var y=s||[Wa];t.rotateLocal(0,0,y[0].value)}else if("rotatex"===r){var _=s||[Wa];t.rotateLocal(_[0].value,0,0)}else if("rotatey"===r){var E=s||[Wa];t.rotateLocal(0,E[0].value,0)}else if("rotatez"===r){var T=s||[Wa];t.rotateLocal(0,0,T[0].value)}else if("rotate3d"===r);else if("skew"===r){var R=(null==s?void 0:s.map((function(t){return t.value})))||[0,0];t.setLocalSkew(ps(R[0]),ps(R[1]))}else if("skewx"===r){var A=(null==s?void 0:s.map((function(t){return t.value})))||[0];t.setLocalSkew(ps(A[0]),t.getLocalSkew()[1])}else if("skewy"===r){var S=(null==s?void 0:s.map((function(t){return t.value})))||[0];t.setLocalSkew(t.getLocalSkew()[0],ps(S[0]))}else if("matrix"===r){var b=s.map((function(t){return t.value})),x=b[0],M=b[1],O=b[2],C=b[3],N=b[4],P=b[5];t.setLocalTransform(i.set(e.tmpMat4,x,M,0,0,O,C,0,0,0,0,1,0,N+o,P+a,0,1))}else"matrix3d"===r&&(i.set.apply(i,[e.tmpMat4].concat(s.map((function(t){return t.value})))),e.tmpMat4[12]+=o,e.tmpMat4[13]+=a,t.setLocalTransform(e.tmpMat4))})))},t}();Hl=_([Object(c.singleton)({token:{token:Ka,named:Ba.TRANSFORM}})],Hl);var Yl=function(){this.parser=qu};Yl=_([Object(c.singleton)({token:{token:Ka,named:Ba.TRANSFORM_ORIGIN}})],Yl);var zl=function(){function t(){this.parser=xu}var e=t.prototype;return e.calculator=function(t,e,n,r){return n.value},e.postProcessor=function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&(n.dirty=!0),r&&(r.dirty=!0)}},t}();zl=_([Object(c.singleton)({token:{token:Ka,named:Ba.Z_INDEX}})],zl);var Kl=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:Ba.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:Ba.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:Ba.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:Ba.PAINT},{n:"stroke",int:!0,k:["none"],d:"none",syntax:Ba.PAINT},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:Ba.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:Ba.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:Ba.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:Ba.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:Ba.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:Ba.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:Ba.OFFSET_PATH},{n:"offsetDistance",int:!0,syntax:Ba.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:Ba.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:Ba.FILTER},{n:"clipPath",syntax:Ba.CLIP_PATH},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:Ba.TRANSFORM},{n:"transformOrigin",p:100,d:function(t){return t===ys.CIRCLE||t===ys.ELLIPSE?"center":t===ys.TEXT?"text-anchor":"left top"},l:!0,syntax:Ba.TRANSFORM_ORIGIN},{n:"anchor",p:99,d:function(t){return t===ys.CIRCLE||t===ys.ELLIPSE?"0.5 0.5":"0 0"},l:!0,syntax:Ba.LENGTH_PERCENTAGE_12},{n:"cx",int:!0,d:"0",syntax:Ba.COORDINATE},{n:"cy",int:!0,d:"0",syntax:Ba.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"x",int:!0,d:"0",syntax:Ba.COORDINATE},{n:"y",int:!0,d:"0",syntax:Ba.COORDINATE},{n:"z",int:!0,d:"0",syntax:Ba.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Ba.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:Ba.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:Ba.COORDINATE},{n:"y1",int:!0,l:!0,syntax:Ba.COORDINATE},{n:"z1",int:!0,l:!0,syntax:Ba.COORDINATE},{n:"x2",int:!0,l:!0,syntax:Ba.COORDINATE},{n:"y2",int:!0,l:!0,syntax:Ba.COORDINATE},{n:"z2",int:!0,l:!0,syntax:Ba.COORDINATE},{n:"path",int:!0,l:!0,d:"",a:["d"],syntax:Ba.PATH,p:50},{n:"points",l:!0,syntax:Ba.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:Ba.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:Ba.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:Ba.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:Ba.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:Ba.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:Ba.NUMBER,d:function(t){return t===ys.PATH||t===ys.POLYGON||t===ys.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","end","left","right"],d:"start"},{n:"whiteSpace",l:!0},{n:"markerStart",syntax:Ba.MARKER},{n:"markerEnd",syntax:Ba.MARKER},{n:"markerMid",syntax:Ba.MARKER},{n:"markerStartOffset",syntax:Ba.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:Ba.LENGTH,l:!0,int:!0,d:"0"}],ql={},Zl={},Ql={},Jl=v((function(t){return t.sort((function(t,e){return Ql[t]-Ql[e]}))})),$l=o.create(),tf=o.create(),ef=o.create(),nf=function(){function t(t,e,n){var r=this;this.sceneGraphService=void 0,this.propertySyntaxFactory=void 0,this.geometryUpdaterFactory=void 0,this.sceneGraphService=t,this.propertySyntaxFactory=e,this.geometryUpdaterFactory=n,Kl.forEach((function(t){r.registerMetadata(t)}))}var e=t.prototype;return e.registerMetadata=function(t){[t.n].concat(t.a||[]).forEach((function(e){ql[e]=t,Ql[e]=t.p||0}))},e.unregisterMetadata=function(t){delete ql[t]},e.getPropertySyntax=function(t){return this.propertySyntaxFactory(t)},e.processProperties=function(t,e,n){var r=this;void 0===n&&(n={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[]});var i=n,o=i.skipUpdateAttribute,a=i.skipParse,s=i.forceUpdateGeometry,u=i.usedAttributes,c=s,l=Object.keys(e);l.forEach((function(n){var r,i=Ta(n,e[n]),a=i[0],s=i[1];o||(t.attributes[a]=s),!c&&(null===(r=ql[a])||void 0===r?void 0:r.l)&&(c=!0)})),a||l.forEach((function(e){t.computedStyle[e]=r.parseProperty(e,t.attributes[e],t)})),(l=Jl((null==u?void 0:u.length)?Array.from(new Set(l.concat(u))):l)).forEach((function(e){e in t.computedStyle&&(t.parsedStyle[e]=r.computeProperty(e,t.computedStyle[e],t))})),c&&this.updateGeometry(t),l.forEach((function(e){e in t.parsedStyle&&r.postProcessProperty(e,t)})),t.children.length&&l.forEach((function(e){e in t.parsedStyle&&r.isPropertyInheritable(e)&&t.children.forEach((function(t){t.internalSetAttribute(e,null,{skipUpdateAttribute:!0,skipParse:!0})}))}))},e.parseProperty=function(t,e,n){var r=ql[t],i=e;if((""===e||Q(e))&&(e="unset"),"unset"===e||"initial"===e||"inherit"===e)i=$a(e);else if(r){var o=r.k,a=r.syntax,s=a&&this.getPropertySyntax(a);o&&o.indexOf(e)>-1?i=$a(e):s&&s.parser&&(i=s.parser(e,n))}return i},e.computeProperty=function(t,e,n){var r=ql[t],i="g-root"===n.id,o=e;if(r){var a=r.syntax,s=r.inh,u=r.d;if(e instanceof da){var c=e.value;if("unset"===c&&(c=s&&!i?"inherit":"initial"),"initial"===c)Q(u)||(e=this.parseProperty(t,p(u)?u(n.nodeName):u,n));else if("inherit"===c){var l=this.tryToResolveProperty(n,t,{inherited:!0});return Q(l)?void this.addUnresolveProperty(n,t):l}}var f=a&&this.getPropertySyntax(a);if(f&&f.calculator){var h=n.parsedStyle[t];o=f.calculator(t,h,e,n,this)}else o=e instanceof da?e.value:e}return o},e.postProcessProperty=function(t,e){var n=ql[t];if(n&&n.syntax){var r=n.syntax&&this.getPropertySyntax(n.syntax);r&&r.postProcessor&&r.postProcessor(e)}},e.addUnresolveProperty=function(t,e){Zl[t.entity]||(Zl[t.entity]=[]),-1===Zl[t.entity].indexOf(e)&&Zl[t.entity].push(e)},e.tryToResolveProperty=function(t,e,n){if(void 0===n&&(n={}),n.inherited&&t.parentElement&&function(t,e){return!Zl[t.entity]||0===Zl[t.entity].length||Zl[t.entity].includes(e)}(t.parentElement,e)){var r=t.parentElement.parsedStyle[e];if("unset"===r||"initial"===r||"inherit"===r)return;return r}},e.recalc=function(t){var e=Zl[t.entity];if(e&&e.length){var n={};e.forEach((function(e){n[e]=t.attributes[e]})),this.processProperties(t,n),delete Zl[t.entity]}},e.updateGeometry=function(t){var e=this.geometryUpdaterFactory(t.nodeName);if(e){var n=t.geometry;n.contentBounds||(n.contentBounds=new lu),n.renderBounds||(n.renderBounds=new lu);var r=t.parsedStyle,i=e.update(r,t),a=i.width,s=i.height,u=i.depth,c=void 0===u?0:u,l=i.offsetX,f=void 0===l?0:l,h=i.offsetY,d=void 0===h?0:h,p=i.offsetZ,v=void 0===p?0:p,g=a<0,m=s<0,y=o.set($l,Math.abs(a)/2,Math.abs(s)/2,c/2),_=r.stroke,E=r.lineWidth,T=r.increasedLineWidthForHitTesting,R=r.shadowType,A=r.shadowColor,S=r.filter,b=void 0===S?[]:S,x=r.transformOrigin,M=r.anchor;t.nodeName===ys.TEXT&&delete r.anchor;var O=o.set(tf,(1-2*(M&&M[0]||0))*a/2+f,(1-2*(M&&M[1]||0))*s/2+d,(1-2*(M&&M[2]||0))*y[2]+v);n.contentBounds.update(O,y);var C=t.nodeName===ys.POLYLINE||t.nodeName===ys.POLYGON||t.nodeName===ys.PATH?Math.SQRT2:.5;if(_&&!_.isNone){var N=((E||0)+(T||0))*C;o.add(y,y,o.set(ef,N,N,0))}if(n.renderBounds.update(O,y),A&&R&&"inner"!==R){var P=n.renderBounds,I=P.min,w=P.max,D=r.shadowBlur||0,L=r.shadowOffsetX||0,B=r.shadowOffsetY||0,F=I[0]-D+L,k=w[0]+D+L,U=I[1]-D+B,G=w[1]+D+B;I[0]=Math.min(I[0],F),w[0]=Math.max(w[0],k),I[1]=Math.min(I[1],U),w[1]=Math.max(w[1],G),n.renderBounds.setMinMax(I,w)}b.forEach((function(t){var e=t.name,r=t.params;if("blur"===e){var i=r[0].value;n.renderBounds.update(n.renderBounds.center,o.add(n.renderBounds.halfExtents,n.renderBounds.halfExtents,o.fromValues(i,i,0)))}else if("drop-shadow"===e){var a=r[0].value,s=r[1].value,u=r[2].value,c=n.renderBounds,l=c.min,f=c.max,h=l[0]-u+a,d=f[0]+u+a,p=l[1]-u+s,v=f[1]+u+s;l[0]=Math.min(l[0],h),f[0]=Math.max(f[0],d),l[1]=Math.min(l[1],p),f[1]=Math.max(f[1],v),n.renderBounds.setMinMax(l,f)}})),M=r.anchor;var V=(g?-1:1)*Ru(x[0],0,t),j=(m?-1:1)*Ru(x[1],1,t);V-=(g?-1:1)*(M&&M[0]||0)*n.contentBounds.halfExtents[0]*2,j-=(m?-1:1)*(M&&M[1]||0)*n.contentBounds.halfExtents[1]*2,t.setOrigin(V,j),this.sceneGraphService.dirtifyToRoot(t)}},e.isPropertyInheritable=function(t){var e=ql[t];return!!e&&e.inh},t}();nf=_([Object(c.singleton)({token:Ha}),E(0,Object(c.inject)(Ac)),E(1,Object(c.inject)(za)),E(2,Object(c.inject)(Ju))],nf);var rf,of,af,sf,uf=Object(c.Module)((function(t){t(kc),t(_l),t(bl),t({token:Rl,useFactory:function(t){return function(){return t.container.get(Al)}}}),t(xl),t(ac),t(fc),t(tc),t(ec),t(oc),t(hc),t(nc),t(ic),t(rc),t({token:Ju,useFactory:function(t){var e={};return function(n){return e[n]||t.container.isBoundNamed($u,n)&&(e[n]=t.container.getNamed($u,n)),e[n]}}}),t(Bl),t(Qu),t(Ml),t(Ol),t(Cl),t(Pl),t(Il),t(wl),t(Dl),t(Fl),t(kl),t(Ul),t(Gl),t(Vl),t(jl),t(Wl),t(Xl),t(Hl),t(Yl),t(zl),t(Ll),t({token:za,useFactory:function(t){var e={};return function(n){return e[n]||t.container.isBoundNamed(Ka,n)&&(e[n]=t.container.getNamed(Ka,n)),e[n]}}}),t(nf)})),cf=function(){this.container=void 0},lf=function(){function t(t){this.plugins=[],this.config=void 0,this.config=Qo({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1},t)}var e=t.prototype;return e.registerPlugin=function(t){this.plugins.push(t)},e.unregisterPlugin=function(t){var e=this.plugins.findIndex((function(e){return e===t}));e>-1&&this.plugins.splice(e,1)},e.getPlugins=function(){return this.plugins},e.getPlugin=function(t){return this.plugins.find((function(e){return e.name===t}))},e.getConfig=function(){return this.config},e.setConfig=function(t){Object.assign(this.config,t)},t}(),ff=c.Syringe.defineToken(""),hf=((rf=function(){function t(t,e){this.strategyProvider=void 0,this.renderingContext=void 0,this.strategyProvider=t,this.renderingContext=e}return t.prototype.apply=function(t){var e=this,n=this.strategyProvider.getContributions();t.hooks.cull.tap(of.tag,(function(t){if(t){var r=t.cullable;return 0===n.length?r.visible=e.renderingContext.unculledEntities.indexOf(t.entity)>-1:r.visible=n.every((function(e){return e.isVisible(t)})),!t.isCulled()&&t.isVisible()?t:(t.dispatchEvent(new gc(Tc.CULLED)),null)}return t})),t.hooks.afterRender.tap(of.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))},t}()).tag="Culling",of=rf);hf=of=_([Object(c.singleton)({contrib:El}),E(0,Object(c.contrib)(ff)),E(1,Object(c.inject)(fl))],hf);var df,pf,vf=((af=function(){function t(){}return t.prototype.apply=function(t){t.hooks.dirtycheck.tap(sf.tag,(function(e){return e?e.renderable.dirty||t.disableDirtyRectangleRendering()?e:null:e}))},t}()).tag="DirtyCheck",sf=af);vf=sf=_([Object(c.singleton)({contrib:El})],vf);var gf=((df=function(){function t(t,e,n,r,i){var o=this;this.canvasConfig=void 0,this.contextService=void 0,this.renderingService=void 0,this.renderingContext=void 0,this.eventService=void 0,this.autoPreventDefault=!1,this.rootPointerEvent=new Dc(null),this.rootWheelEvent=new Lc(null),this.onPointerMove=function(t){var e,n,r=null===(e=o.renderingContext.root)||void 0===e||null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView;if(!r.supportsTouchEvents||"touch"!==t.pointerType){for(var i,a=ra(o.normalizeToPointerEvent(t,r));!(i=a()).done;){var s=i.value,u=o.bootstrapEvent(o.rootPointerEvent,s,r);o.eventService.mapEvent(u)}o.setCursor(o.eventService.cursor)}},this.canvasConfig=t,this.contextService=e,this.renderingService=n,this.renderingContext=r,this.eventService=i}var e=t.prototype;return e.apply=function(t){var e=this,n=this.renderingContext.root.ownerDocument.defaultView;this.eventService.setPickHandler(function(){var t=Ko(Yo().mark((function t(n){var r,i;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderingService.hooks.pick.promise({position:n,picked:[],topmost:!0});case 2:return r=t.sent,i=r.picked,t.abrupt("return",i[0]||null);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.hooks.pointerWheel.tap(pf.tag,(function(t){var n=e.normalizeWheelEvent(t);e.eventService.mapEvent(n)})),t.hooks.pointerDown.tap(pf.tag,(function(t){if(!n.supportsTouchEvents||"touch"!==t.pointerType){var r=e.normalizeToPointerEvent(t,n);if(e.autoPreventDefault&&r[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i,o=ra(r);!(i=o()).done;){var a=i.value,s=e.bootstrapEvent(e.rootPointerEvent,a,n);e.eventService.mapEvent(s)}e.setCursor(e.eventService.cursor)}})),t.hooks.pointerUp.tap(pf.tag,(function(t){if(!n.supportsTouchEvents||"touch"!==t.pointerType){for(var r,i=e.contextService.getDomElement(),o=i&&t.target&&t.target!==i&&i.contains&&!i.contains(t.target)?"outside":"",a=ra(e.normalizeToPointerEvent(t,n));!(r=a()).done;){var s=r.value,u=e.bootstrapEvent(e.rootPointerEvent,s,n);u.type+=o,e.eventService.mapEvent(u)}e.setCursor(e.eventService.cursor)}})),t.hooks.pointerMove.tap(pf.tag,this.onPointerMove),t.hooks.pointerOver.tap(pf.tag,this.onPointerMove),t.hooks.pointerOut.tap(pf.tag,this.onPointerMove)},e.bootstrapEvent=function(t,e,n){t.view=n,t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var r=this.eventService.client2Viewport(new du(e.clientX,e.clientY)),i=r.x,o=r.y;t.viewport.x=i,t.viewport.y=o;var a=this.eventService.viewport2Canvas(t.viewport),s=a.x,u=a.y;return t.canvas.x=s,t.canvas.y=u,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=cs[t.type]||t.type),t},e.normalizeWheelEvent=function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.eventService.client2Viewport(new du(t.clientX,t.clientY)),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var o=this.eventService.viewport2Canvas(e.viewport),a=o.x,s=o.y;return e.canvas.x=a,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e},e.transferMouseData=function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null},e.setCursor=function(t){this.contextService.applyCursorStyle(t||this.canvasConfig.cursor||"default")},e.normalizeToPointerEvent=function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];st(i.button)&&(i.button=0),st(i.buttons)&&(i.buttons=1),st(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),st(i.width)&&(i.width=i.radiusX||1),st(i.height)&&(i.height=i.radiusY||1),st(i.tiltX)&&(i.tiltX=0),st(i.tiltY)&&(i.tiltY=0),st(i.pointerType)&&(i.pointerType="touch"),st(i.pointerId)&&(i.pointerId=i.identifier||0),st(i.pressure)&&(i.pressure=i.force||.5),st(i.twist)&&(i.twist=0),st(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){var o=t;st(o.isPrimary)&&(o.isPrimary=!0),st(o.width)&&(o.width=1),st(o.height)&&(o.height=1),st(o.tiltX)&&(o.tiltX=0),st(o.tiltY)&&(o.tiltY=0),st(o.pointerType)&&(o.pointerType="mouse"),st(o.pointerId)&&(o.pointerId=1),st(o.pressure)&&(o.pressure=.5),st(o.twist)&&(o.twist=0),st(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,n.push(o)}else n.push(t);return n},t}()).tag="Event",pf=df);gf=pf=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(bs)),E(1,Object(c.inject)(dc)),E(2,Object(c.inject)(Tl)),E(3,Object(c.inject)(fl)),E(4,Object(c.inject)(hl))],gf);var mf,yf,_f=[ys.CIRCLE,ys.ELLIPSE,ys.IMAGE,ys.RECT,ys.LINE,ys.POLYLINE,ys.POLYGON,ys.TEXT,ys.PATH,ys.HTML],Ef=function(){function t(t){this.camera=void 0,this.camera=t}var e=t.prototype;return e.isVisible=function(t){var e,n,r=t.cullable;if(!r.enable)return!0;var i=t.getRenderBounds();if(lu.isEmpty(i))return!1;var o=this.camera.getFrustum(),a=null===(e=t.parentNode)||void 0===e||null===(n=e.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,i,a||cu.INDETERMINATE,o.planes),r.visible=r.visibilityPlaneMask!==cu.OUTSIDE,r.visible},e.computeVisibilityWithPlaneMask=function(t,e,n,r){if(n===cu.OUTSIDE||n===cu.INSIDE)return n;for(var i=cu.INSIDE,a=_f.indexOf(t.nodeName)>-1,s=0,u=r.length;s<u;++s){var c=1<<s;if(0!=(n&c)&&(!a||4!==s&&5!==s)){var l=r[s],f=l.normal,h=l.distance;if(o.dot(f,e.getPositiveFarPoint(r[s]))+h<0)return cu.OUTSIDE;o.dot(f,e.getNegativeFarPoint(r[s]))+h<0&&(i|=c)}}return i},t}();Ef=_([Object(c.singleton)({contrib:ff}),E(0,Object(c.inject)(gl))],Ef);var Tf=((mf=function(){function t(t,e,n,r){this.renderingContext=void 0,this.styleValueRegistry=void 0,this.sceneGraphService=void 0,this.rBush=void 0,this.toSync=new Set,this.renderingContext=t,this.styleValueRegistry=e,this.sceneGraphService=n,this.rBush=r}var e=t.prototype;return e.pushToSync=function(t){var e=this;t.forEach((function(t){e.toSync.add(t)}))},e.apply=function(t){var e=this,n=function(e){e.target.renderable.dirty=!0,t.dirtify()},r=function(n){var r=n.detail.affectChildren,i=n.target;r&&i.forEach((function(t){e.pushToSync([t])})),e.pushToSync(n.composedPath().slice(0,-2)),t.dirtify()},i=function(n){var r=n.target;e.pushToSync(n.composedPath().slice(0,-2)),e.styleValueRegistry.recalc(r),e.sceneGraphService.dirtifyToRoot(r),t.dirtify()},o=function(n){var r=n.target,i=r.rBushNode;i.aabb&&e.rBush.remove(i.aabb),e.toSync.delete(r),e.sceneGraphService.dirtifyToRoot(n.target),t.dirtify()};t.hooks.init.tapPromise(yf.tag,Ko(Yo().mark((function t(){return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.renderingContext.root.addEventListener(Tc.MOUNTED,i),e.renderingContext.root.addEventListener(Tc.UNMOUNTED,o),e.renderingContext.root.addEventListener(Tc.ATTR_MODIFIED,n),e.renderingContext.root.addEventListener(Tc.BOUNDS_CHANGED,r);case 4:case"end":return t.stop()}}),t)})))),t.hooks.destroy.tap(yf.tag,(function(){e.renderingContext.root.removeEventListener(Tc.MOUNTED,i),e.renderingContext.root.removeEventListener(Tc.UNMOUNTED,o),e.renderingContext.root.removeEventListener(Tc.ATTR_MODIFIED,n),e.renderingContext.root.removeEventListener(Tc.BOUNDS_CHANGED,r)})),t.hooks.endFrame.tap(yf.tag,(function(){e.syncRTree()}))},e.syncRTree=function(){var t=this,e=[];Array.from(this.toSync).filter((function(t){return t.isConnected})).forEach((function(n){var r=n.rBushNode;r&&r.aabb&&t.rBush.remove(r.aabb);var i=n.getRenderBounds();if(i){var o=i.getMin(),a=o[0],s=o[1],u=i.getMax(),c=u[0],l=u[1];r.aabb||(r.aabb={}),r.aabb.id=n.entity,r.aabb.minX=a,r.aabb.minY=s,r.aabb.maxX=c,r.aabb.maxY=l}r.aabb&&(isNaN(r.aabb.maxX)||isNaN(r.aabb.maxX)||isNaN(r.aabb.minX)||isNaN(r.aabb.minY)||e.push(r.aabb))})),this.rBush.load(e),e.length=0,this.toSync.clear()},t}()).tag="Prepare",yf=mf);Tf=yf=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(fl)),E(1,Object(c.inject)(Ha)),E(2,Object(c.inject)(Ac)),E(3,Object(c.inject)(Rc))],Tf);var Rf,Af=Object(c.Module)((function(t){c.Contribution.register(t,El,{cache:!1}),c.Contribution.register(t,ff,{cache:!1}),t({token:Rc,useValue:new f.a}),t(Tl),t(hl),t(gf),t(Tf),t(vf),t(hf),t(Ef)}));!function(t){t.READY="ready",t.BEFORE_RENDER="beforerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle"}(Rf||(Rf={}));var Sf=function(t){function e(e){var n;(n=t.call(this)||this).container=c.GlobalContainer.createChild(),n.document=void 0,n.customElements=void 0,n.requestAnimationFrame=void 0,n.cancelAnimationFrame=void 0,n.devicePixelRatio=void 0,n.supportsPointerEvents=void 0,n.supportsTouchEvents=void 0,n.isTouchEvent=void 0,n.isMouseEvent=void 0,n.Element=Gc,n.frameId=void 0,n.eventService=void 0,n.renderingService=void 0,n.inited=!1,n.readyPromise=void 0,n.resolveReadyPromise=void 0,n.mountEvent=new gc(Tc.MOUNTED),n.unmountEvent=new gc(Tc.UNMOUNTED),n.beforeRenderEvent=new gc(Rf.BEFORE_RENDER),n.afterRenderEvent=new gc(Rf.AFTER_RENDER),n.document=new Ec,n.document.defaultView=ea(n),n.customElements=new pc;var r=e.container,i=e.canvas,o=e.offscreenCanvas,a=e.width,s=e.height,u=e.devicePixelRatio,l=e.renderer,f=e.background,h=e.cursor,d=e.document,p=e.requestAnimationFrame,v=e.cancelAnimationFrame,g=e.createImage,m=e.supportsPointerEvents,y=e.supportsTouchEvents,_=e.isTouchEvent,E=e.isMouseEvent;!function(t,e){if(t){var n="string"==typeof t?t:t.id||os++;is[n]&&is[n].destroy(),is[n]=e}}(r,ea(n));var T=a,R=s,A=u;return i&&(A=(A=u||as&&window.devicePixelRatio||1)>=1?Math.ceil(A):1,T=a||function(t){var e=us(t,"width");return"auto"===e?t.offsetWidth:parseFloat(e)}(i)||i.width/A,R=s||function(t){var e=us(t,"height");return"auto"===e?t.offsetHeight:parseFloat(e)}(i)||i.height/A),n.devicePixelRatio=A,n.requestAnimationFrame=null!=p?p:Ho.b.bind(globalThis),n.cancelAnimationFrame=null!=v?v:Ho.a.bind(globalThis),n.supportsTouchEvents=null!=y?y:"ontouchstart"in globalThis,n.supportsPointerEvents=null!=m?m:!!globalThis.PointerEvent,n.isTouchEvent=null!=_?_:function(t){return n.supportsTouchEvents&&t instanceof globalThis.TouchEvent},n.isMouseEvent=null!=E?E:function(t){return!globalThis.MouseEvent||t instanceof globalThis.MouseEvent&&(!n.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))},n.initRenderingContext({container:r,canvas:i,width:T,height:R,renderer:l,offscreenCanvas:o,devicePixelRatio:A,cursor:h||"default",background:f||"transparent",createImage:g,document:d}),n.initDefaultCamera(T,R),Ko(Yo().mark((function t(){return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.initRenderer(l);case 2:n.dispatchEvent(new gc(Rf.READY)),n.readyPromise&&n.resolveReadyPromise();case 4:case"end":return t.stop()}}),t)})))(),n}Jo(e,t);var n=e.prototype;return n.initRenderingContext=function(t){var e=this;this.container.register({token:bs,useValue:t}),this.container.register({token:fl,useValue:{root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}),this.document.documentElement.addEventListener(Tc.CHILD_INSERTED,(function(t){e.mountChildren(t.detail.child)})),this.document.documentElement.addEventListener(Tc.CHILD_REMOVED,(function(t){e.unmountChildren(t.detail.child)}))},n.initDefaultCamera=function(t,e){var n=c.GlobalContainer.get(ml);n.setType(dl.EXPLORING,pl.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),n.canvas=this;var r=this.container.get(fl);n.eventEmitter.on(yl,(function(){r.renderReasons.add(Uc.CAMERA_CHANGED)})),this.container.register({token:gl,useValue:n})},n.getConfig=function(){return this.container.get(bs)},n.getContainer=function(){return this.container},n.getRoot=function(){return this.document.documentElement},n.getCamera=function(){return this.container.get(gl)},n.getContextService=function(){return this.container.get(dc)},n.getEventService=function(){return this.eventService},n.getRenderingService=function(){return this.renderingService},n.getRenderingContext=function(){return this.container.get(fl)},n.getStats=function(){return this.getRenderingService().getStats()},n.destroy=function(t,e){(void 0===t&&(t=!0),void 0===e&&(e=!1),e||this.dispatchEvent(new gc(Rf.BEFORE_DESTROY)),this.frameId)&&(this.getConfig().cancelAnimationFrame||cancelAnimationFrame)(this.frameId);var n=this.getRoot();this.unmountChildren(n),t&&this.document.destroy(),this.getContextService().destroy(),this.getRenderingService().destroy(),e||this.dispatchEvent(new gc(Rf.AFTER_DESTROY))},n.changeSize=function(t,e){this.resize(t,e)},n.resize=function(t,e){var n=this.container.get(bs);n.width=t,n.height=e,this.getContextService().resize(t,e);var r=this.container.get(gl),i=r.getProjectionMode();r.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===vl.ORTHOGRAPHIC?r.setOrthographic(t/-2,t/2,e/2,e/-2,r.getNear(),r.getFar()):r.setAspect(t/e),this.dispatchEvent(new gc(Rf.RESIZE,{width:t,height:e}))},n.appendChild=function(t,e){return this.document.documentElement.appendChild(t,e)},n.insertBefore=function(t,e){return this.document.documentElement.insertBefore(t,e)},n.removeChild=function(t){return this.document.documentElement.removeChild(t)},n.removeChildren=function(){this.document.documentElement.removeChildren()},n.render=function(){(this.dispatchEvent(this.beforeRenderEvent),this.container.isBound(Tl))&&this.container.get(Tl).render(this.getConfig());this.dispatchEvent(this.afterRenderEvent)},n.run=function(){var t=this;!function e(){t.render(),t.frameId=requestAnimationFrame(e)}()},n.initRenderer=function(){var t=Ko(Yo().mark((function t(e){var n;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("Renderer is required.");case 2:return this.inited=!1,this.readyPromise=void 0,this.loadCommonContainerModule(),this.loadRendererContainerModule(e),n=this.container.get(dc),this.renderingService=this.container.get(Tl),this.eventService=this.container.get(hl),this.eventService.init(),t.next=12,n.init();case 12:return t.next=14,this.renderingService.init();case 14:this.inited=!0,this.getRoot().forEach((function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)})),this.mountChildren(this.getRoot()),e.getConfig().enableAutoRendering&&this.run();case 18:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.loadCommonContainerModule=function(){this.container.unload(Af),this.container.load(Af,!0)},n.loadRendererContainerModule=function(t){var e=this;t.getPlugins().forEach((function(t){t.container=e.container,t.init()}))},n.setRenderer=function(){var t=Ko(Yo().mark((function t(e){var n,r;return Yo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.getConfig()).renderer!==e){t.next=3;break}return t.abrupt("return");case 3:return r=n.renderer,n.renderer=e,this.destroy(!1,!0),[].concat(null==r?void 0:r.getPlugins()).reverse().forEach((function(t){t.destroy()})),t.next=9,this.initRenderer(e);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.setCursor=function(t){this.container.get(bs).cursor=t,this.getContextService().applyCursorStyle(t)},n.unmountChildren=function(t){var e=this;if(this.inited){var n=[];t.forEach((function(t){t.isConnected&&n.push(t)})),n.reverse().forEach((function(t){t instanceof Xc&&t.disconnectedCallback&&t.disconnectedCallback(),t.dispatchEvent(e.unmountEvent),t!==e.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1}))}},n.mountChildren=function(t){var e=this;this.inited?t.forEach((function(t){t.isConnected||(t.ownerDocument=e.document,t.isConnected=!0,t.dispatchEvent(e.mountEvent),t instanceof Xc&&t.connectedCallback&&t.connectedCallback())})):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName)},n.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},n.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},n.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},n.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},n.getPointByClient=function(t,e){return this.client2Viewport({x:t,y:e})},n.getClientByPoint=function(t,e){return this.viewport2Client({x:t,y:e})},Zo(e,[{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise((function(e){t.resolveReadyPromise=function(){e(t)}})),this.inited&&this.resolveReadyPromise()),this.readyPromise}}]),e}(mc);c.GlobalContainer.load(uf);c.GlobalContainer.get(Ha),n(102),n(105),n(112);var bf=function(t){return null==t},xf=function(t,e,n){return t<e?e:t>n?n:t},Mf={}.toString,Of=function(t,e){return Mf.call(t)==="[object "+e+"]"},Cf=function(t){return Of(t,"Number")},Nf=function(t){return Of(t,"String")};function Pf(){Pf=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function If(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function wf(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){If(o,r,i,a,s,"next",t)}function s(t){If(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Df(t,e){return(Df=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Lf={}.toString,Bf=function(t,e){return Lf.call(t)==="[object "+e+"]"},Ff=function(t){return Bf(t,"Function")};function kf(t,e){var n;if(t)if(n=t,Array.isArray?Array.isArray(n):Bf(n,"Array"))for(var r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e}(t))for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}var Uf,Gf=function(t){return Bf(t,"String")},Vf=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return kf(t,(function(n,r){Ff(t)&&"prototype"===r||e.push(n)})),e};!function(t,e){if(!Ff(t))throw new TypeError("Expected a function");var n=function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return Uf||(Uf=document.createElement("canvas").getContext("2d")),Uf.font=[o,a,i,n+"px",r].join(" "),Uf.measureText(Gf(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),T([t],Vf(e)).join("")}));var jf,Wf,Xf=function(){function t(t){this.canvasConfig=void 0,this.imageCache={},this.gradientCache={},this.patternCache={},this.canvasConfig=t}var e=t.prototype;return e.getImageSync=function(t,e){return this.imageCache[t]?e&&e():this.getOrCreateImage(t).then((function(){e&&e()})),this.imageCache[t]},e.getOrCreateImage=function(t){var e=this;if(this.imageCache[t])return Promise.resolve(this.imageCache[t]);var n=this.canvasConfig.createImage;return new Promise((function(r,i){var o;n?o=n(t):as&&(o=new window.Image),o&&(o.onload=function(){r(o)},o.onerror=function(t){i(t)},o.crossOrigin="Anonymous",o.src=t,e.imageCache[t]=o)}))},e.getOrCreatePatternSync=function(t,e,n){var r=this.generatePatternKey(t);if(r&&this.patternCache[r])return this.patternCache[r];var i,o=t.image,a=t.repetition,s=(i=Gf(o)?this.getImageSync(o,n):o)&&e.createPattern(i,a);return r&&s&&(this.patternCache[r]=s),s},e.getOrCreateGradient=function(t,e){var n=this.generateGradientKey(t),r=t.type,i=t.steps,o=t.width,a=t.height,s=t.angle,u=t.cx,c=t.cy;if(this.gradientCache[n])return this.gradientCache[n];var l=null;if(r===aa.LinearGradient){var f=function(t,e,n){var r=n*Math.PI/180,i=0+t/2,o=0+e/2,a=Math.abs(t*Math.cos(r))+Math.abs(e*Math.sin(r));return{x1:i-Math.cos(r)*a/2,y1:o-Math.sin(r)*a/2,x2:i+Math.cos(r)*a/2,y2:o+Math.sin(r)*a/2}}(o,a,s),h=f.x1,d=f.y1,p=f.x2,v=f.y2;l=e.createLinearGradient(h,d,p,v)}else if(r===aa.RadialGradient){var g=function(t,e,n,r){return{x:n*t,y:r*e,r:Math.sqrt(t*t+e*e)/2}}(o,a,u,c),m=g.x,y=g.y,_=g.r;l=e.createRadialGradient(m,y,0,m,y,_)}return l&&(i.forEach((function(t){var e,n=t[0],r=t[1];null===(e=l)||void 0===e||e.addColorStop(n,r)})),this.gradientCache[n]=l),this.gradientCache[n]},e.generateGradientKey=function(t){var e=t.type,n=t.width,r=t.height,i=t.steps;return"gradient-"+e+"-"+(t.angle||0)+"-"+(t.cx||0)+"-"+(t.cy||0)+"-"+n+"-"+r+"-"+i.map((function(t){return t.join("")})).join("-")},e.generatePatternKey=function(t){var e=t.image,n=t.repetition;if(Gf(e))return"pattern-"+e+"-"+n},t}();Xf=_([Object(c.singleton)(),E(0,Object(c.inject)(bs))],Xf);var Hf=((jf=function(){function t(t,e){this.imagePool=void 0,this.renderingContext=void 0,this.imagePool=t,this.renderingContext=e}return t.prototype.apply=function(t){var e=this,n=function(n){var r=n.target,i=r.nodeName,o=r.attributes;if(i===ys.IMAGE){var a=o.img;Gf(a)&&e.imagePool.getImageSync(a,(function(){r.renderable.dirty=!0,t.dirtify()}))}},r=function(n){var r=n.target,i=n.attrName,o=n.newValue;r.nodeName===ys.IMAGE&&"img"===i&&Gf(o)&&e.imagePool.getOrCreateImage(o).then((function(){r.renderable.dirty=!0,t.dirtify()}))};t.hooks.init.tapPromise(Wf.tag,wf(Pf().mark((function t(){return Pf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.renderingContext.root.addEventListener(Tc.MOUNTED,n),e.renderingContext.root.addEventListener(Tc.ATTR_MODIFIED,r);case 2:case"end":return t.stop()}}),t)})))),t.hooks.destroy.tap(Wf.tag,(function(){e.renderingContext.root.removeEventListener(Tc.MOUNTED,n),e.renderingContext.root.removeEventListener(Tc.ATTR_MODIFIED,r)}))},t}()).tag="LoadImage",Wf=jf);Hf=Wf=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(Xf)),E(1,Object(c.inject)(fl))],Hf);var Yf=Object(c.Module)((function(t){t(Xf),t(Hf)})),zf=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="image-loader",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,Df(e,n);var i=r.prototype;return i.init=function(){this.container.load(Yf,!0)},i.destroy=function(){this.container.unload(Yf)},r}(cf),Kf=n(128),qf=n.n(Kf);function Zf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jf=1e20,$f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.fontSize,r=void 0===n?24:n,i=e.buffer,o=void 0===i?3:i,a=e.radius,s=void 0===a?8:a,u=e.cutoff,c=void 0===u?.25:u,l=e.fontFamily,f=void 0===l?"sans-serif":l,h=e.fontWeight,d=void 0===h?"normal":h,p=e.fontStyle,v=void 0===p?"normal":p;Zf(this,t),this.buffer=o,this.cutoff=c,this.radius=s;var g=this.size=r+4*o,m=this._createCanvas(g),y=this.ctx=m.getContext("2d",{willReadFrequently:!0});y.font="".concat(v," ").concat(d," ").concat(r,"px ").concat(f),y.textBaseline="alphabetic",y.textAlign="left",y.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}var e,n,r;return e=t,(n=[{key:"_createCanvas",value:function(t){var e=document.createElement("canvas");return e.width=e.height=t,e}},{key:"draw",value:function(t){var e=this.ctx.measureText(t),n=e.width,r=e.actualBoundingBoxAscent,i=e.actualBoundingBoxDescent,o=e.actualBoundingBoxLeft,a=e.actualBoundingBoxRight,s=Math.ceil(r),u=Math.min(this.size-this.buffer,Math.ceil(a-o)),c=Math.min(this.size-this.buffer,s+Math.ceil(i)),l=u+2*this.buffer,f=c+2*this.buffer,h=Math.max(l*f,0),d=new Uint8ClampedArray(h),p={data:d,width:l,height:f,glyphWidth:u,glyphHeight:c,glyphTop:s,glyphLeft:0,glyphAdvance:n};if(0===u||0===c)return p;var v=this.ctx,g=this.buffer,m=this.gridInner,y=this.gridOuter;v.clearRect(g,g,u,c),v.fillText(t,g,g+s);var _=v.getImageData(g,g,u,c);y.fill(Jf,0,h),m.fill(0,0,h);for(var E=0;E<c;E++)for(var T=0;T<u;T++){var R=_.data[4*(E*u+T)+3]/255;if(0!==R){var A=(E+g)*l+T+g;if(1===R)y[A]=0,m[A]=Jf;else{var S=.5-R;y[A]=S>0?S*S:0,m[A]=S<0?S*S:0}}}th(y,0,0,l,f,l,this.f,this.v,this.z),th(m,g,g,u,c,l,this.f,this.v,this.z);for(var b=0;b<h;b++){var x=Math.sqrt(y[b])-Math.sqrt(m[b]);d[b]=Math.round(255-255*(x/this.radius+this.cutoff))}return p}}])&&Qf(e.prototype,n),r&&Qf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function th(t,e,n,r,i,o,a,s,u){for(var c=e;c<e+r;c++)eh(t,n*o+c,o,i,a,s,u);for(var l=n;l<n+i;l++)eh(t,l*o+e,1,r,a,s,u)}function eh(t,e,n,r,i,o,a){o[0]=0,a[0]=-Jf,a[1]=Jf,i[0]=t[e];for(var s=1,u=0,c=0;s<r;s++){i[s]=t[e+s*n];var l=s*s;do{var f=o[u];c=(i[s]-i[f]+l-f*f)/(s-f)/2}while(c<=a[u]&&--u>-1);o[++u]=s,a[u]=c,a[u+1]=Jf}for(var h=0,d=0;h<r;h++){for(;a[d+1]<h;)d++;var p=o[d],v=h-p;t[e+h*n]=i[p]+v*v}}function nh(){nh=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function rh(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function ih(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){rh(o,r,i,a,s,"next",t)}function s(t){rh(o,r,i,a,s,"throw",t)}a(void 0)}))}}function oh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ah(t,e,n){return e&&oh(t.prototype,e),n&&oh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sh(){return(sh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function uh(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ch(t,e)}function ch(t,e){return(ch=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function lh(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}function fh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function hh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return fh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fh(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var dh=function(){this.pickingId=void 0,this.encodedPickingColor=void 0,this.meshes=[]};dh.tag="c-renderable-3d";var ph=function(){function t(){this.lights=[],this.fog=void 0}var e=t.prototype;return e.addLight=function(t){this.lights.push(t),this.sortLights()},e.removeLight=function(t){var e=this.lights.indexOf(t);this.lights.splice(e,1),this.sortLights()},e.addFog=function(t){this.fog=t},e.removeFog=function(t){this.fog=null},e.getFog=function(){return this.fog},e.getAllLights=function(){return this.lights},e.getDefines=function(){var t={USE_LIGHT:!!this.lights.length};return this.lights.forEach((function(e){t[e.define]||(t[e.define]=0),t[e.define]++})),t},e.sortLights=function(){this.lights.sort((function(t,e){return t.order-e.order}))},t}();ph=_([Object(c.singleton)()],ph);var vh="undefined"!=typeof Float32Array?Float32Array:Array;function gh(){var t=new vh(16);return vh!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function mh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function yh(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v){var g=new vh(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=u,g[9]=c,g[10]=l,g[11]=f,g[12]=h,g[13]=d,g[14]=p,g[15]=v,g}function _h(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Eh=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],v=e[12],g=e[13],m=e[14],y=e[15],_=n[0],E=n[1],T=n[2],R=n[3];return t[0]=_*r+E*s+T*f+R*v,t[1]=_*i+E*u+T*h+R*g,t[2]=_*o+E*c+T*d+R*m,t[3]=_*a+E*l+T*p+R*y,_=n[4],E=n[5],T=n[6],R=n[7],t[4]=_*r+E*s+T*f+R*v,t[5]=_*i+E*u+T*h+R*g,t[6]=_*o+E*c+T*d+R*m,t[7]=_*a+E*l+T*p+R*y,_=n[8],E=n[9],T=n[10],R=n[11],t[8]=_*r+E*s+T*f+R*v,t[9]=_*i+E*u+T*h+R*g,t[10]=_*o+E*c+T*d+R*m,t[11]=_*a+E*l+T*p+R*y,_=n[12],E=n[13],T=n[14],R=n[15],t[12]=_*r+E*s+T*f+R*v,t[13]=_*i+E*u+T*h+R*g,t[14]=_*o+E*c+T*d+R*m,t[15]=_*a+E*l+T*p+R*y,t};function Th(t,e,n){var r=new vh(3);return r[0]=t,r[1]=e,r[2]=n,r}!function(){var t,e=(t=new vh(3),vh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t)}();var Rh,Ah,Sh,bh,xh,Mh,Oh,Ch,Nh,Ph,Ih,wh,Dh,Lh,Bh,Fh,kh,Uh,Gh,Vh,jh,Wh,Xh,Hh,Yh,zh,Kh;!function(){var t,e=(t=new vh(2),vh!=Float32Array&&(t[0]=0,t[1]=0),t)}();function qh(t,e,n,r){return{dimension:Bh.n2D,pixelFormat:t,width:e,height:n,depth:1,numLevels:r,usage:Fh.Sampled}}function Zh(t,e,n){return t<<16|e<<8|n}function Qh(t){return t>>>8&255}function Jh(t){return t>>>16&255}function $h(t){return 255&t}function td(t){switch(t){case Xh.F32:case Xh.U32:case Xh.S32:return 4;case Xh.U16:case Xh.S16:case Xh.F16:return 2;case Xh.U8:case Xh.S8:return 1;default:throw new Error("whoops")}}function ed(t,e){if(void 0===e&&(e=""),!t)throw console.error((new Error).stack),new Error("Assert fail: "+e)}function nd(t){if(null!=t)return t;throw new Error("Missing object")}function rd(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b&&t.a===e.a}function id(t,e){t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a}function od(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}function ad(t,e,n,r){return void 0===r&&(r=1),{r:t,g:e,b:n,a:r}}!function(t){t[t.Buffer=0]="Buffer",t[t.Texture=1]="Texture",t[t.RenderTarget=2]="RenderTarget",t[t.Sampler=3]="Sampler",t[t.Program=4]="Program",t[t.Bindings=5]="Bindings",t[t.InputLayout=6]="InputLayout",t[t.InputState=7]="InputState",t[t.RenderPipeline=8]="RenderPipeline",t[t.ComputePipeline=9]="ComputePipeline",t[t.Readback=10]="Readback",t[t.QueryPool=11]="QueryPool"}(Rh||(Rh={})),function(t){t[t.Never=512]="Never",t[t.Less=513]="Less",t[t.Equal=514]="Equal",t[t.LessEqual=515]="LessEqual",t[t.Greater=516]="Greater",t[t.NotEqual=517]="NotEqual",t[t.GreaterEqual=518]="GreaterEqual",t[t.Always=519]="Always"}(Ah||(Ah={})),function(t){t[t.CCW=2305]="CCW",t[t.CW=2304]="CW"}(Sh||(Sh={})),function(t){t[t.None=0]="None",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.FrontAndBack=3]="FrontAndBack"}(bh||(bh={})),function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Src=768]="Src",t[t.OneMinusSrc=769]="OneMinusSrc",t[t.Dst=774]="Dst",t[t.OneMinusDst=775]="OneMinusDst",t[t.SrcAlpha=770]="SrcAlpha",t[t.OneMinusSrcAlpha=771]="OneMinusSrcAlpha",t[t.DstAlpha=772]="DstAlpha",t[t.OneMinusDstAlpha=773]="OneMinusDstAlpha"}(xh||(xh={})),function(t){t[t.Add=32774]="Add",t[t.Subtract=32778]="Subtract",t[t.ReverseSubtract=32779]="ReverseSubtract"}(Mh||(Mh={})),function(t){t[t.Clamp=0]="Clamp",t[t.Repeat=1]="Repeat",t[t.Mirror=2]="Mirror"}(Oh||(Oh={})),function(t){t[t.Point=0]="Point",t[t.Bilinear=1]="Bilinear"}(Ch||(Ch={})),function(t){t[t.NoMip=0]="NoMip",t[t.Nearest=1]="Nearest",t[t.Linear=2]="Linear"}(Nh||(Nh={})),function(t){t[t.Points=0]="Points",t[t.Triangles=1]="Triangles",t[t.TriangleStrip=2]="TriangleStrip",t[t.Lines=3]="Lines",t[t.LineStrip=4]="LineStrip"}(Ph||(Ph={})),function(t){t[t.MAP_READ=1]="MAP_READ",t[t.MAP_WRITE=2]="MAP_WRITE",t[t.COPY_SRC=4]="COPY_SRC",t[t.COPY_DST=8]="COPY_DST",t[t.INDEX=16]="INDEX",t[t.VERTEX=32]="VERTEX",t[t.UNIFORM=64]="UNIFORM",t[t.STORAGE=128]="STORAGE",t[t.INDIRECT=256]="INDIRECT",t[t.QUERY_RESOLVE=512]="QUERY_RESOLVE"}(Ih||(Ih={})),function(t){t[t.Static=1]="Static",t[t.Dynamic=2]="Dynamic"}(wh||(wh={})),function(t){t[t.PerVertex=1]="PerVertex",t[t.PerInstance=2]="PerInstance"}(Dh||(Dh={})),function(t){t.LOADED="loaded"}(Lh||(Lh={})),function(t){t[t.n2D=0]="n2D",t[t.n2DArray=1]="n2DArray",t[t.n3D=2]="n3D",t[t.Cube=3]="Cube"}(Bh||(Bh={})),function(t){t[t.Sampled=1]="Sampled",t[t.RenderTarget=2]="RenderTarget"}(Fh||(Fh={})),function(t){t[t.None=0]="None",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Blue=4]="Blue",t[t.Alpha=8]="Alpha",t[t.RGB=7]="RGB",t[t.AllChannels=15]="AllChannels"}(kh||(kh={})),function(t){t[t.Keep=7680]="Keep",t[t.Zero=0]="Zero",t[t.Replace=7681]="Replace",t[t.Invert=5386]="Invert",t[t.IncrementClamp=7682]="IncrementClamp",t[t.DecrementClamp=7683]="DecrementClamp",t[t.IncrementWrap=34055]="IncrementWrap",t[t.DecrementWrap=34056]="DecrementWrap"}(Uh||(Uh={})),function(t){t[t.Float=0]="Float",t[t.Uint=1]="Uint",t[t.Sint=2]="Sint",t[t.Depth=3]="Depth"}(Gh||(Gh={})),function(t){t[t.LowerLeft=0]="LowerLeft",t[t.UpperLeft=1]="UpperLeft"}(Vh||(Vh={})),function(t){t[t.NegativeOne=0]="NegativeOne",t[t.Zero=1]="Zero"}(jh||(jh={})),function(t){t[t.OcclusionConservative=0]="OcclusionConservative"}(Wh||(Wh={})),function(t){t[t.U8=1]="U8",t[t.U16=2]="U16",t[t.U32=3]="U32",t[t.S8=4]="S8",t[t.S16=5]="S16",t[t.S32=6]="S32",t[t.F16=7]="F16",t[t.F32=8]="F32",t[t.BC1=65]="BC1",t[t.BC2=66]="BC2",t[t.BC3=67]="BC3",t[t.BC4_UNORM=68]="BC4_UNORM",t[t.BC4_SNORM=69]="BC4_SNORM",t[t.BC5_UNORM=70]="BC5_UNORM",t[t.BC5_SNORM=71]="BC5_SNORM",t[t.U16_PACKED_5551=97]="U16_PACKED_5551",t[t.D24=129]="D24",t[t.D32F=130]="D32F",t[t.D24S8=131]="D24S8",t[t.D32FS8=132]="D32FS8"}(Xh||(Xh={})),function(t){t[t.R=1]="R",t[t.RG=2]="RG",t[t.RGB=3]="RGB",t[t.RGBA=4]="RGBA",t[t.A=5]="A"}(Hh||(Hh={})),function(t){t[t.None=0]="None",t[t.Normalized=1]="Normalized",t[t.sRGB=2]="sRGB",t[t.Depth=4]="Depth",t[t.Stencil=8]="Stencil",t[t.RenderTarget=16]="RenderTarget"}(Yh||(Yh={})),function(t){t[t.ALPHA=Zh(Xh.U8,Hh.A,Yh.None)]="ALPHA",t[t.F16_R=Zh(Xh.F16,Hh.R,Yh.None)]="F16_R",t[t.F16_RG=Zh(Xh.F16,Hh.RG,Yh.None)]="F16_RG",t[t.F16_RGB=Zh(Xh.F16,Hh.RGB,Yh.None)]="F16_RGB",t[t.F16_RGBA=Zh(Xh.F16,Hh.RGBA,Yh.None)]="F16_RGBA",t[t.F32_R=Zh(Xh.F32,Hh.R,Yh.None)]="F32_R",t[t.F32_RG=Zh(Xh.F32,Hh.RG,Yh.None)]="F32_RG",t[t.F32_RGB=Zh(Xh.F32,Hh.RGB,Yh.None)]="F32_RGB",t[t.F32_RGBA=Zh(Xh.F32,Hh.RGBA,Yh.None)]="F32_RGBA",t[t.U8_R=Zh(Xh.U8,Hh.R,Yh.None)]="U8_R",t[t.U8_R_NORM=Zh(Xh.U8,Hh.R,Yh.Normalized)]="U8_R_NORM",t[t.U8_RG=Zh(Xh.U8,Hh.RG,Yh.None)]="U8_RG",t[t.U8_RG_NORM=Zh(Xh.U8,Hh.RG,Yh.Normalized)]="U8_RG_NORM",t[t.U8_RGB=Zh(Xh.U8,Hh.RGB,Yh.None)]="U8_RGB",t[t.U8_RGB_NORM=Zh(Xh.U8,Hh.RGB,Yh.Normalized)]="U8_RGB_NORM",t[t.U8_RGB_SRGB=Zh(Xh.U8,Hh.RGB,Yh.sRGB|Yh.Normalized)]="U8_RGB_SRGB",t[t.U8_RGBA=Zh(Xh.U8,Hh.RGBA,Yh.None)]="U8_RGBA",t[t.U8_RGBA_NORM=Zh(Xh.U8,Hh.RGBA,Yh.Normalized)]="U8_RGBA_NORM",t[t.U8_RGBA_SRGB=Zh(Xh.U8,Hh.RGBA,Yh.sRGB|Yh.Normalized)]="U8_RGBA_SRGB",t[t.U16_R=Zh(Xh.U16,Hh.R,Yh.None)]="U16_R",t[t.U16_R_NORM=Zh(Xh.U16,Hh.R,Yh.Normalized)]="U16_R_NORM",t[t.U16_RG_NORM=Zh(Xh.U16,Hh.RG,Yh.Normalized)]="U16_RG_NORM",t[t.U16_RGBA_NORM=Zh(Xh.U16,Hh.RGBA,Yh.Normalized)]="U16_RGBA_NORM",t[t.U16_RGB=Zh(Xh.U16,Hh.RGB,Yh.None)]="U16_RGB",t[t.U32_R=Zh(Xh.U32,Hh.R,Yh.None)]="U32_R",t[t.U32_RG=Zh(Xh.U32,Hh.RG,Yh.None)]="U32_RG",t[t.S8_R=Zh(Xh.S8,Hh.R,Yh.None)]="S8_R",t[t.S8_R_NORM=Zh(Xh.S8,Hh.R,Yh.Normalized)]="S8_R_NORM",t[t.S8_RG_NORM=Zh(Xh.S8,Hh.RG,Yh.Normalized)]="S8_RG_NORM",t[t.S8_RGB_NORM=Zh(Xh.S8,Hh.RGB,Yh.Normalized)]="S8_RGB_NORM",t[t.S8_RGBA_NORM=Zh(Xh.S8,Hh.RGBA,Yh.Normalized)]="S8_RGBA_NORM",t[t.S16_R=Zh(Xh.S16,Hh.R,Yh.None)]="S16_R",t[t.S16_RG=Zh(Xh.S16,Hh.RG,Yh.None)]="S16_RG",t[t.S16_RG_NORM=Zh(Xh.S16,Hh.RG,Yh.Normalized)]="S16_RG_NORM",t[t.S16_RGB_NORM=Zh(Xh.S16,Hh.RGB,Yh.Normalized)]="S16_RGB_NORM",t[t.S16_RGBA=Zh(Xh.S16,Hh.RGBA,Yh.None)]="S16_RGBA",t[t.S16_RGBA_NORM=Zh(Xh.S16,Hh.RGBA,Yh.Normalized)]="S16_RGBA_NORM",t[t.S32_R=Zh(Xh.S32,Hh.R,Yh.None)]="S32_R",t[t.U16_RGBA_5551=Zh(Xh.U16_PACKED_5551,Hh.RGBA,Yh.Normalized)]="U16_RGBA_5551",t[t.BC1=Zh(Xh.BC1,Hh.RGBA,Yh.Normalized)]="BC1",t[t.BC1_SRGB=Zh(Xh.BC1,Hh.RGBA,Yh.Normalized|Yh.sRGB)]="BC1_SRGB",t[t.BC2=Zh(Xh.BC2,Hh.RGBA,Yh.Normalized)]="BC2",t[t.BC2_SRGB=Zh(Xh.BC2,Hh.RGBA,Yh.Normalized|Yh.sRGB)]="BC2_SRGB",t[t.BC3=Zh(Xh.BC3,Hh.RGBA,Yh.Normalized)]="BC3",t[t.BC3_SRGB=Zh(Xh.BC3,Hh.RGBA,Yh.Normalized|Yh.sRGB)]="BC3_SRGB",t[t.BC4_UNORM=Zh(Xh.BC4_UNORM,Hh.R,Yh.Normalized)]="BC4_UNORM",t[t.BC4_SNORM=Zh(Xh.BC4_SNORM,Hh.R,Yh.Normalized)]="BC4_SNORM",t[t.BC5_UNORM=Zh(Xh.BC5_UNORM,Hh.RG,Yh.Normalized)]="BC5_UNORM",t[t.BC5_SNORM=Zh(Xh.BC5_SNORM,Hh.RG,Yh.Normalized)]="BC5_SNORM",t[t.D24=Zh(Xh.D24,Hh.R,Yh.Depth)]="D24",t[t.D24_S8=Zh(Xh.D24S8,Hh.RG,Yh.Depth|Yh.Stencil)]="D24_S8",t[t.D32F=Zh(Xh.D32F,Hh.R,Yh.Depth)]="D32F",t[t.D32F_S8=Zh(Xh.D32FS8,Hh.RG,Yh.Depth|Yh.Stencil)]="D32F_S8",t[t.U8_RGB_RT=Zh(Xh.U8,Hh.RGB,Yh.RenderTarget|Yh.Normalized)]="U8_RGB_RT",t[t.U8_RGBA_RT=Zh(Xh.U8,Hh.RGBA,Yh.RenderTarget|Yh.Normalized)]="U8_RGBA_RT",t[t.U8_RGBA_RT_SRGB=Zh(Xh.U8,Hh.RGBA,Yh.RenderTarget|Yh.Normalized|Yh.sRGB)]="U8_RGBA_RT_SRGB"}(zh||(zh={})),function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.ALWAYS=519]="ALWAYS",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.GEQUAL=518]="GEQUAL",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",t[t.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",t[t.RGBA32F_EXT=34836]="RGBA32F_EXT",t[t.RGB32F_EXT=34837]="RGB32F_EXT",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",t[t.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",t[t.MIN_EXT=32775]="MIN_EXT",t[t.MAX_EXT=32776]="MAX_EXT",t[t.SRGB_EXT=35904]="SRGB_EXT",t[t.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",t[t.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",t[t.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",t[t.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",t[t.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",t[t.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",t[t.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",t[t.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",t[t.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",t[t.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",t[t.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",t[t.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",t[t.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",t[t.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",t[t.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",t[t.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",t[t.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",t[t.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",t[t.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",t[t.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",t[t.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",t[t.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",t[t.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",t[t.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",t[t.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",t[t.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",t[t.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",t[t.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",t[t.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",t[t.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",t[t.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",t[t.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",t[t.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",t[t.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",t[t.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",t[t.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",t[t.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"}(Kh||(Kh={}));var sd=ad(0,0,0,0),ud=ad(0,0,0,1),cd=(ad(1,1,1,0),ad(1,1,1,1));function ld(t){return t&&0==(t&t-1)}function fd(t,e){return null!=t?t:e}function hd(t){return void 0===t?null:t}function dd(t,e,n){t.length=e,t.fill(n)}function pd(t,e){return((t+e-1)/e|0)*e}function vd(t,e,n){return n?t|=e:t&=~e,t}function gd(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e();return n}function md(t,e){t.blendDstFactor=e.blendDstFactor,t.blendSrcFactor=e.blendSrcFactor,t.blendMode=e.blendMode}function yd(t,e){return void 0===t&&(t={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),md(t.rgbBlendState,e.rgbBlendState),md(t.alphaBlendState,e.alphaBlendState),t.channelWriteMask=e.channelWriteMask,t}function _d(t,e){t.length!==e.length&&(t.length=e.length);for(var n=0;n<e.length;n++)t[n]=yd(t[n],e[n])}function Ed(t,e){void 0!==e.attachmentsState&&_d(t.attachmentsState,e.attachmentsState),void 0!==e.blendConstant&&id(t.blendConstant,e.blendConstant),t.depthCompare=fd(e.depthCompare,t.depthCompare),t.depthWrite=fd(e.depthWrite,t.depthWrite),t.stencilCompare=fd(e.stencilCompare,t.stencilCompare),t.stencilWrite=fd(e.stencilWrite,t.stencilWrite),t.stencilPassOp=fd(e.stencilPassOp,t.stencilPassOp),t.stencilRef=fd(e.stencilRef,t.stencilRef),t.cullMode=fd(e.cullMode,t.cullMode),t.frontFace=fd(e.frontFace,t.frontFace),t.polygonOffset=fd(e.polygonOffset,t.polygonOffset)}function Td(t){var e=Object.assign({},t);return e.attachmentsState=[],_d(e.attachmentsState,t.attachmentsState),e.blendConstant=od(e.blendConstant),e}var Rd={blendMode:Mh.Add,blendSrcFactor:xh.One,blendDstFactor:xh.Zero},Ad={attachmentsState:[{channelWriteMask:kh.RGB,rgbBlendState:Rd,alphaBlendState:Rd}],blendConstant:od(sd),depthWrite:!0,depthCompare:Ah.LessEqual,stencilCompare:Ah.Always,stencilWrite:!1,stencilPassOp:Uh.Keep,stencilRef:0,cullMode:bh.None,frontFace:Sh.CCW,polygonOffset:!1};!function(t,e){void 0===t&&(t=null),void 0===e&&(e=Ad);var n=Td(e);null!==t&&Ed(n,t)}({depthCompare:Ah.Always,depthWrite:!1},Ad);function Sd(t,e){return void 0===t.attachmentsState&&(t.attachmentsState=[],_d(t.attachmentsState,Ad.attachmentsState)),function(t,e){void 0!==e.channelWriteMask&&(t.channelWriteMask=e.channelWriteMask),void 0!==e.rgbBlendMode&&(t.rgbBlendState.blendMode=e.rgbBlendMode),void 0!==e.alphaBlendMode&&(t.alphaBlendState.blendMode=e.alphaBlendMode),void 0!==e.rgbBlendSrcFactor&&(t.rgbBlendState.blendSrcFactor=e.rgbBlendSrcFactor),void 0!==e.alphaBlendSrcFactor&&(t.alphaBlendState.blendSrcFactor=e.alphaBlendSrcFactor),void 0!==e.rgbBlendDstFactor&&(t.rgbBlendState.blendDstFactor=e.rgbBlendDstFactor),void 0!==e.alphaBlendDstFactor&&(t.alphaBlendState.blendDstFactor=e.alphaBlendDstFactor)}(t.attachmentsState[0],e),t}var bd,xd={formatKind:Gh.Float,dimension:Bh.n2D};function Md(t,e,n){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!n(t[r],e[r]))return!1;return!0}function Od(t,e){for(var n=Array(t.length),r=0;r<t.length;r++)n[r]=e(t[r]);return n}function Cd(t,e){return t.buffer===e.buffer&&t.wordCount===e.wordCount}function Nd(t,e){return null===t?null===e:null!==e&&(t.sampler===e.sampler&&t.texture===e.texture)}function Pd(t,e){return t.samplerBindings.length===e.samplerBindings.length&&(!!Md(t.samplerBindings,e.samplerBindings,Nd)&&(!!Md(t.uniformBufferBindings,e.uniformBufferBindings,Cd)&&!!Dd(t.bindingLayout,e.bindingLayout)))}function Id(t,e){return t.blendMode==e.blendMode&&t.blendSrcFactor===e.blendSrcFactor&&t.blendDstFactor===e.blendDstFactor}function wd(t,e){return!!Id(t.rgbBlendState,e.rgbBlendState)&&(!!Id(t.alphaBlendState,e.alphaBlendState)&&t.channelWriteMask===e.channelWriteMask)}function Dd(t,e){return t.numSamplers===e.numSamplers&&t.numUniformBuffers===e.numUniformBuffers}function Ld(t,e){return t===e}function Bd(t,e){return t.topology===e.topology&&(t.inputLayout===e.inputLayout&&(t.sampleCount===e.sampleCount&&(!!function(t,e){return!!Md(t.attachmentsState,e.attachmentsState,wd)&&(!!rd(t.blendConstant,e.blendConstant)&&(t.depthCompare===e.depthCompare&&t.depthWrite===e.depthWrite&&t.stencilCompare===e.stencilCompare&&t.stencilWrite===e.stencilWrite&&t.stencilPassOp===e.stencilPassOp&&t.stencilRef===e.stencilRef&&t.cullMode===e.cullMode&&t.frontFace===e.frontFace&&t.polygonOffset===e.polygonOffset))}(t.megaStateDescriptor,e.megaStateDescriptor)&&(!!function(t,e){return t.id===e.id}(t.program,e.program)&&(!!Md(t.bindingLayouts,e.bindingLayouts,Dd)&&(!!Md(t.colorAttachmentFormats,e.colorAttachmentFormats,Ld)&&t.depthStencilAttachmentFormat===e.depthStencilAttachmentFormat))))))}function Fd(t,e){return t.bufferIndex===e.bufferIndex&&t.bufferByteOffset===e.bufferByteOffset&&t.location===e.location&&t.format===e.format}function kd(t,e){return bf(t)?bf(e):!bf(e)&&(t.byteStride===e.byteStride&&t.frequency===e.frequency)}function Ud(t,e){return t.indexBufferFormat===e.indexBufferFormat&&(!!Md(t.vertexBufferDescriptors,e.vertexBufferDescriptors,kd)&&!!Md(t.vertexAttributeDescriptors,e.vertexAttributeDescriptors,Fd))}function Gd(t,e){return t.wrapS===e.wrapS&&t.wrapT===e.wrapT&&t.minFilter===e.minFilter&&t.magFilter===e.magFilter&&t.mipFilter===e.mipFilter&&t.minLOD===e.minLOD&&t.maxLOD===e.maxLOD&&t.maxAnisotropy===e.maxAnisotropy&&t.compareMode===e.compareMode}function Vd(t){return{sampler:t.sampler,texture:t.texture,lateBinding:t.lateBinding}}function jd(t){return{buffer:t.buffer,wordCount:t.wordCount}}function Wd(t){return{dimension:t.dimension,formatKind:t.formatKind}}function Xd(t){return{numSamplers:t.numSamplers,numUniformBuffers:t.numUniformBuffers,samplerEntries:void 0!==t.samplerEntries?Od(t.samplerEntries,Wd):void 0}}function Hd(t){return{location:t.location,format:t.format,bufferIndex:t.bufferIndex,bufferByteOffset:t.bufferByteOffset,byteStride:t.byteStride,divisor:t.divisor}}function Yd(t){return bf(t)?t:{byteStride:t.byteStride,frequency:t.frequency}}!function(t){t[t.LITTLE_ENDIAN=0]="LITTLE_ENDIAN",t[t.BIG_ENDIAN=1]="BIG_ENDIAN"}(bd||(bd={}));var zd,Kd=new Uint16Array([65279]);255==new DataView(Kd.buffer).getUint8(0)?bd.LITTLE_ENDIAN:bd.BIG_ENDIAN;var qd=/([^[]*)(\[[0-9]+\])?/;function Zd(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};var e=t.match(qd);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name "+t);return{name:e[1],length:Number(e[2])||1,isArray:Boolean(e[2])}}function Qd(){var t=null;return function(e,n,r){var i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Jd(t,e,n,r){var i=null,o=null;return function(a,s,u){var c=e(u,n),l=c.length,f=!1;if(null===i)i=new Float32Array(l),o=l,f=!0;else{ed(o===l,"Uniform length cannot change.");for(var h=0;h<l;++h)if(c[h]!==i[h]){f=!0;break}}return f&&(r(a,t,s,c),i.set(c)),f}}function $d(t,e,n,r){t[e](n,r)}function tp(t,e,n,r){t[e](n,!1,r)}var ep={},np={},rp={},ip=[0];function op(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(ip[0]=t,t=ip);var i=t.length;if(t instanceof n)return t;var o=r[i];o||(o=new n(i),r[i]=o);for(var a=0;a<i;a++)o[a]=t[a];return o}function ap(t,e){return op(t,e,Float32Array,ep)}function sp(t,e){return op(t,e,Int32Array,np)}function up(t,e){return op(t,e,Uint32Array,rp)}var cp,lp=((zd={})[Kh.FLOAT]=Jd.bind(null,"uniform1fv",ap,1,$d),zd[Kh.FLOAT_VEC2]=Jd.bind(null,"uniform2fv",ap,2,$d),zd[Kh.FLOAT_VEC3]=Jd.bind(null,"uniform3fv",ap,3,$d),zd[Kh.FLOAT_VEC4]=Jd.bind(null,"uniform4fv",ap,4,$d),zd[Kh.INT]=Jd.bind(null,"uniform1iv",sp,1,$d),zd[Kh.INT_VEC2]=Jd.bind(null,"uniform2iv",sp,2,$d),zd[Kh.INT_VEC3]=Jd.bind(null,"uniform3iv",sp,3,$d),zd[Kh.INT_VEC4]=Jd.bind(null,"uniform4iv",sp,4,$d),zd[Kh.BOOL]=Jd.bind(null,"uniform1iv",sp,1,$d),zd[Kh.BOOL_VEC2]=Jd.bind(null,"uniform2iv",sp,2,$d),zd[Kh.BOOL_VEC3]=Jd.bind(null,"uniform3iv",sp,3,$d),zd[Kh.BOOL_VEC4]=Jd.bind(null,"uniform4iv",sp,4,$d),zd[Kh.FLOAT_MAT2]=Jd.bind(null,"uniformMatrix2fv",ap,4,tp),zd[Kh.FLOAT_MAT3]=Jd.bind(null,"uniformMatrix3fv",ap,9,tp),zd[Kh.FLOAT_MAT4]=Jd.bind(null,"uniformMatrix4fv",ap,16,tp),zd[Kh.SAMPLER_2D]=Qd,zd[Kh.SAMPLER_CUBE]=Qd,zd[Kh.UNSIGNED_INT]=Jd.bind(null,"uniform1uiv",up,1,$d),zd[Kh.UNSIGNED_INT_VEC2]=Jd.bind(null,"uniform2uiv",up,2,$d),zd[Kh.UNSIGNED_INT_VEC3]=Jd.bind(null,"uniform3uiv",up,3,$d),zd[Kh.UNSIGNED_INT_VEC4]=Jd.bind(null,"uniform4uiv",up,4,$d),zd[Kh.FLOAT_MAT2x3]=Jd.bind(null,"uniformMatrix2x3fv",ap,6,tp),zd[Kh.FLOAT_MAT2x4]=Jd.bind(null,"uniformMatrix2x4fv",ap,8,tp),zd[Kh.FLOAT_MAT3x2]=Jd.bind(null,"uniformMatrix3x2fv",ap,6,tp),zd[Kh.FLOAT_MAT3x4]=Jd.bind(null,"uniformMatrix3x4fv",ap,12,tp),zd[Kh.FLOAT_MAT4x2]=Jd.bind(null,"uniformMatrix4x2fv",ap,8,tp),zd[Kh.FLOAT_MAT4x3]=Jd.bind(null,"uniformMatrix4x3fv",ap,12,tp),zd[Kh.SAMPLER_2D]=Qd,zd[Kh.SAMPLER_CUBE]=Qd,zd[Kh.SAMPLER_3D]=Qd,zd[Kh.SAMPLER_2D_SHADOW]=Qd,zd[Kh.SAMPLER_2D_ARRAY]=Qd,zd[Kh.SAMPLER_2D_ARRAY_SHADOW]=Qd,zd[Kh.SAMPLER_CUBE_SHADOW]=Qd,zd[Kh.INT_SAMPLER_2D]=Qd,zd[Kh.INT_SAMPLER_3D]=Qd,zd[Kh.INT_SAMPLER_CUBE]=Qd,zd[Kh.INT_SAMPLER_2D_ARRAY]=Qd,zd[Kh.UNSIGNED_INT_SAMPLER_2D]=Qd,zd[Kh.UNSIGNED_INT_SAMPLER_3D]=Qd,zd[Kh.UNSIGNED_INT_SAMPLER_CUBE]=Qd,zd[Kh.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Qd,zd);function fp(t,e,n){var r=lp[n.type];if(!r)throw new Error("Unknown GLSL uniform type "+n.type);return r().bind(null,t,e)}function hp(t,e,n){var r,i,o,a=t.createBuffer({viewOrSize:(r=n.byteLength,i=4,o=i-1,(r+o&~o)/4),usage:e,hint:wh.Static});return a.setSubData(0,new Uint8Array(n)),a}!function(t){t.CHANGED="changed"}(cp||(cp={}));var dp,pp=function(t){function e(e,n){var r;return void 0===n&&(n={}),(r=t.call(this)||this).device=void 0,r.props=void 0,r.drawMode=Ph.Triangles,r.vertexBuffers=[],r.vertices=[],r.indexBuffer=void 0,r.indices=void 0,r.inputLayoutDescriptor={vertexBufferDescriptors:[],vertexAttributeDescriptors:[],indexBufferFormat:zh.U32_R},r.vertexCount=0,r.instancedCount=0,r.indexStart=0,r.primitiveStart=0,r.dirty=!0,r.meshes=[],r.device=e,r.props=n,r}uh(e,t);var n=e.prototype;return n.validate=function(t){return!0},n.build=function(t){},n.computeBoundingBox=function(){return new lu},n.setIndexBuffer=function(t){return this.indexBuffer&&this.indexBuffer.destroy(),this.indexBuffer=hp(this.device,Ih.INDEX|Ih.COPY_DST,new Uint32Array(ArrayBuffer.isView(t)?t.buffer:t).buffer),this.indices=t,this},n.setVertexBuffer=function(t){var e=this,n=t.bufferIndex,r=t.byteStride,i=t.frequency,o=t.attributes,a=t.data;this.inputLayoutDescriptor.vertexBufferDescriptors[n]={byteStride:r,frequency:i},this.vertices[n]=a,o.forEach((function(t){var r=t.format,i=t.bufferByteOffset,o=t.location,a=t.divisor,s=t.byteStride,u=e.inputLayoutDescriptor.vertexAttributeDescriptors.find((function(t){return t.bufferIndex===n&&t.location===o}));u?(u.format=r,u.bufferByteOffset=i,u.byteStride=s,u.divisor=a):e.inputLayoutDescriptor.vertexAttributeDescriptors.push({format:r,bufferIndex:n,bufferByteOffset:i,location:o,byteStride:s,divisor:a})})),this.vertexBuffers[n]&&this.vertexBuffers[n].destroy();var s=hp(this.device,Ih.VERTEX|Ih.COPY_DST,a.buffer);return this.vertexBuffers[n]=s,this},n.getVertexBuffer=function(t){return this.vertexBuffers[t]},n.updateVertexBuffer=function(t,e,n,r){var i=this.inputLayoutDescriptor.vertexBufferDescriptors[t].byteStride,o=this.inputLayoutDescriptor.vertexAttributeDescriptors.find((function(t){return t.location===e}));if(o){var a=n*i;this.getVertexBuffer(t).setSubData(o.bufferByteOffset+a,r)}this.emit(cp.CHANGED)},n.updateIndices=function(t,e){return void 0===e&&(e=0),this.indexBuffer&&this.indexBuffer.setSubData(e,ArrayBuffer.isView(t)?t:new Uint32Array(t)),this},n.destroy=function(){this.vertexBuffers.forEach((function(t){t&&t.destroy()})),this.indexBuffer&&this.indexBuffer.destroy(),this.inputLayoutDescriptor.vertexAttributeDescriptors=[],this.inputLayoutDescriptor.vertexBufferDescriptors=[],this.indexBuffer=void 0,this.vertexBuffers=[],this.indices=void 0,this.vertices=[],this.vertexCount=0,this.instancedCount=0},e}(Xo.EventEmitter),vp=[[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]];function gp(t,e){return"#define "+t+" "+e}function mp(t,e,n,r,i){void 0===r&&(r=null);var o="#version 100"===t.glslVersion,a=n.split("\n").map((function(t){return t.replace(/[/][/].*$/,"")})).filter((function(t){return!(!t||/^\s+$/.test(t))})),s="";null!==r&&(s=Object.keys(r).map((function(t){return gp(t,r[t])})).join("\n"));var u=a.find((function(t){return t.startsWith("precision")}))||"precision mediump float;",c=a.filter((function(t){return!t.startsWith("precision")})).join("\n"),l="";if(t.viewportOrigin===Vh.UpperLeft&&(l+=gp("VIEWPORT_ORIGIN_TL","1")+"\n"),t.clipSpaceNearZ===jh.Zero&&(l+=gp("CLIPSPACE_NEAR_ZERO","1")+"\n"),t.explicitBindingLocations){var f=0,h=0,d=0;c=c.replace(/^(layout\((.*)\))?\s*uniform(.+{)$/gm,(function(t,e,n,r){return"layout("+(n?n+", ":"")+"set = "+f+", binding = "+h+++") uniform "+r})),f++,h=0,ed(t.separateSamplerTextures),c=(c=c.replace(/uniform sampler2D (.*);/g,(function(t,n){return"frag"===e?"\nlayout(set = "+f+", binding = "+h+++") uniform texture2D T_"+n+";\nlayout(set = "+f+", binding = "+h+++") uniform sampler S_"+n+";\n":""}))).replace("frag"===e?/^\b(varying|in)\b/gm:/^\b(varying|out)\b/gm,(function(t,e){return"layout(location = "+d+++") "+e})),l+=gp("gl_VertexID","gl_VertexIndex")+"\n"}c=t.separateSamplerTextures?(c=(c=(c=c.replace(/\bPD_SAMPLER_2D\((.*?)\)/g,(function(t,e){return"texture2D T_P_"+e+", sampler S_P_"+e}))).replace(/\bPU_SAMPLER_2D\((.*?)\)/g,(function(t,e){return"SAMPLER_2D(P_"+e+")"}))).replace(/\bPP_SAMPLER_2D\((.*?)\)/g,(function(t,e){return"T_"+e+", S_"+e}))).replace(/\bSAMPLER_2D\((.*?)\)/g,(function(t,e){return"sampler2D(T_"+e+", S_"+e+")"})):(c=(c=(c=c.replace(/\bPD_SAMPLER_2D\((.*?)\)/g,(function(t,e){return"sampler2D P_"+e}))).replace(/\bPU_SAMPLER_2D\((.*?)\)/g,(function(t,e){return"SAMPLER_2D(P_"+e+")"}))).replace(/\bPP_SAMPLER_2D\((.*?)\)/g,(function(t,e){return e}))).replace(/\bSAMPLER_2D\((.*?)\)/g,(function(t,e){return e}));var p=((o?"":t.glslVersion)+"\n\n"+(o&&"frag"===e?"#extension GL_OES_standard_derivatives : enable":"")+"\n"+u+"\n"+l+"\n"+s+"\n"+c+"\n").trim();if(t.explicitBindingLocations&&"frag"===e&&(p=p.replace(/^\b(out)\b/gm,(function(t,e){return"layout(location = 0) "+e}))),o){if("frag"===e&&(p=p.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,(function(t,e,n){return"varying "+e+" "+n+";\n"}))),"vert"===e&&(p=(p=p.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(function(t,e,n){return"varying "+e+" "+n+";\n"}))).replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,(function(t,e,n){return"attribute "+e+" "+n+";\n"}))),p=p.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,(function(t,e){return e.trim().replace(/^.*$/gm,(function(t){var e=t.trim();return e.startsWith("#")?e:t?"uniform "+e:""}))})),"frag"===e){var v,g=(p=p.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(function(t,e,n){return v=n,e+" "+n+";\n"}))).lastIndexOf("}");p=p.substring(0,g)+"\n  gl_FragColor = vec4("+v+");\n"+p.substring(g)}p=p.replace(/^\s*layout\((.*)\)/gm,"");for(var m,y=hh(vp);!(m=y()).done;){var _=m.value,E=_[0],T=_[1];p=p.replace(E,T)}}return p}function yp(t,e){var n=void 0!==e.defines?e.defines:null,r=(void 0!==e.features&&e.features,void 0!==e.both?e.both+e.vert:e.vert),i=void 0!==e.both?e.both+e.frag:e.frag;return function(t,e,n,r,i){return void 0===r&&(r=null),{vert:e,frag:n,preprocessedVert:mp(t,"vert",e,r),preprocessedFrag:mp(t,"frag",n,r)}}(t.queryVendorInfo(),r,i,n)}!function(t){t.CHANGED="changed"}(dp||(dp={}));var _p=function(t){function e(e,n){var r;return(r=t.call(this,e,sh({},n))||this).defines=sh({},r.defines,{USE_UV:!1,USE_MAP:!1,USE_WIREFRAME:!1,USE_FOG:!1,USE_LIGHT:!1}),r}return uh(e,t),e}(function(t){function e(e,n){var r;(r=t.call(this)||this).device=void 0,r.props={},r.meshes=[],r.defines={},r.uniforms={},r.uniformNames=void 0,r.uboBuffer=[],r.textures={},r.samplers=[],r.programDirty=!0,r.textureDirty=!0,r.geometryDirty=!0;var i=Td(Ad),o=i.cullMode,a=i.depthCompare,s=i.depthWrite,u=i.stencilCompare,c=i.stencilWrite,l=i.stencilPassOp,f=i.frontFace,h=i.polygonOffset,d=i.attachmentsState;return r.device=e,r.props=sh({cullMode:o,depthTest:!0,depthCompare:a,depthWrite:s,stencilCompare:u,stencilWrite:c,stencilPassOp:l,frontFace:f,polygonOffset:h,attachmentsState:d,dithering:!1,wireframe:!1,wireframeColor:"black",wireframeLineWidth:1,vertexShader:"",fragmentShader:""},n),r.compile(),r}uh(e,t);var n=e.prototype;return n.compile=function(){var t=this;this.props.fragmentShader.replace(/^\s*uniform\s*sampler2D\s*(.*)\s*;$/gm,(function(e,n){return t.samplers.push(n),""})),this.uniformNames=function(t){var e=[],n=[];return t.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,(function(t,e,r){var i=[];return r.trim().split("\n").forEach((function(t){var e=t.trim().split(/\s+/),n=e[0],r=e[1];i.push({type:n.trim(),name:r.replace(";","").trim()})})),n.push({type:e.trim(),uniforms:i}),""})),t.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,(function(t,r){return r.trim().split("\n").forEach((function(t){var r=t.trim().split(" "),i=r[0]||"",o=r[1]||"",a=o.indexOf("[")>-1;if(o=o.replace(";","").replace("[","").trim(),!i.startsWith("#")){if(i){var s=n.find((function(t){return i===t.type}));if(s)if(a)for(var u=function(t){s.uniforms.forEach((function(n){e.push(o+"["+t+"]."+n.name)}))},c=0;c<5;c++)u(c);else s.uniforms.forEach((function(t){e.push(o+"."+t.name)}))}o&&e.push(o)}})),""})),e}(this.props.fragmentShader)},n.setUniforms=function(t){var e=this,n=!1;Object.keys(t).forEach((function(r){var i,o=t[r],a=e.textures[r];a&&a!==o&&(e.textureDirty=!0),(i=o)&&i.type?(e.textures[r]=o,e.textureDirty=!0,o.on(Lh.LOADED,(function(){e.dispatchMutationEvent()}))):(e.uniforms[r]=o,n=!0),bf(t[r])&&(delete e.textures[r],delete e.uniforms[r])})),n&&this.dispatchMutationEvent()},n.dispatchMutationEvent=function(){this.emit(dp.CHANGED)},ah(e,[{key:"cullMode",get:function(){return this.props.cullMode},set:function(t){this.props.cullMode=t}},{key:"frontFace",get:function(){return this.props.frontFace},set:function(t){this.props.frontFace=t}},{key:"blendConstant",get:function(){return this.props.blendConstant},set:function(t){this.props.blendConstant=t}},{key:"blendEquation",get:function(){return this.props.blendEquation},set:function(t){this.props.blendEquation=t}},{key:"blendEquationAlpha",get:function(){return this.props.blendEquationAlpha},set:function(t){this.props.blendEquationAlpha=t}},{key:"blendSrc",get:function(){return this.props.blendSrc},set:function(t){this.props.blendSrc=t}},{key:"blendDst",get:function(){return this.props.blendDst},set:function(t){this.props.blendDst=t}},{key:"blendSrcAlpha",get:function(){return this.props.blendSrcAlpha},set:function(t){this.props.blendSrcAlpha=t}},{key:"blendDstAlpha",get:function(){return this.props.blendDstAlpha},set:function(t){this.props.blendDstAlpha=t}},{key:"depthCompare",get:function(){return this.props.depthCompare},set:function(t){this.props.depthCompare=t}},{key:"depthTest",get:function(){return this.props.depthTest},set:function(t){this.props.depthTest=t}},{key:"depthWrite",get:function(){return this.props.depthWrite},set:function(t){this.props.depthWrite=t}},{key:"stencilCompare",get:function(){return this.props.stencilCompare},set:function(t){this.props.stencilCompare=t}},{key:"stencilWrite",get:function(){return this.props.stencilWrite},set:function(t){this.props.stencilWrite=t}},{key:"stencilPassOp",get:function(){return this.props.stencilPassOp},set:function(t){this.props.stencilPassOp=t}},{key:"stencilRef",get:function(){return this.props.stencilRef},set:function(t){this.props.stencilRef=t}},{key:"polygonOffset",get:function(){return this.props.polygonOffset},set:function(t){this.props.polygonOffset=t}},{key:"dithering",get:function(){return this.props.dithering},set:function(t){this.props.dithering=t}},{key:"wireframe",get:function(){return this.props.wireframe},set:function(t){this.props.wireframe!==t&&(this.geometryDirty=!0,this.programDirty=!0,this.props.wireframe=t,this.dispatchMutationEvent()),this.defines.USE_WIREFRAME=!!t}},{key:"wireframeColor",get:function(){return this.props.wireframeColor},set:function(t){this.props.wireframeColor=t}},{key:"wireframeLineWidth",get:function(){return this.props.wireframeLineWidth},set:function(t){this.props.wireframeLineWidth=t}},{key:"vertexShader",get:function(){return this.props.vertexShader},set:function(t){this.props.vertexShader!==t&&(this.programDirty=!0,this.props.vertexShader=t,this.compile())}},{key:"fragmentShader",get:function(){return this.props.fragmentShader},set:function(t){this.props.fragmentShader!==t&&(this.programDirty=!0,this.props.fragmentShader=t,this.compile())}}]),e}(Xo.EventEmitter)),Ep=function(){function t(){this.name="(unnamed)",this.preprocessedVert="",this.preprocessedFrag="",this.both="",this.vert="",this.frag="",this.defines={},this.features={MRT:!0}}var e=t.prototype;return e.definesChanged=function(){this.preprocessedVert="",this.preprocessedFrag=""},e.setDefineString=function(t,e){if(null!==e){if(this.defines[t]===e)return!1;this.defines[t]=e}else{if(bf(this.defines[t]))return!1;delete this.defines[t]}return this.definesChanged(),!0},e.setDefineBool=function(t,e){return this.setDefineString(t,e?"1":null)},e.getDefineString=function(t){return hd(this.defines[t])},e.getDefineBool=function(t){var e=this.getDefineString(t);return null!==e&&ed("1"===e),null!==e},e.ensurePreprocessed=function(t){""===this.preprocessedVert&&(this.preprocessedVert=mp(t,"vert",this.both+this.vert,this.defines,this.features),this.preprocessedFrag=mp(t,"frag",this.both+this.frag,this.defines,this.features))},t}(),Tp=function(){function t(t){this.device=void 0,this.uniformBufferWordAlignment=void 0,this.uniformBufferMaxPageWordSize=void 0,this.currentBufferWordSize=-1,this.currentWordOffset=0,this.buffer=null,this.shadowBufferF32=null,this.shadowBufferU8=null,this.device=t;var e=t.queryLimits();this.uniformBufferWordAlignment=e.uniformBufferWordAlignment,this.uniformBufferMaxPageWordSize=e.uniformBufferMaxPageWordSize}var e=t.prototype;return e.isSupportedUBO=function(){return"WebGL1"!==this.device.queryVendorInfo().platformString},e.findPageIndex=function(t){return t/this.uniformBufferMaxPageWordSize|0},e.allocateChunk=function(t){ed((t=pd(t,this.uniformBufferWordAlignment))<this.uniformBufferMaxPageWordSize);var e=this.currentWordOffset;return this.findPageIndex(e)!==this.findPageIndex(e+t-1)&&(e=pd(e,this.uniformBufferMaxPageWordSize)),this.currentWordOffset=e+t,this.ensureShadowBuffer(e,t),e},e.ensureShadowBuffer=function(t,e){if(null===this.shadowBufferU8||null===this.shadowBufferF32){var n=pd(this.currentWordOffset,this.uniformBufferMaxPageWordSize);this.shadowBufferU8=new Uint8Array(4*n),this.shadowBufferF32=new Float32Array(this.shadowBufferU8.buffer)}else if(t+e>=this.shadowBufferF32.length){ed(t<this.currentWordOffset&&t+e<=this.currentWordOffset);var r=pd(Math.max(this.currentWordOffset,2*this.shadowBufferF32.length),this.uniformBufferMaxPageWordSize),i=new Uint8Array(4*r);if(i.set(this.shadowBufferU8,0),this.shadowBufferU8=i,this.shadowBufferF32=new Float32Array(this.shadowBufferU8.buffer),!(this.currentWordOffset<=r))throw new Error("Assert fail: this.currentWordOffset ["+this.currentWordOffset+"] <= newWordCount ["+r+"]")}},e.mapBufferF32=function(){return nd(this.shadowBufferF32)},e.prepareToRender=function(){if(null!==this.shadowBufferF32){var t=nd(this.shadowBufferF32);t.length!==this.currentBufferWordSize&&(this.currentBufferWordSize=t.length,null!==this.buffer&&this.buffer.destroy(),this.buffer=this.device.createBuffer({viewOrSize:this.currentBufferWordSize,usage:Ih.UNIFORM|Ih.COPY_DST,hint:wh.Dynamic}));var e=pd(this.currentWordOffset,this.uniformBufferMaxPageWordSize);if(!(e<=this.currentBufferWordSize))throw new Error("Assert fail: wordCount ["+e+"] ("+this.currentWordOffset+" aligned "+this.uniformBufferMaxPageWordSize+") <= this.currentBufferWordSize ["+this.currentBufferWordSize+"]");if(this.isSupportedUBO())nd(this.buffer).setSubData(0,this.shadowBufferU8,0,4*e);this.currentWordOffset=0}},e.destroy=function(){null!==this.buffer&&this.buffer.destroy(),this.shadowBufferF32=null,this.shadowBufferU8=null},t}();function Rp(t,e){return t+=e,t+=t<<10,(t+=t>>>6)>>>0}function Ap(t){return t+=t<<3,t^=t>>>11,(t+=t<<15)>>>0}function Sp(t){return 0}var bp=function(){this.keys=[],this.values=[]},xp=function(){function t(t,e){this.keyEqualFunc=void 0,this.keyHashFunc=void 0,this.buckets=new Map,this.keyEqualFunc=t,this.keyHashFunc=e}var e=t.prototype;return e.findBucketIndex=function(t,e){for(var n=0;n<t.keys.length;n++)if(this.keyEqualFunc(e,t.keys[n]))return n;return-1},e.findBucket=function(t){var e=this.keyHashFunc(t);return this.buckets.get(e)},e.get=function(t){var e=this.findBucket(t);if(void 0===e)return null;var n=this.findBucketIndex(e,t);return n<0?null:e.values[n]},e.add=function(t,e){var n=this.keyHashFunc(t);void 0===this.buckets.get(n)&&this.buckets.set(n,new bp);var r=this.buckets.get(n);r.keys.push(t),r.values.push(e)},e.delete=function(t){var e=this.findBucket(t);if(void 0!==e){var n=this.findBucketIndex(e,t);-1!==n&&(e.keys.splice(n,1),e.values.splice(n,1))}},e.clear=function(){this.buckets.clear()},e.size=function(){for(var t,e=0,n=hh(this.buckets.values());!(t=n()).done;){e+=t.value.values.length}return e},e.values=nh().mark((function t(){var e,n,r,i;return nh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=hh(this.buckets.values());case 1:if((n=e()).done){t.next=12;break}r=n.value,i=r.values.length-1;case 4:if(!(i>=0)){t.next=10;break}return t.next=7,r.values[i];case 7:i--,t.next=4;break;case 10:t.next=1;break;case 12:case"end":return t.stop()}}),t,this)})),t}();function Mp(t,e){return ed(""!==t.preprocessedVert&&""!==e.preprocessedVert),ed(""!==t.preprocessedFrag&&""!==e.preprocessedFrag),t.preprocessedVert===e.preprocessedVert&&t.preprocessedFrag===e.preprocessedFrag}function Op(t,e){return t=Rp(t,e.numUniformBuffers),t=Rp(t,e.numSamplers)}function Cp(t,e){return t=Rp(t,e.blendMode),t=Rp(t,e.blendSrcFactor),t=Rp(t,e.blendDstFactor)}function Np(t,e){return t=Cp(t,e.rgbBlendState),t=Rp(t=Cp(t,e.alphaBlendState),e.channelWriteMask)}function Pp(t,e){for(var n=0;n<e.attachmentsState.length;n++)t=Np(t,e.attachmentsState[n]);return t=function(t,e){return t=Rp(t,e.r<<24|e.g<<16|e.b<<8|e.a)}(t,e.blendConstant),t=Rp(t,e.depthCompare),t=Rp(t,e.depthWrite?1:0),t=Rp(t,e.stencilCompare),t=Rp(t,e.stencilPassOp),t=Rp(t,e.stencilWrite?1:0),t=Rp(t,e.cullMode),t=Rp(t,e.frontFace?1:0),t=Rp(t,e.polygonOffset?1:0)}function Ip(t){var e=0;e=Rp(e,t.program.id),null!==t.inputLayout&&(e=Rp(e,t.inputLayout.id));for(var n=0;n<t.bindingLayouts.length;n++)e=Op(e,t.bindingLayouts[n]);e=Pp(e,t.megaStateDescriptor);for(var r=0;r<t.colorAttachmentFormats.length;r++)e=Rp(e,t.colorAttachmentFormats[r]||0);return Ap(e=Rp(e,t.depthStencilAttachmentFormat||0))}function wp(t){for(var e=0,n=0;n<t.samplerBindings.length;n++){var r=t.samplerBindings[n];null!==r&&null!==r.texture&&(e=Rp(e,r.texture.id))}for(var i=0;i<t.uniformBufferBindings.length;i++){var o=t.uniformBufferBindings[i];null!==o&&null!==o.buffer&&(e=Rp(e,o.buffer.id),e=Rp(e,o.wordCount))}return Ap(e)}var Dp,Lp=function(){function t(t){this.device=void 0,this.bindingsCache=new xp(Pd,wp),this.renderPipelinesCache=new xp(Bd,Ip),this.inputLayoutsCache=new xp(Ud,Sp),this.programCache=new xp(Mp,Sp),this.samplerCache=new xp(Gd,Sp),this.device=t}var e=t.prototype;return e.createBindings=function(t){var e,n=this.bindingsCache.get(t);if(null===n){var r={bindingLayout:(e=t).bindingLayout,samplerBindings:Od(e.samplerBindings,Vd),uniformBufferBindings:Od(e.uniformBufferBindings,jd),pipeline:e.pipeline};n=this.device.createBindings(r),this.bindingsCache.add(r,n)}return n},e.createRenderPipeline=function(t){var e,n,r,i,o,a=this.renderPipelinesCache.get(t);if(null===a){var s=(n=Od((e=t).bindingLayouts,Xd),r=e.inputLayout,i=e.program,o=e.topology,{bindingLayouts:n,inputLayout:r,megaStateDescriptor:Td(e.megaStateDescriptor),program:i,topology:o,colorAttachmentFormats:e.colorAttachmentFormats.slice(),depthStencilAttachmentFormat:e.depthStencilAttachmentFormat,sampleCount:e.sampleCount});a=this.device.createRenderPipeline(s),this.renderPipelinesCache.add(s,a)}return a},e.createInputLayout=function(t){var e,n=this.inputLayoutsCache.get(t);if(null===n){var r={vertexAttributeDescriptors:Od((e=t).vertexAttributeDescriptors,Hd),vertexBufferDescriptors:Od(e.vertexBufferDescriptors,Yd),indexBufferFormat:e.indexBufferFormat};n=this.device.createInputLayout(r),this.inputLayoutsCache.add(r,n)}return n},e.createProgramSimple=function(t){var e,n=this.programCache.get(t);if(null===n){var r={preprocessedVert:(e=t).preprocessedVert,preprocessedFrag:e.preprocessedFrag,vert:e.vert,frag:e.frag};n=this.device.createProgramSimple(r),this.programCache.add(r,n)}return n},e.createProgram=function(t){return t.ensurePreprocessed(this.device.queryVendorInfo()),this.createProgramSimple(t)},e.createSampler=function(t){var e=this.samplerCache.get(t);return null===e&&(e=this.device.createSampler(t),this.samplerCache.add(t,e)),e},e.destroy=function(){for(var t,e=hh(this.bindingsCache.values());!(t=e()).done;){t.value.destroy()}for(var n,r=hh(this.renderPipelinesCache.values());!(n=r()).done;){n.value.destroy()}for(var i,o=hh(this.inputLayoutsCache.values());!(i=o()).done;){i.value.destroy()}for(var a,s=hh(this.programCache.values());!(a=s()).done;){a.value.destroy()}for(var u,c=hh(this.samplerCache.values());!(u=c()).done;){u.value.destroy()}this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear(),this.samplerCache.clear()},t}();!function(t){t[t.Color0=0]="Color0",t[t.Color1=1]="Color1",t[t.Color2=2]="Color2",t[t.Color3=3]="Color3",t[t.ColorMax=3]="ColorMax",t[t.DepthStencil=4]="DepthStencil"}(Dp||(Dp={}));var Bp,Fp={x:0,y:0,w:1,h:1},kp=function(){function t(){this.renderTargetIDs=[],this.resolveTextureOutputIDs=[],this.resolveTextureOutputExternalTextures=[],this.resolveTextureInputIDs=[],this.renderTargetExtraRefs=[],this.viewport=Fp,this.resolveTextureInputTextures=[],this.renderTargets=[],this.descriptor={colorAttachment:[],colorResolveTo:[],colorStore:[],depthStencilAttachment:null,depthStencilResolveTo:null,depthStencilStore:!0,colorClearColor:["load"],depthClearValue:"load",stencilClearValue:"load",occlusionQueryPool:null},this.viewportX=0,this.viewportY=0,this.viewportW=0,this.viewportH=0,this.execFunc=null,this.postFunc=null,this.debugName=void 0,this.debugThumbnails=[]}var e=t.prototype;return e.setDebugName=function(t){this.debugName=t},e.pushDebugThumbnail=function(t){this.debugThumbnails[t]=!0},e.setViewport=function(t){this.viewport=t},e.attachRenderTargetID=function(t,e){ed(void 0===this.renderTargetIDs[t]),this.renderTargetIDs[t]=e},e.attachResolveTexture=function(t){this.resolveTextureInputIDs.push(t)},e.attachOcclusionQueryPool=function(t){this.descriptor.occlusionQueryPool=t},e.resolveToExternalTexture=function(t,e){this.resolveTextureOutputExternalTextures[t]=e},e.exec=function(t){ed(null===this.execFunc),this.execFunc=t},e.post=function(t){ed(null===this.postFunc),this.postFunc=t},e.addExtraRef=function(t){this.renderTargetExtraRefs[t]=!0},t}(),Up=function(){function t(t,e){this.debugName=void 0,this.dimension=Bh.n2D,this.depth=1,this.numLevels=1,this.pixelFormat=void 0,this.width=0,this.height=0,this.sampleCount=0,this.usage=Fh.RenderTarget,this.immutable=!0,this.needsClear=!0,this.texture=null,this.attachment=void 0,this.age=0,this.pixelFormat=e.pixelFormat,this.width=e.width,this.height=e.height,this.sampleCount=e.sampleCount,ed(this.sampleCount>=1),this.sampleCount>1?this.attachment=t.createRenderTarget(this):(this.texture=t.createTexture(this),this.attachment=t.createRenderTargetFromTexture(this.texture))}var e=t.prototype;return e.setDebugName=function(t,e){this.debugName=e,null!==this.texture&&t.setResourceName(this.texture,this.debugName),t.setResourceName(this.attachment,this.debugName)},e.matchesDescription=function(t){return this.pixelFormat===t.pixelFormat&&this.width===t.width&&this.height===t.height&&this.sampleCount===t.sampleCount},e.reset=function(t){ed(this.matchesDescription(t)),this.age=0},e.destroy=function(){null!==this.texture&&this.texture.destroy(),this.attachment.destroy()},t}(),Gp=function(){function t(t,e){this.dimension=Bh.n2D,this.depth=1,this.numLevels=1,this.usage=Fh.RenderTarget,this.pixelFormat=void 0,this.width=0,this.height=0,this.texture=void 0,this.age=0,this.immutable=!0,this.pixelFormat=e.pixelFormat,this.width=e.width,this.height=e.height,this.texture=t.createTexture(this)}var e=t.prototype;return e.matchesDescription=function(t){return this.pixelFormat===t.pixelFormat&&this.width===t.width&&this.height===t.height},e.reset=function(t){ed(this.matchesDescription(t)),this.age=0},e.destroy=function(){this.texture.destroy()},t}();Bp=Symbol.species;var Vp,jp=function(){this[Bp]=void 0,this.renderTargetDescriptions=[],this.resolveTextureRenderTargetIDs=[],this.passes=[],this.renderTargetDebugNames=[]},Wp=function(){function t(t){this.device=void 0,this.currentPass=null,this.renderTargetDeadPool=[],this.singleSampledTextureDeadPool=[],this.currentGraph=null,this.renderTargetOutputCount=[],this.renderTargetResolveCount=[],this.resolveTextureUseCount=[],this.renderTargetAliveForID=[],this.singleSampledTextureForResolveTextureID=[],this.device=t}var e=t.prototype;return e.acquireRenderTargetForDescription=function(t){for(var e=0;e<this.renderTargetDeadPool.length;e++){var n=this.renderTargetDeadPool[e];if(n.matchesDescription(t))return n.reset(t),this.renderTargetDeadPool.splice(e--,1),n}return new Up(this.device,t)},e.acquireSingleSampledTextureForDescription=function(t){for(var e=0;e<this.singleSampledTextureDeadPool.length;e++){var n=this.singleSampledTextureDeadPool[e];if(n.matchesDescription(t))return n.reset(t),this.singleSampledTextureDeadPool.splice(e--,1),n}return new Gp(this.device,t)},e.beginGraphBuilder=function(){ed(null===this.currentGraph),this.currentGraph=new jp},e.pushPass=function(t){var e=new kp;t(e),this.currentGraph.passes.push(e)},e.createRenderTargetID=function(t,e){return this.currentGraph.renderTargetDebugNames.push(e),this.currentGraph.renderTargetDescriptions.push(t)-1},e.createResolveTextureID=function(t){return this.currentGraph.resolveTextureRenderTargetIDs.push(t)-1},e.findMostRecentPassThatAttachedRenderTarget=function(t){for(var e=this.currentGraph.passes.length-1;e>=0;e--){var n=this.currentGraph.passes[e];if(n.renderTargetIDs.includes(t))return n}return null},e.resolveRenderTargetPassAttachmentSlot=function(t,e){var n=t;if(void 0===n.resolveTextureOutputIDs[e]){var r=n.renderTargetIDs[e],i=this.createResolveTextureID(r);n.resolveTextureOutputIDs[e]=i}return n.resolveTextureOutputIDs[e]},e.findPassForResolveRenderTarget=function(t){var e=nd(this.findMostRecentPassThatAttachedRenderTarget(t)),n=e.renderTargetIDs.indexOf(t);return ed(void 0===e.resolveTextureOutputExternalTextures[n]),e},e.resolveRenderTarget=function(t){var e=this.findPassForResolveRenderTarget(t),n=e.renderTargetIDs.indexOf(t);return this.resolveRenderTargetPassAttachmentSlot(e,n)},e.resolveRenderTargetToExternalTexture=function(t,e){var n=this.findPassForResolveRenderTarget(t),r=n.renderTargetIDs.indexOf(t);ed(void 0===n.resolveTextureOutputIDs[r]),n.resolveTextureOutputExternalTextures[r]=e},e.getRenderTargetDescription=function(t){return nd(this.currentGraph.renderTargetDescriptions[t])},e.scheduleAddUseCount=function(t,e){for(var n=0;n<e.renderTargetIDs.length;n++){var r=e.renderTargetIDs[n];void 0!==r&&(this.renderTargetOutputCount[r]++,e.renderTargetExtraRefs[n]&&this.renderTargetOutputCount[r]++)}for(var i=0;i<e.resolveTextureInputIDs.length;i++){var o=e.resolveTextureInputIDs[i];if(void 0!==o){this.resolveTextureUseCount[o]++;var a=t.resolveTextureRenderTargetIDs[o];this.renderTargetResolveCount[a]++}}},e.acquireRenderTargetForID=function(t,e){if(void 0===e)return null;if(ed(this.renderTargetOutputCount[e]>0),!this.renderTargetAliveForID[e]){var n=t.renderTargetDescriptions[e],r=this.acquireRenderTargetForDescription(n);r.setDebugName(this.device,t.renderTargetDebugNames[e]),this.renderTargetAliveForID[e]=r}return this.renderTargetAliveForID[e]},e.releaseRenderTargetForID=function(t,e){if(void 0===t)return null;var n=nd(this.renderTargetAliveForID[t]);return e?(ed(this.renderTargetOutputCount[t]>0),this.renderTargetOutputCount[t]--):(ed(this.renderTargetResolveCount[t]>0),this.renderTargetResolveCount[t]--),0===this.renderTargetOutputCount[t]&&0===this.renderTargetResolveCount[t]&&(n.needsClear=!0,delete this.renderTargetAliveForID[t],this.renderTargetDeadPool.push(n)),n},e.acquireResolveTextureInputTextureForID=function(t,e){var n=t.resolveTextureRenderTargetIDs[e];ed(this.resolveTextureUseCount[e]>0),this.resolveTextureUseCount[e]--;var r=nd(this.releaseRenderTargetForID(n,!1));if(void 0!==this.singleSampledTextureForResolveTextureID[e]){var i=this.singleSampledTextureForResolveTextureID[e];return 0===this.resolveTextureUseCount[e]&&this.singleSampledTextureDeadPool.push(i),i.texture}return nd(r.texture)},e.determineResolveParam=function(t,e,n){var r=e.renderTargetIDs[n],i=e.resolveTextureOutputIDs[n],o=e.resolveTextureOutputExternalTextures[n],a=void 0!==i,s=void 0!==o;ed(!(a&&s));var u=null,c=!1;if(this.renderTargetOutputCount[r]>1&&(c=!0),a){ed(t.resolveTextureRenderTargetIDs[i]===r),ed(this.resolveTextureUseCount[i]>0),ed(this.renderTargetOutputCount[r]>0);var l=nd(this.renderTargetAliveForID[r]);if(null!==l.texture&&1===this.renderTargetOutputCount[r])u=null,c=!0;else{if(!this.singleSampledTextureForResolveTextureID[i]){var f=nd(t.renderTargetDescriptions[r]);this.singleSampledTextureForResolveTextureID[i]=this.acquireSingleSampledTextureForDescription(f),this.device.setResourceName(this.singleSampledTextureForResolveTextureID[i].texture,l.debugName+" (Resolve "+i+")")}u=this.singleSampledTextureForResolveTextureID[i].texture}}else u=s?o:null;return{resolveTo:u,store:c}},e.schedulePass=function(t,e){for(var n=e.renderTargetIDs[Dp.DepthStencil],r=Dp.Color0;r<=Dp.ColorMax;r++){var i=e.renderTargetIDs[r],o=this.acquireRenderTargetForID(t,i);e.renderTargets[r]=o,e.descriptor.colorAttachment[r]=null!==o?o.attachment:null;var a=this.determineResolveParam(t,e,r),s=a.resolveTo,u=a.store;e.descriptor.colorResolveTo[r]=s,e.descriptor.colorStore[r]=u,e.descriptor.colorClearColor[r]=null!==o&&o.needsClear?t.renderTargetDescriptions[i].colorClearColor:"load"}var c=this.acquireRenderTargetForID(t,n);e.renderTargets[Dp.DepthStencil]=c,e.descriptor.depthStencilAttachment=null!==c?c.attachment:null;var l=this.determineResolveParam(t,e,Dp.DepthStencil),f=l.resolveTo,h=l.store;e.descriptor.depthStencilResolveTo=f,e.descriptor.depthStencilStore=h,e.descriptor.depthClearValue=null!==c&&c.needsClear?t.renderTargetDescriptions[n].depthClearValue:"load",e.descriptor.stencilClearValue=null!==c&&c.needsClear?t.renderTargetDescriptions[n].stencilClearValue:"load";for(var d=0,p=0,v=0,g=0;g<e.renderTargets.length;g++){var m=e.renderTargets[g];m&&(0===d&&(d=m.width,p=m.height,v=m.sampleCount),ed(m.width===d),ed(m.height===p),ed(m.sampleCount===v),m.needsClear=!1)}if(d>0&&p>0){var y=d*e.viewport.x,_=p*e.viewport.y,E=d*e.viewport.w,T=p*e.viewport.h;e.viewportX=y,e.viewportY=_,e.viewportW=E,e.viewportH=T}for(var R=0;R<e.resolveTextureInputIDs.length;R++){var A=e.resolveTextureInputIDs[R];e.resolveTextureInputTextures[R]=this.acquireResolveTextureInputTextureForID(t,A)}for(var S=0;S<e.renderTargetIDs.length;S++)this.releaseRenderTargetForID(e.renderTargetIDs[S],!0);for(r=0;r<e.renderTargetExtraRefs.length;r++)e.renderTargetExtraRefs[r]&&this.releaseRenderTargetForID(e.renderTargetIDs[r],!0)},e.scheduleGraph=function(t){ed(0===this.renderTargetOutputCount.length),ed(0===this.renderTargetResolveCount.length),ed(0===this.resolveTextureUseCount.length);for(var e=0;e<this.renderTargetDeadPool.length;e++)this.renderTargetDeadPool[e].age++;for(var n=0;n<this.singleSampledTextureDeadPool.length;n++)this.singleSampledTextureDeadPool[n].age++;dd(this.renderTargetOutputCount,t.renderTargetDescriptions.length,0),dd(this.renderTargetResolveCount,t.renderTargetDescriptions.length,0),dd(this.resolveTextureUseCount,t.resolveTextureRenderTargetIDs.length,0);for(var r=0;r<t.passes.length;r++)this.scheduleAddUseCount(t,t.passes[r]);for(var i=0;i<t.passes.length;i++)this.schedulePass(t,t.passes[i]);for(var o=0;o<this.renderTargetOutputCount.length;o++)ed(0===this.renderTargetOutputCount[o]);for(var a=0;a<this.renderTargetResolveCount.length;a++)ed(0===this.renderTargetResolveCount[a]);for(var s=0;s<this.resolveTextureUseCount.length;s++)ed(0===this.resolveTextureUseCount[s]);for(var u=0;u<this.renderTargetAliveForID.length;u++)ed(void 0===this.renderTargetAliveForID[u]);for(var c=0;c<this.renderTargetDeadPool.length;c++)this.renderTargetDeadPool[c].age>=1&&(this.renderTargetDeadPool[c].destroy(),this.renderTargetDeadPool.splice(c--,1));for(var l=0;l<this.singleSampledTextureDeadPool.length;l++)this.singleSampledTextureDeadPool[l].age>=1&&(this.singleSampledTextureDeadPool[l].destroy(),this.singleSampledTextureDeadPool.splice(l--,1));this.renderTargetResolveCount.length=0,this.renderTargetOutputCount.length=0,this.resolveTextureUseCount.length=0},e.execPass=function(t){ed(null===this.currentPass),this.currentPass=t;var e=this.device.createRenderPass(t.descriptor);e.beginDebugGroup(t.debugName),e.setViewport(t.viewportX,t.viewportY,t.viewportW,t.viewportH),null!==t.execFunc&&t.execFunc(e,this),e.endDebugGroup(),this.device.submitPass(e),null!==t.postFunc&&t.postFunc(this),this.currentPass=null},e.execGraph=function(t){var e=this;this.scheduleGraph(t),t.passes.forEach((function(t){e.execPass(t)})),this.singleSampledTextureForResolveTextureID.length=0},e.execute=function(){var t=nd(this.currentGraph);this.execGraph(t),this.currentGraph=null},e.getDebug=function(){return this},e.getPasses=function(){return this.currentGraph.passes},e.getPassDebugThumbnails=function(t){return t.debugThumbnails},e.getPassRenderTargetID=function(t,e){return t.renderTargetIDs[e]},e.getRenderTargetIDDebugName=function(t){return this.currentGraph.renderTargetDebugNames[t]},e.getResolveTextureForID=function(t){var e=this.currentPass,n=e.resolveTextureInputIDs.indexOf(t);return ed(n>=0),nd(e.resolveTextureInputTextures[n])},e.getRenderTargetAttachment=function(t){var e=this.currentPass.renderTargets[t];return e?e.attachment:null},e.getRenderTargetTexture=function(t){var e=this.currentPass.renderTargets[t];return e?e.texture:null},e.newGraphBuilder=function(){return this.beginGraphBuilder(),this},e.destroy=function(){for(var t=0;t<this.renderTargetAliveForID.length;t++)ed(void 0===this.renderTargetAliveForID[t]);for(var e=0;e<this.singleSampledTextureForResolveTextureID.length;e++)ed(void 0===this.singleSampledTextureForResolveTextureID[e]);for(var n=0;n<this.renderTargetDeadPool.length;n++)this.renderTargetDeadPool[n].destroy();for(var r=0;r<this.singleSampledTextureDeadPool.length;r++)this.singleSampledTextureDeadPool[r].destroy()},t}();!function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.ALPHA_TEST=16]="ALPHA_TEST",t[t.OPAQUE=32]="OPAQUE",t[t.TRANSLUCENT=128]="TRANSLUCENT"}(Vp||(Vp={}));function Xp(t,e){return(16777215&t|(255&e)<<24)>>>0}function Hp(t,e){return Xp(function(t,e){return!!(t>>>31&1)?t:(4278190335&t|(65535&e)<<8)>>>0}(0,e),t)}yh(1,0,0,0,0,1,0,0,0,0,2,0,0,0,-1,1);var Yp;yh(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);function zp(t,e,n,r,i,o){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),t[e+0]=n,t[e+1]=r,t[e+2]=i,t[e+3]=o,4}!function(t){t[t.Indexed=1]="Indexed",t[t.AllowSkippingIfPipelineNotReady=2]="AllowSkippingIfPipelineNotReady",t[t.Template=4]="Template",t[t.Draw=8]="Draw",t[t.InheritedFlags=3]="InheritedFlags"}(Yp||(Yp={}));var Kp,qp=function(){function t(){this.sortKey=0,this.debug=null,this.renderPipelineDescriptor=void 0,this.uniformBuffer=void 0,this.uniforms=[],this.bindingDescriptors=gd(1,(function(){return{bindingLayout:null,samplerBindings:[],uniformBufferBindings:[]}})),this.dynamicUniformBufferByteOffsets=gd(4,(function(){return 0})),this.flags=0,this.inputState=null,this.drawStart=0,this.drawCount=0,this.drawInstanceCount=0,this.renderPipelineDescriptor={bindingLayouts:[],inputLayout:null,megaStateDescriptor:Td(Ad),program:null,topology:Ph.Triangles,colorAttachmentFormats:[],depthStencilAttachmentFormat:null,sampleCount:1},this.reset()}var e=t.prototype;return e.reset=function(){this.sortKey=0,this.flags=Yp.AllowSkippingIfPipelineNotReady,this.inputState=null,this.renderPipelineDescriptor.inputLayout=null},e.setFromTemplate=function(t){Ed(this.renderPipelineDescriptor.megaStateDescriptor,t.renderPipelineDescriptor.megaStateDescriptor),this.renderPipelineDescriptor.program=t.renderPipelineDescriptor.program,this.renderPipelineDescriptor.inputLayout=t.renderPipelineDescriptor.inputLayout,this.renderPipelineDescriptor.topology=t.renderPipelineDescriptor.topology,this.renderPipelineDescriptor.colorAttachmentFormats.length=Math.max(this.renderPipelineDescriptor.colorAttachmentFormats.length,t.renderPipelineDescriptor.colorAttachmentFormats.length);for(var e=0;e<t.renderPipelineDescriptor.colorAttachmentFormats.length;e++)this.renderPipelineDescriptor.colorAttachmentFormats[e]=t.renderPipelineDescriptor.colorAttachmentFormats[e];this.renderPipelineDescriptor.depthStencilAttachmentFormat=t.renderPipelineDescriptor.depthStencilAttachmentFormat,this.renderPipelineDescriptor.sampleCount=t.renderPipelineDescriptor.sampleCount,this.inputState=t.inputState,this.uniformBuffer=t.uniformBuffer,this.uniforms=[].concat(t.uniforms),this.drawCount=t.drawCount,this.drawStart=t.drawStart,this.drawInstanceCount=t.drawInstanceCount,this.flags=this.flags&~Yp.InheritedFlags|t.flags&Yp.InheritedFlags,this.sortKey=t.sortKey;var n=this.bindingDescriptors[0],r=t.bindingDescriptors[0];null!==r.bindingLayout&&this.setBindingLayout(r.bindingLayout);for(var i=0;i<Math.min(n.uniformBufferBindings.length,r.uniformBufferBindings.length);i++)n.uniformBufferBindings[i].wordCount=t.bindingDescriptors[0].uniformBufferBindings[i].wordCount;this.setSamplerBindingsFromTextureMappings(r.samplerBindings);for(var o=0;o<t.dynamicUniformBufferByteOffsets.length;o++)this.dynamicUniformBufferByteOffsets[o]=t.dynamicUniformBufferByteOffsets[o]},e.setProgram=function(t){this.renderPipelineDescriptor.program=t},e.setMegaStateFlags=function(t){return Ed(this.renderPipelineDescriptor.megaStateDescriptor,t),this.renderPipelineDescriptor.megaStateDescriptor},e.getMegaStateFlags=function(){return this.renderPipelineDescriptor.megaStateDescriptor},e.setInputLayoutAndState=function(t,e){this.inputState=e,this.renderPipelineDescriptor.inputLayout=t},e.setBindingLayout=function(t){ed(t.numUniformBuffers<this.dynamicUniformBufferByteOffsets.length),this.renderPipelineDescriptor.bindingLayouts[0]=t,this.bindingDescriptors[0].bindingLayout=t;for(var e=this.bindingDescriptors[0].uniformBufferBindings.length;e<t.numUniformBuffers;e++)this.bindingDescriptors[0].uniformBufferBindings.push({buffer:null,wordCount:0});for(var n=this.bindingDescriptors[0].samplerBindings.length;n<t.numSamplers;n++)this.bindingDescriptors[0].samplerBindings.push({sampler:null,texture:null,lateBinding:null})},e.setBindingLayouts=function(t){ed(t.length<=this.bindingDescriptors.length),ed(1===t.length),this.setBindingLayout(t[0])},e.drawIndexes=function(t,e){void 0===e&&(e=0),this.flags=vd(this.flags,Yp.Indexed,!0),this.drawCount=t,this.drawStart=e,this.drawInstanceCount=1},e.drawIndexesInstanced=function(t,e,n){void 0===n&&(n=0),this.flags=vd(this.flags,Yp.Indexed,!0),this.drawCount=t,this.drawStart=n,this.drawInstanceCount=e},e.drawPrimitives=function(t,e){void 0===e&&(e=0),this.flags=vd(this.flags,Yp.Indexed,!1),this.drawCount=t,this.drawStart=e,this.drawInstanceCount=1},e.setUniforms=function(t,e){if(0!==e.length){this.uniforms[t]=e;var n=0,r=[];e.forEach((function(t){var e=t.value;if(Cf(e)||Array.isArray(e)||e instanceof Float32Array){var i=Cf(e)?[e]:e,o=i.length>4?4:i.length,a=4-n%4;if(4!==a)if(a>=o);else{n+=a;for(var s=0;s<a;s++)r.push(0)}n+=i.length,r.push.apply(r,i)}}));var i=4-r.length%4;if(4!==i)for(var o=0;o<i;o++)r.push(0);for(var a=this.allocateUniformBuffer(t,r.length),s=this.mapUniformBufferF32(t),u=0;u<r.length;u+=4)a+=zp(s,a,r[u],r[u+1],r[u+2],r[u+3])}},e.setUniformBuffer=function(t){this.uniformBuffer=t},e.allocateUniformBuffer=function(t,e){return ed(this.bindingDescriptors[0].bindingLayout.numUniformBuffers<this.dynamicUniformBufferByteOffsets.length),this.dynamicUniformBufferByteOffsets[t]=this.uniformBuffer.allocateChunk(e)<<2,this.bindingDescriptors[0].uniformBufferBindings[t].wordCount=e,this.getUniformBufferOffset(t)},e.getUniformBufferOffset=function(t){return this.dynamicUniformBufferByteOffsets[t]>>>2},e.setUniformBufferOffset=function(t,e,n){this.dynamicUniformBufferByteOffsets[t]=e<<2,this.bindingDescriptors[0].uniformBufferBindings[t].wordCount=n},e.mapUniformBufferF32=function(t){return this.uniformBuffer.mapBufferF32()},e.getUniformBuffer=function(){return this.uniformBuffer},e.setSamplerBindingsFromTextureMappings=function(t){t=t.filter((function(t){return t}));for(var e=0;e<this.bindingDescriptors[0].samplerBindings.length;e++){var n=this.bindingDescriptors[0].samplerBindings[e],r=t[e];null!=r?(n.texture=r.texture,n.sampler=r.sampler,n.lateBinding=r.lateBinding):(n.texture=null,n.sampler=null,n.lateBinding=null)}},e.hasLateSamplerBinding=function(t){for(var e=0;e<this.bindingDescriptors[0].samplerBindings.length;e++){if(this.bindingDescriptors[0].samplerBindings[e].lateBinding===t)return!0}return!1},e.resolveLateSamplerBinding=function(t,e){for(var n=0;n<this.bindingDescriptors[0].samplerBindings.length;n++){var r=this.bindingDescriptors[0].samplerBindings[n];r.lateBinding===t&&(null===e?(r.texture=null,r.sampler=null):(ed(null===e.lateBinding),r.texture=e.texture,null!==e.sampler&&(r.sampler=e.sampler)),r.lateBinding=null)}},e.setAllowSkippingIfPipelineNotReady=function(t){this.flags=vd(this.flags,Yp.AllowSkippingIfPipelineNotReady,t)},e.setAttachmentFormatsFromRenderPass=function(t,e){for(var n=t.queryRenderPass(e),r=-1,i=0;i<n.colorAttachment.length;i++){var o=null!==n.colorAttachment[i]?t.queryRenderTarget(n.colorAttachment[i]):null;this.renderPipelineDescriptor.colorAttachmentFormats[i]=null!==o?o.pixelFormat:null,null!==o&&(-1===r?r=o.sampleCount:ed(r===o.sampleCount))}var a=null!==n.depthStencilAttachment?t.queryRenderTarget(n.depthStencilAttachment):null;this.renderPipelineDescriptor.depthStencilAttachmentFormat=null!==a?a.pixelFormat:null,null!==a&&(-1===r?r=a.sampleCount:ed(r==a.sampleCount)),ed(r>0),this.renderPipelineDescriptor.sampleCount=r},e.drawOnPass=function(t,e){var n=this,r=t.device;this.setAttachmentFormatsFromRenderPass(r,e);var i=t.createRenderPipeline(this.renderPipelineDescriptor);if(!r.pipelineQueryReady(i)){if(this.flags&Yp.AllowSkippingIfPipelineNotReady)return!1;r.pipelineForceReady(i)}e.setPipeline(i),e.setInputState(this.inputState);for(var o=0;o<this.bindingDescriptors[0].uniformBufferBindings.length;o++)this.bindingDescriptors[0].uniformBufferBindings[o].buffer=nd(this.uniformBuffer.buffer);this.renderPipelineDescriptor.program.gl_program&&this.uniforms.forEach((function(t){var e={};t.forEach((function(t){var n=t.name,r=t.value;e[n]=r})),n.renderPipelineDescriptor.program.setUniforms(e)}));var a=t.createBindings(sh({},this.bindingDescriptors[0],{pipeline:i}));return e.setBindings(0,a,this.dynamicUniformBufferByteOffsets),this.drawInstanceCount>1?(ed(!!(this.flags&Yp.Indexed)),e.drawIndexedInstanced(this.drawCount,this.drawStart,this.drawInstanceCount)):this.flags&Yp.Indexed?e.drawIndexed(this.drawCount,this.drawStart):e.draw(this.drawCount,this.drawStart),!0},t}();function Zp(t,e){return t.sortKey-e.sortKey}!function(t){t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards"}(Kp||(Kp={}));var Qp=function(){function t(t,e){void 0===t&&(t=Zp),void 0===e&&(e=Kp.Forwards),this.renderInsts=[],this.compareFunction=void 0,this.executionOrder=void 0,this.usePostSort=!1,this.compareFunction=t,this.executionOrder=e}var e=t.prototype;return e.checkUsePostSort=function(){this.usePostSort=null!==this.compareFunction&&this.renderInsts.length>=500},e.insertSorted=function(t){var e,n,r,i;null===this.compareFunction||this.usePostSort?this.renderInsts.push(t):(e=this.renderInsts,n=t,r=this.compareFunction,i=function(t,e,n){for(var r=0,i=t.length;r<i;){var o=r+(i-r>>>1);n(e,t[o])<0?i=o:r=o+1}return r}(e,n,r),e.splice(i,0,n)),this.checkUsePostSort()},e.submitRenderInst=function(t){t.flags|=Yp.Draw,this.insertSorted(t)},e.hasLateSamplerBinding=function(t){for(var e=0;e<this.renderInsts.length;e++)if(this.renderInsts[e].hasLateSamplerBinding(t))return!0;return!1},e.resolveLateSamplerBinding=function(t,e){for(var n=0;n<this.renderInsts.length;n++)this.renderInsts[n].resolveLateSamplerBinding(t,e)},e.ensureSorted=function(){this.usePostSort&&(0!==this.renderInsts.length&&this.renderInsts.sort(this.compareFunction),this.usePostSort=!1)},e.drawOnPassRendererNoReset=function(t,e){this.ensureSorted();var n=0;if(this.executionOrder===Kp.Forwards)for(var r=0;r<this.renderInsts.length;r++)this.renderInsts[r].drawOnPass(t,e)&&n++;else for(var i=this.renderInsts.length-1;i>=0;i--)this.renderInsts[i].drawOnPass(t,e)&&n++;return n},e.reset=function(){this.renderInsts.length=0},e.drawOnPassRenderer=function(t,e){this.drawOnPassRendererNoReset(t,e),this.reset()},t}(),Jp=function(){function t(){this.pool=[],this.allocCount=0}var e=t.prototype;return e.allocRenderInstIndex=function(){return this.allocCount++,this.allocCount>this.pool.length&&this.pool.push(new qp),this.allocCount-1},e.popRenderInst=function(){this.allocCount--},e.reset=function(){for(var t=0;t<this.pool.length;t++)this.pool[t].reset();this.allocCount=0},e.destroy=function(){this.pool.length=0,this.allocCount=0},t}(),$p=function(){function t(t){this.renderCache=void 0,this.instPool=new Jp,this.templatePool=new Jp,this.simpleRenderInstList=new Qp,this.currentRenderInstList=this.simpleRenderInstList,this.renderCache=t}var e=t.prototype;return e.newRenderInst=function(){var t=this.templatePool.allocCount-1,e=this.instPool.allocRenderInstIndex(),n=this.instPool.pool[e];return n.debug=null,t>=0&&n.setFromTemplate(this.templatePool.pool[t]),n},e.submitRenderInst=function(t,e){void 0===e&&(e=this.currentRenderInstList),e.submitRenderInst(t)},e.setCurrentRenderInstList=function(t){ed(null===this.simpleRenderInstList),this.currentRenderInstList=t},e.pushTemplateRenderInst=function(){var t=this.templatePool.allocCount-1,e=this.templatePool.allocRenderInstIndex(),n=this.templatePool.pool[e];return t>=0&&n.setFromTemplate(this.templatePool.pool[t]),n.flags|=Yp.Template,n},e.popTemplateRenderInst=function(){this.templatePool.popRenderInst()},e.getTemplateRenderInst=function(){var t=this.templatePool.allocCount-1;return this.templatePool.pool[t]},e.resetRenderInsts=function(){this.instPool.reset(),null!==this.simpleRenderInstList&&this.simpleRenderInstList.reset(),ed(0===this.templatePool.allocCount)},e.destroy=function(){this.instPool.destroy(),this.renderCache.destroy()},e.disableSimpleMode=function(){this.simpleRenderInstList=null},e.drawOnPassRenderer=function(t){nd(this.simpleRenderInstList).drawOnPassRenderer(this.renderCache,t)},e.drawOnPassRendererNoReset=function(t){nd(this.simpleRenderInstList).drawOnPassRendererNoReset(this.renderCache,t)},t}(),tv=function(){function t(){this.renderCache=void 0,this.renderGraph=void 0,this.renderInstManager=void 0,this.uniformBuffer=void 0,this.device=void 0}var e=t.prototype;return e.getDevice=function(){return this.device},e.setDevice=function(t){this.device=t,this.renderCache=new Lp(t),this.renderGraph=new Wp(this.device),this.renderInstManager=new $p(this.renderCache),this.uniformBuffer=new Tp(this.device)},e.pushTemplateRenderInst=function(){var t=this.renderInstManager.pushTemplateRenderInst();return t.setUniformBuffer(this.uniformBuffer),t},e.prepareToRender=function(){this.uniformBuffer.prepareToRender()},e.destroy=function(){this.uniformBuffer&&this.uniformBuffer.destroy(),this.renderInstManager&&this.renderInstManager.destroy(),this.renderCache.destroy(),this.renderGraph.destroy()},e.getCache=function(){return this.renderCache},t}();tv=_([Object(c.singleton)()],tv);var ev=function(){function t(t){this.pixelFormat=void 0,this.width=0,this.height=0,this.sampleCount=0,this.colorClearColor="load",this.depthClearValue="load",this.stencilClearValue="load",this.pixelFormat=t}var e=t.prototype;return e.setDimensions=function(t,e,n){this.width=t,this.height=e,this.sampleCount=n},e.copyDimensions=function(t){this.width=t.width,this.height=t.height,this.sampleCount=t.sampleCount},t}();function nv(t){return{colorClearColor:t,depthClearValue:1,stencilClearValue:0}}nv(ad(.88,.88,.88,1)),nv(ud);var rv,iv=nv(cd);function ov(t,e){var n=function(t){return t.antialiasingMode===rv.MSAAx4?4:1}(e);t.setDimensions(e.backbufferWidth,e.backbufferHeight,n)}function av(t,e,n){var r=function(t){if(t===Dp.Color0)return zh.U8_RGBA_RT;if(t===Dp.DepthStencil)return zh.D24_S8;throw new Error("whoops")}(t),i=new ev(r);return ov(i,e),null!==n&&(i.colorClearColor=n.colorClearColor,i.depthClearValue=n.depthClearValue,i.stencilClearValue=n.stencilClearValue),i}!function(t){t[t.None=0]="None",t[t.FXAA=1]="FXAA",t[t.MSAAx4=2]="MSAAx4"}(rv||(rv={}));var sv=function(){function t(){this.name=void 0,this.texture=null,this.sampler=null,this.lateBinding=null,this.width=0,this.height=0,this.lodBias=0}var e=t.prototype;return e.reset=function(){this.texture=null,this.sampler=null,this.lateBinding=null,this.width=0,this.height=0,this.lodBias=0},e.copy=function(t){this.texture=t.texture,this.sampler=t.sampler,this.lateBinding=t.lateBinding,this.width=t.width,this.height=t.height,this.lodBias=t.lodBias},t}(),uv=function(){function t(t,e,n,r){this.imagePool=void 0,this.offscreenCanvas=void 0,this.renderingService=void 0,this.canvasConfig=void 0,this.textureCache={},this.imagePool=t,this.offscreenCanvas=e,this.renderingService=n,this.canvasConfig=r}var e=t.prototype;return e.getOrCreateTexture=function(t,e,n,r){var i,o=this,a="string"==typeof e?e:e.src||"";if(a&&this.textureCache[a])(i=this.textureCache[a]).emit(Lh.LOADED);else if(i=t.createTexture(sh({pixelFormat:zh.U8_RGBA_NORM,width:1,height:1,depth:1,numLevels:1,dimension:Bh.n2D,usage:Fh.Sampled,pixelStore:{unpackFlipY:!1},immutable:!1},n)),a&&(this.textureCache[a]=i),Nf(e)){var s,u=this.canvasConfig.createImage;u?s=u(e):as&&(s=new window.Image),s&&(s.onload=function(){o.textureCache[a].setImageData(s),o.textureCache[a].emit(Lh.LOADED),o.renderingService.dirtify(),r&&r(o.textureCache[a])},s.onerror=function(){},s.crossOrigin="Anonymous",s.src=e)}else i.setImageData(e),i.emit(Lh.LOADED),this.renderingService.dirtify();return i},e.getOrCreateCanvas=function(){return this.offscreenCanvas.getOrCreateCanvas(this.canvasConfig.offscreenCanvas)},e.getOrCreateGradient=function(t){var e=this,n=t.instance,r=t.gradients,i=n.getGeometryBounds().halfExtents,o=2*i[0]||1,a=2*i[1]||1,s=this.offscreenCanvas.getOrCreateCanvas(this.canvasConfig.offscreenCanvas),u=this.offscreenCanvas.getOrCreateContext(this.canvasConfig.offscreenCanvas);s.width=o,s.height=a,r.forEach((function(t){var n=e.imagePool.getOrCreateGradient(sh({type:t.type},t.value,{width:o,height:a}),u);u.fillStyle=n,u.fillRect(0,0,o,a)}))},e.getOrCreatePattern=function(t,e,n){var r,i=t.image,o=t.repetition,a=e.getGeometryBounds().halfExtents,s=2*a[0]||1,u=2*a[1]||1,c=this.offscreenCanvas.getOrCreateCanvas(this.canvasConfig.offscreenCanvas),l=this.offscreenCanvas.getOrCreateContext(this.canvasConfig.offscreenCanvas);c.width=s,c.height=u;var f=(r=Nf(i)?this.imagePool.getImageSync(i,n):i)&&l.createPattern(r,o);l.fillStyle=f,l.fillRect(0,0,s,u)},e.destroy=function(){for(var t in this.textureCache)this.textureCache[t].destroy();this.textureCache={}},t}();uv=_([Object(c.singleton)(),E(0,Object(c.inject)(Xf)),E(1,Object(c.inject)(ac)),E(2,Object(c.inject)(Tl)),E(3,Object(c.inject)(bs))],uv);var cv=c.Syringe.defineToken(""),lv=c.Syringe.defineToken(""),fv=c.Syringe.defineToken(""),hv=1,dv=function(){function t(t,e,n){this.renderHelper=void 0,this.rendererFactory=void 0,this.meshFactory=void 0,this.device=void 0,this.renderingService=void 0,this.meshes=[],this.pendingUpdatePatches={},this.stencilRefCache={},this.renderHelper=t,this.rendererFactory=e,this.meshFactory=n}var e=t.prototype;return e.render=function(t,e){var n=this;void 0===e&&(e=!1),e||this.updatePendingPatches(),this.meshes.forEach((function(r){r.init(n.device,n.renderingService);var i=r.objects;r.clipPathTarget&&(i=[r.clipPath]);var o=n.renderHelper.renderInstManager.newRenderInst();o.setAllowSkippingIfPipelineNotReady(!1),r.applyRenderInst(o,i),n.renderHelper.renderInstManager.submitRenderInst(o,t),e||r.objects.forEach((function(t){t.renderable.dirty=!1}))}))},e.attach=function(t,e){this.device=t,this.renderingService=e},e.add=function(t){var e=this,n=t.renderable3D;if(n&&!n.meshes.length){var r=this.rendererFactory(t.nodeName);r&&r.meshes.forEach((function(i,o){if(n.meshes[o]=void 0,r.shouldSubmitRenderInst(t,o)){var a=e.meshes.find((function(e){return i===e.constructor&&e.index===o&&e.shouldMerge(t,o)}));a||((a=e.meshFactory(i)).renderer=r,a.index=o,e.meshes.push(a)),a&&(a.objects.push(t),n.meshes[o]=a,a.geometryDirty=!0)}}))}},e.remove=function(t){var e=this,n=t.renderable3D;n&&(n.meshes.forEach((function(n){if(n){var r=n.objects.indexOf(t);r>-1&&(n.objects.splice(r,1),n.geometryDirty=!0),0===n.objects.length&&e.meshes.splice(e.meshes.indexOf(n),1)}})),n.meshes=[])},e.updateAttribute=function(t,e,n,r){var i=this;void 0===r&&(r=!1);var o=t.renderable3D,a=this.rendererFactory(t.nodeName);a&&a.meshes.forEach((function(s,u){var c=a.shouldSubmitRenderInst(t,u),l=o.meshes.find((function(t){return t&&t.index===u&&t.constructor===s}));if(c!==!!l&&(l&&(l.objects.splice(l.objects.indexOf(t),1),l.geometryDirty=!0,0===l.objects.length&&i.meshes.splice(i.meshes.indexOf(l),1),o.meshes[o.meshes.indexOf(l)]=void 0),c&&((l=i.meshes.find((function(e){return s===e.constructor&&e.index===u&&e.shouldMerge(t,u)})))||((l=i.meshFactory(s)).renderer=a,l.index=u,l.init(i.device,i.renderingService),i.meshes.push(l)),l&&(l.objects.push(t),o.meshes[u]=l))),c&&l&&l.inited&&!l.geometryDirty){var f=l.objects.indexOf(t);if(r)t.parsedStyle[e]=n,l.updateAttribute([t],f,e,n);else{var h=l.id+e;i.pendingUpdatePatches[h]||(i.pendingUpdatePatches[h]={instance:l,objectIndices:[],name:e,value:n}),-1===i.pendingUpdatePatches[h].objectIndices.indexOf(f)&&i.pendingUpdatePatches[h].objectIndices.push(f)}}}))},e.changeRenderOrder=function(t,e){var n=t.renderable3D;n&&n.meshes.length&&n.meshes.forEach((function(n){n&&n.inited&&!n.geometryDirty&&(n.renderer.shouldSubmitRenderInst(t,n.index)&&n.inited&&n.changeRenderOrder(t,e))}))},e.getStencilRef=function(t){return this.stencilRefCache[t.entity]||(this.stencilRefCache[t.entity]=hv++),this.stencilRefCache[t.entity]},e.updatePendingPatches=function(){var t=this;Object.keys(this.pendingUpdatePatches).forEach((function(e){var n=t.pendingUpdatePatches[e],r=n.instance,i=n.objectIndices,o=n.name,a=n.value;i.sort((function(t,e){return t-e}));var s=[];i.forEach((function(t){var e=s[s.length-1];e&&t===e[e.length-1]+1?e.push(t):s.push([t])})),s.forEach((function(t){r.updateAttribute(r.objects.slice(t[0],t[0]+t.length),t[0],o,a)}))})),this.pendingUpdatePatches={}},t}();dv=_([Object(c.singleton)(),E(0,Object(c.inject)(tv)),E(1,Object(c.inject)(cv)),E(2,Object(c.inject)(fv))],dv);var pv=1,vv=function(){function t(){this.renderHelper=void 0,this.texturePool=void 0,this.camera=void 0,this.lightPool=void 0,this.batchManager=void 0,this.device=void 0,this.renderingService=void 0,this.id=pv++,this.meshes=[],this.clipPathMeshCreated=!1}var e=t.prototype;return e.shouldSubmitRenderInst=function(t,e){return!0},e.beforeUploadUBO=function(t,e,n){},e.beforeInitMesh=function(t){},e.afterInitMesh=function(t){},t}();function gv(t){var e={};return Object.keys(t).forEach((function(n){"number"==typeof t[n]&&(e[n]=t[n])})),e}_([Object(c.inject)(tv)],vv.prototype,"renderHelper",void 0),_([Object(c.inject)(uv)],vv.prototype,"texturePool",void 0),_([Object(c.inject)(gl)],vv.prototype,"camera",void 0),_([Object(c.inject)(ph)],vv.prototype,"lightPool",void 0),_([Object(c.inject)(dv)],vv.prototype,"batchManager",void 0),vv=_([Object(c.injectable)()],vv);var mv,yv,_v=function(t){return Object.fromEntries(Object.entries(t).filter((function(t){t[0];return void 0!==t[1]})))},Ev=1;!function(t){t[t.MODEL_MATRIX=0]="MODEL_MATRIX",t[t.FILL_STROKE=1]="FILL_STROKE",t[t.PACKED_STYLE=2]="PACKED_STYLE",t[t.PICKING_COLOR=3]="PICKING_COLOR",t[t.POSITION=4]="POSITION",t[t.NORMAL=5]="NORMAL",t[t.UV=6]="UV",t[t.BARYCENTRIC=7]="BARYCENTRIC",t[t.MAX=8]="MAX"}(mv||(mv={})),function(t){t[t.MODEL_MATRIX0=0]="MODEL_MATRIX0",t[t.MODEL_MATRIX1=1]="MODEL_MATRIX1",t[t.MODEL_MATRIX2=2]="MODEL_MATRIX2",t[t.MODEL_MATRIX3=3]="MODEL_MATRIX3",t[t.COLOR=4]="COLOR",t[t.STROKE_COLOR=5]="STROKE_COLOR",t[t.PACKED_STYLE1=6]="PACKED_STYLE1",t[t.PACKED_STYLE2=7]="PACKED_STYLE2",t[t.PICKING_COLOR=8]="PICKING_COLOR",t[t.POSITION=9]="POSITION",t[t.NORMAL=10]="NORMAL",t[t.UV=11]="UV",t[t.BARYCENTRIC=12]="BARYCENTRIC",t[t.MAX=13]="MAX"}(yv||(yv={}));var Tv=function(){function t(){this.id=Ev++,this.renderer=void 0,this.index=-1,this.renderHelper=void 0,this.texturePool=void 0,this.camera=void 0,this.lightPool=void 0,this.device=void 0,this.renderingService=void 0,this.objects=[],this.material=void 0,this.geometry=void 0,this.clipPath=void 0,this.clipPathTarget=void 0,this.inputState=void 0,this.program=new Ep,this.programDescriptorSimpleWithOrig=void 0,this.geometryDirty=!0,this.materialDirty=!0,this.inputStateDirty=!0,this.textureMappings=[],this.samplerEntries=void 0,this.inited=!1}var e=t.prototype;return e.init=function(t,e){this.inited||(this.renderer.beforeInitMesh(this),this.device=t,this.renderingService=e,this.material=new _p(this.device),this.material.defines=sh({},gv(yv),this.material.defines),this.geometry=new pp(this.device),this.geometry.meshes=this.objects,this.material.meshes=this.objects,this.observeGeometryChanged(),this.observeMaterialChanged(),this.inited=!0,this.renderer.afterInitMesh(this))},e.observeGeometryChanged=function(){var t=this;this.geometry.on(cp.CHANGED,(function(){t.geometry.meshes.forEach((function(t){t.renderable.dirty=!0})),t.renderingService.dirtify()}))},e.observeMaterialChanged=function(){var t=this;this.material.on(dp.CHANGED,(function(){t.material.meshes.forEach((function(t){t.renderable.dirty=!0})),t.renderingService.dirtify()}))},e.shouldMergeColor=function(t,e,n){var r=t.parsedStyle[n],i=e.parsedStyle[n];return r instanceof Xa&&i instanceof Xa||(!(!au(r)||!au(i)||r.image!==i.image)||!(!Array.isArray(r)||!Array.isArray(i)||t.style[n]!==e.style[n]))},e.shouldMerge=function(t,e){return!this.instance||(this.instance.nodeName===t.nodeName||this.instance.nodeName===t.renderable.proxyNodeName||this.instance.renderable.proxyNodeName===t.nodeName||this.instance.renderable.proxyNodeName===t.renderable.proxyNodeName)&&(!t.parsedStyle.clipPath&&!(!this.shouldMergeColor(this.instance,t,"fill")||!this.shouldMergeColor(this.instance,t,"stroke")))},e.createGeometry=function(t){var e=this,n=gh(),r=gh(),i=[],o=[],a=[],s=[];t.forEach((function(t){var u,c=t.parsedStyle,l=c.fill,f=c.stroke,h=c.opacity,d=c.fillOpacity,p=c.strokeOpacity,v=c.lineWidth,g=c.anchor,m=c.visibility,y=c.increasedLineWidthForHitTesting,_=[0,0,0,0];l instanceof Xa&&(_=[Number(l.r)/255,Number(l.g)/255,Number(l.b)/255,Number(l.alpha)]);var E=[0,0,0,0];f instanceof Xa&&(E=[Number(f.r)/255,Number(f.g)/255,Number(f.b)/255,Number(f.alpha)]),e.clipPathTarget?(mh(n,t.getLocalTransform()),_=[1,1,1,1],Eh(n,e.clipPathTarget.getWorldTransform(),n)):mh(n,t.getWorldTransform()),Eh(r,e.camera.getViewTransform(),n);var T=t.isInteractive()&&(null===(u=t.renderable3D)||void 0===u?void 0:u.encodedPickingColor)||[0,0,0];i.push.apply(i,n),o.push.apply(o,_.concat(E)),a.push(h,d,p,v,"visible"===m?1:0,g[0],g[1],y||0),s.push.apply(s,T.concat([.005*t.sortable.renderOrder]))})),this.geometry.instancedCount=t.length,this.geometry.setVertexBuffer({bufferIndex:mv.MODEL_MATRIX,byteStride:64,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGBA,bufferByteOffset:0,location:yv.MODEL_MATRIX0,divisor:1},{format:zh.F32_RGBA,bufferByteOffset:16,location:yv.MODEL_MATRIX1,divisor:1},{format:zh.F32_RGBA,bufferByteOffset:32,location:yv.MODEL_MATRIX2,divisor:1},{format:zh.F32_RGBA,bufferByteOffset:48,location:yv.MODEL_MATRIX3,divisor:1}],data:new Float32Array(i)}),this.geometry.setVertexBuffer({bufferIndex:mv.FILL_STROKE,byteStride:32,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGBA,bufferByteOffset:0,location:yv.COLOR,divisor:1},{format:zh.F32_RGBA,bufferByteOffset:16,location:yv.STROKE_COLOR,divisor:1}],data:new Float32Array(o)}),this.geometry.setVertexBuffer({bufferIndex:mv.PACKED_STYLE,byteStride:32,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGBA,bufferByteOffset:0,location:yv.PACKED_STYLE1,divisor:1},{format:zh.F32_RGBA,bufferByteOffset:16,location:yv.PACKED_STYLE2,divisor:1}],data:new Float32Array(a)}),this.geometry.setVertexBuffer({bufferIndex:mv.PICKING_COLOR,byteStride:16,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGBA,bufferByteOffset:0,location:yv.PICKING_COLOR,divisor:1}],data:new Float32Array(s)})},e.destroy=function(){this.geometry&&this.geometry.destroy(),this.inputState&&this.inputState.destroy()},e.applyRenderInst=function(t,e){var n,r,i,o,a=this,s=this.lightPool.getAllLights(),u=!!this.lightPool.getFog(),c=!!s.length,l=sh({},this.material.defines);if(this.material.defines.USE_FOG=u,this.material.defines.USE_LIGHT=c,this.material.defines=sh({},this.material.defines,this.lightPool.getDefines()),this.clipPathTarget||this.clipPath?this.clipPathTarget?(this.material.stencilWrite=!0,this.material.depthWrite=!1,this.material.stencilCompare=Ah.Always,this.material.stencilPassOp=Uh.Replace):(this.material.stencilWrite=!1,this.material.depthWrite=!0,this.material.stencilCompare=Ah.Equal,this.material.stencilPassOp=Uh.Keep):this.material.stencilWrite=!1,(this.materialDirty||this.material.programDirty)&&this.createMaterial(e),this.material.textureDirty){this.textureMappings=[];var f=this.createFillGradientTextureMapping(e);f&&this.textureMappings.push(f),Object.keys(this.material.textures).sort((function(t,e){return a.material.samplers.indexOf(t)-a.material.samplers.indexOf(e)})).forEach((function(t){var e=new sv;e.name=t,e.texture=a.material.textures[t],a.device.setResourceName(e.texture,"Material Texture "+t),e.sampler=a.renderHelper.getCache().createSampler({wrapS:Oh.Clamp,wrapT:Oh.Clamp,minFilter:Ch.Point,magFilter:Ch.Bilinear,mipFilter:Nh.Linear,minLOD:0,maxLOD:0}),a.textureMappings.push(e)})),this.textureMappings.length?(this.material.defines.USE_UV=!0,this.material.defines.USE_MAP=!0):(this.material.defines.USE_UV=!1,this.material.defines.USE_MAP=!1),this.material.textureDirty=!1}((n=l,r=this.material.defines,i=Object.keys(n),o=Object.keys(r),i.length===o.length&&i.every((function(t){return n[t]===r[t]})))||this.material.programDirty||this.materialDirty)&&(this.material.defines=sh({},this.material.defines,gv(yv)),Object.keys(this.material.defines).forEach((function(t){var e=a.material.defines[t];"number"==typeof e?a.program.setDefineString(t,""+e):a.program.setDefineBool(t,e)})),this.program.vert=this.material.vertexShader,this.program.frag=this.material.fragmentShader,this.programDescriptorSimpleWithOrig=yp(this.device,this.program),this.material.programDirty=!1,this.materialDirty=!1),this.material.geometryDirty&&(this.geometryDirty=!0,this.inputStateDirty=!0,this.material.geometryDirty=!1),(this.geometryDirty||this.geometry.dirty)&&(this.geometry&&this.geometry.destroy(),this.createGeometry(e),this.material.wireframe&&this.generateWireframe(this.geometry),this.geometryDirty=!1,this.geometry.dirty=!1,this.inputStateDirty=!0);var h=this.renderHelper.getCache().createInputLayout(this.geometry.inputLayoutDescriptor),d=this.renderHelper.getCache().createProgramSimple(this.programDescriptorSimpleWithOrig),p=!!this.geometry.indexBuffer;this.inputStateDirty&&(this.inputState&&this.inputState.destroy(),this.inputState=this.device.createInputState(h,this.geometry.vertexBuffers.map((function(t){return{buffer:t,byteOffset:0}})),p?{buffer:this.geometry.indexBuffer,byteOffset:0}:null,d),this.inputStateDirty=!1),t.renderPipelineDescriptor.topology=this.geometry.drawMode,t.setProgram(d),t.setInputLayoutAndState(h,this.inputState),this.renderer.beforeUploadUBO(t,this,this.index),this.uploadUBO(t),p?t.drawIndexesInstanced(this.geometry.vertexCount,this.geometry.instancedCount,this.geometry.indexStart):t.drawPrimitives(this.geometry.vertexCount,this.geometry.primitiveStart),t.sortKey=Hp(Vp.OPAQUE,e[0].sortable.renderOrder)},e.updateBatchedAttribute=function(t,e,n,r){if("fill"===n||"stroke"===n){var i=[];t.forEach((function(t){var e=t.parsedStyle,n=e.fill,r=e.stroke,o=[0,0,0,0];n instanceof Xa&&(o=[Number(n.r)/255,Number(n.g)/255,Number(n.b)/255,Number(n.alpha)]);var a=[0,0,0,0];r instanceof Xa&&(a=[Number(r.r)/255,Number(r.g)/255,Number(r.b)/255,Number(r.alpha)]),i.push.apply(i,o.concat(a))})),this.geometry.updateVertexBuffer(mv.FILL_STROKE,yv.COLOR,e,new Uint8Array(new Float32Array(i).buffer));var o=this.instance.parsedStyle.fill,a=this.textureMappings.findIndex((function(t){return"FillTextureMapping"===t.name}));if(o instanceof Xa)a>=0&&(this.textureMappings.splice(a,-1),this.material.textureDirty=!0);else{var s=this.createFillGradientTextureMapping([this.instance]);a>=0&&this.textureMappings.splice(a,1,s),this.material.textureDirty=!0}}else if(["opacity","fillOpacity","strokeOpacity","lineWidth","visibility","anchor","increasedLineWidthForHitTesting"].indexOf(n)>-1){var u=[];t.forEach((function(t){var e=t.parsedStyle,n=e.opacity,r=e.fillOpacity,i=e.strokeOpacity,o=e.lineWidth,a=e.visibility,s=e.anchor,c=e.increasedLineWidthForHitTesting;u.push(n,r,i,o,"visible"===a?1:0,s[0],s[1],c||0)})),this.geometry.updateVertexBuffer(mv.PACKED_STYLE,yv.PACKED_STYLE1,e,new Uint8Array(new Float32Array(u).buffer))}else if("modelMatrix"===n){var c=[];t.forEach((function(t){var e=mh(gh(),t.getWorldTransform());c.push.apply(c,e)})),this.geometry.updateVertexBuffer(mv.MODEL_MATRIX,yv.MODEL_MATRIX0,e,new Uint8Array(new Float32Array(c).buffer))}else if("pointerEvents"===n){var l=[];t.forEach((function(t){var e,n=r&&t.isInteractive()&&(null===(e=t.renderable3D)||void 0===e?void 0:e.encodedPickingColor)||[0,0,0];l.push.apply(l,n.concat([.005*t.sortable.renderOrder]))})),this.geometry.updateVertexBuffer(mv.PICKING_COLOR,yv.PICKING_COLOR,e,new Uint8Array(new Float32Array(l).buffer))}},e.updateAttribute=function(t,e,n,r){"clipPath"===n&&this.clipPath&&(this.geometryDirty=!0)},e.changeRenderOrder=function(t,e){var n,r=this.objects.indexOf(t),i=t.isInteractive()&&(null===(n=t.renderable3D)||void 0===n?void 0:n.encodedPickingColor)||[0,0,0];this.geometry.updateVertexBuffer(mv.PICKING_COLOR,yv.PICKING_COLOR,r,new Uint8Array(new Float32Array([].concat(i,[.005*e])).buffer))},e.generateWireframe=function(t){for(var e=t.indices,n=t.indices.length,r=t.vertices.map((function(t){return t.slice()})),i=mv.PICKING_COLOR;i<t.vertexBuffers.length;i++){var o=t.inputLayoutDescriptor.vertexBufferDescriptors[i].byteStride;t.vertices[i]=new Float32Array(o/4*n)}for(var a=0,s=new Uint32Array(n),u=0;u<n;u++){for(var c=e[u],l=1;l<t.vertices.length;l++)for(var f=t.inputLayoutDescriptor.vertexBufferDescriptors[l].byteStride/4,h=0;h<f;h++)t.vertices[l][a*f+h]=r[l][c*f+h];s[u]=a,a++}for(var d=function(e){var n=t.inputLayoutDescriptor.vertexBufferDescriptors[e],r=n.frequency,i=n.byteStride,o=t.inputLayoutDescriptor.vertexAttributeDescriptors.find((function(t){return t.bufferIndex===e}));if(o){var a=o.location,s=o.bufferIndex,u=o.bufferByteOffset,c=o.format,l=o.divisor;t.setVertexBuffer({bufferIndex:s,byteStride:i,frequency:r,attributes:[{format:c,bufferByteOffset:u,location:a,divisor:l}],data:t.vertices[e]})}},p=mv.PICKING_COLOR+1;p<t.vertexBuffers.length;p++)d(p);for(var v=new Float32Array(3*n),g=0;g<n;)for(var m=0;m<3;m++){v[3*s[g++]+m]=1}t.setVertexBuffer({bufferIndex:mv.BARYCENTRIC,byteStride:12,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RGB,bufferByteOffset:0,location:Number(yv.BARYCENTRIC)}],data:v}),t.setIndexBuffer(s)},e.beforeUploadUBO=function(t,e,n){},e.uploadUBO=function(t){var e=this,n=this.material,r=this.lightPool.getAllLights(),i=this.lightPool.getFog(),o=!!i,a=!!r.length,s=n.defines.USE_WIREFRAME,u=[];if(s){var c=su(n.wireframeColor);u.push({name:"u_WireframeLineColor",value:[Number(c.r)/255,Number(c.g)/255,Number(c.b)/255]}),u.push({name:"u_WireframeLineWidth",value:n.wireframeLineWidth})}if(o&&this.uploadFog(u,i),this.uploadMaterial(u,n),a){var l={};r.forEach((function(t){l[t.define]||(l[t.define]=-1),l[t.define]++,t.uploadUBO(u,l[t.define])}))}u.sort((function(t,n){return e.material.uniformNames.indexOf(t.name)-e.material.uniformNames.indexOf(n.name)})),t.setUniforms(1,u);var f=n.depthCompare,h=n.depthWrite,d=n.stencilCompare,p=n.stencilWrite,v=n.stencilPassOp,g=n.stencilRef,m=n.cullMode,y=n.frontFace,_=n.polygonOffset,E=n.blendConstant,T=n.blendEquation,R=n.blendEquationAlpha,A=n.blendSrc,S=n.blendDst,b=n.blendSrcAlpha,x=n.blendDstAlpha,M=_v({blendConstant:E,depthCompare:f,depthWrite:h,stencilCompare:d,stencilWrite:p,stencilPassOp:v,stencilRef:g,cullMode:m,frontFace:y,polygonOffset:_}),O=t.getMegaStateFlags().attachmentsState[0];t.setMegaStateFlags(sh({attachmentsState:[{channelWriteMask:this.material.stencilWrite?kh.None:kh.AllChannels,rgbBlendState:sh({},O.rgbBlendState,_v({blendMode:T,blendSrcFactor:A,blendDstFactor:S})),alphaBlendState:sh({},O.alphaBlendState,_v({blendMode:R,blendSrcFactor:b,blendDstFactor:x}))}]},M)),t.setBindingLayouts([{numUniformBuffers:1,numSamplers:this.textureMappings.length,samplerEntries:this.samplerEntries}]),t.setSamplerBindingsFromTextureMappings(this.textureMappings)},e.uploadFog=function(t,e){var n=e.parsedStyle,r=n.type,i=n.fill,o=n.start,a=n.end,s=n.density;if(i instanceof Xa){var u=[Number(i.r)/255,Number(i.g)/255,Number(i.b)/255,Number(i.alpha)];t.push({name:"u_FogInfos",value:[r,o,a,s]}),t.push({name:"u_FogColor",value:u})}},e.uploadMaterial=function(t,e){var n=Object.keys(e.uniforms).map((function(t){return{name:t,value:e.uniforms[t]}}));t.push.apply(t,n)},e.createFillGradientTextureMapping=function(t){var e,n=this,r=t[0],i=r.nodeName===ys.LINE?r.parsedStyle.stroke:r.parsedStyle.fill;if(i&&(au(i)||Array.isArray(i))){Array.isArray(i)?(this.program.setDefineBool("USE_PATTERN",!1),this.texturePool.getOrCreateGradient({gradients:i,width:128,height:128,instance:r})):au(i)&&(this.program.setDefineBool("USE_PATTERN",!0),this.texturePool.getOrCreatePattern(i,r,(function(){t.forEach((function(t){t.renderable.dirty=!0})),n.material.textureDirty=!0}))),e=this.texturePool.getOrCreateCanvas();var o=this.texturePool.getOrCreateTexture(this.device,e,qh(zh.U8_RGBA_NORM,1,1,1));if(o){var a=new sv;return a.name="FillTextureMapping",a.texture=o,a.texture.on("loaded",(function(){t.forEach((function(t){t.renderable.dirty=!0})),n.material.textureDirty=!0})),this.device.setResourceName(a.texture,"Fill Texture"+this.id),a.sampler=this.renderHelper.getCache().createSampler({wrapS:Oh.Repeat,wrapT:Oh.Repeat,minFilter:Ch.Point,magFilter:Ch.Bilinear,mipFilter:Nh.Linear,minLOD:0,maxLOD:0}),a}}return null},ah(t,[{key:"instance",get:function(){return this.objects[0]}}]),t}();_([Object(c.inject)(tv)],Tv.prototype,"renderHelper",void 0),_([Object(c.inject)(uv)],Tv.prototype,"texturePool",void 0),_([Object(c.inject)(gl)],Tv.prototype,"camera",void 0),_([Object(c.inject)(ph)],Tv.prototype,"lightPool",void 0),Tv=_([Object(c.injectable)()],Tv);var Rv,Av;!function(t){t[t.PACKED_STYLE=5]="PACKED_STYLE"}(Rv||(Rv={})),function(t){t[t.PACKED_STYLE3=13]="PACKED_STYLE3",t[t.SIZE=14]="SIZE"}(Av||(Av={}));var Sv=[ys.CIRCLE,ys.ELLIPSE],bv=function(t){function e(){return t.apply(this,arguments)||this}uh(e,t);var n=e.prototype;return n.shouldMerge=function(e,n){var r=t.prototype.shouldMerge.call(this,e,n);if(!r)return!1;if(this.needDrawStrokeSeparately(e.parsedStyle)||this.needDrawStrokeSeparately(this.instance.parsedStyle))return!1;var i=this.instance.parsedStyle.fill,o=e.parsedStyle.fill;return i.isNone===o.isNone},n.createMaterial=function(t){this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = POSITION) in vec2 a_Extrude;\nlayout(location = PACKED_STYLE3) in vec4 a_StylePacked3;\nlayout(location = SIZE) in vec2 a_Size;\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\n\nout vec4 v_Data;\nout vec2 v_Radius;\nout vec4 v_StylePacked3;\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n  float strokeWidth;\n  if (u_IsPicking > 0.5) {\n    strokeWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\n  } else {\n    strokeWidth = u_StrokeWidth;\n  }\n\n  float antialiasblur = 1.0 / (a_Size.x + strokeWidth);\n\n  bool omitStroke = a_StylePacked3.z == 1.0;\n  vec2 radius = a_Size + vec2(omitStroke ? 0.0 : strokeWidth / 2.0);\n  vec2 offset = (a_Extrude + vec2(1.0) - 2.0 * u_Anchor.xy) * radius;\n\n  gl_Position = project(vec4(offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n  \n  v_Radius = radius;\n  v_Data = vec4(a_Extrude, antialiasblur, a_StylePacked3.x);\n  v_StylePacked3 = a_StylePacked3;\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nin vec4 v_Data;\nin vec2 v_Radius;\nin vec4 v_StylePacked3;\n\nout vec4 outputColor;\n\n/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\n// @see http://www.iquilezles.org/www/articles/ellipsoids/ellipsoids.htm\nfloat sdEllipsoidApproximated(vec2 p, vec2 r) {\n  float k0 = length(p / r);\n  float k1 = length(p / (r * r));\n  return k0 * (k0 - 1.0) / k1;\n}\n\nvoid main() {\n  int shape = int(floor(v_Data.w + 0.5));\n  float epsilon = 0.000001;\n\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n  #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n  bool omitStroke = v_StylePacked3.z == 1.0;\n\n  float antialiasblur = v_Data.z;\n  float antialiased_blur = -max(0.0, antialiasblur);\n  vec2 r = (v_Radius - (omitStroke ? 0.0 : u_StrokeWidth)) / v_Radius;\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'ellipse', 'rect'\n  if (shape == 0) {\n    outer_df = sdCircle(v_Data.xy, 1.0);\n    inner_df = sdCircle(v_Data.xy, r.x);\n  } else if (shape == 1) {\n    outer_df = sdEllipsoidApproximated(v_Data.xy, vec2(1.0));\n    inner_df = sdEllipsoidApproximated(v_Data.xy, r);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n\n  float color_t = u_StrokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n\n  // vec2 imagecoord = mod(v_Uv, 0.1);\n  // vec4 texel = texture(SAMPLER_2D(u_Map), imagecoord);\n  // u_Color = texel;\n\n  vec4 diffuseColor;\n  vec4 strokeColor;\n  if (u_IsPicking > 0.5) {\n    diffuseColor = vec4(u_PickingColor, 1.0);\n    strokeColor = vec4(u_PickingColor, 1.0);\n  } else {\n    diffuseColor = u_Color;\n    strokeColor = (u_StrokeColor == vec4(0) || omitStroke) ? vec4(0.0) : u_StrokeColor;\n  }\n\n  outputColor = mix(vec4(diffuseColor.rgb, diffuseColor.a * u_FillOpacity), strokeColor * u_StrokeOpacity, color_t);\n  outputColor.a = outputColor.a * u_Opacity * opacity_t;\n\n  if (outputColor.a < epsilon)\n    discard;\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n  }\n}",this.material.defines=sh({},this.material.defines,gv(Av))},n.createGeometry=function(e){var n=this;t.prototype.createGeometry.call(this,e);var r=[],i=[],o=[];e.forEach((function(t,e){var a=t,s=4*e,u=a.parsedStyle.radius,c=n.shouldOmitStroke(a.parsedStyle),l=n.getSize(t.parsedStyle,a.nodeName);i.push.apply(i,l.concat([Sv.indexOf(a.nodeName),u||0,c?1:0,0])),r.push(-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1),o.push(0+s,2+s,1+s,0+s,3+s,2+s)})),this.geometry.setIndexBuffer(new Uint32Array(o)),this.geometry.vertexCount=6,this.geometry.setVertexBuffer({bufferIndex:mv.POSITION,byteStride:16,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:yv.POSITION},{format:zh.F32_RG,bufferByteOffset:8,location:yv.UV}],data:new Float32Array(r)}),this.geometry.setVertexBuffer({bufferIndex:Rv.PACKED_STYLE,byteStride:24,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:Av.SIZE,divisor:1},{format:zh.F32_RGBA,bufferByteOffset:8,location:Av.PACKED_STYLE3,divisor:1}],data:new Float32Array(i)})},n.updateAttribute=function(e,n,r,i){var o=this;if(t.prototype.updateAttribute.call(this,e,n,r,i),this.updateBatchedAttribute(e,n,r,i),"r"===r||"rx"===r||"ry"===r||"lineWidth"===r||"stroke"===r||"lineDash"===r||"strokeOpacity"===r){var a=[];e.forEach((function(t){var e=t,n=o.shouldOmitStroke(e.parsedStyle),r=o.getSize(t.parsedStyle,t.nodeName),i=[r[0],r[1]];a.push.apply(a,i.concat([Sv.indexOf(t.nodeName),t.parsedStyle.radius||0,n?1:0,0]))})),this.geometry.updateVertexBuffer(Rv.PACKED_STYLE,Av.SIZE,n,new Uint8Array(new Float32Array(a).buffer))}},n.getSize=function(t,e){var n=[0,0];if(e===ys.CIRCLE){var r=t.r;n=[r,r]}else if(e===ys.ELLIPSE){n=[t.rx,t.ry]}return n},n.shouldOmitStroke=function(t){var e=t.lineDash,n=t.stroke,r=t.strokeOpacity,i=n&&!n.isNone,o=e&&e.length&&e.every((function(t){return 0!==t}));return!i||i&&(o||r<1)},n.needDrawStrokeSeparately=function(t){var e=t.stroke,n=t.lineDash,r=t.lineWidth,i=t.strokeOpacity,o=e&&!e.isNone,a=n&&n.length&&n.every((function(t){return 0!==t}));return o&&r>0&&(a||i<1)},e}(Tv);bv=_([Object(c.injectable)()],bv);var xv,Mv,Ov=[0,-.5,0,0,0,1,-.5,1,1,0,1,.5,1,1,1,0,.5,0,0,1];!function(t){t[t.POINT=5]="POINT",t[t.CAP=6]="CAP",t[t.DASH=7]="DASH"}(xv||(xv={})),function(t){t[t.POSITION=9]="POSITION",t[t.UV=11]="UV",t[t.POINTA=10]="POINTA",t[t.POINTB=12]="POINTB",t[t.CAP=13]="CAP",t[t.DASH=14]="DASH"}(Mv||(Mv={}));var Cv={butt:1,round:2,square:3},Nv=function(t){function e(){return t.apply(this,arguments)||this}uh(e,t);var n=e.prototype;return n.shouldMerge=function(e,n){var r=t.prototype.shouldMerge.call(this,e,n);return!!r},n.createMaterial=function(t){this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = POSITION) in vec3 a_Position;\nlayout(location = POINTA) in vec3 a_PointA;\nlayout(location = POINTB) in vec3 a_PointB;\nlayout(location = CAP) in float a_Cap;\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\nlayout(location = DASH) in vec4 a_Dash;\n\nout vec4 v_Dash;\n// out vec2 v_Normal;\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n  float strokeWidth;\n  if (u_IsPicking > 0.5) {\n    strokeWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\n  } else {\n    strokeWidth = u_StrokeWidth;\n  }\n\n  float isBillboard = a_Dash.w;\n  if (isBillboard < 0.5) {\n    vec2 xBasis = a_PointB.xy - a_PointA.xy;\n    vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n\n    vec2 point = a_PointA.xy + xBasis * a_Position.x + yBasis * strokeWidth * a_Position.y;\n    point = point - u_Anchor.xy * abs(xBasis);\n\n    // round & square\n    if (a_Cap > 1.0) {\n      point += sign(a_Position.x - 0.5) * normalize(xBasis) * vec2(strokeWidth / 2.0);\n    }\n\n    gl_Position = project(vec4(point, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n  } else {\n    // clip space\n    vec4 clip0 = project(vec4(a_PointA, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n    vec4 clip1 = project(vec4(a_PointB, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n    // screen space\n    vec2 screen0 = u_Viewport * (0.5 * clip0.xy / clip0.w + 0.5);\n    vec2 screen1 = u_Viewport * (0.5 * clip1.xy / clip1.w + 0.5);\n    vec2 xBasis = normalize(screen1 - screen0);\n    vec2 yBasis = vec2(-xBasis.y, xBasis.x);\n    vec2 pt0 = screen0 + strokeWidth * (a_Position.x * xBasis + a_Position.y * yBasis);\n    vec2 pt1 = screen1 + strokeWidth * (a_Position.x * xBasis + a_Position.y * yBasis);\n    vec2 pt = mix(pt0, pt1, a_Position.z);\n    vec4 clip = mix(clip0, clip1, a_Position.z);\n    gl_Position = vec4(clip.w * (2.0 * pt / u_Viewport - 1.0), clip.z, clip.w);\n  }\n\n  v_Dash = vec4(a_Position.x, a_Dash.xyz);\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nin vec4 v_Dash;\n// in vec2 v_Normal;\n\nout vec4 outputColor;\n\nvoid main() {\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n  #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(u_PickingColor, 1.0);\n  } else {\n    outputColor = u_StrokeColor;\n    #ifdef USE_MAP\n        outputColor = u_Color;\n    #endif\n\n    // float blur = 1. - smoothstep(0.98, 1., length(v_Normal));\n    float u_dash_offset = v_Dash.y;\n    float u_dash_array = v_Dash.z;\n    float u_dash_ratio = v_Dash.w;\n    outputColor.a = outputColor.a\n      // * blur\n      * u_Opacity * u_StrokeOpacity\n      * ceil(mod(v_Dash.x + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));\n  }\n}",this.material.defines=sh({},this.material.defines,gv(Mv))},n.createGeometry=function(e){var n=this;t.prototype.createGeometry.call(this,e);var r=[],i=[],o=[],a=[],s=0;e.forEach((function(t){var e,u;if(t.nodeName===ys.LINE)e=t.parsedStyle,u=t.getTotalLength();else if(t.nodeName===ys.POLYLINE){var c=t.parsedStyle,l=c.points.points,f=c.defX,h=c.defY,d=c.lineCap,p=c.markerStart,v=c.markerEnd,g=c.markerStartOffset,m=c.markerEndOffset;e={x1:l[0][0],y1:l[0][1],x2:l[l.length-1][0],y2:l[l.length-1][1],z1:0,z2:0,defX:f,defY:h,lineCap:d,isBillboard:!0,markerStart:p,markerEnd:v,markerStartOffset:g,markerEndOffset:m},u=t.getTotalLength()}else if(t.nodeName===ys.PATH){var y=t.parsedStyle,_=y.path.curve,E=y.defX,T=y.defY,R=y.lineCap,A=y.markerStart,S=y.markerEnd,b=y.markerStartOffset,x=y.markerEndOffset;e={x1:_[0][1],y1:_[0][2],x2:_[1][5],y2:_[1][6],z1:0,z2:0,defX:E,defY:T,lineCap:R,isBillboard:!1,markerStart:A,markerEnd:S,markerStartOffset:b,markerEndOffset:x},u=t.getTotalLength()}var M=e,O=M.x1,C=M.y1,N=M.x2,P=M.y2,I=M.z1,w=M.z2,D=M.defX,L=M.defY,B=M.lineCap,F=M.isBillboard,k=n.calcOffset(e),U=k.startOffsetX,G=k.startOffsetY,V=k.endOffsetX,j=k.endOffsetY,W=n.calcDash(e,u),X=W.dashOffset,H=W.dashSegmentPercent,Y=W.dashRatioInEachSegment;i.push(Cv[B]),o.push(X,H,Y,F?1:0),r.push(O-D+U,C-L+G,I,N-D+V,P-L+j,w),a.push(0+s,2+s,1+s,0+s,3+s,2+s),s+=4})),this.geometry.setIndexBuffer(new Uint32Array(a)),this.geometry.vertexCount=6,this.geometry.setVertexBuffer({bufferIndex:mv.POSITION,byteStride:20,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGB,bufferByteOffset:0,location:Mv.POSITION,divisor:0},{format:zh.F32_RG,bufferByteOffset:12,location:Mv.UV,divisor:0}],data:new Float32Array(Ov)}),this.geometry.setVertexBuffer({bufferIndex:xv.POINT,byteStride:24,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGB,bufferByteOffset:0,location:Mv.POINTA,divisor:1},{format:zh.F32_RGB,bufferByteOffset:12,location:Mv.POINTB,divisor:1}],data:new Float32Array(r)}),this.geometry.setVertexBuffer({bufferIndex:xv.CAP,byteStride:4,frequency:Dh.PerInstance,attributes:[{format:zh.F32_R,bufferByteOffset:0,location:Mv.CAP,divisor:1}],data:new Float32Array(i)}),this.geometry.setVertexBuffer({bufferIndex:xv.DASH,byteStride:16,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RGBA,bufferByteOffset:0,location:Mv.DASH,divisor:1}],data:new Float32Array(o)})},n.updateAttribute=function(e,n,r,i){var o=this;if(t.prototype.updateAttribute.call(this,e,n,r,i),this.updateBatchedAttribute(e,n,r,i),"x1"===r||"y1"===r||"x2"===r||"y2"===r||"z1"===r||"z2"===r||"markerStartOffset"===r||"markerEndOffset"===r||"markerStart"===r||"markerEnd"===r||"points"===r||"path"===r){var a=[];e.forEach((function(t){var e;if(t.nodeName===ys.LINE)e=t.parsedStyle;else if(t.nodeName===ys.POLYLINE&&t.renderable.proxyNodeName===ys.LINE){var n=t.parsedStyle,r=n.points.points,i=n.defX,s=n.defY,u=n.lineCap,c=n.markerStart,l=n.markerEnd,f=n.markerStartOffset,h=n.markerEndOffset;e={x1:r[0][0],y1:r[0][1],x2:r[r.length-1][0],y2:r[r.length-1][1],z1:0,z2:0,defX:i,defY:s,lineCap:u,isBillboard:!0,markerStart:c,markerEnd:l,markerStartOffset:f,markerEndOffset:h}}else if(t.nodeName===ys.PATH&&t.renderable.proxyNodeName===ys.LINE){var d=t.parsedStyle,p=d.path.curve,v=d.defX,g=d.defY,m=d.lineCap,y=d.markerStart,_=d.markerEnd,E=d.markerStartOffset,T=d.markerEndOffset;e={x1:p[0][1],y1:p[0][2],x2:p[1][5],y2:p[1][6],z1:0,z2:0,defX:v,defY:g,lineCap:m,isBillboard:!0,markerStart:y,markerEnd:_,markerStartOffset:E,markerEndOffset:T}}var R=e,A=R.x1,S=R.y1,b=R.x2,x=R.y2,M=R.z1,O=R.z2,C=R.defX,N=R.defY,P=o.calcOffset(e),I=P.startOffsetX,w=P.startOffsetY,D=P.endOffsetX,L=P.endOffsetY;a.push(A-C+I,S-N+w,M,b-C+D,x-N+L,O)})),this.geometry.updateVertexBuffer(xv.POINT,Mv.POINTA,n,new Uint8Array(new Float32Array(a).buffer))}else if("lineDashOffset"===r||"lineDash"===r){var s=[];e.forEach((function(t){var e=t.getTotalLength(),n=o.calcDash(t.parsedStyle,e),r=n.dashOffset,i=n.dashSegmentPercent,a=n.dashRatioInEachSegment;s.push(r,i,a,t.parsedStyle.isBillboard?1:0)})),this.geometry.updateVertexBuffer(xv.DASH,Mv.DASH,n,new Uint8Array(new Float32Array(s).buffer))}else if("lineCap"===r){var u=[];e.forEach((function(t){var e=t.parsedStyle.lineCap;u.push(Cv[e])})),this.geometry.updateVertexBuffer(xv.CAP,Mv.CAP,n,new Uint8Array(new Float32Array(u).buffer))}},n.calcOffset=function(t){var e,n,r=t.x1,i=t.y1,o=t.x2,a=t.y2,s=t.markerStart,u=t.markerEnd,c=t.markerStartOffset,l=t.markerEndOffset,f=0,h=0,d=0,p=0,v=0;return s&&s instanceof Gc&&c&&(e=o-r,n=a-i,v=Math.atan2(n,e),f=Math.cos(v)*(c||0),h=Math.sin(v)*(c||0)),u&&u instanceof Gc&&l&&(e=r-o,n=i-a,v=Math.atan2(n,e),d=Math.cos(v)*(l||0),p=Math.sin(v)*(l||0)),{startOffsetX:f,startOffsetY:h,endOffsetX:d,endOffsetY:p}},n.calcDash=function(t,e){var n=t.lineDash,r=t.lineDashOffset,i=0,o=1,a=0;if(n&&n.length){i=(r||0)/e;var s=n.reduce((function(t,e){return t+e}),0);0===s?(o=1,a=0):(o=s/e,a=n[1]/s)}return{dashOffset:i,dashSegmentPercent:o,dashRatioInEachSegment:a}},e}(Tv);function Pv(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}Nv=_([Object(c.injectable)()],Nv);var Iv=function(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}};function wv(t,e,n,r,i){var o=1-i;return o*o*o*t+3*e*i*o*o+3*n*i*i*o+r*i*i*i}function Dv(t,e,n,r,i,o,a,s,u){var c=wv(t,n,i,a,u),l=wv(e,r,o,s,u),f=Iv(t,e,n,r,u),h=Iv(n,r,i,o,u),d=Iv(i,o,a,s,u),p=Iv(f.x,f.y,h.x,h.y,u),v=Iv(h.x,h.y,d.x,d.y,u);return[[t,e,f.x,f.y,p.x,p.y,c,l],[c,l,v.x,v.y,d.x,d.y,a,s]]}function Lv(t,e,n,r,i,o,a,s,u){if(0===u)return function(t,e){for(var n=0,r=t.length,i=0;i<r;i++){n+=Pv(t[i],e[i],t[(i+1)%r],e[(i+1)%r])}return n/2}([t,n,i,a],[e,r,o,s]);var c=Dv(t,e,n,r,i,o,a,s,.5),l=[].concat(c[0],[u-1]),f=[].concat(c[1],[u-1]);return Lv.apply(void 0,l)+Lv.apply(void 0,f)}var Bv,Fv=function(t,e,n,r,i,o,a,s){return Lv(t,e,n,r,i,o,a,s,3)};!function(t){t[t.NONE=0]="NONE",t[t.FILL=1]="FILL",t[t.JOINT_BEVEL=4]="JOINT_BEVEL",t[t.JOINT_MITER=8]="JOINT_MITER",t[t.JOINT_ROUND=12]="JOINT_ROUND",t[t.JOINT_CAP_BUTT=16]="JOINT_CAP_BUTT",t[t.JOINT_CAP_SQUARE=18]="JOINT_CAP_SQUARE",t[t.JOINT_CAP_ROUND=20]="JOINT_CAP_ROUND",t[t.FILL_EXPAND=24]="FILL_EXPAND",t[t.CAP_BUTT=32]="CAP_BUTT",t[t.CAP_SQUARE=64]="CAP_SQUARE",t[t.CAP_ROUND=96]="CAP_ROUND",t[t.CAP_BUTT2=128]="CAP_BUTT2"}(Bv||(Bv={}));var kv,Uv,Gv;!function(t){t[t.PACKED=0]="PACKED",t[t.VERTEX_NUM=1]="VERTEX_NUM",t[t.TRAVEL=2]="TRAVEL"}(kv||(kv={})),function(t){t[t.PREV=0]="PREV",t[t.POINT1=1]="POINT1",t[t.POINT2=2]="POINT2",t[t.NEXT=3]="NEXT",t[t.VERTEX_JOINT=4]="VERTEX_JOINT",t[t.VERTEX_NUM=5]="VERTEX_NUM",t[t.TRAVEL=6]="TRAVEL"}(Uv||(Uv={})),function(t){t.MODEL_MATRIX="u_ModelMatrix",t.FILL_COLOR="u_FillColor",t.STROKE_COLOR="u_StrokeColor",t.STROKE_WIDTH="u_StrokeWidth",t.INCREASED_LINE_WIDTH_FOR_HIT_TESTING="u_IncreasedLineWidthForHitTesting",t.OPACITY="u_Opacity",t.FILL_OPACITY="u_FillOpacity",t.STROKE_OPACITY="u_StrokeOpacity",t.EXPAND="u_Expand",t.MITER_LIMIT="u_MiterLimit",t.SCALE_MODE="u_ScaleMode",t.ALIGNMENT="u_Alignment",t.PICKING_COLOR="u_PickingColor",t.DASH="u_Dash",t.GAP="u_Gap",t.DASH_OFFSET="u_DashOffset",t.VISIBLE="u_Visible",t.Z_INDEX="u_ZIndex"}(Gv||(Gv={}));var Vv=function(t){function e(){return t.apply(this,arguments)||this}uh(e,t);var n=e.prototype;return n.shouldMerge=function(t,e){return!1},n.updateAttribute=function(e,n,r,i){var o=this;t.prototype.updateAttribute.call(this,e,n,r,i),e.forEach((function(t){var e=t.parsedStyle,n=e.stroke,a=e.opacity,s=e.fillOpacity,u=e.strokeOpacity,c=e.lineWidth,l=e.increasedLineWidthForHitTesting,f=e.anchor,h=e.lineDash,d=e.lineDashOffset,p=e.visibility;if("lineJoin"===r||"lineCap"===r||"markerStart"===r||"markerEnd"===r||"markerStartOffset"===r||"markerEndOffset"===r||t.nodeName===ys.CIRCLE&&"r"===r||t.nodeName===ys.ELLIPSE&&("rx"===r||"ry"===r)||t.nodeName===ys.RECT&&("width"===r||"height"===r||"radius"===r)||t.nodeName===ys.LINE&&("x1"===r||"y1"===r||"x2"===r||"y2"===r)||t.nodeName===ys.POLYLINE&&"points"===r||t.nodeName===ys.POLYGON&&"points"===r||t.nodeName===ys.PATH&&"path"===r)o.material.geometryDirty=!0,o.material.programDirty=!0;else if("stroke"===r){var v,g=[0,0,0,0];n instanceof Xa&&(g=[Number(n.r)/255,Number(n.g)/255,Number(n.b)/255,Number(n.alpha)]),o.material.setUniforms(((v={})[Gv.STROKE_COLOR]=g,v))}else if("opacity"===r){var m;o.material.setUniforms(((m={})[Gv.OPACITY]=a,m))}else if("fillOpacity"===r){var y;o.material.setUniforms(((y={})[Gv.FILL_OPACITY]=s,y))}else if("strokeOpacity"===r){var _;o.material.setUniforms(((_={})[Gv.STROKE_OPACITY]=u,_))}else if("lineWidth"===r){var E;o.material.setUniforms(((E={})[Gv.STROKE_WIDTH]=c,E))}else if("increasedLineWidthForHitTesting"===r){var T;o.material.setUniforms(((T={})[Gv.INCREASED_LINE_WIDTH_FOR_HIT_TESTING]=l||0,T))}else if("anchor"===r||"modelMatrix"===r){var R,A=0,S=0,b=t.getGeometryBounds();if(b){var x=b.halfExtents;A=-x[0]*f[0]*2,S=-x[1]*f[1]*2}var M=gh();Eh(M,t.getWorldTransform(),_h(M,Th(A,S,0))),o.material.setUniforms(((R={})[Gv.MODEL_MATRIX]=M,R))}else if("visibility"===r){var O;o.material.setUniforms(((O={})[Gv.VISIBLE]="visible"===p?1:0,O))}else if("lineDash"===r){var C;o.material.setUniforms(((C={})[Gv.DASH]=h[0]||0,C[Gv.GAP]=h[1]||0,C))}else if("lineDashOffset"===r){var N;o.material.setUniforms(((N={})[Gv.DASH_OFFSET]=d||0,N))}else if("pointerEvents"===r){var P,I,w=i&&t.isInteractive()&&(null===(P=t.renderable3D)||void 0===P?void 0:P.encodedPickingColor)||[0,0,0];o.material.setUniforms(((I={})[Gv.PICKING_COLOR]=w,I))}}))},n.changeRenderOrder=function(t,e){var n;this.material&&this.material.setUniforms(((n={})[Gv.Z_INDEX]=.005*e,n))},n.createMaterial=function(t){var e,n;this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_FillColor;\n  vec4 u_StrokeColor;\n  float u_StrokeWidth;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_StrokeOpacity;\n  float u_Expand;\n  float u_MiterLimit;\n  float u_ScaleMode;\n  float u_Alignment;\n  vec3 u_PickingColor;\n  float u_Dash;\n  float u_Gap;\n  float u_DashOffset;\n  float u_Visible;\n  float u_ZIndex;\n  float u_IncreasedLineWidthForHitTesting;\n};\n\nlayout(location = PREV) in vec2 a_Prev;\nlayout(location = POINT1) in vec2 a_Point1;\nlayout(location = POINT2) in vec2 a_Point2;\nlayout(location = NEXT) in vec2 a_Next;\nlayout(location = VERTEX_JOINT) in float a_VertexJoint;\nlayout(location = VERTEX_NUM) in float a_VertexNum;\nlayout(location = TRAVEL) in float a_Travel;\n\nconst float FILL = 1.0;\nconst float BEVEL = 4.0;\nconst float MITER = 8.0;\nconst float ROUND = 12.0;\nconst float JOINT_CAP_BUTT = 16.0;\nconst float JOINT_CAP_SQUARE = 18.0;\nconst float JOINT_CAP_ROUND = 20.0;\nconst float FILL_EXPAND = 24.0;\nconst float CAP_BUTT = 1.0;\nconst float CAP_SQUARE = 2.0;\nconst float CAP_ROUND = 3.0;\nconst float CAP_BUTT2 = 4.0;\n\nout vec4 v_Distance;\nout vec4 v_Arc;\nout float v_Type;\nout float v_Travel;\n\nvec2 doBisect(\n  vec2 norm, float len, vec2 norm2, float len2, float dy, float inner\n) {\n  vec2 bisect = (norm + norm2) / 2.0;\n  bisect /= dot(norm, bisect);\n  vec2 shift = dy * bisect;\n  if (inner > 0.5) {\n    if (len < len2) {\n      if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {\n        return dy * norm;\n      }\n    } else {\n      if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {\n        return dy * norm;\n      }\n    }\n  }\n  return dy * bisect;\n}\n\nvoid main() {\n  vec2 pointA = (u_ModelMatrix * vec4(a_Point1, 0., 1.0)).xy;\n  vec2 pointB = (u_ModelMatrix * vec4(a_Point2, 0., 1.0)).xy;\n\n  vec2 xBasis = pointB - pointA;\n  float len = length(xBasis);\n  vec2 forward = xBasis / len;\n  vec2 norm = vec2(forward.y, -forward.x);\n\n  float type = a_VertexJoint;\n\n  float lineWidth;\n  if (u_IsPicking > 0.5) {\n    lineWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\n  } else {\n    lineWidth = u_StrokeWidth;\n  }\n\n  if (u_ScaleMode > 2.5) {\n      lineWidth *= length(u_ModelMatrix * vec4(1.0, 0.0, 0.0, 0.0));\n  } else if (u_ScaleMode > 1.5) {\n      lineWidth *= length(u_ModelMatrix * vec4(0.0, 1.0, 0.0, 0.0));\n  } else if (u_ScaleMode > 0.5) {\n      vec2 avgDiag = (u_ModelMatrix * vec4(1.0, 1.0, 0.0, 0.0)).xy;\n      lineWidth *= sqrt(dot(avgDiag, avgDiag) * 0.5);\n  }\n  float capType = floor(type / 32.0);\n  type -= capType * 32.0;\n  v_Arc = vec4(0.0);\n  lineWidth *= 0.5;\n  float lineAlignment = 2.0 * u_Alignment - 1.0;\n\n  vec2 pos;\n\n  if (capType == CAP_ROUND) {\n      if (a_VertexNum < 3.5) {\n      gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n      }\n      type = JOINT_CAP_ROUND;\n      capType = 0.0;\n  }\n\n  if (type >= BEVEL) {\n      float dy = lineWidth + u_Expand;\n      float inner = 0.0;\n      if (a_VertexNum >= 1.5) {\n      dy = -dy;\n      inner = 1.0;\n      }\n\n      vec2 base, next, xBasis2, bisect;\n      float flag = 0.0;\n      float sign2 = 1.0;\n      if (a_VertexNum < 0.5 || a_VertexNum > 2.5 && a_VertexNum < 3.5) {\n      next = (u_ModelMatrix * vec4(a_Prev, 0.0, 1.0)).xy;\n      base = pointA;\n      flag = type - floor(type / 2.0) * 2.0;\n      sign2 = -1.0;\n\n      } else {\n      next = (u_ModelMatrix * vec4(a_Next, 0.0, 1.0)).xy;\n      base = pointB;\n      if (type >= MITER && type < MITER + 3.5) {\n          flag = step(MITER + 1.5, type);\n          // check miter limit here?\n      }\n      }\n      xBasis2 = next - base;\n      float len2 = length(xBasis2);\n      vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;\n      float D = norm.x * norm2.y - norm.y * norm2.x;\n      if (D < 0.0) {\n      inner = 1.0 - inner;\n      }\n      norm2 *= sign2;\n\n      if (abs(lineAlignment) > 0.01) {\n      float shift = lineWidth * lineAlignment;\n      pointA += norm * shift;\n      pointB += norm * shift;\n      if (abs(D) < 0.01) {\n          base += norm * shift;\n      } else {\n          base += doBisect(norm, len, norm2, len2, shift, 0.0);\n      }\n      }\n\n      float collinear = step(0.0, dot(norm, norm2));\n      v_Type = 0.0;\n      float dy2 = -1000.0;\n      float dy3 = -1000.0;\n      if (abs(D) < 0.01 && collinear < 0.5) {\n      if (type >= ROUND && type < ROUND + 1.5) {\n          type = JOINT_CAP_ROUND;\n      }\n      //TODO: BUTT here too\n      }\n\n      if (a_VertexNum < 3.5) {\n      if (abs(D) < 0.01) {\n          pos = dy * norm;\n      } else {\n          if (flag < 0.5 && inner < 0.5) {\n          pos = dy * norm;\n          } else {\n          pos = doBisect(norm, len, norm2, len2, dy, inner);\n          }\n      }\n      if (capType >= CAP_BUTT && capType < CAP_ROUND) {\n          float extra = step(CAP_SQUARE, capType) * lineWidth;\n          vec2 back = -forward;\n          if (a_VertexNum < 0.5 || a_VertexNum > 2.5) {\n          pos += back * (u_Expand + extra);\n          dy2 = u_Expand;\n          } else {\n          dy2 = dot(pos + base - pointA, back) - extra;\n          }\n      }\n      if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {\n          float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;\n          if (a_VertexNum < 0.5 || a_VertexNum > 2.5) {\n          dy3 = dot(pos + base - pointB, forward) - extra;\n          } else {\n          pos += forward * (u_Expand + extra);\n          dy3 = u_Expand;\n          if (capType >= CAP_BUTT) {\n              dy2 -= u_Expand + extra;\n          }\n          }\n      }\n      } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {\n      if (inner > 0.5) {\n          dy = -dy;\n          inner = 0.0;\n      }\n      vec2 d2 = abs(dy) * forward;\n      if (a_VertexNum < 4.5) {\n          dy = -dy;\n          pos = dy * norm;\n      } else if (a_VertexNum < 5.5) {\n          pos = dy * norm;\n      } else if (a_VertexNum < 6.5) {\n          pos = dy * norm + d2;\n          v_Arc.x = abs(dy);\n      } else {\n          dy = -dy;\n          pos = dy * norm + d2;\n          v_Arc.x = abs(dy);\n      }\n      dy2 = 0.0;\n      v_Arc.y = dy;\n      v_Arc.z = 0.0;\n      v_Arc.w = lineWidth;\n      v_Type = 3.0;\n      } else if (abs(D) < 0.01) {\n      pos = dy * norm;\n      } else {\n      if (type >= ROUND && type < ROUND + 1.5) {\n          if (inner > 0.5) {\n          dy = -dy;\n          inner = 0.0;\n          }\n          if (a_VertexNum < 4.5) {\n          pos = doBisect(norm, len, norm2, len2, -dy, 1.0);\n          } else if (a_VertexNum < 5.5) {\n          pos = dy * norm;\n          } else if (a_VertexNum > 7.5) {\n          pos = dy * norm2;\n          } else {\n          pos = doBisect(norm, len, norm2, len2, dy, 0.0);\n          float d2 = abs(dy);\n          if (length(pos) > abs(dy) * 1.5) {\n              if (a_VertexNum < 6.5) {\n              pos.x = dy * norm.x - d2 * norm.y;\n              pos.y = dy * norm.y + d2 * norm.x;\n              } else {\n              pos.x = dy * norm2.x + d2 * norm2.y;\n              pos.y = dy * norm2.y - d2 * norm2.x;\n              }\n          }\n          }\n          vec2 norm3 = normalize(norm + norm2);\n          float sign = step(0.0, dy) * 2.0 - 1.0;\n          v_Arc.x = sign * dot(pos, norm3);\n          v_Arc.y = pos.x * norm3.y - pos.y * norm3.x;\n          v_Arc.z = dot(norm, norm3) * lineWidth;\n          v_Arc.w = lineWidth;\n          dy = -sign * dot(pos, norm);\n          dy2 = -sign * dot(pos, norm2);\n          dy3 = v_Arc.z - v_Arc.x;\n          v_Type = 3.0;\n      } else {\n          float hit = 0.0;\n          if (type >= BEVEL && type < BEVEL + 1.5) {\n          if (dot(norm, norm2) > 0.0) {\n              type = MITER;\n          }\n          }\n          if (type >= MITER && type < MITER + 3.5) {\n          if (inner > 0.5) {\n              dy = -dy;\n              inner = 0.0;\n          }\n          float sign = step(0.0, dy) * 2.0 - 1.0;\n          pos = doBisect(norm, len, norm2, len2, dy, 0.0);\n          if (length(pos) > abs(dy) * u_MiterLimit) {\n              type = BEVEL;\n          } else {\n              if (a_VertexNum < 4.5) {\n              dy = -dy;\n              pos = doBisect(norm, len, norm2, len2, dy, 1.0);\n              } else if (a_VertexNum < 5.5) {\n              pos = dy * norm;\n              } else if (a_VertexNum > 6.5) {\n              pos = dy * norm2;\n              }\n              v_Type = 1.0;\n              dy = -sign * dot(pos, norm);\n              dy2 = -sign * dot(pos, norm2);\n              hit = 1.0;\n          }\n          }\n          if (type >= BEVEL && type < BEVEL + 1.5) {\n          if (inner > 0.5) {\n              dy = -dy;\n              inner = 0.0;\n          }\n          float d2 = abs(dy);\n          vec2 pos3 = vec2(dy * norm.x - d2 * norm.y, dy * norm.y + d2 * norm.x);\n          vec2 pos4 = vec2(dy * norm2.x + d2 * norm2.y, dy * norm2.y - d2 * norm2.x);\n          if (a_VertexNum < 4.5) {\n              pos = doBisect(norm, len, norm2, len2, -dy, 1.0);\n          } else if (a_VertexNum < 5.5) {\n              pos = dy * norm;\n          } else if (a_VertexNum > 7.5) {\n              pos = dy * norm2;\n          } else {\n              if (a_VertexNum < 6.5) {\n              pos = pos3;\n              } else {\n              pos = pos4;\n              }\n          }\n          vec2 norm3 = normalize(norm + norm2);\n          float sign = step(0.0, dy) * 2.0 - 1.0;\n          dy = -sign * dot(pos, norm);\n          dy2 = -sign * dot(pos, norm2);\n          dy3 = (-sign * dot(pos, norm3)) + lineWidth;\n          v_Type = 4.0;\n          hit = 1.0;\n          }\n          if (hit < 0.5) {\n          gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n          return;\n          }\n      }\n      }\n      pos += base;\n      v_Distance = vec4(dy, dy2, dy3, lineWidth) * u_DevicePixelRatio;\n      v_Arc = v_Arc * u_DevicePixelRatio;\n      v_Travel = a_Travel + dot(pos - pointA, vec2(-norm.y, norm.x));\n  }\n\n  gl_Position = u_ProjectionMatrix * u_ViewMatrix * vec4(pos, u_ZIndex, 1.0);\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_FillColor;\n  vec4 u_StrokeColor;\n  float u_StrokeWidth;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_StrokeOpacity;\n  float u_Expand;\n  float u_MiterLimit;\n  float u_ScaleMode;\n  float u_Alignment;\n  vec3 u_PickingColor;\n  float u_Dash;\n  float u_Gap;\n  float u_DashOffset;\n  float u_Visible;\n  float u_ZIndex;\n  float u_IncreasedLineWidthForHitTesting;\n};\n\nin vec4 v_Distance;\nin vec4 v_Arc;\nin float v_Type;\nin float v_Travel;\n\nout vec4 outputColor;\n\n#define COLOR_SCALE 1. / 255.\n\nvoid main(){\n  if (u_Visible < 0.5) {\n    discard;\n  }\n\n  float alpha = 1.0;\n  float lineWidth = v_Distance.w;\n  if (v_Type < 0.5) {\n    float left = max(v_Distance.x - 0.5, -v_Distance.w);\n    float right = min(v_Distance.x + 0.5, v_Distance.w);\n    float near = v_Distance.y - 0.5;\n    float far = min(v_Distance.y + 0.5, 0.0);\n    float top = v_Distance.z - 0.5;\n    float bottom = min(v_Distance.z + 0.5, 0.0);\n    alpha = max(right - left, 0.0) * max(bottom - top, 0.0) * max(far - near, 0.0);\n  } else if (v_Type < 1.5) {\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\n    alpha = a2 * b2 - a1 * b1;\n  } else if (v_Type < 2.5) {\n    alpha *= max(min(v_Distance.x + 0.5, 1.0), 0.0);\n    alpha *= max(min(v_Distance.y + 0.5, 1.0), 0.0);\n    alpha *= max(min(v_Distance.z + 0.5, 1.0), 0.0);\n  } else if (v_Type < 3.5) {\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\n    float alpha_miter = a2 * b2 - a1 * b1;\n    float alpha_plane = max(min(v_Distance.z + 0.5, 1.0), 0.0);\n    float d = length(v_Arc.xy);\n    float circle_hor = max(min(v_Arc.w, d + 0.5) - max(-v_Arc.w, d - 0.5), 0.0);\n    float circle_vert = min(v_Arc.w * 2.0, 1.0);\n    float alpha_circle = circle_hor * circle_vert;\n    alpha = min(alpha_miter, max(alpha_circle, alpha_plane));\n  } else {\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\n    alpha = a2 * b2 - a1 * b1;\n    alpha *= max(min(v_Distance.z + 0.5, 1.0), 0.0);\n  }\n\n  if (u_Dash + u_Gap > 1.0) {\n    float scalingFactor = sqrt(u_ModelMatrix[0][0] * u_ModelMatrix[0][0] + u_ModelMatrix[0][1] * u_ModelMatrix[0][1] + u_ModelMatrix[0][2] * u_ModelMatrix[0][2]);\n    float travel = mod(v_Travel + u_Gap * scalingFactor * 0.5 + u_DashOffset, u_Dash * scalingFactor + u_Gap * scalingFactor) - (u_Gap * scalingFactor * 0.5);\n    float left = max(travel - 0.5, -0.5);\n    float right = min(travel + 0.5, u_Gap * scalingFactor + 0.5);\n    alpha *= max(0.0, right - left);\n  }\n\n  if (u_IsPicking > 0.5) {\n    vec3 pickingColor = COLOR_SCALE * u_PickingColor;\n    if (pickingColor.x == 0.0 && pickingColor.y == 0.0 && pickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(pickingColor, 1.0);\n  } else {\n    outputColor = u_StrokeColor;\n    outputColor.a *= alpha * u_Opacity * u_StrokeOpacity;\n  }\n}",this.material.defines=sh({},this.material.defines,gv(Uv));var r=t[0],i=r.parsedStyle,o=i.fill,a=i.stroke,s=i.opacity,u=i.fillOpacity,c=i.strokeOpacity,l=i.lineWidth,f=i.increasedLineWidthForHitTesting,h=i.anchor,d=i.lineDash,p=i.lineDashOffset,v=i.visibility,g=[0,0,0,0];o instanceof Xa&&(g=[Number(o.r)/255,Number(o.g)/255,Number(o.b)/255,Number(o.alpha)]);var m=[0,0,0,0];a instanceof Xa&&(m=[Number(a.r)/255,Number(a.g)/255,Number(a.b)/255,Number(a.alpha)]);var y=r.isInteractive()&&(null===(e=r.renderable3D)||void 0===e?void 0:e.encodedPickingColor)||[0,0,0],_=0,E=0,T=r.getGeometryBounds();if(T){var R=T.halfExtents;_=-R[0]*h[0]*2,E=-R[1]*h[1]*2}var A=gh();Eh(A,r.getWorldTransform(),_h(A,Th(_,E,0))),this.material.setUniforms(((n={})[Gv.MODEL_MATRIX]=A,n[Gv.FILL_COLOR]=g,n[Gv.STROKE_COLOR]=m,n[Gv.STROKE_WIDTH]=l,n[Gv.INCREASED_LINE_WIDTH_FOR_HIT_TESTING]=f||0,n[Gv.OPACITY]=s,n[Gv.FILL_OPACITY]=u,n[Gv.STROKE_OPACITY]=c,n[Gv.EXPAND]=1,n[Gv.MITER_LIMIT]=5,n[Gv.SCALE_MODE]=1,n[Gv.ALIGNMENT]=.5,n[Gv.PICKING_COLOR]=y,n[Gv.DASH]=d&&d[0]||0,n[Gv.GAP]=d&&d[1]||0,n[Gv.DASH_OFFSET]=p||0,n[Gv.VISIBLE]="visible"===v?1:0,n[Gv.Z_INDEX]=.005*r.sortable.renderOrder,n)),this.material.cullMode=bh.None},n.createGeometry=function(t){var e=Wv(t[0]),n=e.pointsBuffer,r=e.travelBuffer,i=e.instancedCount;this.geometry.setVertexBuffer({bufferIndex:kv.PACKED,byteStride:48,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RG,bufferByteOffset:0,byteStride:12,location:Uv.PREV,divisor:1},{format:zh.F32_RG,bufferByteOffset:12,byteStride:12,location:Uv.POINT1,divisor:1},{format:zh.F32_R,bufferByteOffset:20,byteStride:12,location:Uv.VERTEX_JOINT,divisor:1},{format:zh.F32_RG,bufferByteOffset:24,byteStride:12,location:Uv.POINT2,divisor:1},{format:zh.F32_RG,bufferByteOffset:36,byteStride:12,location:Uv.NEXT,divisor:1}],data:new Float32Array(n)}),this.geometry.setVertexBuffer({bufferIndex:kv.VERTEX_NUM,byteStride:4,frequency:Dh.PerInstance,attributes:[{format:zh.F32_R,bufferByteOffset:0,byteStride:4,location:Uv.VERTEX_NUM,divisor:0}],data:new Float32Array([0,1,2,3,4,5,6,7,8])}),this.geometry.setVertexBuffer({bufferIndex:kv.TRAVEL,byteStride:4,frequency:Dh.PerInstance,attributes:[{format:zh.F32_R,bufferByteOffset:0,byteStride:4,location:Uv.TRAVEL,divisor:1}],data:new Float32Array(r)}),this.geometry.vertexCount=15,this.geometry.instancedCount=i,this.geometry.setIndexBuffer(new Uint32Array([0,2,1,0,3,2,4,6,5,4,7,6,4,7,8]))},e}(Tv);function jv(t,e,n,r,i,o,a){var s=a[a.length-2],u=a[a.length-1];a.length-=2;var c=function(t,e){var n=Math.ceil(t/10);n<8?n=8:n>2048&&(n=2048);return n}(Fv(s,u,t,e,n,r,i,o)),l=0,f=0,h=0,d=0,p=0;a.push(s,u);for(var v=1,g=0;v<=c;++v)h=(f=(l=1-(g=v/c))*l)*l,p=(d=g*g)*g,a.push(h*s+3*f*g*t+3*l*d*n+p*i,h*u+3*f*g*e+3*l*d*r+p*o)}Vv=_([Object(c.injectable)()],Vv);function Wv(t,e){void 0===e&&(e=!1);var n=t.parsedStyle,r=n.lineCap,i=n.lineJoin,o=t.parsedStyle,a=o.defX,s=o.defY,u=t.parsedStyle,c=u.markerStart,l=u.markerEnd,f=u.markerStartOffset,h=u.markerEndOffset,d=[],p=[];if(t.nodeName===ys.POLYLINE||t.nodeName===ys.POLYGON){var v,g,m=t.parsedStyle.points.points,y=m.length,_=0,E=0,T=0,R=0,A=0;if(c&&c instanceof Gc&&f&&(v=m[1][0]-m[0][0],g=m[1][1]-m[0][1],A=Math.atan2(g,v),_=Math.cos(A)*(f||0),E=Math.sin(A)*(f||0)),l&&l instanceof Gc&&h&&(v=m[y-2][0]-m[y-1][0],g=m[y-2][1]-m[y-1][1],A=Math.atan2(g,v),T=Math.cos(A)*(h||0),R=Math.sin(A)*(h||0)),d[0]=m.reduce((function(t,e,n){var r=0,i=0;return 0===n?(r=_,i=E):n===y-1&&(r=T,i=R),t.push(e[0]-a+r,e[1]-s+i),t}),[]),t.nodeName===ys.POLYGON){if(e)return p=qf()(d[0],[],2),{pointsBuffer:d[0],travelBuffer:[],triangles:p,instancedCount:Math.round(d[0].length/2)};var S;d[0].push(d[0][0],d[0][1]),(S=d[0]).push.apply(S,Xv(d[0][0],d[0][1],d[0][2],d[0][3]))}}else if(t.nodeName===ys.PATH||t.nodeName===ys.CIRCLE||t.nodeName===ys.ELLIPSE||t.nodeName===ys.RECT){var b;if(t.nodeName!==ys.PATH){if(b=Iu(Cs(t,!1),t),a=b.rect.x,s=b.rect.y,t.nodeName===ys.RECT){var x=t.parsedStyle,M=x.width,O=x.height;M<0&&(a+=b.rect.width),O<0&&(s+=b.rect.height)}}else b=t.parsedStyle.path;var C,N,P=b.zCommandIndexes,I=[].concat(b.curve).map((function(t,e){return P.includes(e)?["Z"]:t})),w=I.length&&"Z"===I[I.length-1][0],D=0,L=0,B=0,F=0,k=0;if(c&&c instanceof Gc&&f){var U=c.parentNode.getStartTangent(),G=U[0],V=U[1];C=G[0]-V[0],N=G[1]-V[1],k=Math.atan2(N,C),D=Math.cos(k)*(f||0),L=Math.sin(k)*(f||0)}if(l&&l instanceof Gc&&h){var j=l.parentNode.getEndTangent(),W=j[0],X=j[1];C=W[0]-X[0],N=W[1]-X[1],k=Math.atan2(N,C),B=Math.cos(k)*(h||0),F=Math.sin(k)*(h||0)}var H=-1,Y=-1;if(I.forEach((function(e,n){var r=e[0],i=e.slice(1);if("M"===r)Y++,d[Y]=[],H=d[Y].length,d[Y].push(i[0]-a+D,i[1]-s+L);else if("C"===r){var o=n===I.length-(w?2:1)?B:0,u=n===I.length-(w?2:1)?F:0;jv(i[0]-a,i[1]-s,i[2]-a,i[3]-s,i[4]-a+o,i[5]-s+u,d[Y])}else if("Z"===r&&(t.nodeName===ys.PATH||t.nodeName===ys.RECT)){var c;(Math.abs(d[Y][d[Y].length-2]-d[Y][H])>1e-4||Math.abs(d[Y][d[Y].length-1]-d[Y][H+1])>1e-4)&&d[Y].push(d[Y][H],d[Y][H+1]),(c=d[Y]).push.apply(c,Xv(d[Y][H],d[Y][H+1],d[Y][H+2],d[Y][H+3]))}})),e){var z=d.reduce((function(t,e){return t.push.apply(t,e),t}),[]);return{pointsBuffer:z,travelBuffer:[],triangles:p=qf()(z,[],2),instancedCount:Math.round(z.length/2)}}}var K=function(t){var e;switch(t){case"bevel":e=Bv.JOINT_BEVEL;break;case"round":e=Bv.JOINT_ROUND;break;default:e=Bv.JOINT_MITER}return e}(i),q=function(t){var e;switch(t){case"square":e=Bv.CAP_SQUARE;break;case"round":e=Bv.CAP_ROUND;break;default:e=Bv.CAP_BUTT}return e}(r),Z=q;return q===Bv.CAP_ROUND&&(Z=Bv.JOINT_CAP_ROUND),q===Bv.CAP_BUTT&&(Z=Bv.JOINT_CAP_BUTT),q===Bv.CAP_SQUARE&&(Z=Bv.JOINT_CAP_SQUARE),d.map((function(t){for(var e=3*(Math.round(0)+2),n=0,r=[],i=[],o=0;o<t.length;o+=2)o>1&&(n+=Math.sqrt(Math.pow(t[o]-t[o-2],2)+Math.pow(t[o+1]-t[o+1-2],2))),i.push(n),r[e++]=t[o],r[e++]=t[o+1],r[e]=K,0==o&&q!==Bv.CAP_ROUND&&(r[e]+=q),o+4>=t.length?r[e]+=Z-K:o+2>=t.length&&(r[e]=0),e++;r[e++]=t[t.length-4],r[e++]=t[t.length-3],r[e++]=0,r[0]=t[0],r[1]=t[1],r[2]=0,r[3]=t[2],r[4]=t[3],r[5]=q===Bv.CAP_ROUND?q:0;var a=Math.round(t.length/2);return{pointsBuffer:r,travelBuffer:i,triangles:p,instancedCount:a}})).reduce((function(t,e){var n,r;return(n=t.pointsBuffer).push.apply(n,e.pointsBuffer),(r=t.travelBuffer).push.apply(r,e.travelBuffer),t.instancedCount+=e.instancedCount,t}),{pointsBuffer:[],travelBuffer:[],triangles:p,instancedCount:0})}function Xv(t,e,n,r){void 0===n&&(n=t),void 0===r&&(r=e);var i=[n-t,r-e];return[t+.01*i[0],e+.01*i[1]]}var Hv=function(t){function e(){return t.apply(this,arguments)||this}uh(e,t);var n=e.prototype;return n.shouldMerge=function(t,e){return!1},n.createGeometry=function(t){var e=t[0],n=Wv(e,!0),r=n.triangles,i=n.pointsBuffer;this.geometry.setVertexBuffer({bufferIndex:mv.POSITION,byteStride:8,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:yv.POSITION}],data:new Float32Array(i)});var o=e.getGeometryBounds().halfExtents,a=i.map((function(t,e){return t/o[e%2]/2}));this.geometry.setVertexBuffer({bufferIndex:mv.UV,byteStride:8,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:yv.UV}],data:new Float32Array(a)}),this.geometry.vertexCount=r.length,this.geometry.setIndexBuffer(new Uint32Array(r))},n.createMaterial=function(t){var e,n;this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_FillColor;\n  vec3 u_PickingColor;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_Visible;\n  float u_ZIndex;\n};\n\nlayout(location = POSITION) in vec2 a_Position;\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\n\nvoid main() {\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n  gl_Position = u_ProjectionMatrix * u_ViewMatrix * u_ModelMatrix * vec4(a_Position, u_ZIndex, 1.0);\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_FillColor;\n  vec3 u_PickingColor;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_Visible;\n  float u_ZIndex;\n};\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nout vec4 outputColor;\n\n#define COLOR_SCALE 1. / 255.\n\nvoid main(){\n  if (u_Visible < 0.5) {\n    discard;\n  }\n\n  if (u_IsPicking > 0.5) {\n    vec3 pickingColor = COLOR_SCALE * u_PickingColor;\n    if (pickingColor.x == 0.0 && pickingColor.y == 0.0 && pickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(pickingColor, 1.0);\n  } else {\n\n    vec4 u_Color = u_FillColor;\n\n    #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n    outputColor = u_Color;\n    outputColor.a = outputColor.a * u_Opacity * u_FillOpacity;\n  }\n}";var r=t[0],i=r.parsedStyle,o=i.fill,a=i.opacity,s=i.fillOpacity,u=i.anchor,c=i.visibility,l=[0,0,0,0];o instanceof Xa&&(l=[Number(o.r)/255,Number(o.g)/255,Number(o.b)/255,Number(o.alpha)]);var f=r.isInteractive()&&(null===(e=r.renderable3D)||void 0===e?void 0:e.encodedPickingColor)||[0,0,0],h=0,d=0,p=r.getGeometryBounds();if(p){var v=p.halfExtents;h=-v[0]*u[0]*2,d=-v[1]*u[1]*2}var g=gh();Eh(g,r.getWorldTransform(),_h(g,Th(h,d,0))),this.material.setUniforms(((n={})[Gv.MODEL_MATRIX]=g,n[Gv.FILL_COLOR]=l,n[Gv.PICKING_COLOR]=f,n[Gv.OPACITY]=a,n[Gv.FILL_OPACITY]=s,n[Gv.VISIBLE]="visible"===c?1:0,n[Gv.Z_INDEX]=.005*r.sortable.renderOrder,n))},n.updateAttribute=function(e,n,r,i){var o=this;t.prototype.updateAttribute.call(this,e,n,r,i),e.forEach((function(t){var e=t.parsedStyle,n=e.fill,a=e.opacity,s=e.fillOpacity,u=e.anchor,c=e.visibility;if("lineJoin"===r||"lineCap"===r||"markerStart"===r||"markerEnd"===r||"markerStartOffset"===r||"markerEndOffset"===r||t.nodeName===ys.RECT&&("width"===r||"height"===r||"radius"===r)||t.nodeName===ys.LINE&&("x1"===r||"y1"===r||"x2"===r||"y2"===r)||t.nodeName===ys.POLYLINE&&"points"===r||t.nodeName===ys.POLYGON&&"points"===r||t.nodeName===ys.PATH&&"path"===r)o.material.geometryDirty=!0,o.material.programDirty=!0;else if("fill"===r)if(n instanceof Xa){var l,f=[Number(n.r)/255,Number(n.g)/255,Number(n.b)/255,Number(n.alpha)];o.material.setUniforms(((l={})[Gv.FILL_COLOR]=f,l))}else{var h=o.textureMappings.findIndex((function(t){return"FillTextureMapping"===t.name})),d=o.createFillGradientTextureMapping([o.instance]);h>=0&&o.textureMappings.splice(h,1,d),o.material.textureDirty=!0}else if("opacity"===r){var p;o.material.setUniforms(((p={})[Gv.OPACITY]=a,p))}else if("fillOpacity"===r){var v;o.material.setUniforms(((v={})[Gv.FILL_OPACITY]=s,v))}else if("anchor"===r||"modelMatrix"===r){var g,m=0,y=0,_=t.getGeometryBounds();if(_){var E=_.halfExtents;m=-E[0]*u[0]*2,y=-E[1]*u[1]*2}var T=gh();Eh(T,t.getWorldTransform(),_h(T,Th(m,y,0))),o.material.setUniforms(((g={})[Gv.MODEL_MATRIX]=T,g))}else if("visibility"===r){var R;o.material.setUniforms(((R={})[Gv.VISIBLE]="visible"===c?1:0,R))}else if("pointerEvents"===r){var A,S,b=i&&t.isInteractive()&&(null===(A=t.renderable3D)||void 0===A?void 0:A.encodedPickingColor)||[0,0,0];o.material.setUniforms(((S={})[Gv.PICKING_COLOR]=b,S))}}))},n.changeRenderOrder=function(t,e){var n;this.material&&this.material.setUniforms(((n={})[Gv.Z_INDEX]=.005*e,n))},e}(Tv);Hv=_([Object(c.injectable)()],Hv);var Yv=function(t){function e(){return t.apply(this,arguments)||this}uh(e,t);var n=e.prototype;return n.shouldMerge=function(e,n){var r=t.prototype.shouldMerge.call(this,e,n);return!!r&&this.instance.parsedStyle.img===e.parsedStyle.img},n.createMaterial=function(t){var e=t[0].parsedStyle.img;this.material.defines=sh({},this.material.defines),this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = POSITION) in vec2 a_Size;\n\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n\n  vec2 offset = (a_Uv - u_Anchor.xy) * a_Size;\n\n  gl_Position = project(vec4(offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nout vec4 outputColor;\n\nvoid main() {\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n  #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(u_PickingColor, 1.0);\n  } else {\n    outputColor = u_Color;\n    outputColor.a = outputColor.a * u_Opacity;\n  }\n}";var n=this.texturePool.getOrCreateTexture(this.device,e);this.material.setUniforms({u_Map:n})},n.createGeometry=function(e){t.prototype.createGeometry.call(this,e);var n=[],r=[],i=[];e.forEach((function(t,e){var o=4*e,a=t.parsedStyle,s=a.width,u=a.height;n.push(s,u),r.push(0,0,1,0,1,1,0,1),i.push(0+o,2+o,1+o,0+o,3+o,2+o)})),this.geometry.setIndexBuffer(new Uint32Array(i)),this.geometry.vertexCount=6,this.geometry.setVertexBuffer({bufferIndex:mv.POSITION,byteStride:8,frequency:Dh.PerInstance,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:yv.POSITION}],data:new Float32Array(n)}),this.geometry.setVertexBuffer({bufferIndex:mv.UV,byteStride:8,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:yv.UV}],data:new Float32Array(r)})},n.updateAttribute=function(e,n,r,i){if(t.prototype.updateAttribute.call(this,e,n,r,i),this.updateBatchedAttribute(e,n,r,i),"width"===r||"height"===r){var o=[];e.forEach((function(t){var e=t.parsedStyle,n=e.width,r=e.height;o.push(n,r)})),this.geometry.updateVertexBuffer(mv.POSITION,yv.POSITION,n,new Uint8Array(new Float32Array(o).buffer))}else if("img"===r){var a=this.texturePool.getOrCreateTexture(this.device,i);this.material.setUniforms({u_Map:a})}},e}(Tv);Yv=_([Object(c.injectable)()],Yv);function zv(t,e,n,r){var i=e.width,o=e.height;if(r){if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return t.width=i,t.height=o,t.data=r,t}function Kv(t,e,n,r,i,o){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=t.data,s=e.data,u=0;u<i.height;u++)for(var c=((n.y+u)*t.width+n.x)*o,l=((r.y+u)*e.width+r.x)*o,f=0;f<i.width*o;f++)s[l+f]=a[c+f];return e}var qv=function(){function t(t,e){this.width=void 0,this.height=void 0,this.data=void 0,zv(this,t,1,e)}var e=t.prototype;return e.resize=function(t){!function(t,e,n){var r=e.width,i=e.height;if(r!==t.width||i!==t.height){var o=zv({},{width:r,height:i},n);Kv(t,o,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,r),height:Math.min(t.height,i)},n),t.width=r,t.height=i,t.data=o.data}}(this,t,1)},e.clone=function(){return new t({width:this.width,height:this.height},new Uint8Array(this.data))},t.copy=function(t,e,n,r,i){Kv(t,e,n,r,i,1)},t}();var Zv=function(t){this.image=void 0,this.positions=void 0;var e={},n=[];for(var r in t){var i=t[r],o=e[r]={};for(var a in i){if((h=i[+a])&&0!==h.bitmap.width&&0!==h.bitmap.height){var s={x:0,y:0,w:h.bitmap.width+2,h:h.bitmap.height+2};n.push(s),o[a]={rect:s,metrics:h.metrics}}}}var u=function(t){for(var e,n=0,r=0,i=hh(t);!(e=i()).done;){var o=e.value;n+=o.w*o.h,r=Math.max(r,o.w)}t.sort((function(t,e){return e.h-t.h}));for(var a,s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),r),h:1/0}],u=0,c=0,l=hh(t);!(a=l()).done;)for(var f=a.value,h=s.length-1;h>=0;h--){var d=s[h];if(!(f.w>d.w||f.h>d.h)){if(f.x=d.x,f.y=d.y,c=Math.max(c,f.y+f.h),u=Math.max(u,f.x+f.w),f.w===d.w&&f.h===d.h){var p=s.pop();h<s.length&&(s[h]=p)}else f.h===d.h?(d.x+=f.w,d.w-=f.w):f.w===d.w?(d.y+=f.h,d.h-=f.h):(s.push({x:d.x+f.w,y:d.y,w:d.w-f.w,h:f.h}),d.y+=f.h,d.h-=f.h);break}}return{w:u,h:c,fill:n/(u*c)||0}}(n),c=u.w,l=u.h,f=new qv({width:c||1,height:l||1});for(var r in t){i=t[r];for(var a in i){var h;if((h=i[+a])&&0!==h.bitmap.width&&0!==h.bitmap.height){s=e[r][a].rect;qv.copy(h.bitmap,f,{x:0,y:0},{x:s.x+1,y:s.y+1},h.bitmap)}}}this.image=f,this.positions=e};var Qv,Jv,$v,tg=function(){function t(){this.sdfGeneratorCache={},this.textMetricsCache={},this.glyphAtlas=void 0,this.glyphMap={},this.glyphAtlasTexture=void 0}var e=t.prototype;return e.getMap=function(){return this.glyphMap},e.getAtlas=function(){return this.glyphAtlas},e.getAtlasTexture=function(){return this.glyphAtlasTexture},e.layout=function(t,e,n,r,i,o,a){var s=this,u=[],c=o,l=a,f="right"===r||"end"===r?1:"left"===r||"start"===r?0:.5;return t.forEach((function(t){var r=u.length;Array.from(t).forEach((function(t){var n=s.glyphMap[e],r=t.charCodeAt(0),o=n&&n[r];o&&(u.push({glyph:r,x:c,y:l,scale:1,fontStack:e}),c+=o.metrics.advance+i)}));for(var o=c-i,a=r;a<u.length;a++)u[a].x=u[a].x-f*o;c=0,l+=n})),u},e.generateAtlas=function(t,e,n,r,i,o){var a=this;void 0===t&&(t=""),void 0===r&&(r="");var s=[];this.glyphMap[t]||(s=function(){for(var t=[],e=32;e<128;e++)t.push(String.fromCharCode(e));return t}());var u=Object.keys(this.glyphMap[t]||{});if(Array.from(new Set(i.split(""))).forEach((function(t){-1===u.indexOf(t.charCodeAt(0).toString())&&s.push(t)})),s.length){var c=s.map((function(i){return a.generateSDF(t,e,n,r,i)})).reduce((function(t,e){return t[e.id]=e,t}),{});this.glyphMap[t]=sh({},this.glyphMap[t],c),this.glyphAtlas=new Zv(this.glyphMap);var l=this.glyphAtlas.image,f=l.width,h=l.height,d=l.data;this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.glyphAtlasTexture=o.createTexture(sh({},qh(zh.ALPHA,f,h,1),{pixelStore:{unpackFlipY:!1,unpackAlignment:1},immutable:!1})),this.glyphAtlasTexture.setImageData([d],0)}},e.generateSDF=function(t,e,n,r,i){void 0===t&&(t="");var o=i.charCodeAt(0),a=this.sdfGeneratorCache[t];a||(a=this.sdfGeneratorCache[t]=new $f({fontSize:24,fontFamily:e,fontWeight:n,fontStyle:r,buffer:3,radius:8,cutoff:.25})),this.textMetricsCache[t]||(this.textMetricsCache[t]={}),this.textMetricsCache[t][i]||(this.textMetricsCache[t][i]=a.ctx.measureText(i).width);var s=a.draw(i),u=s.data,c=s.width,l=s.height,f=s.glyphWidth,h=s.glyphHeight,d=s.glyphLeft,p=s.glyphTop,v=s.glyphAdvance;return{id:o,bitmap:new qv({width:c,height:l},u),metrics:{width:f,height:h,left:d,top:p-24+3,advance:v}}},t}();tg=_([Object(c.injectable)()],tg),function(t){t[t.INSTANCED=5]="INSTANCED",t[t.TEX=6]="TEX"}(Qv||(Qv={})),function(t){t[t.TEX=13]="TEX",t[t.OFFSET=14]="OFFSET"}(Jv||(Jv={})),function(t){t.SDF_MAP="u_SDFMap",t.SDF_MAP_SIZE="u_SDFMapSize",t.FONT_SIZE="u_FontSize",t.GAMMA_SCALE="u_GammaScale",t.STROKE_BLUR="u_StrokeBlur",t.HAS_STROKE="u_HasStroke"}($v||($v={}));var eg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).glyphManager=void 0,e}uh(e,t);var n=e.prototype;return n.shouldMerge=function(e,n){var r=t.prototype.shouldMerge.call(this,e,n);if(!r)return!1;if(this.index!==n)return!1;var i=this.instance;return i.parsedStyle.metrics.font===e.parsedStyle.metrics.font&&!["fontSize","fontFamily","fontWeight","textBaseline","letterSpacing"].some((function(t){return i.parsedStyle[t].value!==e.parsedStyle[t].value}))},n.createGeometry=function(t){var e=this,n=this.instance.parsedStyle,r=n.textBaseline,i=n.fontSize,o=n.letterSpacing,a=24/i,s=[],u=[],c=[],l=0;t.forEach((function(t){var n=t.parsedStyle,i=n.metrics,f=n.dx,h=n.dy,d=i.font,p=i.lines,v=i.height,g=i.lineHeight,m=f||0,y=h||0,_=0;"middle"===r?_=-v/2:"bottom"===r?_=-v:"top"===r||"hanging"===r?_=0:"alphabetic"===r?_=.25*g-v:"ideographic"===r&&(_=-v);var E=e.glyphManager.getAtlas(),T=e.buildTextBuffers({object:t,lines:p,fontStack:d,lineHeight:a*g,offsetX:a*m,offsetY:a*(_+y),letterSpacing:a*o,glyphAtlas:E,indicesOffset:l}),R=T.indicesOffset,A=T.indexBuffer,S=T.charUVOffsetBuffer,b=T.charPackedBuffer;l=R,c.push.apply(c,b),u.push.apply(u,S),s.push.apply(s,A)})),this.geometry.vertexCount=s.length,this.geometry.setIndexBuffer(new Uint32Array(s)),this.geometry.setVertexBuffer({bufferIndex:Qv.INSTANCED,byteStride:144,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RGBA,bufferByteOffset:0,location:yv.MODEL_MATRIX0},{format:zh.F32_RGBA,bufferByteOffset:16,location:yv.MODEL_MATRIX1},{format:zh.F32_RGBA,bufferByteOffset:32,location:yv.MODEL_MATRIX2},{format:zh.F32_RGBA,bufferByteOffset:48,location:yv.MODEL_MATRIX3},{format:zh.F32_RGBA,bufferByteOffset:64,location:yv.COLOR},{format:zh.F32_RGBA,bufferByteOffset:80,location:yv.STROKE_COLOR},{format:zh.F32_RGBA,bufferByteOffset:96,location:yv.PACKED_STYLE1},{format:zh.F32_RGBA,bufferByteOffset:112,location:yv.PACKED_STYLE2},{format:zh.F32_RGBA,bufferByteOffset:128,location:yv.PICKING_COLOR}],data:new Float32Array(c)}),this.geometry.setVertexBuffer({bufferIndex:Qv.TEX,byteStride:16,frequency:Dh.PerVertex,attributes:[{format:zh.F32_RG,bufferByteOffset:0,location:Jv.TEX},{format:zh.F32_RG,bufferByteOffset:8,location:Jv.OFFSET}],data:new Float32Array(u)})},n.createMaterial=function(t){var e;this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  vec2 u_SDFMapSize;\n  float u_FontSize;\n  float u_GammaScale;\n  float u_StrokeBlur;\n  float u_HasStroke;\n};\n\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = TEX) in vec2 a_Tex;\nlayout(location = OFFSET) in vec2 a_Offset;\n\nout vec2 v_UV;\nout float v_GammaScale;\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n\n  v_UV = a_Tex / u_SDFMapSize;\n\n  float fontScale = u_FontSize / 24.;\n\n  gl_Position = project(vec4(a_Offset * fontScale, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n  v_GammaScale = gl_Position.w;\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  vec2 u_SDFMapSize;\n  float u_FontSize;\n  float u_GammaScale;\n  float u_StrokeBlur;\n  float u_HasStroke;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n\nuniform sampler2D u_SDFMap;\n\n#define SDF_PX 8.0\n\nin vec2 v_UV;\nin float v_GammaScale;\n\nout vec4 outputColor;\n\nvoid main() {\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n\n  float dist = texture(SAMPLER_2D(u_SDFMap), v_UV).a;\n\n  float EDGE_GAMMA = 0.105 / u_DevicePixelRatio;\n  float fontScale = u_FontSize / 24.0;\n  highp float gamma = EDGE_GAMMA / (fontScale * u_GammaScale);\n  lowp vec4 color = u_Color;\n  lowp float buff = (256.0 - 64.0) / 256.0;\n  float opacity = u_FillOpacity;\n  if (u_HasStroke > 0.5 && u_StrokeWidth > 0.0) {\n    color = u_StrokeColor;\n    gamma = (u_StrokeBlur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_GammaScale);\n    buff = (6.0 - u_StrokeWidth / fontScale / 2.0) / SDF_PX;\n    opacity = u_StrokeOpacity;\n  }\n\n  highp float gamma_scaled = gamma * v_GammaScale;\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n  opacity *= alpha * u_Opacity;\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(u_PickingColor, 1.0);\n  } else {\n\n    if (opacity < 0.001) {\n      discard;\n    }\n\n    outputColor = color;\n    outputColor.a *= opacity;\n  }\n}",this.material.cullMode=bh.Back,this.material.defines=sh({},this.material.defines,gv(Jv));var n=this.instance.parsedStyle,r=n.fontSize,i=n.fontFamily,o=void 0===i?"":i,a=n.fontWeight,s=void 0===a?"":a,u=n.fontStyle,c=n.metrics.font,l=t.map((function(t){return t.parsedStyle.text})).join("");this.glyphManager.generateAtlas(c,o,s.toString(),u,l,this.device);var f=this.glyphManager.getAtlasTexture(),h=this.glyphManager.getAtlas();this.device.setResourceName(f,"TextSDF Texture");var d=h.image,p=d.width,v=d.height;this.material.setUniforms(((e={})[$v.SDF_MAP]=f,e[$v.SDF_MAP_SIZE]=[p,v],e[$v.FONT_SIZE]=r,e[$v.GAMMA_SCALE]=1,e[$v.STROKE_BLUR]=.2,e[$v.HAS_STROKE]=this.index,e))},n.changeRenderOrder=function(t,e){this.material&&(this.material.programDirty=!0,this.material.geometryDirty=!0)},n.updateAttribute=function(t,e,n,r){"text"===n||"fontFamily"===n||"fontSize"===n||"fontWeight"===n||"fontStyle"===n||"fontVariant"===n||"textBaseline"===n||"letterSpacing"===n||"wordWrapWidth"===n||"lineHeight"===n||"wordWrap"===n||"textAlign"===n||"modelMatrix"===n||"visibility"===n||"dx"===n||"dy"===n?(this.material.programDirty=!0,this.material.geometryDirty=!0,this.material.textureDirty=!0):"fill"!==n&&"fillOpacity"!==n&&"stroke"!==n&&"strokeOpacity"!==n&&"opacity"!==n&&"lineWidth"!==n&&"visibility"!==n&&"pointerEvents"!==n||(this.material.geometryDirty=!0)},n.buildTextBuffers=function(t){var e,n=t.object,r=t.lines,i=t.fontStack,o=t.lineHeight,a=t.letterSpacing,s=t.offsetX,u=t.offsetY,c=t.glyphAtlas,l=t.indicesOffset,f=n.parsedStyle,h=f.textAlign,d=f.fill,p=f.stroke,v=f.opacity,g=f.fillOpacity,m=f.strokeOpacity,y=f.lineWidth,_=f.visibility,E=[0,0,0,0];d instanceof Xa&&(E=[Number(d.r)/255,Number(d.g)/255,Number(d.b)/255,Number(d.alpha)]);var T=[0,0,0,0];p instanceof Xa&&(T=[Number(p.r)/255,Number(p.g)/255,Number(p.b)/255,Number(p.alpha)]);var R=n.isInteractive()&&(null===(e=n.renderable3D)||void 0===e?void 0:e.encodedPickingColor)||[0,0,0],A=mh(gh(),n.getWorldTransform()),S=[],b=[],x=[],M=l;return function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],o=e[i.fontStack],a=o&&o[i.glyph];if(a){var s=a.rect;if(s){var u=a.metrics.advance*i.scale/2,c=[i.x+u,i.y],l=(a.metrics.left-4)*i.scale-u+c[0],f=(-a.metrics.top-4)*i.scale+c[1],h=l+s.w*i.scale,d=f+s.h*i.scale,p={x:l,y:f},v={x:h,y:f},g={x:l,y:d},m={x:h,y:d};n.push({tl:p,tr:v,bl:g,br:m,tex:s,glyphOffset:[0,0]})}}}return n}(this.glyphManager.layout(r,i,o,h,a,s,u),c.positions).forEach((function(t){var e=[];e.push.apply(e,A);var r=[].concat(e,E,T,[v,g,m,y,"visible"===_?1:0,0,0,0],R,[.005*n.sortable.renderOrder]);S.push.apply(S,r.concat(r,r,r)),b.push(t.tex.x,t.tex.y,t.tl.x,t.tl.y),b.push(t.tex.x+t.tex.w,t.tex.y,t.tr.x,t.tr.y),b.push(t.tex.x+t.tex.w,t.tex.y+t.tex.h,t.br.x,t.br.y),b.push(t.tex.x,t.tex.y+t.tex.h,t.bl.x,t.bl.y),x.push(0+M,2+M,1+M),x.push(2+M,0+M,3+M),M+=4})),{indexBuffer:x,charUVOffsetBuffer:b,charPackedBuffer:S,indicesOffset:M}},e}(Tv);_([Object(c.inject)(tg)],eg.prototype,"glyphManager",void 0),eg=_([Object(c.injectable)()],eg);var ng=function(t){function e(){return t.apply(this,arguments)||this}uh(e,t);var n=e.prototype;return n.shouldMerge=function(e,n){var r=t.prototype.shouldMerge.call(this,e,n);return!!r&&(this.instance.nodeName!==ys.MESH||this.instance.parsedStyle.material===e.parsedStyle.material&&this.instance.parsedStyle.geometry===e.parsedStyle.geometry)},n.updateAttribute=function(e,n,r,i){t.prototype.updateAttribute.call(this,e,n,r,i),this.updateBatchedAttribute(e,n,r,i)},n.createMaterial=function(t){var e=this.instance.parsedStyle.material;this.material=e,this.observeMaterialChanged()},n.createGeometry=function(e){var n=this.instance.parsedStyle.geometry;this.geometry=n,t.prototype.createGeometry.call(this,e),this.geometry.build(e),this.observeGeometryChanged()},e}(Tv);ng=_([Object(c.injectable)()],ng);var rg=function(){function t(){}return t.prototype.update=function(t){return t.geometry.computeBoundingBox(),{width:0,height:0,depth:0}},t}();rg=_([Object(c.singleton)({token:{token:$u,named:ys.MESH}})],rg);var ig=function(){function t(){this.counter=0,this.id2DisplayObjectMap={}}var e=t.prototype;return e.getId=function(t){var e=this.counter++;return this.id2DisplayObjectMap[e]=t,e},e.getById=function(t){return this.id2DisplayObjectMap[t]},e.reset=function(){this.counter=0,this.id2DisplayObjectMap={}},e.decodePickingColor=function(t){return t[0]+256*t[1]+65536*t[2]-1},e.encodePickingColor=function(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]},t}();ig=_([Object(c.singleton)()],ig);var og=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[bv,Vv],e}uh(e,t);var n=e.prototype;return n.shouldSubmitRenderInst=function(t,e){if(0===e&&t.parsedStyle.fill.isNone)return!1;return 1!==e||this.needDrawStrokeSeparately(t)},n.needDrawStrokeSeparately=function(t){var e=t.parsedStyle,n=e.fill,r=e.stroke,i=e.lineDash,o=e.lineWidth,a=e.strokeOpacity,s=n&&!n.isNone,u=r&&!r.isNone,c=i&&i.length&&i.every((function(t){return 0!==t}));return!s||u&&o>0&&(a<1||c)},e}(vv);og=_([Object(c.injectable)({token:[{token:lv,named:ys.CIRCLE},{token:lv,named:ys.ELLIPSE}]})],og);var ag=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[Hv,Vv,Nv],e}uh(e,t);var n=e.prototype;return n.shouldSubmitRenderInst=function(t,e){var n=t.parsedStyle,r=n.fill,i=n.stroke,o=n.opacity,a=n.strokeOpacity,s=n.lineDash,u=n.lineWidth,c=t.nodeName,l=i&&!i.isNone,f=s&&s.length&&s.every((function(t){return 0!==t})),h=this.isLine(t);if(t.renderable.proxyNodeName=h?ys.LINE:null,0===e&&(t.nodeName===ys.POLYLINE||r.isNone))return!1;if(1===e){if(h||0===a||0===o||0===u||!l)return!1;if(c===ys.CIRCLE||c===ys.ELLIPSE)return f}return 2!==e||h},n.isLine=function(t){if(t.nodeName===ys.PATH){var e=t.parsedStyle.path.curve;if(2===e.length&&"M"===e[0][0]&&"C"===e[1][0]){var n=e[0],r=(n[0],n[1]),i=n[2],o=e[1],a=(o[0],o[1]),s=o[2],u=o[3],c=o[4],l=o[5],f=o[6],h=(r-l)/(i-f);return(r-a)/(i-s)-h<.01&&(u-l)/(c-f)-h<.01}}else if(t.nodeName===ys.POLYLINE){for(var d=t.parsedStyle.points.points,p=(d[1][0]-d[1][1])/(d[0][0]-d[0][1]),v=1;v<d.length-1;v++)if((d[v+1][0]-d[v+1][1])/(d[v][0]-d[v][1])!==p)return!1;return!0}return!1},e}(vv);ag=_([Object(c.injectable)({token:[{token:lv,named:ys.POLYLINE},{token:lv,named:ys.PATH},{token:lv,named:ys.POLYGON},{token:lv,named:ys.RECT}]})],ag);var sg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[],e}return uh(e,t),e.prototype.shouldSubmitRenderInst=function(t,e){return!0},e}(vv);sg=_([Object(c.injectable)({token:[{token:lv,named:ys.GROUP}]})],sg);var ug=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[Yv],e}return uh(e,t),e.prototype.shouldSubmitRenderInst=function(t,e){return!0},e}(vv);ug=_([Object(c.injectable)({token:[{token:lv,named:ys.IMAGE}]})],ug);var cg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[eg,eg],e}uh(e,t);var n=e.prototype;return n.shouldSubmitRenderInst=function(t,e){var n=t.parsedStyle,r=n.stroke,i=n.lineWidth;return!!(r&&i||0!==e)},n.beforeUploadUBO=function(t,e,n){var r;e.material.setUniforms(((r={})[$v.HAS_STROKE]=1-e.index,r))},e}(vv);cg=_([Object(c.injectable)({token:[{token:lv,named:ys.TEXT}]})],cg);var lg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[Nv],e}return uh(e,t),e.prototype.shouldSubmitRenderInst=function(t,e){return!0},e}(vv);lg=_([Object(c.injectable)({token:{token:lv,named:ys.LINE}})],lg);var fg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).meshes=[ng],e}return uh(e,t),e}(vv);fg=_([Object(c.injectable)({token:[{token:lv,named:ys.MESH}]})],fg);var hg=c.Syringe.defineToken(""),dg=["style"],pg=function(t){function e(n){var r=void 0===n?{}:n,i=r.style,o=lh(r,dg);return t.call(this,sh({type:e.tag,style:sh({intensity:Math.PI},i)},o))||this}return uh(e,t),e}(Gc);pg.tag="light";var vg,gg=["style"];!function(t){t[t.NONE=0]="NONE",t[t.EXP=1]="EXP",t[t.EXP2=2]="EXP2",t[t.LINEAR=3]="LINEAR"}(vg||(vg={}));var mg,yg,_g=function(t){function e(n){var r=void 0===n?{}:n,i=r.style,o=lh(r,gg);return t.call(this,sh({type:e.tag,style:sh({type:vg.NONE,fill:"black",start:1,end:1e3,density:0},i)},o))||this}return uh(e,t),e}(Gc);_g.tag="fog";var Eg;!function(t){t.PROJECTION_MATRIX="u_ProjectionMatrix",t.VIEW_MATRIX="u_ViewMatrix",t.CAMERA_POSITION="u_CameraPosition",t.DEVICE_PIXEL_RATIO="u_DevicePixelRatio",t.VIEWPORT="u_Viewport",t.IS_ORTHO="u_IsOrtho",t.IS_PICKING="u_IsPicking"}(Eg||(Eg={}));var Tg,Rg,Ag=((mg=function(){function t(t,e,n,r,i,o,a,s,u){this.canvasConfig=void 0,this.contextService=void 0,this.renderingContext=void 0,this.camera=void 0,this.renderHelper=void 0,this.lightPool=void 0,this.texturePool=void 0,this.batchManager=void 0,this.deviceContribution=void 0,this.device=void 0,this.swapChain=void 0,this.renderLists={world:new Qp,picking:new Qp},this.builder=void 0,this.enableCapture=void 0,this.captureOptions=void 0,this.capturePromise=void 0,this.resolveCapturePromise=void 0,this.canvasConfig=t,this.contextService=e,this.renderingContext=n,this.camera=r,this.renderHelper=i,this.lightPool=o,this.texturePool=a,this.batchManager=s,this.deviceContribution=u}var e=t.prototype;return e.getDevice=function(){return this.device},e.getSwapChain=function(){return this.swapChain},e.getRenderLists=function(){return this.renderLists},e.apply=function(t){var e=this,n=function(t){var n=t.target;if(n.nodeName!==pg.tag)if(n.nodeName!==_g.tag){var r=new dh;n.renderable3D=r,e.batchManager.add(n)}else e.lightPool.addFog(n);else e.lightPool.addLight(n)},r=function(t){var n=t.target;n.nodeName!==pg.tag?n.nodeName!==_g.tag?(e.batchManager.remove(n),delete n.renderable3D):e.lightPool.removeFog(n):e.lightPool.removeLight(n)},i=function(t){var n=t.target,r=t.attrName,i=t.newValue;e.batchManager.updateAttribute(n,r,i)},o=function(t){var n=t.target;e.batchManager.updateAttribute(n,"modelMatrix",null)},a=function(t){var n=t.target,r=t.detail.renderOrder;e.batchManager.changeRenderOrder(n,r)};t.hooks.init.tapPromise(yg.tag,ih(nh().mark((function s(){var u,c,l,f;return nh().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e.renderingContext.root.addEventListener(Tc.MOUNTED,n),e.renderingContext.root.addEventListener(Tc.UNMOUNTED,r),e.renderingContext.root.addEventListener(Tc.ATTR_MODIFIED,i),e.renderingContext.root.addEventListener(Tc.BOUNDS_CHANGED,o),e.renderingContext.root.addEventListener(Tc.RENDER_ORDER_CHANGED,a),e.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering=!1,u=e.contextService.getDomElement(),c=e.canvasConfig,l=c.width,f=c.height,e.contextService.resize(l,f),s.next=11,e.deviceContribution.createSwapChain(u);case 11:e.swapChain=s.sent,e.device=e.swapChain.getDevice(),e.renderHelper.setDevice(e.device),e.renderHelper.renderInstManager.disableSimpleMode(),e.swapChain.configureSwapChain(u.width,u.height),e.renderingContext.root.ownerDocument.defaultView.addEventListener(Rf.RESIZE,(function(){e.swapChain.configureSwapChain(u.width,u.height)})),e.batchManager.attach(e.device,t);case 18:case"end":return s.stop()}}),s)})))),t.hooks.destroy.tap(yg.tag,(function(){e.renderHelper.destroy(),e.renderingContext.root.removeEventListener(Tc.MOUNTED,n),e.renderingContext.root.removeEventListener(Tc.UNMOUNTED,r),e.renderingContext.root.removeEventListener(Tc.ATTR_MODIFIED,i),e.renderingContext.root.removeEventListener(Tc.BOUNDS_CHANGED,o),e.renderingContext.root.removeEventListener(Tc.RENDER_ORDER_CHANGED,a)})),t.hooks.beginFrame.tap(yg.tag,(function(){var t=e.swapChain.getCanvas(),n=e.renderHelper.renderInstManager;e.builder=e.renderHelper.renderGraph.newGraphBuilder();var r=su(e.canvasConfig.background),i=e.canvasConfig.background?ad(Number(r.r)/255*Number(r.alpha),Number(r.g)/255*Number(r.alpha),Number(r.b)/255*Number(r.alpha),Number(r.alpha)):sd,o={backbufferWidth:t.width,backbufferHeight:t.height,antialiasingMode:rv.None},a=av(Dp.Color0,o,nv(i)),s=av(Dp.DepthStencil,o,iv),u=e.builder.createRenderTargetID(a,"Main Color"),c=e.builder.createRenderTargetID(s,"Main Depth");e.builder.pushPass((function(t){t.setDebugName("Main Render Pass"),t.attachRenderTargetID(Dp.Color0,u),t.attachRenderTargetID(Dp.DepthStencil,c),t.exec((function(t){e.renderLists.world.drawOnPassRenderer(n.renderCache,t)}))})),e.builder.resolveRenderTargetToExternalTexture(u,e.swapChain.getOnscreenTexture())})),t.hooks.endFrame.tap(yg.tag,(function(){var t=e.renderHelper.renderInstManager,n=e.renderHelper.pushTemplateRenderInst();n.setBindingLayouts([{numUniformBuffers:2,numSamplers:0}]),n.setMegaStateFlags(Sd({depthWrite:!0,blendConstant:sd},{rgbBlendMode:Mh.Add,alphaBlendMode:Mh.Add,rgbBlendSrcFactor:xh.SrcAlpha,alphaBlendSrcFactor:xh.One,rgbBlendDstFactor:xh.OneMinusSrcAlpha,alphaBlendDstFactor:xh.OneMinusSrcAlpha}));var r=e.canvasConfig,i=r.width,o=r.height;if(n.setUniforms(0,[{name:Eg.PROJECTION_MATRIX,value:e.camera.getPerspective()},{name:Eg.VIEW_MATRIX,value:e.camera.getViewTransform()},{name:Eg.CAMERA_POSITION,value:e.camera.getPosition()},{name:Eg.DEVICE_PIXEL_RATIO,value:e.contextService.getDPR()},{name:Eg.VIEWPORT,value:[i,o]},{name:Eg.IS_ORTHO,value:e.camera.isOrtho()?1:0},{name:Eg.IS_PICKING,value:0}]),e.batchManager.render(e.renderLists.world),t.popTemplateRenderInst(),e.renderHelper.prepareToRender(),e.renderHelper.renderGraph.execute(),t.resetRenderInsts(),e.swapChain.present(),e.enableCapture&&e.resolveCapturePromise){var a=e.captureOptions,s=a.type,u=a.encoderOptions,c=e.contextService.getDomElement().toDataURL(s,u);e.resolveCapturePromise(c),e.enableCapture=!1,e.captureOptions=void 0,e.resolveCapturePromise=void 0}}))},e.loadTexture=function(t,e,n){return this.texturePool.getOrCreateTexture(this.device,t,e,(function(t){n&&n(t)}))},e.toDataURL=function(){var t=ih(nh().mark((function t(e){var n=this;return nh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.enableCapture=!0,this.captureOptions=e,this.capturePromise=new Promise((function(t){n.resolveCapturePromise=function(e){t(e)}})),t.abrupt("return",this.capturePromise);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),t}()).tag="RenderGraph",yg=mg);Ag=yg=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(bs)),E(1,Object(c.inject)(dc)),E(2,Object(c.inject)(fl)),E(3,Object(c.inject)(gl)),E(4,Object(c.inject)(tv)),E(5,Object(c.inject)(ph)),E(6,Object(c.inject)(uv)),E(7,Object(c.inject)(dv)),E(8,Object(c.inject)(hg))],Ag);var Sg=((Tg=function(){function t(t,e,n,r,i,o,a,s,u){this.canvasConfig=void 0,this.sceneGraphService=void 0,this.contextService=void 0,this.renderingContext=void 0,this.renderHelper=void 0,this.renderGraphPlugin=void 0,this.pickingIdGenerator=void 0,this.camera=void 0,this.batchManager=void 0,this.canvasConfig=t,this.sceneGraphService=e,this.contextService=n,this.renderingContext=r,this.renderHelper=i,this.renderGraphPlugin=o,this.pickingIdGenerator=a,this.camera=s,this.batchManager=u}var e=t.prototype;return e.apply=function(t){var e=this,n=function(t){var n=t.target,r=n.renderable3D;if(r){var i=e.pickingIdGenerator.getId(n);r.pickingId=i,r.encodedPickingColor=e.pickingIdGenerator.encodePickingColor(i)}};t.hooks.init.tapPromise(Rg.tag,ih(nh().mark((function t(){return nh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.renderingContext.root.addEventListener(Tc.MOUNTED,n);case 1:case"end":return t.stop()}}),t)})))),t.hooks.destroy.tap(Rg.tag,(function(){e.renderingContext.root.removeEventListener(Tc.MOUNTED,n)})),t.hooks.pick.tapPromise(Rg.tag,function(){var t=ih(nh().mark((function t(n){var r,i,o,a,s,u,c,l,f,h;return nh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.topmost,i=n.position,o=i.viewportX,a=i.viewportY,s=e.contextService.getDPR(),u=e.canvasConfig.width*s,c=e.canvasConfig.height*s,f=a*s,!((l=o*s)>u||l<0||f>c||f<0)){t.next=10;break}return n.picked=[],t.abrupt("return",n);case 10:return t.next=12,e.pickByRectangleInDepth(new pu(xf(Math.round(l),0,u-1),xf(Math.round(f),0,c-1),1,1),r?1:100);case 12:return h=t.sent,n.picked=h,t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.pickByRectangleInDepth=function(){var t=ih(nh().mark((function t(e,n){var r,i,o;return nh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===n&&(n=100),r=null,i=1,o=[];case 4:return t.next=6,this.pickByRectangle(e,r);case 6:if(!(r=t.sent)){t.next=12;break}i++,o.push(r),t.next=13;break;case 12:return t.abrupt("break",14);case 13:if(r&&i<=n){t.next=4;break}case 14:return n>1&&this.restorePickingColor(o),t.abrupt("return",o);case 16:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),e.restorePickingColor=function(t){var e=this;t.forEach((function(t){e.batchManager.updateAttribute(t,"pointerEvents",!0,!0)}))},e.pickByRectangle=function(t,e){var n=this,r=this.renderGraphPlugin.getDevice(),i=this.renderGraphPlugin.getRenderLists(),o=this.renderHelper.renderInstManager,a=this.renderHelper.renderGraph.newGraphBuilder(),s=sd,u=t.x,c=t.y,l=t.width,f=t.height,h={backbufferWidth:l,backbufferHeight:f,antialiasingMode:rv.None},d=av(Dp.Color0,h,nv(s)),p=a.createRenderTargetID(d,"Picking Color"),v=av(Dp.DepthStencil,h,iv),g=a.createRenderTargetID(v,"Picking Depth"),m=sh({},this.camera.getView());return new Promise((function(t){n.renderHelper.renderGraph.renderTargetDeadPool.forEach((function(t){t.age=-1})),a.pushPass((function(e){e.setDebugName("Picking Pass"),e.attachRenderTargetID(Dp.Color0,p),e.attachRenderTargetID(Dp.DepthStencil,g),e.exec((function(t){i.picking.drawOnPassRenderer(o.renderCache,t)})),e.post((function(e){var i=e.getRenderTargetTexture(Dp.Color0),o=r.createReadback();m&&m.enabled?n.camera.setViewOffset(m.fullWidth,m.fullHeight,m.offsetX,m.offsetY,m.width,m.height):n.camera.clearViewOffset(),n.camera.setEnableUpdate(!0),o.readTexture(i,0,0,l,f,new Uint8Array(l*f*4)).then((function(e){var r,i=-1;if(!e||0===e[0]&&0===e[1]&&0===e[2]||(i=n.pickingIdGenerator.decodePickingColor(e)),i>-1){var a=n.pickingIdGenerator.getById(i);a&&a.isVisible()&&a.isInteractive()&&(r=a)}o.destroy(),t(r)}))}))}));var s=n.renderHelper.pushTemplateRenderInst();s.setBindingLayouts([{numUniformBuffers:2,numSamplers:0}]),s.setMegaStateFlags(Sd({depthWrite:!0},{rgbBlendMode:Mh.Add,rgbBlendSrcFactor:xh.One,rgbBlendDstFactor:xh.Zero,alphaBlendMode:Mh.Add,alphaBlendSrcFactor:xh.One,alphaBlendDstFactor:xh.Zero}));var h=n.canvasConfig,d=h.width,v=h.height,y=n.contextService.getDPR();n.camera.setEnableUpdate(!1),n.camera.setViewOffset(d*y,v*y,u,c,l,f),s.setUniforms(0,[{name:Eg.PROJECTION_MATRIX,value:n.camera.getPerspective()},{name:Eg.VIEW_MATRIX,value:n.camera.getViewTransform()},{name:Eg.CAMERA_POSITION,value:n.camera.getPosition()},{name:Eg.DEVICE_PIXEL_RATIO,value:n.contextService.getDPR()},{name:Eg.VIEWPORT,value:[d,v]},{name:Eg.IS_ORTHO,value:n.camera.isOrtho()?1:0},{name:Eg.IS_PICKING,value:1}]),e&&n.batchManager.updateAttribute(e,"pointerEvents",!1,!0),n.batchManager.render(i.picking,!0),o.popTemplateRenderInst(),n.renderHelper.prepareToRender(),n.renderHelper.renderGraph.execute(),o.resetRenderInsts()}))},t}()).tag="WebGLPicker",Rg=Tg);Sg=Rg=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(bs)),E(1,Object(c.inject)(Ac)),E(2,Object(c.inject)(dc)),E(3,Object(c.inject)(fl)),E(4,Object(c.inject)(tv)),E(5,Object(c.inject)(Ag)),E(6,Object(c.inject)(ig)),E(7,Object(c.inject)(gl)),E(8,Object(c.inject)(dv))],Sg);var bg="#define GLSLIFY 1\nlayout(location = 0) in vec2 a_Position;\n\nout vec2 v_TexCoord;\n\nvoid main() {\n  v_TexCoord = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_TexCoord.y = 1.0 - v_TexCoord.y;\n  #endif\n}",xg="#define GLSLIFY 1\nuniform sampler2D u_Texture;\nin vec2 v_TexCoord;\n\nout vec4 outputColor;\n\nvoid main() {\n  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);\n}",Mg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).vert=bg,e.frag=xg,e.features={},e}return uh(e,t),e}(Ep);gd(1,(function(){return new sv}));var Og,Cg,Ng=Object(c.Module)((function(t){t(tv),t(uv),t(ph),t(tg),t(ig),t(dv),t(Ag),t(Sg),t(bv),t(Nv),t(Vv),t(Hv),t(Yv),t(eg),t(ng),t({token:fv,useFactory:function(t){return function(e){return t.container.isBound(e)&&t.container.get(e)||null}}}),t(og),t(ag),t(ug),t(lg),t(cg),t(fg),t({token:cv,useFactory:function(t){var e={};return function(n){return e[n]||t.container.isBoundNamed(lv,n)&&(e[n]=t.container.getNamed(lv,n)),e[n]||null}}})})),Pg=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="device-renderer",e}uh(e,t);var n=e.prototype;return n.init=function(){c.GlobalContainer.isBound(rg)||c.GlobalContainer.register(rg),this.container.load(Ng,!0)},n.destroy=function(){c.GlobalContainer.isBound(rg)&&c.GlobalContainer.remove(rg),this.container.unload(Ng)},n.getDevice=function(){return this.container.get(Ag).getDevice()},n.loadTexture=function(t,e,n){return this.container.get(Ag).loadTexture(t,e,n)},n.toDataURL=function(t){return this.container.get(Ag).toDataURL(t)},e}(cf);function Ig(){Ig=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function wg(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Dg(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){wg(o,r,i,a,s,"next",t)}function s(t){wg(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Lg(t,e){return(Lg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Bg=((Og=function(){function t(t,e){this.contextService=void 0,this.renderingContext=void 0,this.contextService=t,this.renderingContext=e}return t.prototype.apply=function(t){var e=this,n=this.renderingContext.root.ownerDocument.defaultView,r=function(e){t.hooks.pointerMove.call(e)},i=function(e){t.hooks.pointerUp.call(e)},o=function(e){t.hooks.pointerDown.call(e)},a=function(e){t.hooks.pointerOver.call(e)},s=function(e){t.hooks.pointerOut.call(e)},u=function(e){t.hooks.pointerCancel.call(e)},c=function(e){t.hooks.pointerWheel.call(e)},l=function(t){globalThis.document.addEventListener("pointermove",r,!0),t.addEventListener("pointerdown",o,!0),t.addEventListener("pointerleave",s,!0),t.addEventListener("pointerover",a,!0),globalThis.addEventListener("pointerup",i,!0)},f=function(t){t.addEventListener("touchstart",o,!0),t.addEventListener("touchend",i,!0),t.addEventListener("touchmove",r,!0),t.addEventListener("touchcancel",u,!0)},h=function(t){globalThis.document.addEventListener("mousemove",r,!0),t.addEventListener("mousedown",o,!0),t.addEventListener("mouseout",s,!0),t.addEventListener("mouseover",a,!0),globalThis.addEventListener("mouseup",i,!0)};t.hooks.init.tapPromise(Cg.tag,Dg(Ig().mark((function t(){var r;return Ig().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.contextService.getDomElement(),globalThis.navigator.msPointerEnabled?(r.style.msContentZooming="none",r.style.msTouchAction="none"):n.supportsPointerEvents&&(r.style.touchAction="none"),n.supportsPointerEvents?l(r):h(r),n.supportsTouchEvents&&f(r),r.addEventListener("wheel",c,{passive:!0,capture:!0});case 5:case"end":return t.stop()}}),t)})))),t.hooks.destroy.tap(Cg.tag,(function(){var t=e.contextService.getDomElement();globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):n.supportsPointerEvents&&(t.style.touchAction=""),n.supportsPointerEvents?function(t){globalThis.document.removeEventListener("pointermove",r,!0),t.removeEventListener("pointerdown",o,!0),t.removeEventListener("pointerleave",s,!0),t.removeEventListener("pointerover",a,!0),globalThis.removeEventListener("pointerup",i,!0)}(t):function(t){globalThis.document.removeEventListener("mousemove",r,!0),t.removeEventListener("mousedown",o,!0),t.removeEventListener("mouseout",s,!0),t.removeEventListener("mouseover",a,!0),globalThis.removeEventListener("mouseup",i,!0)}(t),n.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",o,!0),t.removeEventListener("touchend",i,!0),t.removeEventListener("touchmove",r,!0),t.removeEventListener("touchcancel",u,!0)}(t),t.removeEventListener("wheel",c,!0)}))},t}()).tag="DOMInteraction",Cg=Og);Bg=Cg=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(dc)),E(1,Object(c.inject)(fl))],Bg);var Fg=Object(c.Module)((function(t){t(Bg)})),kg=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="dom-interaction",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,Lg(e,n);var i=r.prototype;return i.init=function(){this.container.load(Fg,!0)},i.destroy=function(){this.container.unload(Fg)},r}(cf);function Ug(){Ug=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function Gg(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Vg(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Gg(o,r,i,a,s,"next",t)}function s(t){Gg(o,r,i,a,s,"throw",t)}a(void 0)}))}}function jg(t,e){return(jg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wg={}.toString,Xg=function(t,e){return Wg.call(t)==="[object "+e+"]"},Hg=function(t){return Xg(t,"Function")};function Yg(t,e){var n;if(t)if(n=t,Array.isArray?Array.isArray(n):Xg(n,"Array"))for(var r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e}(t))for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}var zg,Kg,qg,Zg=function(t){return Xg(t,"String")},Qg=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return Yg(t,(function(n,r){Hg(t)&&"prototype"===r||e.push(n)})),e};!function(t,e){if(!Hg(t))throw new TypeError("Expected a function");var n=function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return zg||(zg=document.createElement("canvas").getContext("2d")),zg.font=[o,a,i,n+"px",r].join(" "),zg.measureText(Zg(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),T([t],Qg(e)).join("")}));var Jg=((Kg=function(){function t(t,e,n){this.contextService=void 0,this.renderingContext=void 0,this.canvasConfig=void 0,this.$camera=void 0,this.contextService=t,this.renderingContext=e,this.canvasConfig=n}var e=t.prototype;return e.apply=function(t){var e=this,n=function(t,e){var n=t.getWorldTransform();e.style.transform="matrix("+[n[0],n[1],n[4],n[5],n[12],n[13]].join(",")+")"},r=function(t){var r=t.target;if(r.nodeName===ys.HTML){var i=e.getOrCreateEl(r),o=r.ownerDocument.documentElement.attributes;Object.keys(o).forEach((function(t){i.style[t]=o[t]})),Object.keys(r.attributes).forEach((function(t){e.updateAttribute(t,r)})),n(r,i)}},i=function(t){var n=t.target;if(n.nodeName===ys.HTML){var r=e.getId(n),i=e.contextService.getDomElement().parentNode;if(i){var o=i.querySelector("#"+r);o&&i.removeChild(o)}}},o=function(t){var n=t.target;if(n.nodeName===ys.HTML){var r=t.attrName;e.updateAttribute(r,n)}},a=function(t){var r=t.target;if(r.nodeName===ys.HTML){var i=e.getOrCreateEl(r);n(r,i)}};t.hooks.init.tapPromise(qg.tag,Vg(Ug().mark((function t(){return Ug().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.renderingContext.root.addEventListener(Tc.MOUNTED,r),e.renderingContext.root.addEventListener(Tc.UNMOUNTED,i),e.renderingContext.root.addEventListener(Tc.ATTR_MODIFIED,o),e.renderingContext.root.addEventListener(Tc.BOUNDS_CHANGED,a);case 4:case"end":return t.stop()}}),t)})))),t.hooks.destroy.tap(qg.tag,(function(){e.renderingContext.root.removeEventListener(Tc.MOUNTED,r),e.renderingContext.root.removeEventListener(Tc.UNMOUNTED,i),e.renderingContext.root.removeEventListener(Tc.ATTR_MODIFIED,o),e.renderingContext.root.removeEventListener(Tc.BOUNDS_CHANGED,a)}))},e.getId=function(t){return t.id||"g-html-"+t.entity},e.getOrCreateEl=function(t){var e=this.canvasConfig.document,n=this.getId(t),r=this.contextService.getDomElement().parentNode;if(r){var i=r.querySelector("#"+n);if(!i){i=(e||document).createElement("div"),t.parsedStyle.$el=i,i.id=n,t.name&&i.setAttribute("name",t.name),t.className&&(i.className=t.className),r.appendChild(i),i.style.position="absolute",i.style.left="0",i.style.top="0",i.style["will-change"]="transform";var o=t.getWorldTransform();i.style.transform="matrix("+[o[0],o[1],o[4],o[5],o[12],o[13]].join(",")+")"}return i}return null},e.updateAttribute=function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var r=e.parsedStyle.innerHTML;Zg(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"transformOrigin":var i=e.parsedStyle.transformOrigin;n.style["transform-origin"]=i[0].value+" "+i[1].value;break;case"width":var o=e.computedStyleMap().get("width");n.style.width=o.toString();break;case"height":var a=e.computedStyleMap().get("height");n.style.height=a.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;n.style["z-index"]=""+s;break;case"visibility":var u=e.parsedStyle.visibility;n.style.visibility=u;break;case"pointerEvents":var c=e.parsedStyle.pointerEvents;n.style.pointerEvents=c;break;case"opacity":var l=e.parsedStyle.opacity;n.style.opacity=""+l;break;case"fill":var f=e.parsedStyle.fill,h="";f instanceof Xa?h=f.isNone?"transparent":e.getAttribute("fill"):Array.isArray(f)?h=e.getAttribute("fill"):au(f),n.style.background=h;break;case"stroke":var d=e.parsedStyle.stroke,p="";d instanceof Xa?p=d.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(d)?p=e.getAttribute("stroke"):au(d),n.style["border-color"]=p,n.style["border-style"]="solid";break;case"lineWidth":var v=e.parsedStyle.lineWidth;n.style["border-width"]=(v||0)+"px";break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var g=e.style.filter;n.style.filter=g}},t}()).tag="HTMLRendering",qg=Kg);Jg=qg=_([Object(c.singleton)({contrib:El}),E(0,Object(c.inject)(dc)),E(1,Object(c.inject)(fl)),E(2,Object(c.inject)(bs))],Jg);var $g=Object(c.Module)((function(t){t(Jg)})),tm=function(t){var e,n;function r(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))||this).name="html-renderer",e}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,jg(e,n);var i=r.prototype;return i.init=function(){this.container.load($g,!0)},i.destroy=function(){this.container.unload($g)},r}(cf);function em(){em=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function nm(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function rm(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){nm(o,r,i,a,s,"next",t)}function s(t){nm(o,r,i,a,s,"throw",t)}a(void 0)}))}}function im(){return(im=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function om(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,am(t,e)}function am(t,e){return(am=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function sm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function um(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return sm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sm(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var cm=c.Syringe.defineToken(""),lm=function(t){function e(e){var n,r=e.id,i=e.device;return(n=t.call(this)||this).id=void 0,n.name=void 0,n.device=void 0,n.id=r,n.device=i,null!==n.device.resourceCreationTracker&&n.device.resourceCreationTracker.trackResourceCreated(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)),n}return om(e,t),e.prototype.destroy=function(){null!==this.device.resourceCreationTracker&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},e}(Xo.EventEmitter),fm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.Bindings,n.uniformBufferBindings=void 0,n.samplerBindings=void 0;var a=o.bindingLayout,s=o.uniformBufferBindings,u=o.samplerBindings;ed(s.length>=a.numUniformBuffers),ed(u.length>=a.numSamplers);for(var c=0;c<a.numUniformBuffers;c++)ed(s[c].wordCount>0);return n.uniformBufferBindings=o.uniformBufferBindings,n.samplerBindings=o.samplerBindings,n}return om(e,t),e}(lm),hm={}.toString,dm=function(t,e){return hm.call(t)==="[object "+e+"]"},pm=function(t){return dm(t,"Function")},vm=function(t){return null==t};function gm(t,e){var n;if(t)if(n=t,Array.isArray?Array.isArray(n):dm(n,"Array"))for(var r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e}(t))for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}var mm,ym=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return gm(t,(function(n,r){pm(t)&&"prototype"===r||e.push(n)})),e};function _m(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function Em(t){if($h(t)&Yh.Normalized)return!1;var e=Jh(t);return e===Xh.S8||e===Xh.S16||e===Xh.S32||(e===Xh.U8||e===Xh.U16||e===Xh.U32)}function Tm(t){return t&Ih.INDEX?Kh.ELEMENT_ARRAY_BUFFER:t&Ih.VERTEX?Kh.ARRAY_BUFFER:t&Ih.UNIFORM?Kh.UNIFORM_BUFFER:void 0}function Rm(t){var e=Jh(t),n=Qh(t),r=$h(t),i=function(t){switch(t){case Xh.U8:return Kh.UNSIGNED_BYTE;case Xh.U16:return Kh.UNSIGNED_SHORT;case Xh.U32:return Kh.UNSIGNED_INT;case Xh.S8:return Kh.BYTE;case Xh.S16:return Kh.SHORT;case Xh.S32:return Kh.INT;case Xh.F16:return Kh.HALF_FLOAT;case Xh.F32:return Kh.FLOAT;default:throw new Error("whoops")}}(e);return{size:function(t){switch(t){case Hh.R:return 1;case Hh.RG:return 2;case Hh.RGB:return 3;case Hh.RGBA:return 4;default:return 1}}(n),type:i,normalized:!!(r&Yh.Normalized)}}function Am(t){switch(t){case Oh.Clamp:return Kh.CLAMP_TO_EDGE;case Oh.Repeat:return Kh.REPEAT;case Oh.Mirror:return Kh.MIRRORED_REPEAT;default:throw new Error("whoops")}}function Sm(t,e){if(e===Nh.Linear&&t===Ch.Bilinear)return Kh.LINEAR_MIPMAP_LINEAR;if(e===Nh.Linear&&t===Ch.Point)return Kh.NEAREST_MIPMAP_LINEAR;if(e===Nh.Nearest&&t===Ch.Bilinear)return Kh.LINEAR_MIPMAP_NEAREST;if(e===Nh.Nearest&&t===Ch.Point)return Kh.NEAREST_MIPMAP_NEAREST;if(e===Nh.NoMip&&t===Ch.Bilinear)return Kh.LINEAR;if(e===Nh.NoMip&&t===Ch.Point)return Kh.NEAREST;throw new Error("Unknown texture filter mode")}function bm(t,e){void 0===e&&(e=0);var n=t;return n.gl_buffer_pages[e/n.pageByteSize|0]}function xm(t){return t.gl_texture}function Mm(t){return t.gl_sampler}function Om(t,e){t.name=e,t.__SPECTOR_Metadata={name:e}}function Cm(t,e){for(var n=[];;){var r=e.exec(t);if(!r)break;n.push(r)}return n}function Nm(t){return t.blendMode==Mh.Add&&t.blendSrcFactor==xh.One&&t.blendDstFactor===xh.Zero}function Pm(t){if(t===Bh.n2D)return Kh.TEXTURE_2D;if(t===Bh.n2DArray)return Kh.TEXTURE_2D_ARRAY;if(t===Bh.Cube)return Kh.TEXTURE_CUBE_MAP;if(t===Bh.n3D)return Kh.TEXTURE_3D;throw new Error("whoops")}function Im(t,e,n,r){return t%n==0&&e%r==0}!function(t,e){if(!pm(t))throw new TypeError("Expected a function");var n=function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n,r=e.fontSize,i=e.fontFamily,o=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return mm||(mm=document.createElement("canvas").getContext("2d")),mm.font=[a,s,o,r+"px",i].join(" "),mm.measureText((n=t,dm(n,"String")?t:"")).width}),(function(t,e){return void 0===e&&(e={}),T([t],ym(e)).join("")}));var wm,Dm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.Buffer,n.gl_buffer_pages=void 0,n.gl_target=void 0,n.usage=void 0,n.byteSize=void 0,n.pageByteSize=void 0;var a=o.viewOrSize,s=o.usage,u=o.hint,c=i.uniformBufferMaxPageByteSize,l=i.gl,f=s&Ih.UNIFORM;f||(_m(l)?l.bindVertexArray(null):i.OES_vertex_array_object.bindVertexArrayOES(null));var h,d=dm(a,"Number")?4*a:4*a.byteLength;if(n.gl_buffer_pages=[],f){ed(d%c==0);for(var p=d;p>0;)n.gl_buffer_pages.push(n.createBufferPage(Math.min(p,c),s,u)),p-=c;h=c}else n.gl_buffer_pages.push(n.createBufferPage(d,s,u)),h=d;return n.pageByteSize=h,n.byteSize=d,n.usage=s,n.gl_target=Tm(s),f||(_m(l)?l.bindVertexArray(n.device.currentBoundVAO):i.OES_vertex_array_object.bindVertexArrayOES(n.device.currentBoundVAO)),n}om(e,t);var n=e.prototype;return n.setSubData=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=e.byteLength-n);var i=this.device.gl,o=this.gl_target,a=this.byteSize,s=this.pageByteSize;if(!(t+r<=a))throw new Error("Assert fail: (dstByteOffset ["+t+"] + byteSize ["+r+"]) <= dstByteSize ["+a+"], gl_target "+o);for(var u=t+r,c=t,l=t%s;c<u;){var f=_m(i)?i.COPY_WRITE_BUFFER:this.gl_target;i.bindBuffer(f,bm(this,c)),_m(i)?i.bufferSubData(f,l,e,n,Math.min(u-c,s)):i.bufferSubData(f,l,e),c+=s,l=0,n+=s,this.device.debugGroupStatisticsBufferUpload()}},n.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.gl_buffer_pages.length;e++)this.gl_buffer_pages[e].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[e])},n.createBufferPage=function(t,e,n){var r=this.device.gl,i=e&Ih.UNIFORM;if(!_m(r)&&i)return{ubo:!0};var o=this.device.ensureResourceExists(r.createBuffer()),a=Tm(e),s=function(t){switch(t){case wh.Static:return Kh.STATIC_DRAW;case wh.Dynamic:return Kh.DYNAMIC_DRAW}}(n);return r.bindBuffer(a,o),r.bufferData(a,t,s),o},e}(lm),Lm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.InputLayout,n.vertexAttributeDescriptors=void 0,n.vertexBufferDescriptors=void 0,n.indexBufferFormat=void 0;var a=o.vertexAttributeDescriptors,s=o.vertexBufferDescriptors,u=o.indexBufferFormat;return ed(u===zh.U16_R||u===zh.U32_R||null===u),n.vertexAttributeDescriptors=a,n.vertexBufferDescriptors=s,n.indexBufferFormat=u,n}return om(e,t),e}(lm),Bm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.inputLayout,a=e.vertexBuffers,s=e.indexBufferBinding,u=e.program;(n=t.call(this,{id:r,device:i})||this).type=Rh.InputState,n.vao=void 0,n.indexBufferByteOffset=void 0,n.indexBufferType=void 0,n.indexBufferCompByteSize=void 0,n.inputLayout=void 0,n.vertexBuffers=void 0;var c=n.device.gl,l=n.device.ensureResourceExists(_m(c)?c.createVertexArray():i.OES_vertex_array_object.createVertexArrayOES());_m(c)?c.bindVertexArray(l):i.OES_vertex_array_object.bindVertexArrayOES(l),i.currentBoundVAO=l;for(var f=0;f<o.vertexAttributeDescriptors.length;f++){var h,d=o.vertexAttributeDescriptors[f],p=d.format,v=d.divisor,g=void 0===v?1:v,m=d.byteStride,y=d.bufferByteOffset,_=d.bufferIndex,E=_m(c)?d.location:null===(h=u.attributes[d.location])||void 0===h?void 0:h.location;if(!vm(E)){Em(p);var T=Rm(p),R=T.size,A=T.type,S=T.normalized,b=a[_];if(null===b)continue;var x=nd(o.vertexBufferDescriptors[_]);ed(!!(b.buffer.usage&Ih.VERTEX)),c.bindBuffer(c.ARRAY_BUFFER,bm(b.buffer));var M=b.byteOffset+y;c.vertexAttribPointer(E,R,A,S,m||x.byteStride,M),x.frequency===Dh.PerInstance&&(_m(c)?c.vertexAttribDivisor(E,g):i.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(E,g)),c.enableVertexAttribArray(E)}}var O=null,C=null,N=null;null!==s&&(ed(!!(s.buffer.usage&Ih.INDEX)),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,bm(s.buffer)),O=function(t){switch(t){case zh.U8_R:return Kh.UNSIGNED_BYTE;case zh.U16_R:return Kh.UNSIGNED_SHORT;case zh.U32_R:return Kh.UNSIGNED_INT;default:throw new Error("whoops")}}(nd(o.indexBufferFormat)),C=td(Jh(o.indexBufferFormat)),N=s.byteOffset);return _m(c)?c.bindVertexArray(null):i.OES_vertex_array_object.bindVertexArrayOES(null),i.currentBoundVAO=null,n.vao=l,n.indexBufferByteOffset=N,n.indexBufferType=O,n.indexBufferCompByteSize=C,n.inputLayout=o,n.vertexBuffers=a,n}return om(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(_m(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},e}(lm),Fm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor,a=e.fake;(n=t.call(this,{id:r,device:i})||this).type=Rh.Texture,n.gl_texture=void 0,n.gl_target=void 0,n.pixelFormat=void 0,n.width=void 0,n.height=void 0,n.depth=void 0,n.numLevels=void 0,n.immutable=void 0,n.pixelStore=void 0,n.mipmaps=void 0,n.formatKind=void 0,n.textureIndex=void 0;var s,u,c=n.device.gl,l=n.clampNumLevels(o);if(n.immutable=!!o.immutable,n.pixelStore=o.pixelStore,n.pixelFormat=o.pixelFormat,n.formatKind=function(t){var e=$h(t);if(e&Yh.Depth)return Gh.Depth;if(e&Yh.Normalized)return Gh.Float;var n=Jh(t);if(n===Xh.F16||n===Xh.F32)return Gh.Float;if(n===Xh.U8||n===Xh.U16||n===Xh.U32)return Gh.Uint;if(n===Xh.S8||n===Xh.S16||n===Xh.S32)return Gh.Sint;throw new Error("whoops")}(o.pixelFormat),n.width=o.width,n.height=o.height,n.depth=o.depth,n.mipmaps=l>=1,!a){u=n.device.ensureResourceExists(c.createTexture());var f=n.device.translateTextureType(o.pixelFormat),h=n.device.translateTextureInternalFormat(o.pixelFormat);if(n.device.setActiveTexture(c.TEXTURE0),n.device.currentTextures[0]=null,n.preprocessImage(),o.dimension===Bh.n2D){if(s=Kh.TEXTURE_2D,c.bindTexture(s,u),n.immutable)if(_m(c))c.texStorage2D(s,l,h,o.width,o.height);else{var d=(h===Kh.DEPTH_COMPONENT||n.isNPOT(),0);c.texImage2D(s,d,h,o.width,o.height,0,h,f,null),n.mipmaps&&n.isNPOT()&&(n.mipmaps=!1,c.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_MIN_FILTER,Kh.LINEAR),c.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_WRAP_S,Kh.CLAMP_TO_EDGE),c.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_WRAP_T,Kh.CLAMP_TO_EDGE))}ed(1===o.depth)}else if(o.dimension===Bh.n2DArray)s=Kh.TEXTURE_2D_ARRAY,c.bindTexture(s,u),_m(c)&&c.texStorage3D(s,l,h,o.width,o.height,o.depth);else if(o.dimension===Bh.n3D)s=Kh.TEXTURE_3D,c.bindTexture(s,u),_m(c)&&c.texStorage3D(s,l,h,o.width,o.height,o.depth);else{if(o.dimension!==Bh.Cube)throw new Error("whoops");s=Kh.TEXTURE_CUBE_MAP,c.bindTexture(s,u),_m(c)&&c.texStorage2D(s,l,h,o.width,o.height),ed(6===o.depth)}}return n.gl_texture=u,n.gl_target=s,n.numLevels=l,n}om(e,t);var n=e.prototype;return n.setImageData=function(t,e){var n,r,i=this.device.gl,o=Array.isArray(t);this.device.setActiveTexture(i.TEXTURE0),this.device.currentTextures[0]=null,o?(n=this.width,r=this.height):(n=t.width,r=t.height,this.width=n,this.height=r),i.bindTexture(this.gl_target,this.gl_texture);var a=this.device.translateTextureFormat(this.pixelFormat),s=this.device.translateTextureType(this.pixelFormat);this.preprocessImage(),this.immutable?i.texSubImage2D(this.gl_target,0,0,0,n,r,a,s,o?t[0]:t):_m(i)?i.texImage2D(this.gl_target,0,a,n,r,0,a,s,o?t[0]:t):o?i.texImage2D(this.gl_target,0,a,n,r,0,a,s,t[0]):i.texImage2D(this.gl_target,0,a,a,s,t),this.mipmaps&&this.generateMipmap()},n.destroy=function(){t.prototype.destroy.call(this),this.device.gl.deleteTexture(xm(this))},n.clampNumLevels=function(t){if(t.dimension===Bh.n2DArray&&t.depth>1&&Jh(t.pixelFormat)===Xh.BC1)for(var e=t.width,n=t.height,r=0;r<t.numLevels;r++){if(e<=2||n<=2)return r-1;e=Math.max(e/2|0,1),n=Math.max(n/2|0,1)}return t.numLevels},n.preprocessImage=function(){var t=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&t.pixelStorei(Kh.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&t.pixelStorei(Kh.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&t.pixelStorei(Kh.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},n.generateMipmap=function(){var t=this.device.gl;return!_m(t)&&this.isNPOT()||this.gl_texture&&this.gl_target&&(t.bindTexture(this.gl_target,this.gl_texture),t.generateMipmap(this.gl_target),t.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_MIN_FILTER,Kh.NEAREST_MIPMAP_LINEAR),t.bindTexture(this.gl_target,null)),this},n.isNPOT=function(){return!_m(this.device.gl)&&(!ld(this.width)||!ld(this.height))},e}(lm);!function(t){t[t.NeedsCompile=0]="NeedsCompile",t[t.Compiling=1]="Compiling",t[t.NeedsBind=2]="NeedsBind",t[t.ReadyToUse=3]="ReadyToUse"}(wm||(wm={}));var km=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.Program,n.gl_program=void 0,n.gl_shader_vert=void 0,n.gl_shader_frag=void 0,n.compileState=void 0,n.descriptor=void 0,n.uniformSetters={},n.attributes=[];var a=n.device.gl;return n.descriptor=o,n.gl_program=n.device.ensureResourceExists(a.createProgram()),n.gl_shader_vert=null,n.gl_shader_frag=null,n.compileState=wm.NeedsCompile,n.tryCompileProgram(),n}om(e,t);var n=e.prototype;return n.destroy=function(){t.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},n.tryCompileProgram=function(){ed(this.compileState===wm.NeedsCompile);var t=this.descriptor,e=this.device.gl;null!==this.gl_shader_vert&&e.deleteShader(this.gl_shader_vert),null!==this.gl_shader_frag&&e.deleteShader(this.gl_shader_frag),this.gl_shader_vert=this.compileShader(t.preprocessedVert,e.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(t.preprocessedFrag,e.FRAGMENT_SHADER),e.attachShader(this.gl_program,this.gl_shader_vert),e.attachShader(this.gl_program,this.gl_shader_frag),e.linkProgram(this.gl_program),this.compileState=wm.Compiling,_m(e)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram())},n.readAttributesFromLinkedProgram=function(){for(var t=this,e=this.device.gl,n=e.getProgramParameter(this.gl_program,e.ACTIVE_ATTRIBUTES),r=function(t){var e={};return t.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,(function(t,n,r){var i=Number(r);return e[n]=isNaN(i)?r:i,""})),e}(this.descriptor.preprocessedVert),i=function(t,e){var n=[];return t.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,(function(t,r,i){var o=Number(r);return n.push({location:isNaN(o)?e[r]:o,name:i}),""})),n}(this.descriptor.vert,r),o=function(n){var r,o=e.getActiveAttrib(t.gl_program,n),a=o.name,s=o.type,u=o.size,c=e.getAttribLocation(t.gl_program,a),l=null===(r=i.find((function(t){return t.name===a})))||void 0===r?void 0:r.location;c>=0&&!vm(l)&&(t.attributes[l]={name:a,location:c,type:s,size:u})},a=0;a<n;a++)o(a)},n.readUniformLocationsFromLinkedProgram=function(){for(var t=this.device.gl,e=t.getProgramParameter(this.gl_program,t.ACTIVE_UNIFORMS),n=0;n<e;n++){var r=t.getActiveUniform(this.gl_program,n),i=Zd(r.name).name,o=t.getUniformLocation(this.gl_program,i);if(this.uniformSetters[i]=fp(t,o,r),r&&r.size>1)for(var a=0;a<r.size;a++)o=t.getUniformLocation(this.gl_program,i+"["+a+"]"),this.uniformSetters[i+"["+a+"]"]=fp(t,o,r)}},n.compileShader=function(t,e){var n=this.device.gl,r=this.device.ensureResourceExists(n.createShader(e));return n.shaderSource(r,t),n.compileShader(r),r},n.setUniforms=function(t){void 0===t&&(t={});var e=this.device.gl;if(!_m(e)){var n=!1;for(var r in t){n||(e.useProgram(this.gl_program),n=!0);var i=t[r],o=this.uniformSetters[r];if(o){var a=i;a instanceof Fm&&(a=a.textureIndex),o(a)}}}return this},e}(lm),Um=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.QueryPool,n.gl_query_type=void 0,n.gl_query=void 0;var a=n.device.gl;if(_m(a)){var s=o.elemCount,u=o.type;n.gl_query=gd(s,(function(){return n.device.ensureResourceExists(a.createQuery())})),n.gl_query_type=function(t){switch(t){case Wh.OcclusionConservative:return Kh.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}(u)}return n}om(e,t);var n=e.prototype;return n.queryResultOcclusion=function(t){var e=this.device.gl;if(_m(e)){var n=this.gl_query[t];return e.getQueryParameter(n,e.QUERY_RESULT_AVAILABLE)?!!e.getQueryParameter(n,e.QUERY_RESULT):null}return null},n.destroy=function(){t.prototype.destroy.call(this);var e=this.device.gl;if(_m(e))for(var n=0;n<this.gl_query.length;n++)e.deleteQuery(this.gl_query[n])},e}(lm),Gm=function(t){function e(e){var n,r=e.id,i=e.device;return(n=t.call(this,{id:r,device:i})||this).type=Rh.Readback,n.gl_pbo=null,n.gl_sync=null,n}om(e,t);var n=e.prototype;return n.clientWaitAsync=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var r=this.device.gl;return new Promise((function(i,o){!function a(){var s,u,c,l=r.clientWaitSync(t,e,0);l!=r.WAIT_FAILED?l!=r.TIMEOUT_EXPIRED?i():setTimeout(a,(s=n,u=0,c=r.MAX_CLIENT_WAIT_TIMEOUT_WEBGL,s<u?u:s>c?c:s)):o()}()}))},n.getBufferSubDataAsync=function(){var t=rm(em().mark((function t(e,n,r,i,o,a){var s;return em().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===o&&(o=0),void 0===a&&(a=i.byteLength||0),!_m(s=this.device.gl)){t.next=12;break}return this.gl_sync=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0),s.flush(),t.next=8,this.clientWaitAsync(this.gl_sync,0,10);case 8:return s.bindBuffer(e,n),s.getBufferSubData(e,r,i,o,a),s.bindBuffer(e,null),t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)})));return function(e,n,r,i,o,a){return t.apply(this,arguments)}}(),n.readTexture=function(){var t=rm(em().mark((function t(e,n,r,i,o,a,s,u){var c,l,f;return em().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===u&&(u=a.byteLength||0),c=this.device.gl,l=e,f=this.device.translateTextureType(l.pixelFormat),c.bindFramebuffer(Kh.FRAMEBUFFER,this.device.readbackFramebuffer),c.framebufferTexture2D(Kh.FRAMEBUFFER,Kh.COLOR_ATTACHMENT0,Kh.TEXTURE_2D,l.gl_texture,0),c.pixelStorei(c.PACK_ALIGNMENT,4),c.readPixels(n,r,i,o,c.RGBA,f,a),t.abrupt("return",Promise.resolve(a));case 10:case"end":return t.stop()}}),t,this)})));return function(e,n,r,i,o,a,s,u){return t.apply(this,arguments)}}(),n.readBuffer=function(){var t=rm(em().mark((function t(e,n,r,i,o){var a;return em().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!_m(a=this.device.gl)){t.next=3;break}return t.abrupt("return",this.getBufferSubDataAsync(a.ARRAY_BUFFER,bm(e,n),n,r,i,o));case 3:return t.abrupt("return",Promise.reject());case 4:case"end":return t.stop()}}),t,this)})));return function(e,n,r,i,o){return t.apply(this,arguments)}}(),n.destroy=function(){t.prototype.destroy.call(this),_m(this.device.gl)&&(null!==this.gl_sync&&this.device.gl.deleteSync(this.gl_sync),null!==this.gl_pbo&&this.device.gl.deleteBuffer(this.gl_pbo))},e}(lm),Vm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;return(n=t.call(this,{id:r,device:i})||this).type=Rh.RenderPipeline,n.bindingLayouts=void 0,n.program=void 0,n.drawMode=void 0,n.megaState=void 0,n.inputLayout=void 0,n.colorAttachmentFormats=void 0,n.depthStencilAttachmentFormat=void 0,n.sampleCount=void 0,n.bindingLayouts=n.createBindingLayouts(o.bindingLayouts),n.drawMode=function(t){switch(t){case Ph.Triangles:return Kh.TRIANGLES;case Ph.Points:return Kh.POINTS;case Ph.TriangleStrip:return Kh.TRIANGLE_STRIP;case Ph.Lines:return Kh.LINES;case Ph.LineStrip:return Kh.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}(o.topology),n.program=o.program,n.inputLayout=o.inputLayout,n.megaState=o.megaStateDescriptor,n.colorAttachmentFormats=o.colorAttachmentFormats.slice(),n.depthStencilAttachmentFormat=o.depthStencilAttachmentFormat,n.sampleCount=o.sampleCount,n}return om(e,t),e.prototype.createBindingLayouts=function(t){for(var e=0,n=0,r=[],i=0;i<t.length;i++){var o=t[i],a=o.numUniformBuffers,s=o.numSamplers,u=o.samplerEntries,c=[];void 0!==u&&ed(u.length===s);for(var l=0;l<s;l++){var f=void 0!==u?u[l]:xd,h=f.dimension,d=f.formatKind;c.push({gl_target:Pm(h),formatKind:d})}r.push({firstUniformBuffer:e,numUniformBuffers:a,firstSampler:n,numSamplers:s,samplerEntries:c}),e+=a,n+=s}return{numUniformBuffers:e,numSamplers:n,bindingLayoutTables:r}},e}(lm),jm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.RenderTarget,n.gl_renderbuffer=null,n.texture=null,n.pixelFormat=void 0,n.width=void 0,n.height=void 0,n.sampleCount=void 0;var a=n.device.gl,s=o.pixelFormat,u=o.width,c=o.height,l=o.texture,f=o.sampleCount;if(l)n.texture=l;else{n.gl_renderbuffer=n.device.ensureResourceExists(a.createRenderbuffer()),a.bindRenderbuffer(a.RENDERBUFFER,n.gl_renderbuffer);var h=n.device.translateTextureInternalFormat(s);_m(a)?a.renderbufferStorageMultisample(Kh.RENDERBUFFER,f,h,u,c):a.renderbufferStorage(Kh.RENDERBUFFER,h,u,c)}return n.pixelFormat=s,n.width=u,n.height=c,n.sampleCount=f,n}return om(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),null!==this.gl_renderbuffer&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer)},e}(lm),Wm=function(){function t(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}var e=t.prototype;return e.trackResourceCreated=function(t){this.creationStacks.set(t,(new Error).stack),this.liveObjects.add(t)},e.trackResourceDestroyed=function(t){this.deletionStacks.has(t)&&console.warn("Object double freed:",t,"\n\nCreation stack: ",this.creationStacks.get(t),"\n\nDeletion stack: ",this.deletionStacks.get(t),"\n\nThis stack: ",(new Error).stack),this.deletionStacks.set(t,(new Error).stack),this.liveObjects.delete(t)},e.checkForLeaks=function(){for(var t,e=um(this.liveObjects.values());!(t=e()).done;){var n=t.value;console.warn("Object leaked:",n,"Creation stack:",this.creationStacks.get(n))}},e.setResourceLeakCheck=function(t,e){e?this.liveObjects.add(t):this.liveObjects.delete(t)},t}(),Xm=function(t){function e(e){var n,r=e.id,i=e.device,o=e.descriptor;(n=t.call(this,{id:r,device:i})||this).type=Rh.Sampler,n.gl_sampler=void 0,n.descriptor=void 0;var a=n.device.gl;if(_m(a)){var s,u,c=n.device.ensureResourceExists(a.createSampler());a.samplerParameteri(c,Kh.TEXTURE_WRAP_S,Am(o.wrapS)),a.samplerParameteri(c,Kh.TEXTURE_WRAP_T,Am(o.wrapT)),a.samplerParameteri(c,Kh.TEXTURE_WRAP_R,Am(null!==(s=o.wrapQ)&&void 0!==s?s:o.wrapS)),a.samplerParameteri(c,Kh.TEXTURE_MIN_FILTER,Sm(o.minFilter,o.mipFilter)),a.samplerParameteri(c,Kh.TEXTURE_MAG_FILTER,Sm(o.magFilter,Nh.NoMip)),void 0!==o.minLOD&&a.samplerParameterf(c,Kh.TEXTURE_MIN_LOD,o.minLOD),void 0!==o.maxLOD&&a.samplerParameterf(c,Kh.TEXTURE_MAX_LOD,o.maxLOD),void 0!==o.compareMode&&(a.samplerParameteri(c,a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.samplerParameteri(c,a.TEXTURE_COMPARE_FUNC,o.compareMode));var l=null!==(u=o.maxAnisotropy)&&void 0!==u?u:1;l>1&&null!==n.device.EXT_texture_filter_anisotropic&&(ed(o.minFilter===Ch.Bilinear&&o.magFilter===Ch.Bilinear&&o.mipFilter===Nh.Linear),a.samplerParameterf(c,n.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l)),n.gl_sampler=c}else n.descriptor=o;return n}om(e,t);var n=e.prototype;return n.setTextureParameters=function(t,e,n){var r,i=this.device.gl,o=this.descriptor;this.isNPOT(e,n)?i.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_MIN_FILTER,Kh.LINEAR):i.texParameteri(t,Kh.TEXTURE_MIN_FILTER,Sm(o.minFilter,o.mipFilter)),i.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_WRAP_S,Am(o.wrapS)),i.texParameteri(Kh.TEXTURE_2D,Kh.TEXTURE_WRAP_T,Am(o.wrapT)),i.texParameteri(t,Kh.TEXTURE_MAG_FILTER,Sm(o.magFilter,Nh.NoMip));var a=null!==(r=o.maxAnisotropy)&&void 0!==r?r:1;a>1&&null!==this.device.EXT_texture_filter_anisotropic&&(ed(o.minFilter===Ch.Bilinear&&o.magFilter===Ch.Bilinear&&o.mipFilter===Nh.Linear),i.texParameteri(t,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a))},n.destroy=function(){t.prototype.destroy.call(this),_m(this.device.gl)&&this.device.gl.deleteSampler(Mm(this))},n.isNPOT=function(t,e){return!ld(t)||!ld(e)},e}(lm),Hm=function(){function t(t,e){this.shaderDebug=!1,this.contextAttributes=void 0,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_depth_texture=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorResolveTos=[],this.currentDepthStencilAttachment=void 0,this.currentDepthStencilResolveTo=null,this.currentSampleCount=-1,this.currentPipeline=void 0,this.currentInputState=void 0,this.currentMegaState=Td(Ad),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveColorReadFramebuffer=void 0,this.resolveColorDrawFramebuffer=void 0,this.resolveDepthStencilAttachmentsChanged=!1,this.resolveDepthStencilReadFramebuffer=void 0,this.resolveDepthStencilDrawFramebuffer=void 0,this.renderPassDrawFramebuffer=void 0,this.readbackFramebuffer=void 0,this.fallbackTexture2D=void 0,this.fallbackTexture2DDepth=void 0,this.fallbackTexture2DArray=void 0,this.fallbackTexture3D=void 0,this.fallbackTextureCube=void 0,this.platformString=void 0,this.glslVersion=void 0,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=Vh.LowerLeft,this.clipSpaceNearZ=jh.NegativeOne,this.supportMRT=!1,this.inBlitRenderPass=!1,this.blitRenderPipeline=void 0,this.blitInputState=void 0,this.blitBindings=void 0,this.uniformBufferMaxPageByteSize=void 0,this.uniformBufferWordAlignment=void 0,this.uniformBufferMaxPageWordSize=void 0,this.supportedSampleCounts=[],this.maxVertexAttribs=void 0,this.occlusionQueriesRecommended=!1,this.gl=void 0,this.gl=t,this.contextAttributes=nd(t.getContextAttributes()),_m(t)?this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"):(this.OES_vertex_array_object=t.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=t.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=t.getExtension("OES_texture_float"),this.WEBGL_depth_texture=t.getExtension("WEBGL_depth_texture"),t.getExtension("EXT_frag_depth"),t.getExtension("OES_element_index_uint"),t.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=t.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=t.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=t.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=t.getExtension("KHR_parallel_shader_compile"),_m(t)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new Fm({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depth:1,dimension:Bh.n2D,numLevels:1,usage:Fh.RenderTarget,pixelFormat:!1===this.contextAttributes.alpha?zh.U8_RGB_RT:zh.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=Gh.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(Bh.n2D,Gh.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(Bh.n2D,Gh.Depth),_m(t),this.currentMegaState.depthCompare=Ah.Less,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=kh.AllChannels,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),this.checkLimits(),e.shaderDebug&&(this.shaderDebug=!0),e.trackResources&&(this.resourceCreationTracker=new Wm)}var e=t.prototype;return e.createFallbackTexture=function(t,e){var n=t===Bh.Cube?6:1,r=e===Gh.Depth?zh.D32F:zh.U8_RGBA_NORM,i=this.createTexture({dimension:t,pixelFormat:r,usage:Fh.Sampled,width:1,height:1,depth:n,numLevels:1,immutable:!0});return e===Gh.Float&&i.setImageData([new Uint8Array(4*n)],0),xm(i)},e.getNextUniqueId=function(){return++this.resourceUniqueId},e.checkLimits=function(){var t=this.gl;if(this.maxVertexAttribs=t.getParameter(Kh.MAX_VERTEX_ATTRIBS),_m(t)){this.uniformBufferMaxPageByteSize=Math.min(t.getParameter(Kh.MAX_UNIFORM_BLOCK_SIZE),65536),this.uniformBufferWordAlignment=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var e=t.getInternalformatParameter(t.RENDERBUFFER,t.DEPTH32F_STENCIL8,t.SAMPLES);this.supportedSampleCounts=e?[].concat(e):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=65536;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort((function(t,e){return t-e}))},e.configureSwapChain=function(t,e,n){var r=this.scTexture;r.width=t,r.height=e,this.scPlatformFramebuffer=hd(n)},e.getDevice=function(){return this},e.getCanvas=function(){return this.gl.canvas},e.getOnscreenTexture=function(){return this.scTexture},e.present=function(){},e.translateTextureInternalFormat=function(t){switch(t){case zh.ALPHA:return Kh.ALPHA;case zh.F16_R:return Kh.R16F;case zh.F16_RG:return Kh.RG16F;case zh.F16_RGB:return Kh.RGB16F;case zh.F16_RGBA:return Kh.RGBA16F;case zh.F32_R:return Kh.R32F;case zh.F32_RG:return Kh.RG32F;case zh.F32_RGB:return Kh.RGB32F;case zh.F32_RGBA:return Kh.RGBA32F;case zh.U8_R_NORM:return Kh.R8;case zh.U8_RG_NORM:return Kh.RG8;case zh.U8_RGB_NORM:case zh.U8_RGB_RT:return Kh.RGB8;case zh.U8_RGB_SRGB:return Kh.SRGB8;case zh.U8_RGBA_NORM:case zh.U8_RGBA_RT:return _m(this.gl)?Kh.RGBA8:Kh.RGBA;case zh.U8_RGBA_SRGB:case zh.U8_RGBA_RT_SRGB:return Kh.SRGB8_ALPHA8;case zh.U16_R:return Kh.R16UI;case zh.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case zh.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case zh.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case zh.U16_RGBA_5551:return Kh.RGB5_A1;case zh.U32_R:return Kh.R32UI;case zh.S8_RGBA_NORM:return Kh.RGBA8_SNORM;case zh.S8_RG_NORM:return Kh.RG8_SNORM;case zh.U16_RGBA_5551:return Kh.UNSIGNED_SHORT_5_5_5_1;case zh.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case zh.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case zh.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case zh.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case zh.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case zh.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case zh.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case zh.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case zh.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case zh.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case zh.D32F_S8:return _m(this.gl)?Kh.DEPTH32F_STENCIL8:Kh.DEPTH_STENCIL;case zh.D24_S8:return _m(this.gl)?Kh.DEPTH24_STENCIL8:Kh.DEPTH_STENCIL;case zh.D32F:return _m(this.gl)?Kh.DEPTH_COMPONENT32F:Kh.DEPTH_COMPONENT;case zh.D24:return _m(this.gl)?Kh.DEPTH_COMPONENT24:Kh.DEPTH_COMPONENT;default:throw new Error("whoops")}},e.translateTextureType=function(t){switch(Jh(t)){case Xh.U8:return Kh.UNSIGNED_BYTE;case Xh.U16:return Kh.UNSIGNED_SHORT;case Xh.U32:return Kh.UNSIGNED_INT;case Xh.S8:return Kh.BYTE;case Xh.F16:return Kh.HALF_FLOAT;case Xh.F32:return Kh.FLOAT;case Xh.U16_PACKED_5551:return Kh.UNSIGNED_SHORT_5_5_5_1;case Xh.D32F:return _m(this.gl)?Kh.FLOAT:Kh.UNSIGNED_INT;case Xh.D24:return _m(this.gl)?Kh.UNSIGNED_INT_24_8:Kh.UNSIGNED_SHORT;case Xh.D24S8:return _m(this.gl)?Kh.UNSIGNED_INT_24_8:Kh.UNSIGNED_INT_24_8_WEBGL;case Xh.D32FS8:return Kh.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.translateTextureFormat=function(t){if(function(t){switch(Jh(t)){case Xh.BC1:case Xh.BC2:case Xh.BC3:case Xh.BC4_UNORM:case Xh.BC4_SNORM:case Xh.BC5_UNORM:case Xh.BC5_SNORM:return!0;default:return!1}}(t))return this.translateTextureInternalFormat(t);switch(t){case zh.D24_S8:case zh.D32F_S8:return Kh.DEPTH_STENCIL;case zh.D24:case zh.D32F:return Kh.DEPTH_COMPONENT}var e=Em(t);switch(Qh(t)){case Hh.A:return Kh.ALPHA;case Hh.R:return e?Kh.RED_INTEGER:Kh.RED;case Hh.RG:return e?Kh.RG_INTEGER:Kh.RG;case Hh.RGB:return e?Kh.RGB_INTEGER:Kh.RGB;case Hh.RGBA:return Kh.RGBA}},e.setActiveTexture=function(t){this.currentActiveTexture!==t&&(this.gl.activeTexture(t),this.currentActiveTexture=t)},e.bindVAO=function(t){this.currentBoundVAO!==t&&(_m(this.gl)?this.gl.bindVertexArray(t):this.OES_vertex_array_object.bindVertexArrayOES(t),this.currentBoundVAO=t)},e.programCompiled=function(t){ed(t.compileState!==wm.NeedsCompile),t.compileState===wm.Compiling&&(t.compileState=wm.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(t))},e.useProgram=function(t){this.currentProgram!==t&&(this.programCompiled(t),this.gl.useProgram(t.gl_program),this.currentProgram=t)},e.ensureResourceExists=function(t){if(null===t){var e=this.gl.getError();throw new Error("Created resource is null; GL error encountered: "+e)}return t},e.createBuffer=function(t){return new Dm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createTexture=function(t){return new Fm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createSampler=function(t){return new Xm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createRenderTarget=function(t){return new jm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createRenderTargetFromTexture=function(t){var e=t.pixelFormat,n=t.width,r=t.height;return ed(1===t.numLevels),this.createRenderTarget({pixelFormat:e,width:n,height:r,sampleCount:1,texture:t})},e.createProgram=function(t){return t.ensurePreprocessed(this.queryVendorInfo()),this.createProgramSimple(t)},e.createProgramSimple=function(t){return new km({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createBindings=function(t){return new fm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createInputLayout=function(t){return new Lm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createInputState=function(t,e,n,r){var i=t;return new Bm({id:this.getNextUniqueId(),device:this,inputLayout:i,vertexBuffers:e,indexBufferBinding:n,program:r})},e.createRenderPipeline=function(t){return new Vm({id:this.getNextUniqueId(),device:this,descriptor:t})},e.createComputePass=function(t){throw new Error("Method not implemented.")},e.createComputePipeline=function(t){throw new Error("Method not implemented.")},e.createReadback=function(){return new Gm({id:this.getNextUniqueId(),device:this})},e.createQueryPool=function(t,e){return new Um({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:e}})},e.createRenderPass=function(t){ed(null===this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=t;var e=t.colorAttachment,n=t.colorClearColor,r=t.colorResolveTo,i=t.depthStencilAttachment,o=t.depthClearValue,a=t.stencilClearValue,s=t.depthStencilResolveTo;this.setRenderPassParametersBegin(e.length);for(var u=0;u<e.length;u++)this.setRenderPassParametersColor(u,e[u],r[u]);this.setRenderPassParametersDepthStencil(i,s),this.validateCurrentAttachments();for(var c=0;c<e.length;c++){var l=n[c];"load"!==l&&this.setRenderPassParametersClearColor(c,l.r,l.g,l.b,l.a)}return this.setRenderPassParametersClearDepthStencil(o,a),this},e.submitPass=function(t){ed(null!==this.currentRenderPassDescriptor),this.endPass(),this.currentRenderPassDescriptor=null},e.copySubTexture2D=function(t,e,n,r,i,o){var a=this.gl,s=t,u=r;ed(1===u.numLevels),ed(1===s.numLevels),_m(a)&&(s===this.scTexture?a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,s)),a.bindFramebuffer(a.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,u),a.blitFramebuffer(i,o,i+u.width,o+u.height,e,n,e+u.width,n+u.height,a.COLOR_BUFFER_BIT,a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null))},e.queryLimits=function(){return this},e.queryTextureFormatSupported=function(t,e,n){switch(t){case zh.BC1_SRGB:case zh.BC2_SRGB:case zh.BC3_SRGB:return null!==this.WEBGL_compressed_texture_s3tc_srgb&&Im(e,n,4,4);case zh.BC1:case zh.BC2:case zh.BC3:return null!==this.WEBGL_compressed_texture_s3tc&&Im(e,n,4,4);case zh.BC4_UNORM:case zh.BC4_SNORM:case zh.BC5_UNORM:case zh.BC5_SNORM:return null!==this.EXT_texture_compression_rgtc&&Im(e,n,4,4);case zh.U16_R_NORM:case zh.U16_RG_NORM:case zh.U16_RGBA_NORM:return null!==this.EXT_texture_norm16;case zh.F32_R:case zh.F32_RG:case zh.F32_RGB:case zh.F32_RGBA:return null!==this.OES_texture_float_linear;case zh.F16_R:case zh.F16_RG:case zh.F16_RGB:case zh.F16_RGBA:return null!==this.OES_texture_half_float_linear;default:return!0}},e.queryProgramReady=function(t){var e,n=this.gl;if(t.compileState===wm.NeedsCompile)throw new Error("whoops");return t.compileState===wm.Compiling?((e=null===this.KHR_parallel_shader_compile||n.getProgramParameter(t.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR))&&this.programCompiled(t),e):t.compileState===wm.NeedsBind||t.compileState===wm.ReadyToUse},e.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.queryVendorInfo=function(){return this},e.queryRenderPass=function(t){return this.currentRenderPassDescriptor},e.queryRenderTarget=function(t){return t},e.setResourceName=function(t,e){if(t.name=e,t.type===Rh.Buffer)for(var n=t.gl_buffer_pages,r=0;r<n.length;r++)Om(n[r],e+" Page "+r);else if(t.type===Rh.Texture)Om(xm(t),e);else if(t.type===Rh.Sampler)Om(Mm(t),e);else if(t.type===Rh.RenderTarget){var i=t.gl_renderbuffer;null!==i&&Om(i,e)}else t.type===Rh.InputState&&Om(t.vao,e)},e.setResourceLeakCheck=function(t,e){null!==this.resourceCreationTracker&&this.resourceCreationTracker.setResourceLeakCheck(t,e)},e.checkForLeaks=function(){null!==this.resourceCreationTracker&&this.resourceCreationTracker.checkForLeaks()},e.pushDebugGroup=function(t){this.debugGroupStack.push(t)},e.popDebugGroup=function(){this.debugGroupStack.pop()},e.programPatched=function(t,e){ed(this.shaderDebug)},e.getBufferData=function(t,e,n){void 0===n&&(n=0);var r=this.gl;_m(r)&&(r.bindBuffer(r.COPY_READ_BUFFER,bm(t,4*n)),r.getBufferSubData(r.COPY_READ_BUFFER,4*n,e))},e.debugGroupStatisticsDrawCall=function(t){void 0===t&&(t=1);for(var e=this.debugGroupStack.length-1;e>=0;e--)this.debugGroupStack[e].drawCallCount+=t},e.debugGroupStatisticsBufferUpload=function(t){void 0===t&&(t=1);for(var e=this.debugGroupStack.length-1;e>=0;e--)this.debugGroupStack[e].bufferUploadCount+=t},e.debugGroupStatisticsTextureBind=function(t){void 0===t&&(t=1);for(var e=this.debugGroupStack.length-1;e>=0;e--)this.debugGroupStack[e].textureBindCount+=t},e.debugGroupStatisticsTriangles=function(t){for(var e=this.debugGroupStack.length-1;e>=0;e--)this.debugGroupStack[e].triangleCount+=t},e.reportShaderError=function(t,e){var n=this.gl,r=n.getShaderParameter(t,n.COMPILE_STATUS);if(!r){console.error(function(t,e){return void 0===e&&(e=1),t.split("\n").map((function(t,n){return function(t,e,n){void 0===n&&(n="0");for(;t.length<e;)t=""+n+t;return t}(""+(e+n),4," ")+"  "+t})).join("\n")}(e));var i=n.getExtension("WEBGL_debug_shaders");i&&console.error(i.getTranslatedShaderSource(t)),console.error(n.getShaderInfoLog(t))}return r},e.checkProgramCompilationForErrors=function(t){var e=this.gl,n=t.gl_program;if(!e.getProgramParameter(n,e.LINK_STATUS)){var r=t.descriptor;if(!this.reportShaderError(t.gl_shader_vert,r.preprocessedVert))return;if(!this.reportShaderError(t.gl_shader_frag,r.preprocessedFrag))return;console.error(e.getProgramInfoLog(t.gl_program))}},e.bindFramebufferAttachment=function(t,e,n){var r=this.gl;null===n?r.framebufferRenderbuffer(t,e,r.RENDERBUFFER,null):n.type===Rh.RenderTarget?null!==n.gl_renderbuffer?r.framebufferRenderbuffer(t,e,r.RENDERBUFFER,n.gl_renderbuffer):null!==n.texture&&r.framebufferTexture2D(t,e,Kh.TEXTURE_2D,xm(n.texture),0):n.type===Rh.Texture&&r.framebufferTexture2D(t,e,Kh.TEXTURE_2D,xm(n),0)},e.bindFramebufferDepthStencilAttachment=function(t,e){var n=this.gl,r=null!==e?$h(e.pixelFormat):Yh.Depth|Yh.Stencil,i=!!(r&Yh.Depth),o=!!(r&Yh.Stencil);i&&o?this.bindFramebufferAttachment(t,n.DEPTH_STENCIL_ATTACHMENT,e):i?(this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,e),this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,null)):o&&(this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,e),this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,null))},e.validateCurrentAttachments=function(){for(var t=-1,e=-1,n=-1,r=0;r<this.currentColorAttachments.length;r++){var i=this.currentColorAttachments[r];null!==i&&(-1===t?(t=i.sampleCount,e=i.width,n=i.height):(ed(t===i.sampleCount),ed(e===i.width),ed(n===i.height)))}null!==this.currentDepthStencilAttachment&&(-1===t?(t=this.currentDepthStencilAttachment.sampleCount,e=this.currentDepthStencilAttachment.width,n=this.currentDepthStencilAttachment.height):(ed(t===this.currentDepthStencilAttachment.sampleCount),ed(e===this.currentDepthStencilAttachment.width),ed(n===this.currentDepthStencilAttachment.height))),this.currentSampleCount=t},e.setRenderPassParametersBegin=function(t){var e=this.gl;if(_m(e)?e.bindFramebuffer(Kh.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||e.bindFramebuffer(Kh.FRAMEBUFFER,this.renderPassDrawFramebuffer),!this.inBlitRenderPass)for(var n=t;n<this.currentColorAttachments.length;n++){var r=_m(e)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,i=_m(e)?Kh.COLOR_ATTACHMENT0:Kh.COLOR_ATTACHMENT0_WEBGL;e.framebufferRenderbuffer(r,i+n,Kh.RENDERBUFFER,null),e.framebufferTexture2D(r,i+n,Kh.TEXTURE_2D,null,0)}this.currentColorAttachments.length=t},e.setRenderPassParametersColor=function(t,e,n){var r=this.gl;this.currentColorAttachments[t]!==e&&(this.currentColorAttachments[t]=e,(_m(r)||0===t)&&this.bindFramebufferAttachment(_m(r)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,(_m(r)?Kh.COLOR_ATTACHMENT0:Kh.COLOR_ATTACHMENT0_WEBGL)+t,e),this.resolveColorAttachmentsChanged=!0),this.currentColorResolveTos[t]!==n&&(this.currentColorResolveTos[t]=n,null!==n&&(this.resolveColorAttachmentsChanged=!0))},e.setRenderPassParametersDepthStencil=function(t,e){var n=this.gl;this.currentDepthStencilAttachment!==t&&(this.currentDepthStencilAttachment=t,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(_m(n)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==e&&(this.currentDepthStencilResolveTo=e,null!==e&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.setRenderPassParametersClearColor=function(t,e,n,r,i){var o=this.gl;if(null!==this.OES_draw_buffers_indexed){var a=this.currentMegaState.attachmentsState[t];a&&a.channelWriteMask!==kh.AllChannels&&(this.OES_draw_buffers_indexed.colorMaskiOES(t,!0,!0,!0,!0),a.channelWriteMask=kh.AllChannels)}else{var s=this.currentMegaState.attachmentsState[0];s&&s.channelWriteMask!==kh.AllChannels&&(o.colorMask(!0,!0,!0,!0),s.channelWriteMask=kh.AllChannels)}this.setScissorEnabled(!1),_m(o)?o.clearBufferfv(o.COLOR,t,[e,n,r,i]):(o.clearColor(e,n,r,i),o.clear(o.COLOR_BUFFER_BIT))},e.setRenderPassParametersClearDepthStencil=function(t,e){var n=this.gl;"load"!==t&&(ed(null!==this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(n.depthMask(!0),this.currentMegaState.depthWrite=!0),_m(n)?n.clearBufferfv(n.DEPTH,0,[t]):(n.clearDepth(t),n.clear(n.DEPTH_BUFFER_BIT))),"load"!==e&&(ed(null!==this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(n.enable(n.STENCIL_TEST),n.stencilMask(255),this.currentMegaState.stencilWrite=!0),_m(n)?n.clearBufferiv(n.STENCIL,0,[e]):(n.clearStencil(e),n.clear(n.STENCIL_BUFFER_BIT)))},e.setBindings=function(t,e,n){var r=this.gl;ed(t<this.currentPipeline.bindingLayouts.bindingLayoutTables.length);var i=this.currentPipeline.bindingLayouts.bindingLayoutTables[t],o=e.uniformBufferBindings,a=e.samplerBindings;ed(o.length>=i.numUniformBuffers),ed(a.length>=i.numSamplers),ed(n.length>=o.length);for(var s=0;s<o.length;s++){var u=o[s];if(0!==u.wordCount){var c=i.firstUniformBuffer+s,l=u.buffer,f=n[s],h=4*u.wordCount;if(l!==this.currentUniformBuffers[c]||f!==this.currentUniformBufferByteOffsets[c]||h!==this.currentUniformBufferByteSizes[c]){var d=f%l.pageByteSize,p=l.gl_buffer_pages[f/l.pageByteSize|0];ed(d+h<=l.pageByteSize),_m(r)&&r.bindBufferRange(r.UNIFORM_BUFFER,c,p,d,h),this.currentUniformBuffers[c]=l,this.currentUniformBufferByteOffsets[c]=f,this.currentUniformBufferByteSizes[c]=h}}}for(var v=0;v<i.numSamplers;v++){var g=a[v],m=i.firstSampler+v,y=i.samplerEntries[v],_=null!==g&&null!==g.sampler?Mm(g.sampler):null,E=null!==g&&null!==g.texture?xm(g.texture):null;if(this.currentSamplers[m]!==_&&(_m(r)&&r.bindSampler(m,_),this.currentSamplers[m]=_),this.currentTextures[m]!==E){if(this.setActiveTexture(r.TEXTURE0+m),null!==E){g.texture.textureIndex=m;var T,R=nd(g).texture,A=R.gl_target,S=R.width,b=R.height;if(r.bindTexture(A,E),!_m(r))null===(T=g.sampler)||void 0===T||T.setTextureParameters(A,S,b);this.debugGroupStatisticsTextureBind(),ed(y.gl_target===A)}else r.bindTexture(y.gl_target,this.getFallbackTexture(y));this.currentTextures[m]=E}}},e.setViewport=function(t,e,n,r){this.gl.viewport(t,e,n,r)},e.setScissor=function(t,e,n,r){var i=this.gl;this.setScissorEnabled(!0),i.scissor(t,e,n,r)},e.applyAttachmentStateIndexed=function(t,e,n){var r=this.gl,i=this.OES_draw_buffers_indexed;e.channelWriteMask!==n.channelWriteMask&&(i.colorMaskiOES(t,!!(n.channelWriteMask&kh.Red),!!(n.channelWriteMask&kh.Green),!!(n.channelWriteMask&kh.Blue),!!(n.channelWriteMask&kh.Alpha)),e.channelWriteMask=n.channelWriteMask);var o=e.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||e.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,a=e.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||e.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||e.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||e.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(a||o)&&(Nm(e.rgbBlendState)&&Nm(e.alphaBlendState)?i.enableiOES(t,r.BLEND):Nm(n.rgbBlendState)&&Nm(n.alphaBlendState)&&i.disableiOES(t,r.BLEND)),o&&(i.blendEquationSeparateiOES(t,n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),e.rgbBlendState.blendMode=n.rgbBlendState.blendMode,e.alphaBlendState.blendMode=n.alphaBlendState.blendMode),a&&(i.blendFuncSeparateiOES(t,n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),e.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,e.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,e.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,e.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.applyAttachmentState=function(t,e){var n=this.gl;t.channelWriteMask!==e.channelWriteMask&&(n.colorMask(!!(e.channelWriteMask&kh.Red),!!(e.channelWriteMask&kh.Green),!!(e.channelWriteMask&kh.Blue),!!(e.channelWriteMask&kh.Alpha)),t.channelWriteMask=e.channelWriteMask);var r=t.rgbBlendState.blendMode!==e.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==e.alphaBlendState.blendMode,i=t.rgbBlendState.blendSrcFactor!==e.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==e.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==e.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==e.alphaBlendState.blendDstFactor;(i||r)&&(Nm(t.rgbBlendState)&&Nm(t.alphaBlendState)?n.enable(n.BLEND):Nm(e.rgbBlendState)&&Nm(e.alphaBlendState)&&n.disable(n.BLEND)),r&&(n.blendEquationSeparate(e.rgbBlendState.blendMode,e.alphaBlendState.blendMode),t.rgbBlendState.blendMode=e.rgbBlendState.blendMode,t.alphaBlendState.blendMode=e.alphaBlendState.blendMode),i&&(n.blendFuncSeparate(e.rgbBlendState.blendSrcFactor,e.rgbBlendState.blendDstFactor,e.alphaBlendState.blendSrcFactor,e.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=e.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=e.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=e.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=e.alphaBlendState.blendDstFactor)},e.setMegaState=function(t){var e=this.gl,n=this.currentMegaState;if(null!==this.OES_draw_buffers_indexed)for(var r=0;r<t.attachmentsState.length;r++)this.applyAttachmentStateIndexed(r,n.attachmentsState[0],t.attachmentsState[0]);else ed(1===t.attachmentsState.length),this.applyAttachmentState(n.attachmentsState[0],t.attachmentsState[0]);rd(n.blendConstant,t.blendConstant)||(e.blendColor(t.blendConstant.r,t.blendConstant.g,t.blendConstant.b,t.blendConstant.a),id(n.blendConstant,t.blendConstant)),n.depthCompare!==t.depthCompare&&(e.depthFunc(t.depthCompare),n.depthCompare=t.depthCompare),n.depthWrite!==t.depthWrite&&(e.depthMask(t.depthWrite),n.depthWrite=t.depthWrite),n.stencilWrite!==t.stencilWrite&&(e.stencilMask(t.stencilWrite?255:0),n.stencilWrite=t.stencilWrite),n.stencilPassOp!==t.stencilPassOp&&(e.stencilOp(e.KEEP,e.KEEP,t.stencilPassOp),n.stencilPassOp=t.stencilPassOp),n.stencilRef===t.stencilRef&&n.stencilCompare===t.stencilCompare||(n.stencilCompare=t.stencilCompare,this.setStencilRef(t.stencilRef)),n.cullMode!==t.cullMode&&(n.cullMode===bh.None?e.enable(e.CULL_FACE):t.cullMode===bh.None&&e.disable(e.CULL_FACE),t.cullMode===bh.Back?e.cullFace(e.BACK):t.cullMode===bh.Front?e.cullFace(e.FRONT):t.cullMode===bh.FrontAndBack&&e.cullFace(e.FRONT_AND_BACK),n.cullMode=t.cullMode),n.frontFace!==t.frontFace&&(e.frontFace(t.frontFace),n.frontFace=t.frontFace),n.polygonOffset!==t.polygonOffset&&(t.polygonOffset?(e.polygonOffset(1,1),e.enable(e.POLYGON_OFFSET_FILL)):e.disable(e.POLYGON_OFFSET_FILL),n.polygonOffset=t.polygonOffset)},e.validatePipelineFormats=function(t){for(var e=0;e<this.currentColorAttachments.length;e++){var n=this.currentColorAttachments[e];null!==n&&ed(n.pixelFormat===t.colorAttachmentFormats[e])}null!==this.currentDepthStencilAttachment&&ed(this.currentDepthStencilAttachment.pixelFormat===t.depthStencilAttachmentFormat),-1!==this.currentSampleCount&&ed(this.currentSampleCount===t.sampleCount)},e.setPipeline=function(t){this.currentPipeline=t,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var e=this.currentPipeline.program;if(this.useProgram(e),e.compileState===wm.NeedsBind){var n=this.gl,r=e.gl_program,i=e.descriptor,o=Cm(i.preprocessedVert,/uniform (\w+) {([^]*?)}/g);if(_m(n))for(var a=0;a<o.length;a++){var s=o[a],u=(s[0],s[1]),c=(s[2],n.getUniformBlockIndex(r,u));-1!==c&&4294967295!==c&&n.uniformBlockBinding(r,c,a)}for(var l=Cm(i.preprocessedVert,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),f=0;f<l.length;f++){var h=l[f],d=(h[0],h[1]),p=h[2],v=n.getUniformLocation(r,d);n.uniform1i(v,parseInt(p))}e.compileState=wm.ReadyToUse}},e.setInputState=function(t){var e=t;this.currentInputState=e,null!==this.currentInputState?(ed(this.currentPipeline.inputLayout===this.currentInputState.inputLayout),this.bindVAO(this.currentInputState.vao)):(ed(null===this.currentPipeline.inputLayout),this.bindVAO(null))},e.setStencilRef=function(t){this.currentStencilRef!==t&&(this.currentStencilRef=t,this.applyStencil())},e.draw=function(t,e){var n=this.gl,r=this.currentPipeline;n.drawArrays(r.drawMode,e,t),this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3)},e.drawIndexed=function(t,e){var n=this.gl,r=this.currentPipeline,i=this.currentInputState,o=nd(i.indexBufferByteOffset)+e*nd(i.indexBufferCompByteSize);n.drawElements(r.drawMode,t,nd(i.indexBufferType),o),this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3)},e.drawIndexedInstanced=function(t,e,n){var r,i=this.gl,o=this.currentPipeline,a=this.currentInputState,s=nd(a.indexBufferByteOffset)+e*nd(a.indexBufferCompByteSize),u=[o.drawMode,t,nd(a.indexBufferType),s,n];_m(i)?i.drawElementsInstanced.apply(i,u):(r=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(r,u);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*n)},e.beginOcclusionQuery=function(t){var e=this.gl;if(_m(e)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;e.beginQuery(n.gl_query_type,n.gl_query[t])}},e.endOcclusionQuery=function(t){var e=this.gl;if(_m(e)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;e.endQuery(n.gl_query_type)}},e.beginDebugGroup=function(t){},e.endDebugGroup=function(){},e.pipelineQueryReady=function(t){var e=t;return this.queryProgramReady(e.program)},e.pipelineForceReady=function(t){},e.endPass=function(){for(var t=this.gl,e=!1,n=0;n<this.currentColorAttachments.length;n++){var r=this.currentColorAttachments[n];if(null!==r){var i=this.currentColorResolveTos[n],o=!1;null!==i&&(ed(r.width===i.width&&r.height===i.height),ed(r.pixelFormat===i.pixelFormat),this.setScissorEnabled(!1),_m(t)&&t.bindFramebuffer(t.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&_m(t)&&this.bindFramebufferAttachment(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,r),o=!0,i===this.scTexture?t.bindFramebuffer(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,this.scPlatformFramebuffer):(t.bindFramebuffer(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&t.framebufferTexture2D(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i.gl_texture,0)),_m(t)?(t.blitFramebuffer(0,0,r.width,r.height,0,0,i.width,i.height,t.COLOR_BUFFER_BIT,t.LINEAR),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(r,i),e=!0),this.currentRenderPassDescriptor.colorStore[n]||(o||(t.bindFramebuffer(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,t.COLOR_ATTACHMENT0,r)),_m(t)&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.COLOR_ATTACHMENT0])),t.bindFramebuffer(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var a=this.currentDepthStencilAttachment;if(null!==a){var s=this.currentDepthStencilResolveTo,u=!1;null!==s&&(ed(a.width===s.width&&a.height===s.height),this.setScissorEnabled(!1),t.bindFramebuffer(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),t.bindFramebuffer(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,a),this.bindFramebufferDepthStencilAttachment(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,s)),u=!0,_m(t)&&t.blitFramebuffer(0,0,a.width,a.height,0,0,s.width,s.height,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,null),e=!0),this.currentRenderPassDescriptor.depthStencilStore||(u||(t.bindFramebuffer(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,a),u=!0),_m(t)&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.DEPTH_STENCIL_ATTACHMENT])),u&&t.bindFramebuffer(_m(t)?Kh.READ_FRAMEBUFFER:Kh.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}e||t.bindFramebuffer(_m(t)?Kh.DRAW_FRAMEBUFFER:Kh.FRAMEBUFFER,null)},e.setScissorEnabled=function(t){if(this.currentScissorEnabled!==t){var e=this.gl;t?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),this.currentScissorEnabled=t}},e.applyStencil=function(){null!==this.currentStencilRef&&this.gl.stencilFunc(this.currentMegaState.stencilCompare,this.currentStencilRef,255)},e.getFallbackTexture=function(t){var e=t.gl_target,n=t.formatKind;if(e===Kh.TEXTURE_2D)return n===Gh.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(e===Kh.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(e===Kh.TEXTURE_3D)return this.fallbackTexture3D;if(e===Kh.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.submitBlitRenderPass=function(t,e){if(!this.blitRenderPipeline){var n=hp(this,Ih.VERTEX|Ih.COPY_DST,new Float32Array([-4,-4,4,-4,0,4]).buffer),r=this.createInputLayout({vertexBufferDescriptors:[{byteStride:8,frequency:Dh.PerVertex}],vertexAttributeDescriptors:[{format:zh.F32_RG,bufferIndex:0,bufferByteOffset:0,location:0}],indexBufferFormat:null}),i=[{numSamplers:1,numUniformBuffers:0}],o=this.createProgram(im({},yp(this,new Mg),{ensurePreprocessed:function(){},associate:function(){}}));this.blitInputState=this.createInputState(r,[{buffer:n,byteOffset:0}],null,o),this.blitRenderPipeline=this.createRenderPipeline({topology:Ph.Triangles,sampleCount:1,program:o,bindingLayouts:i,colorAttachmentFormats:[zh.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:r,megaStateDescriptor:this.currentMegaState}),this.blitBindings=this.createBindings({bindingLayout:i[0],samplerBindings:[{sampler:null,texture:t.texture,lateBinding:null}],uniformBufferBindings:[]}),o.setUniforms({u_Texture:t})}var a=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var s=this.createRenderPass({colorAttachment:[t],colorResolveTo:[e],colorClearColor:[sd],colorStore:[!0],depthStencilAttachment:null,depthStencilResolveTo:null,depthStencilStore:!0,depthClearValue:"load",stencilClearValue:"load",occlusionQueryPool:null}),u=this.getCanvas(),c=u.width,l=u.height;s.setPipeline(this.blitRenderPipeline),s.setBindings(0,this.blitBindings,[0]),s.setInputState(this.blitInputState),s.setViewport(0,0,c,l),this.gl.disable(this.gl.BLEND),s.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=a,this.inBlitRenderPass=!1},t}(),Ym=function(){function t(t){this.pluginOptions=void 0,this.pluginOptions=t}return t.prototype.createSwapChain=function(){var t=rm(em().mark((function t(e){var n,r,i;return em().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={antialias:!1,preserveDrawingBuffer:!1,stencil:!0},(r=this.pluginOptions.targets).includes("webgl2")&&(i=e.getContext("webgl2",n)||e.getContext("experimental-webgl2",n)),!i&&r.includes("webgl1")&&(i=e.getContext("webgl",n)||e.getContext("experimental-webgl",n)),t.abrupt("return",new Hm(i,{shaderDebug:!0,trackResources:!0}));case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),t}();Ym=_([Object(c.singleton)({token:hg}),E(0,Object(c.inject)(cm))],Ym);var zm=Object(c.Module)((function(t){t(Ym)})),Km=function(t){function e(e){var n;return(n=t.call(this)||this).options=void 0,n.name="webgl-device",n.options=e,n}om(e,t);var n=e.prototype;return n.init=function(){this.container.register(cm,{useValue:im({},this.options)}),this.container.load(zm,!0)},n.destroy=function(){this.container.remove(cm),this.container.unload(zm)},e}(cf);function qm(){qm=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(x){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return b()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(x){return{type:"throw",arg:x}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(S([])));g&&g!==e&&n.call(g,i)&&(p=g);var m=d.prototype=f.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:b}}function b(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(_.prototype),s(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new _(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function Zm(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(r,i)}function Qm(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Zm(o,r,i,a,s,"next",t)}function s(t){Zm(o,r,i,a,s,"throw",t)}a(void 0)}))}}function Jm(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,$m(t,e)}function $m(t,e){return($m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ty=c.Syringe.defineToken("");function ey(t,e){return function(n,r){e(n,r,t)}}var ny={}.toString,ry=function(t,e){return ny.call(t)==="[object "+e+"]"},iy=function(t){return ry(t,"Function")};function oy(t,e){var n;if(t)if(n=t,Array.isArray?Array.isArray(n):ry(n,"Array"))for(var r=0,i=t.length;r<i&&!1!==e(t[r],r);r++);else if(function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e}(t))for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}var ay,sy=function(t){return ry(t,"String")},uy=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return oy(t,(function(n,r){iy(t)&&"prototype"===r||e.push(n)})),e};!function(t,e){if(!iy(t))throw new TypeError("Expected a function");var n=function n(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return ay||(ay=document.createElement("canvas").getContext("2d")),ay.font=[o,a,i,n+"px",r].join(" "),ay.measureText(sy(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}([t],uy(e)).join("")}));var cy=function(){function t(t,e){this.canvasConfig=void 0,this.deviceRendererPlugin=void 0,this.$container=void 0,this.$canvas=void 0,this.dpr=void 0,this.canvasConfig=t,this.deviceRendererPlugin=e}var e=t.prototype;return e.init=function(){var t=Qm(qm().mark((function t(){var e,n,r,i,o,a;return qm().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.canvasConfig,n=e.container,r=e.canvas,i=e.devicePixelRatio,r?(this.$canvas=r,n&&r.parentElement!==n&&n.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container):n&&(this.$container=sy(n)?document.getElementById(n):n,this.$container&&(o=document.createElement("canvas"),this.$container.appendChild(o),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=o)),a=(a=i||as&&window.devicePixelRatio||1)>=1?Math.ceil(a):1,this.dpr=a;case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getDomElement=function(){return this.$canvas},e.getContext=function(){return this.deviceRendererPlugin.getDevice().gl},e.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},e.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},e.resize=function(t,e){if(this.$canvas){var n=this.getDPR();this.$canvas.width=n*t,this.$canvas.height=n*e,function(t,e,n){as&&t.style&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e)}},e.getDPR=function(){return this.dpr},e.applyCursorStyle=function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)},e.toDataURL=function(){var t=Qm(qm().mark((function t(e){return qm().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),t.abrupt("return",this.deviceRendererPlugin.toDataURL(e));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),t}();cy=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}([Object(c.singleton)({token:dc}),ey(0,Object(c.inject)(bs)),ey(1,Object(c.inject)(ty))],cy);var ly=Object(c.Module)((function(t){t(cy)})),fy=function(t){function e(e){var n;return(n=t.call(this)||this).rendererPlugin=void 0,n.name="webgl-context-register",n.rendererPlugin=e,n}Jm(e,t);var n=e.prototype;return n.init=function(){this.container.register(ty,{useValue:this.rendererPlugin}),this.container.load(ly,!0)},n.destroy=function(){this.container.unload(ly),this.container.remove(ty)},e}(cf),hy=function(t){function e(e){var n;n=t.call(this,e)||this;var r=new Pg;return n.registerPlugin(new fy(r)),n.registerPlugin(new zf),n.registerPlugin(new Km((null==e?void 0:e.targets)?{targets:e.targets}:{targets:["webgl2","webgl1"]})),n.registerPlugin(r),n.registerPlugin(new kg),n.registerPlugin(new tm),n}return Jm(e,t),e}(lf);function dy(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function py(t){return function(t){if(Array.isArray(t))return dy(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return dy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dy(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var vy,gy,my=n(29);let yy;function _y(t,e){const n=new hy({targets:["webgl1"]}),r=n.getPlugin("dom-interaction");n.unregisterPlugin(r),yy=new Sf({canvas:t,devicePixelRatio:e,renderer:n});const i=new jc({style:{cx:300,cy:200,r:50,fill:"#1890FF",stroke:"#F04864",lineWidth:4}});yy.addEventListener(Rf.READY,()=>{yy.appendChild(i),i.animate([{transform:"scale(1)",fill:"#1890FF",stroke:"#F04864",opacity:1,shadowColor:"black",shadowBlur:30},{transform:"scale(2)",fill:"red",stroke:"#1890FF",opacity:.8,shadowColor:"red",shadowBlur:0}],{duration:1500,iterations:1/0,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)"}),i.addEventListener("pointerenter",()=>{i.style.lineWidth=20}),i.addEventListener("pointerleave",()=>{i.style.lineWidth=4})})}function Ey(t,e){e.target=yy.getContextService().getDomElement(),e.preventDefault=()=>{},e.composedPath=()=>[yy.getContextService().getDomElement()],"pointermove"===t?yy.getRenderingService().hooks.pointerMove.call(e):"pointerdown"===t?yy.getRenderingService().hooks.pointerDown.call(e):"pointerleave"===t?yy.getRenderingService().hooks.pointerOut.call(e):"pointerover"===t?yy.getRenderingService().hooks.pointerOver.call(e):"pointerup"===t&&yy.getRenderingService().hooks.pointerUp.call(e)}vy={render:{fn:_y},triggerEvent:{fn:Ey}},(gy=Object(my.a)()).addEventListener("message",(function(t){var e,n=t.data,r=n.type,i=n.method,o=n.id,a=n.params;"RPC_transferable"===r&&i&&((e=vy[i])?Promise.resolve().then((function(){var t;return(t=e).fn.apply(t,py(a))})):Promise.reject("No such method")).then((function(t){gy.postMessage({type:"RPC_transferable",id:o,result:t},e.pickTransferablesFromResult?e.pickTransferablesFromResult(t):[])})).catch((function(t){var e;try{e=t.message.toString()}catch(r){e=null}var n={message:e};t.stack&&(n.stack=t.stack,n.name=t.name),t.status&&(n.status=t.status,n.responseJson=t.responseJson),gy.postMessage({type:"RPC_transferable",id:o,error:n})}))})),addEventListener("message",(function(t){var n,r=t.data,i=r.type,o=r.method,a=r.id,s=r.params;"RPC"===i&&o&&((n=e[o])?Promise.resolve().then((function(){return n.apply(e,s)})):Promise.reject("No such method")).then((function(t){postMessage({type:"RPC",id:a,result:t})})).catch((function(t){var e={message:t};t.stack&&(e.message=t.message,e.stack=t.stack,e.name=t.name),postMessage({type:"RPC",id:a,error:e})}))})),postMessage({type:"RPC",method:"ready"})}]);