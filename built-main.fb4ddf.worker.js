/*! For license information please see built-main.fb4ddf.worker.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=185)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return s})),n.d(t,"__param",(function(){return u})),n.d(t,"__metadata",(function(){return c})),n.d(t,"__awaiter",(function(){return l})),n.d(t,"__generator",(function(){return f})),n.d(t,"__createBinding",(function(){return h})),n.d(t,"__exportStar",(function(){return d})),n.d(t,"__values",(function(){return p})),n.d(t,"__read",(function(){return v})),n.d(t,"__spread",(function(){return y})),n.d(t,"__spreadArrays",(function(){return m})),n.d(t,"__spreadArray",(function(){return _})),n.d(t,"__await",(function(){return g})),n.d(t,"__asyncGenerator",(function(){return E})),n.d(t,"__asyncDelegator",(function(){return T})),n.d(t,"__asyncValues",(function(){return b})),n.d(t,"__makeTemplateObject",(function(){return S})),n.d(t,"__importStar",(function(){return A})),n.d(t,"__importDefault",(function(){return O})),n.d(t,"__classPrivateFieldGet",(function(){return C})),n.d(t,"__classPrivateFieldSet",(function(){return M}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function f(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var h=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function d(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||h(t,e,n)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function m(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function _(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function g(e){return this instanceof g?(this.v=e,this):new g(e)}function E(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof g?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(r){l(o[0][3],r)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function T(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:g(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var R=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);return R(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function C(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function M(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},function(e,t,n){"use strict";n.r(t),n.d(t,"injectable",(function(){return T})),n.d(t,"singleton",(function(){return b})),n.d(t,"transient",(function(){return S})),n.d(t,"inject",(function(){return R})),n.d(t,"named",(function(){return A})),n.d(t,"postConstruct",(function(){return o.postConstruct})),n.d(t,"optional",(function(){return o.optional})),n.d(t,"unmanaged",(function(){return o.unmanaged})),n.d(t,"decorate",(function(){return o.decorate})),n.d(t,"Container",(function(){return J})),n.d(t,"GlobalContainer",(function(){return Q})),n.d(t,"register",(function(){return $})),n.d(t,"SyringeModule",(function(){return H})),n.d(t,"isSyringeModule",(function(){return X})),n.d(t,"Module",(function(){return z})),n.d(t,"Provider",(function(){return I})),n.d(t,"DefaultContributionProvider",(function(){return G})),n.d(t,"contrib",(function(){return ee})),n.d(t,"Contribution",(function(){return K})),n.d(t,"Syringe",(function(){return r})),n.d(t,"Utils",(function(){return i})),n.d(t,"OptionSymbol",(function(){return O})),n.d(t,"registerSideOption",(function(){return C}));var r,i,o=n(22);n(63);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){return t.lifecycle===r.Lifecycle.singleton?function(e){return e.inSingletonScope()}(e):function(e){return e.inTransientScope()}(e)}function h(e,t){e.whenTargetNamed(v(t))}function d(e,t){return t.bind(y(e))}function p(e,t){if(t.isBound(y(e)))try{return t.rebind(y(e))}catch(n){return t.bind(y(e))}return t.bind(y(e))}function v(e){return i.isDefinedToken(e)?e.symbol:e}function y(e){return i.isDefinedToken(e)?e.symbol:e}!function(e){e.defineToken=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new e.DefinedToken(t,n)};var t,n=u((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,e),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var r=n.multiple,i=void 0!==r&&r;this.name=t,this.symbol=Symbol(this.name),this.multiple=i}));e.DefinedToken=n,e.isModule=function(e){return!!e&&"object"===a(e)&&"id"in e},function(e){e.singleton="singleton",e.transient="transient"}(t=e.Lifecycle||(e.Lifecycle={})),e.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),e.DefaultOption={lifecycle:t.transient}}(r||(r={})),function(e){e.toArray=function(e){return Array.isArray(e)?e:void 0===e?[]:[e]},e.isClass=function(e){return!(!e||"function"!=typeof e||!("prototype"in e))},e.isDefinedToken=function(e){return!!(e&&"object"===a(e)&&"symbol"in e&&"multiple"in e)},e.isInjectOption=function(e){return!(!e||"object"!==a(e)||!("token"in e))},e.isNamedToken=function(e){return!!(e&&"object"===a(e)&&"token"in e&&"named"in e)},e.isMultipleEnabled=function(t){return e.isDefinedToken(t)&&t.multiple}}(i||(i={}));var m=new o.Container;function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(o.injectable)();return function(n){Reflect.defineMetadata(r.ClassOptionSymbol,g(g({},e),{},{target:n}),n),t(n)}}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(g(g({},e),{},{lifecycle:r.Lifecycle.singleton}))}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return T(g(g({},e),{},{lifecycle:r.Lifecycle.transient}))}function R(e){return Object(o.inject)(y(e))}function A(e){return Object(o.named)(v(e))}var O=Symbol("SyringeOptionSymbol"),C=function(e,t){Reflect.defineMetadata(O,e,t)};function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.register=void 0,this.mutiple=void 0,this.register=t,this.token=n,this.option=r,this.rawToken=i.isNamedToken(n)?n.token:n,this.named=i.isNamedToken(n)?n.named:void 0,this.mutiple=!!this.named||i.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}var t,n,o;return t=e,o=[{key:"resolveTarget",value:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var a=Reflect.getMetadata(O,n);a&&e.resolveOption(t,a)}catch(l){}if(i.isClass(n))if(o.useClass){var s=i.toArray(o.useClass);s.unshift(n),o.useClass=s}else o.useClass=[n];var u;try{u=Reflect.getMetadata(r.ClassOptionSymbol,n)}catch(l){}if((u=x(x({},u||{}),o)).token){var c=i.toArray(u.token);c.unshift(n),u.token=c}else u.token=[n];e.resolveOption(t,u)}catch(l){}}},{key:"resolveOption",value:function(t,n){var o,a,s,u,c,l,f,h,d=(o=x(x({},e.globalConfig),n),a=i.toArray(o.token),s=i.toArray(o.useClass),u=i.toArray(o.useDynamic),c=i.toArray(o.useFactory),l=i.toArray(o.contrib),f=o.lifecycle||r.Lifecycle.transient,h={token:a,useClass:s,lifecycle:l.length>0?r.Lifecycle.singleton:f,contrib:l,useDynamic:u,useFactory:c},"useValue"in o&&(h.useValue=o.useValue),h);(0!==d.useClass.length||0!==d.useDynamic.length||0!==d.useFactory.length||"useValue"in d)&&d.token.forEach((function(n){new e(t,n,x({},d)).resolve()}))}}],(n=[{key:"resolve",value:function(){var e,t=this,n=this.register;(e=n)&&"object"===l(e)&&"bind"in e&&"unbind"in e&&"rebind"in e&&"isBound"in e&&(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(e){i.isMultipleEnabled(e)?d(e,n).toService(t.generalToken):p(e,n).toService(t.generalToken)}))))}},{key:"resolveMono",value:function(e){if("useValue"in this.option)return p(this.generalToken,e).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var t=this.option.useDynamic[this.option.useDynamic.length-1];return f(p(this.generalToken,e).toDynamicValue((function(e){var n=J.getContainer(e.container);return t({container:n})})),this.option)}if(this.option.useFactory.length>0){var n=this.option.useFactory[this.option.useFactory.length-1];return p(this.generalToken,e).toFactory((function(e){var t=J.getContainer(e.container);return n({container:t})}))}if(this.option.useClass.length>0){var r=this.option.useClass[this.option.useClass.length-1];return f(p(this.generalToken,e).to(r),this.option)}}},{key:"resolveMutilple",value:function(e){var t=this,n=this.option.useClass.map((function(n){return f(d(t.generalToken,e).to(n),t.option)})),r=this.option.useDynamic.map((function(n){return f(d(t.generalToken,e).toDynamicValue((function(e){var t=J.getContainer(e.container);return n({container:t})})),t.option)})),i=this.option.useFactory.map((function(n){return d(t.generalToken,e).toFactory((function(e){var t=J.getContainer(e.container);return n({container:t})}))})),o="useValue"in this.option?d(this.generalToken,e).toConstantValue(this.option.useValue):void 0;this.named&&(n.forEach((function(e){return t.named&&h(e,t.named)})),r.forEach((function(e){return t.named&&h(e,t.named)})),i.forEach((function(e){return t.named&&h(e,t.named)})),o&&h(o,this.named))}}])&&N(t.prototype,n),o&&N(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();F.globalConfig=r.DefaultOption;var I=r.defineToken("ContributionProvider");function D(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=n,this.serviceIdentifier=t,r&&(this.option=w(w({},this.option),r))}var t,n,r;return t=e,(n=[{key:"setServices",value:function(e){for(var t=[],n=this.container;n;){if(n.isBound(this.serviceIdentifier)){var r=n.getAll(this.serviceIdentifier);t.push.apply(t,D(r))}n=e?n.parent:void 0}return t}},{key:"getContributions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=w(w({},this.option),e),n=t.cache,r=t.recursive;return n&&void 0!==this.services||(this.services=this.setServices(!!r)),this.services}}])&&U(t.prototype,n),r&&U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function j(e,t){return{token:{token:I,named:e},useDynamic:function(n){return new G(e,n.container,t)},lifecycle:r.Lifecycle.singleton}}function V(e,t,n){e({token:{token:I,named:t},useDynamic:function(e){return new G(t,e.container,n)},lifecycle:r.Lifecycle.singleton})}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=void 0,this.inversifyModule=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,this.inversifyRegister=function(e,t,r,o){var a={bind:e,unbind:t,isBound:r,rebind:o},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.isInjectOption(e)?F.resolveOption(a,e):F.resolveTarget(a,e,t)};n.baseRegistry&&n.baseRegistry(s),n.optionCollection&&n.optionCollection.forEach((function(e){return s(e)}))},this.baseRegistry=t,this.inversifyModule=new o.ContainerModule(this.inversifyRegister),this.id=this.inversifyModule.id}var t,n,r;return t=e,(n=[{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.options.push(t)})),this}},{key:"contribution",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.options.push(j(t))})),this}}])&&W(t.prototype,n),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function X(e){return e&&"inversifyModule"in e}function z(e){return new H(e)}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K,q,Z=new Map,J=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=t||new o.Container,e.setContainer(this.container,this)}var t,n,r;return t=e,r=[{key:"setContainer",value:function(e,t){return Z.set(e.id,t)}},{key:"getContainer",value:function(t){var n=Z.get(t.id);if(!n){var r=new e(t);return e.setContainer(t,r),r}return n}},{key:"config",value:function(e){F.globalConfig=e}}],(n=[{key:"load",value:function(e,t){var n=this;return t||!this.loadedModules.includes(e.id)?(X(e)&&this.container.load(e.inversifyModule),this.loadedModules.push(e.id),{dispose:function(){n.unload(e)}}):(console.warn("Unsupported module."),{dispose:function(){}})}},{key:"unload",value:function(e){X(e)&&(this.container.unload(e.inversifyModule),this.loadedModules=this.loadedModules.filter((function(t){return t!==e.id})))}},{key:"remove",value:function(e){return this.container.unbind(y(e))}},{key:"get",value:function(e){return this.container.get(y(e))}},{key:"getNamed",value:function(e,t){return this.container.getNamed(y(e),v(t))}},{key:"getAll",value:function(e){return this.container.getAll(y(e))}},{key:"getAllNamed",value:function(e,t){return this.container.getAllNamed(y(e),v(t))}},{key:"isBound",value:function(e){return this.container.isBound(y(e))}},{key:"isBoundNamed",value:function(e,t){return this.container.isBoundNamed(y(e),v(t))}},{key:"createChild",value:function(){var t=new e(this.container.createChild());return t.parent=this,t}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.isInjectOption(e)?F.resolveOption(this.container,e):F.resolveTarget(this.container,e,t)}}])&&Y(t.prototype,n),r&&Y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Q=new J(m),$=Q.register.bind(Q),ee=function(e){return function(t,n,r){A(e)(t,n,r),R(I)(t,n,r)}};(q=K||(K={})).Provider=I,q.register=V},function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n(40))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NON_CUSTOM_TAG_KEYS=t.POST_CONSTRUCT=t.DESIGN_PARAM_TYPES=t.PARAM_TYPES=t.TAGGED_PROP=t.TAGGED=t.MULTI_INJECT_TAG=t.INJECT_TAG=t.OPTIONAL_TAG=t.UNMANAGED_TAG=t.NAME_TAG=t.NAMED_TAG=void 0,t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct",t.NON_CUSTOM_TAG_KEYS=[t.INJECT_TAG,t.MULTI_INJECT_TAG,t.NAME_TAG,t.UNMANAGED_TAG,t.NAMED_TAG,t.OPTIONAL_TAG]},function(e,t,n){"use strict";var r=n(183);n(11),n(12),n(24),n(15),n(33),Object.defineProperty(t,"__esModule",{value:!0}),n(93);var i=n(1),o=n(0),a=n(13),s=n(34),u=n(184),c=n(186);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=l(u),h=l(c);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){v(o,r,i,a,s,"next",e)}function s(e){v(o,r,i,a,s,"throw",e)}a(void 0)}))}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O(this,n)}}function M(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}function x(){return(x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=M(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function P(e,t){return I(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(e,t)||L(e,t)||w()}function N(e){return I(e)||D(e)||L(e)||w()}function F(e){return function(e){if(Array.isArray(e))return B(e)}(e)||D(e)||L(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e){if(Array.isArray(e))return e}function D(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function L(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=L(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}var U=g((function e(){m(this,e),this.pickingId=void 0,this.encodedPickingColor=void 0,this.meshes=[]}));U.tag="c-renderable-3d";var G,j,V,W,H,X,z,Y,K,q,Z,J,Q,$,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,fe,he=function(){function e(){m(this,e),this.counter=0,this.id2DisplayObjectMap={}}return g(e,[{key:"getId",value:function(e){var t=this.counter++;return this.id2DisplayObjectMap[t]=e,t}},{key:"getById",value:function(e){return this.id2DisplayObjectMap[e]}},{key:"reset",value:function(){this.counter=0,this.id2DisplayObjectMap={}}},{key:"decodePickingColor",value:function(e){var t=P(e,3);return t[0]+256*t[1]+65536*t[2]-1}},{key:"encodePickingColor",value:function(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}}]),e}();function de(e,n,r,i){return{dimension:t.TextureDimension.n2D,pixelFormat:e,width:n,height:r,depth:1,numLevels:i,usage:t.TextureUsage.Sampled}}function pe(e){return e}function ve(e,t,n){return e<<16|t<<8|n}function ye(e){return e>>>8&255}function me(e){return e>>>16&255}function _e(e){return 255&e}function ge(e){switch(e){case t.FormatTypeFlags.F32:case t.FormatTypeFlags.U32:case t.FormatTypeFlags.S32:return 4;case t.FormatTypeFlags.U16:case t.FormatTypeFlags.S16:case t.FormatTypeFlags.F16:return 2;case t.FormatTypeFlags.U8:case t.FormatTypeFlags.S8:return 1;default:throw new Error("whoops")}}function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e)throw console.error((new Error).stack),new Error("Assert fail: ".concat(t))}function Te(e){if(null!=e)return e;throw new Error("Missing object")}function be(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function Se(e,t){e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a}function Re(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}function Ae(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return{r:e,g:t,b:n,a:r}}he=o.__decorate([i.singleton()],he),(G=t.ResourceType||(t.ResourceType={}))[G.Buffer=0]="Buffer",G[G.Texture=1]="Texture",G[G.RenderTarget=2]="RenderTarget",G[G.Sampler=3]="Sampler",G[G.Program=4]="Program",G[G.Bindings=5]="Bindings",G[G.InputLayout=6]="InputLayout",G[G.InputState=7]="InputState",G[G.RenderPipeline=8]="RenderPipeline",G[G.ComputePipeline=9]="ComputePipeline",G[G.Readback=10]="Readback",G[G.QueryPool=11]="QueryPool",(j=t.CompareMode||(t.CompareMode={}))[j.Never=512]="Never",j[j.Less=513]="Less",j[j.Equal=514]="Equal",j[j.LessEqual=515]="LessEqual",j[j.Greater=516]="Greater",j[j.NotEqual=517]="NotEqual",j[j.GreaterEqual=518]="GreaterEqual",j[j.Always=519]="Always",(V=t.FrontFaceMode||(t.FrontFaceMode={}))[V.CCW=2305]="CCW",V[V.CW=2304]="CW",(W=t.CullMode||(t.CullMode={}))[W.None=0]="None",W[W.Front=1]="Front",W[W.Back=2]="Back",W[W.FrontAndBack=3]="FrontAndBack",(H=t.BlendFactor||(t.BlendFactor={}))[H.Zero=0]="Zero",H[H.One=1]="One",H[H.Src=768]="Src",H[H.OneMinusSrc=769]="OneMinusSrc",H[H.Dst=774]="Dst",H[H.OneMinusDst=775]="OneMinusDst",H[H.SrcAlpha=770]="SrcAlpha",H[H.OneMinusSrcAlpha=771]="OneMinusSrcAlpha",H[H.DstAlpha=772]="DstAlpha",H[H.OneMinusDstAlpha=773]="OneMinusDstAlpha",(X=t.BlendMode||(t.BlendMode={}))[X.Add=32774]="Add",X[X.Subtract=32778]="Subtract",X[X.ReverseSubtract=32779]="ReverseSubtract",(z=t.WrapMode||(t.WrapMode={}))[z.Clamp=0]="Clamp",z[z.Repeat=1]="Repeat",z[z.Mirror=2]="Mirror",(Y=t.TexFilterMode||(t.TexFilterMode={}))[Y.Point=0]="Point",Y[Y.Bilinear=1]="Bilinear",(K=t.MipFilterMode||(t.MipFilterMode={}))[K.NoMip=0]="NoMip",K[K.Nearest=1]="Nearest",K[K.Linear=2]="Linear",(q=t.PrimitiveTopology||(t.PrimitiveTopology={}))[q.Points=0]="Points",q[q.Triangles=1]="Triangles",q[q.TriangleStrip=2]="TriangleStrip",q[q.Lines=3]="Lines",q[q.LineStrip=4]="LineStrip",(Z=t.BufferUsage||(t.BufferUsage={}))[Z.MAP_READ=1]="MAP_READ",Z[Z.MAP_WRITE=2]="MAP_WRITE",Z[Z.COPY_SRC=4]="COPY_SRC",Z[Z.COPY_DST=8]="COPY_DST",Z[Z.INDEX=16]="INDEX",Z[Z.VERTEX=32]="VERTEX",Z[Z.UNIFORM=64]="UNIFORM",Z[Z.STORAGE=128]="STORAGE",Z[Z.INDIRECT=256]="INDIRECT",Z[Z.QUERY_RESOLVE=512]="QUERY_RESOLVE",(J=t.BufferFrequencyHint||(t.BufferFrequencyHint={}))[J.Static=1]="Static",J[J.Dynamic=2]="Dynamic",(Q=t.VertexBufferFrequency||(t.VertexBufferFrequency={}))[Q.PerVertex=1]="PerVertex",Q[Q.PerInstance=2]="PerInstance",(t.TextureEvent||(t.TextureEvent={})).LOADED="loaded",($=t.TextureDimension||(t.TextureDimension={}))[$.n2D=0]="n2D",$[$.n2DArray=1]="n2DArray",$[$.n3D=2]="n3D",$[$.Cube=3]="Cube",(ee=t.TextureUsage||(t.TextureUsage={}))[ee.Sampled=1]="Sampled",ee[ee.RenderTarget=2]="RenderTarget",(te=t.ChannelWriteMask||(t.ChannelWriteMask={}))[te.None=0]="None",te[te.Red=1]="Red",te[te.Green=2]="Green",te[te.Blue=4]="Blue",te[te.Alpha=8]="Alpha",te[te.RGB=7]="RGB",te[te.AllChannels=15]="AllChannels",(ne=t.StencilOp||(t.StencilOp={}))[ne.Keep=7680]="Keep",ne[ne.Zero=0]="Zero",ne[ne.Replace=7681]="Replace",ne[ne.Invert=5386]="Invert",ne[ne.IncrementClamp=7682]="IncrementClamp",ne[ne.DecrementClamp=7683]="DecrementClamp",ne[ne.IncrementWrap=34055]="IncrementWrap",ne[ne.DecrementWrap=34056]="DecrementWrap",(re=t.SamplerFormatKind||(t.SamplerFormatKind={}))[re.Float=0]="Float",re[re.Uint=1]="Uint",re[re.Sint=2]="Sint",re[re.Depth=3]="Depth",(ie=t.ViewportOrigin||(t.ViewportOrigin={}))[ie.LowerLeft=0]="LowerLeft",ie[ie.UpperLeft=1]="UpperLeft",(oe=t.ClipSpaceNearZ||(t.ClipSpaceNearZ={}))[oe.NegativeOne=0]="NegativeOne",oe[oe.Zero=1]="Zero",(ae=t.QueryPoolType||(t.QueryPoolType={}))[ae.OcclusionConservative=0]="OcclusionConservative",(se=t.FormatTypeFlags||(t.FormatTypeFlags={}))[se.U8=1]="U8",se[se.U16=2]="U16",se[se.U32=3]="U32",se[se.S8=4]="S8",se[se.S16=5]="S16",se[se.S32=6]="S32",se[se.F16=7]="F16",se[se.F32=8]="F32",se[se.BC1=65]="BC1",se[se.BC2=66]="BC2",se[se.BC3=67]="BC3",se[se.BC4_UNORM=68]="BC4_UNORM",se[se.BC4_SNORM=69]="BC4_SNORM",se[se.BC5_UNORM=70]="BC5_UNORM",se[se.BC5_SNORM=71]="BC5_SNORM",se[se.U16_PACKED_5551=97]="U16_PACKED_5551",se[se.D24=129]="D24",se[se.D32F=130]="D32F",se[se.D24S8=131]="D24S8",se[se.D32FS8=132]="D32FS8",(ue=t.FormatCompFlags||(t.FormatCompFlags={}))[ue.R=1]="R",ue[ue.RG=2]="RG",ue[ue.RGB=3]="RGB",ue[ue.RGBA=4]="RGBA",ue[ue.A=5]="A",(ce=t.FormatFlags||(t.FormatFlags={}))[ce.None=0]="None",ce[ce.Normalized=1]="Normalized",ce[ce.sRGB=2]="sRGB",ce[ce.Depth=4]="Depth",ce[ce.Stencil=8]="Stencil",ce[ce.RenderTarget=16]="RenderTarget",(le=t.Format||(t.Format={}))[le.ALPHA=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.A,t.FormatFlags.None)]="ALPHA",le[le.F16_R=ve(t.FormatTypeFlags.F16,t.FormatCompFlags.R,t.FormatFlags.None)]="F16_R",le[le.F16_RG=ve(t.FormatTypeFlags.F16,t.FormatCompFlags.RG,t.FormatFlags.None)]="F16_RG",le[le.F16_RGB=ve(t.FormatTypeFlags.F16,t.FormatCompFlags.RGB,t.FormatFlags.None)]="F16_RGB",le[le.F16_RGBA=ve(t.FormatTypeFlags.F16,t.FormatCompFlags.RGBA,t.FormatFlags.None)]="F16_RGBA",le[le.F32_R=ve(t.FormatTypeFlags.F32,t.FormatCompFlags.R,t.FormatFlags.None)]="F32_R",le[le.F32_RG=ve(t.FormatTypeFlags.F32,t.FormatCompFlags.RG,t.FormatFlags.None)]="F32_RG",le[le.F32_RGB=ve(t.FormatTypeFlags.F32,t.FormatCompFlags.RGB,t.FormatFlags.None)]="F32_RGB",le[le.F32_RGBA=ve(t.FormatTypeFlags.F32,t.FormatCompFlags.RGBA,t.FormatFlags.None)]="F32_RGBA",le[le.U8_R=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.R,t.FormatFlags.None)]="U8_R",le[le.U8_R_NORM=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.R,t.FormatFlags.Normalized)]="U8_R_NORM",le[le.U8_RG=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RG,t.FormatFlags.None)]="U8_RG",le[le.U8_RG_NORM=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RG,t.FormatFlags.Normalized)]="U8_RG_NORM",le[le.U8_RGB=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGB,t.FormatFlags.None)]="U8_RGB",le[le.U8_RGB_NORM=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGB,t.FormatFlags.Normalized)]="U8_RGB_NORM",le[le.U8_RGB_SRGB=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGB,t.FormatFlags.sRGB|t.FormatFlags.Normalized)]="U8_RGB_SRGB",le[le.U8_RGBA=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGBA,t.FormatFlags.None)]="U8_RGBA",le[le.U8_RGBA_NORM=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="U8_RGBA_NORM",le[le.U8_RGBA_SRGB=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGBA,t.FormatFlags.sRGB|t.FormatFlags.Normalized)]="U8_RGBA_SRGB",le[le.U16_R=ve(t.FormatTypeFlags.U16,t.FormatCompFlags.R,t.FormatFlags.None)]="U16_R",le[le.U16_R_NORM=ve(t.FormatTypeFlags.U16,t.FormatCompFlags.R,t.FormatFlags.Normalized)]="U16_R_NORM",le[le.U16_RG_NORM=ve(t.FormatTypeFlags.U16,t.FormatCompFlags.RG,t.FormatFlags.Normalized)]="U16_RG_NORM",le[le.U16_RGBA_NORM=ve(t.FormatTypeFlags.U16,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="U16_RGBA_NORM",le[le.U16_RGB=ve(t.FormatTypeFlags.U16,t.FormatCompFlags.RGB,t.FormatFlags.None)]="U16_RGB",le[le.U32_R=ve(t.FormatTypeFlags.U32,t.FormatCompFlags.R,t.FormatFlags.None)]="U32_R",le[le.U32_RG=ve(t.FormatTypeFlags.U32,t.FormatCompFlags.RG,t.FormatFlags.None)]="U32_RG",le[le.S8_R=ve(t.FormatTypeFlags.S8,t.FormatCompFlags.R,t.FormatFlags.None)]="S8_R",le[le.S8_R_NORM=ve(t.FormatTypeFlags.S8,t.FormatCompFlags.R,t.FormatFlags.Normalized)]="S8_R_NORM",le[le.S8_RG_NORM=ve(t.FormatTypeFlags.S8,t.FormatCompFlags.RG,t.FormatFlags.Normalized)]="S8_RG_NORM",le[le.S8_RGB_NORM=ve(t.FormatTypeFlags.S8,t.FormatCompFlags.RGB,t.FormatFlags.Normalized)]="S8_RGB_NORM",le[le.S8_RGBA_NORM=ve(t.FormatTypeFlags.S8,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="S8_RGBA_NORM",le[le.S16_R=ve(t.FormatTypeFlags.S16,t.FormatCompFlags.R,t.FormatFlags.None)]="S16_R",le[le.S16_RG=ve(t.FormatTypeFlags.S16,t.FormatCompFlags.RG,t.FormatFlags.None)]="S16_RG",le[le.S16_RG_NORM=ve(t.FormatTypeFlags.S16,t.FormatCompFlags.RG,t.FormatFlags.Normalized)]="S16_RG_NORM",le[le.S16_RGB_NORM=ve(t.FormatTypeFlags.S16,t.FormatCompFlags.RGB,t.FormatFlags.Normalized)]="S16_RGB_NORM",le[le.S16_RGBA=ve(t.FormatTypeFlags.S16,t.FormatCompFlags.RGBA,t.FormatFlags.None)]="S16_RGBA",le[le.S16_RGBA_NORM=ve(t.FormatTypeFlags.S16,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="S16_RGBA_NORM",le[le.S32_R=ve(t.FormatTypeFlags.S32,t.FormatCompFlags.R,t.FormatFlags.None)]="S32_R",le[le.U16_RGBA_5551=ve(t.FormatTypeFlags.U16_PACKED_5551,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="U16_RGBA_5551",le[le.BC1=ve(t.FormatTypeFlags.BC1,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="BC1",le[le.BC1_SRGB=ve(t.FormatTypeFlags.BC1,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized|t.FormatFlags.sRGB)]="BC1_SRGB",le[le.BC2=ve(t.FormatTypeFlags.BC2,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="BC2",le[le.BC2_SRGB=ve(t.FormatTypeFlags.BC2,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized|t.FormatFlags.sRGB)]="BC2_SRGB",le[le.BC3=ve(t.FormatTypeFlags.BC3,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized)]="BC3",le[le.BC3_SRGB=ve(t.FormatTypeFlags.BC3,t.FormatCompFlags.RGBA,t.FormatFlags.Normalized|t.FormatFlags.sRGB)]="BC3_SRGB",le[le.BC4_UNORM=ve(t.FormatTypeFlags.BC4_UNORM,t.FormatCompFlags.R,t.FormatFlags.Normalized)]="BC4_UNORM",le[le.BC4_SNORM=ve(t.FormatTypeFlags.BC4_SNORM,t.FormatCompFlags.R,t.FormatFlags.Normalized)]="BC4_SNORM",le[le.BC5_UNORM=ve(t.FormatTypeFlags.BC5_UNORM,t.FormatCompFlags.RG,t.FormatFlags.Normalized)]="BC5_UNORM",le[le.BC5_SNORM=ve(t.FormatTypeFlags.BC5_SNORM,t.FormatCompFlags.RG,t.FormatFlags.Normalized)]="BC5_SNORM",le[le.D24=ve(t.FormatTypeFlags.D24,t.FormatCompFlags.R,t.FormatFlags.Depth)]="D24",le[le.D24_S8=ve(t.FormatTypeFlags.D24S8,t.FormatCompFlags.RG,t.FormatFlags.Depth|t.FormatFlags.Stencil)]="D24_S8",le[le.D32F=ve(t.FormatTypeFlags.D32F,t.FormatCompFlags.R,t.FormatFlags.Depth)]="D32F",le[le.D32F_S8=ve(t.FormatTypeFlags.D32FS8,t.FormatCompFlags.RG,t.FormatFlags.Depth|t.FormatFlags.Stencil)]="D32F_S8",le[le.U8_RGB_RT=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGB,t.FormatFlags.RenderTarget|t.FormatFlags.Normalized)]="U8_RGB_RT",le[le.U8_RGBA_RT=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGBA,t.FormatFlags.RenderTarget|t.FormatFlags.Normalized)]="U8_RGBA_RT",le[le.U8_RGBA_RT_SRGB=ve(t.FormatTypeFlags.U8,t.FormatCompFlags.RGBA,t.FormatFlags.RenderTarget|t.FormatFlags.Normalized|t.FormatFlags.sRGB)]="U8_RGBA_RT_SRGB",(fe=t.GL||(t.GL={}))[fe.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",fe[fe.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",fe[fe.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",fe[fe.POINTS=0]="POINTS",fe[fe.LINES=1]="LINES",fe[fe.LINE_LOOP=2]="LINE_LOOP",fe[fe.LINE_STRIP=3]="LINE_STRIP",fe[fe.TRIANGLES=4]="TRIANGLES",fe[fe.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",fe[fe.TRIANGLE_FAN=6]="TRIANGLE_FAN",fe[fe.ZERO=0]="ZERO",fe[fe.ONE=1]="ONE",fe[fe.SRC_COLOR=768]="SRC_COLOR",fe[fe.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",fe[fe.SRC_ALPHA=770]="SRC_ALPHA",fe[fe.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",fe[fe.DST_ALPHA=772]="DST_ALPHA",fe[fe.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",fe[fe.DST_COLOR=774]="DST_COLOR",fe[fe.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",fe[fe.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",fe[fe.CONSTANT_COLOR=32769]="CONSTANT_COLOR",fe[fe.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",fe[fe.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",fe[fe.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",fe[fe.FUNC_ADD=32774]="FUNC_ADD",fe[fe.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",fe[fe.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",fe[fe.BLEND_EQUATION=32777]="BLEND_EQUATION",fe[fe.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",fe[fe.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",fe[fe.BLEND_DST_RGB=32968]="BLEND_DST_RGB",fe[fe.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",fe[fe.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",fe[fe.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",fe[fe.BLEND_COLOR=32773]="BLEND_COLOR",fe[fe.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",fe[fe.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",fe[fe.LINE_WIDTH=2849]="LINE_WIDTH",fe[fe.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",fe[fe.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",fe[fe.CULL_FACE_MODE=2885]="CULL_FACE_MODE",fe[fe.FRONT_FACE=2886]="FRONT_FACE",fe[fe.DEPTH_RANGE=2928]="DEPTH_RANGE",fe[fe.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",fe[fe.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",fe[fe.DEPTH_FUNC=2932]="DEPTH_FUNC",fe[fe.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",fe[fe.STENCIL_FUNC=2962]="STENCIL_FUNC",fe[fe.STENCIL_FAIL=2964]="STENCIL_FAIL",fe[fe.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",fe[fe.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",fe[fe.STENCIL_REF=2967]="STENCIL_REF",fe[fe.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",fe[fe.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",fe[fe.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",fe[fe.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",fe[fe.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",fe[fe.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",fe[fe.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",fe[fe.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",fe[fe.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",fe[fe.VIEWPORT=2978]="VIEWPORT",fe[fe.SCISSOR_BOX=3088]="SCISSOR_BOX",fe[fe.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",fe[fe.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",fe[fe.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",fe[fe.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",fe[fe.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",fe[fe.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",fe[fe.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",fe[fe.RED_BITS=3410]="RED_BITS",fe[fe.GREEN_BITS=3411]="GREEN_BITS",fe[fe.BLUE_BITS=3412]="BLUE_BITS",fe[fe.ALPHA_BITS=3413]="ALPHA_BITS",fe[fe.DEPTH_BITS=3414]="DEPTH_BITS",fe[fe.STENCIL_BITS=3415]="STENCIL_BITS",fe[fe.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",fe[fe.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",fe[fe.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",fe[fe.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",fe[fe.SAMPLES=32937]="SAMPLES",fe[fe.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",fe[fe.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",fe[fe.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",fe[fe.VENDOR=7936]="VENDOR",fe[fe.RENDERER=7937]="RENDERER",fe[fe.VERSION=7938]="VERSION",fe[fe.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",fe[fe.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",fe[fe.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",fe[fe.STATIC_DRAW=35044]="STATIC_DRAW",fe[fe.STREAM_DRAW=35040]="STREAM_DRAW",fe[fe.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",fe[fe.ARRAY_BUFFER=34962]="ARRAY_BUFFER",fe[fe.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",fe[fe.BUFFER_SIZE=34660]="BUFFER_SIZE",fe[fe.BUFFER_USAGE=34661]="BUFFER_USAGE",fe[fe.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",fe[fe.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",fe[fe.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",fe[fe.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",fe[fe.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",fe[fe.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",fe[fe.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",fe[fe.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",fe[fe.CULL_FACE=2884]="CULL_FACE",fe[fe.FRONT=1028]="FRONT",fe[fe.BACK=1029]="BACK",fe[fe.FRONT_AND_BACK=1032]="FRONT_AND_BACK",fe[fe.BLEND=3042]="BLEND",fe[fe.DEPTH_TEST=2929]="DEPTH_TEST",fe[fe.DITHER=3024]="DITHER",fe[fe.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",fe[fe.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",fe[fe.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",fe[fe.SCISSOR_TEST=3089]="SCISSOR_TEST",fe[fe.STENCIL_TEST=2960]="STENCIL_TEST",fe[fe.NO_ERROR=0]="NO_ERROR",fe[fe.INVALID_ENUM=1280]="INVALID_ENUM",fe[fe.INVALID_VALUE=1281]="INVALID_VALUE",fe[fe.INVALID_OPERATION=1282]="INVALID_OPERATION",fe[fe.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",fe[fe.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",fe[fe.CW=2304]="CW",fe[fe.CCW=2305]="CCW",fe[fe.DONT_CARE=4352]="DONT_CARE",fe[fe.FASTEST=4353]="FASTEST",fe[fe.NICEST=4354]="NICEST",fe[fe.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",fe[fe.BYTE=5120]="BYTE",fe[fe.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",fe[fe.SHORT=5122]="SHORT",fe[fe.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",fe[fe.INT=5124]="INT",fe[fe.UNSIGNED_INT=5125]="UNSIGNED_INT",fe[fe.FLOAT=5126]="FLOAT",fe[fe.DOUBLE=5130]="DOUBLE",fe[fe.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",fe[fe.ALPHA=6406]="ALPHA",fe[fe.RGB=6407]="RGB",fe[fe.RGBA=6408]="RGBA",fe[fe.LUMINANCE=6409]="LUMINANCE",fe[fe.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",fe[fe.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",fe[fe.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",fe[fe.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",fe[fe.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",fe[fe.VERTEX_SHADER=35633]="VERTEX_SHADER",fe[fe.COMPILE_STATUS=35713]="COMPILE_STATUS",fe[fe.DELETE_STATUS=35712]="DELETE_STATUS",fe[fe.LINK_STATUS=35714]="LINK_STATUS",fe[fe.VALIDATE_STATUS=35715]="VALIDATE_STATUS",fe[fe.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",fe[fe.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",fe[fe.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",fe[fe.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",fe[fe.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",fe[fe.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",fe[fe.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",fe[fe.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",fe[fe.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",fe[fe.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",fe[fe.SHADER_TYPE=35663]="SHADER_TYPE",fe[fe.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",fe[fe.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",fe[fe.NEVER=512]="NEVER",fe[fe.ALWAYS=519]="ALWAYS",fe[fe.LESS=513]="LESS",fe[fe.EQUAL=514]="EQUAL",fe[fe.LEQUAL=515]="LEQUAL",fe[fe.GREATER=516]="GREATER",fe[fe.GEQUAL=518]="GEQUAL",fe[fe.NOTEQUAL=517]="NOTEQUAL",fe[fe.KEEP=7680]="KEEP",fe[fe.REPLACE=7681]="REPLACE",fe[fe.INCR=7682]="INCR",fe[fe.DECR=7683]="DECR",fe[fe.INVERT=5386]="INVERT",fe[fe.INCR_WRAP=34055]="INCR_WRAP",fe[fe.DECR_WRAP=34056]="DECR_WRAP",fe[fe.NEAREST=9728]="NEAREST",fe[fe.LINEAR=9729]="LINEAR",fe[fe.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",fe[fe.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",fe[fe.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",fe[fe.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",fe[fe.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",fe[fe.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",fe[fe.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",fe[fe.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",fe[fe.TEXTURE_2D=3553]="TEXTURE_2D",fe[fe.TEXTURE=5890]="TEXTURE",fe[fe.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",fe[fe.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",fe[fe.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",fe[fe.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",fe[fe.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",fe[fe.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",fe[fe.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",fe[fe.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",fe[fe.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",fe[fe.TEXTURE0=33984]="TEXTURE0",fe[fe.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",fe[fe.REPEAT=10497]="REPEAT",fe[fe.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",fe[fe.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",fe[fe.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",fe[fe.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",fe[fe.FLOAT_VEC2=35664]="FLOAT_VEC2",fe[fe.FLOAT_VEC3=35665]="FLOAT_VEC3",fe[fe.FLOAT_VEC4=35666]="FLOAT_VEC4",fe[fe.INT_VEC2=35667]="INT_VEC2",fe[fe.INT_VEC3=35668]="INT_VEC3",fe[fe.INT_VEC4=35669]="INT_VEC4",fe[fe.BOOL=35670]="BOOL",fe[fe.BOOL_VEC2=35671]="BOOL_VEC2",fe[fe.BOOL_VEC3=35672]="BOOL_VEC3",fe[fe.BOOL_VEC4=35673]="BOOL_VEC4",fe[fe.FLOAT_MAT2=35674]="FLOAT_MAT2",fe[fe.FLOAT_MAT3=35675]="FLOAT_MAT3",fe[fe.FLOAT_MAT4=35676]="FLOAT_MAT4",fe[fe.SAMPLER_2D=35678]="SAMPLER_2D",fe[fe.SAMPLER_CUBE=35680]="SAMPLER_CUBE",fe[fe.LOW_FLOAT=36336]="LOW_FLOAT",fe[fe.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",fe[fe.HIGH_FLOAT=36338]="HIGH_FLOAT",fe[fe.LOW_INT=36339]="LOW_INT",fe[fe.MEDIUM_INT=36340]="MEDIUM_INT",fe[fe.HIGH_INT=36341]="HIGH_INT",fe[fe.FRAMEBUFFER=36160]="FRAMEBUFFER",fe[fe.RENDERBUFFER=36161]="RENDERBUFFER",fe[fe.RGBA4=32854]="RGBA4",fe[fe.RGB5_A1=32855]="RGB5_A1",fe[fe.RGB565=36194]="RGB565",fe[fe.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",fe[fe.STENCIL_INDEX=6401]="STENCIL_INDEX",fe[fe.STENCIL_INDEX8=36168]="STENCIL_INDEX8",fe[fe.DEPTH_STENCIL=34041]="DEPTH_STENCIL",fe[fe.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",fe[fe.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",fe[fe.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",fe[fe.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",fe[fe.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",fe[fe.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",fe[fe.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",fe[fe.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",fe[fe.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",fe[fe.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",fe[fe.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",fe[fe.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",fe[fe.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",fe[fe.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",fe[fe.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",fe[fe.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",fe[fe.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",fe[fe.NONE=0]="NONE",fe[fe.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",fe[fe.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",fe[fe.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",fe[fe.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",fe[fe.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",fe[fe.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",fe[fe.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",fe[fe.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",fe[fe.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",fe[fe.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",fe[fe.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",fe[fe.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",fe[fe.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",fe[fe.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",fe[fe.READ_BUFFER=3074]="READ_BUFFER",fe[fe.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",fe[fe.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",fe[fe.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",fe[fe.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",fe[fe.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",fe[fe.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",fe[fe.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",fe[fe.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",fe[fe.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",fe[fe.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",fe[fe.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",fe[fe.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",fe[fe.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",fe[fe.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",fe[fe.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",fe[fe.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",fe[fe.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",fe[fe.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",fe[fe.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",fe[fe.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",fe[fe.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",fe[fe.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",fe[fe.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",fe[fe.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",fe[fe.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",fe[fe.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",fe[fe.RED=6403]="RED",fe[fe.RGB8=32849]="RGB8",fe[fe.RGBA8=32856]="RGBA8",fe[fe.RGB10_A2=32857]="RGB10_A2",fe[fe.TEXTURE_3D=32879]="TEXTURE_3D",fe[fe.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",fe[fe.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",fe[fe.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",fe[fe.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",fe[fe.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",fe[fe.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",fe[fe.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",fe[fe.SRGB=35904]="SRGB",fe[fe.SRGB8=35905]="SRGB8",fe[fe.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",fe[fe.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",fe[fe.RGBA32F=34836]="RGBA32F",fe[fe.RGB32F=34837]="RGB32F",fe[fe.RGBA16F=34842]="RGBA16F",fe[fe.RGB16F=34843]="RGB16F",fe[fe.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",fe[fe.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",fe[fe.R11F_G11F_B10F=35898]="R11F_G11F_B10F",fe[fe.RGB9_E5=35901]="RGB9_E5",fe[fe.RGBA32UI=36208]="RGBA32UI",fe[fe.RGB32UI=36209]="RGB32UI",fe[fe.RGBA16UI=36214]="RGBA16UI",fe[fe.RGB16UI=36215]="RGB16UI",fe[fe.RGBA8UI=36220]="RGBA8UI",fe[fe.RGB8UI=36221]="RGB8UI",fe[fe.RGBA32I=36226]="RGBA32I",fe[fe.RGB32I=36227]="RGB32I",fe[fe.RGBA16I=36232]="RGBA16I",fe[fe.RGB16I=36233]="RGB16I",fe[fe.RGBA8I=36238]="RGBA8I",fe[fe.RGB8I=36239]="RGB8I",fe[fe.RED_INTEGER=36244]="RED_INTEGER",fe[fe.RGB_INTEGER=36248]="RGB_INTEGER",fe[fe.RGBA_INTEGER=36249]="RGBA_INTEGER",fe[fe.R8=33321]="R8",fe[fe.RG8=33323]="RG8",fe[fe.R16F=33325]="R16F",fe[fe.R32F=33326]="R32F",fe[fe.RG16F=33327]="RG16F",fe[fe.RG32F=33328]="RG32F",fe[fe.R8I=33329]="R8I",fe[fe.R8UI=33330]="R8UI",fe[fe.R16I=33331]="R16I",fe[fe.R16UI=33332]="R16UI",fe[fe.R32I=33333]="R32I",fe[fe.R32UI=33334]="R32UI",fe[fe.RG8I=33335]="RG8I",fe[fe.RG8UI=33336]="RG8UI",fe[fe.RG16I=33337]="RG16I",fe[fe.RG16UI=33338]="RG16UI",fe[fe.RG32I=33339]="RG32I",fe[fe.RG32UI=33340]="RG32UI",fe[fe.R8_SNORM=36756]="R8_SNORM",fe[fe.RG8_SNORM=36757]="RG8_SNORM",fe[fe.RGB8_SNORM=36758]="RGB8_SNORM",fe[fe.RGBA8_SNORM=36759]="RGBA8_SNORM",fe[fe.RGB10_A2UI=36975]="RGB10_A2UI",fe[fe.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",fe[fe.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",fe[fe.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",fe[fe.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",fe[fe.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",fe[fe.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",fe[fe.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",fe[fe.HALF_FLOAT=5131]="HALF_FLOAT",fe[fe.RG=33319]="RG",fe[fe.RG_INTEGER=33320]="RG_INTEGER",fe[fe.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",fe[fe.CURRENT_QUERY=34917]="CURRENT_QUERY",fe[fe.QUERY_RESULT=34918]="QUERY_RESULT",fe[fe.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",fe[fe.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",fe[fe.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",fe[fe.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",fe[fe.DRAW_BUFFER0=34853]="DRAW_BUFFER0",fe[fe.DRAW_BUFFER1=34854]="DRAW_BUFFER1",fe[fe.DRAW_BUFFER2=34855]="DRAW_BUFFER2",fe[fe.DRAW_BUFFER3=34856]="DRAW_BUFFER3",fe[fe.DRAW_BUFFER4=34857]="DRAW_BUFFER4",fe[fe.DRAW_BUFFER5=34858]="DRAW_BUFFER5",fe[fe.DRAW_BUFFER6=34859]="DRAW_BUFFER6",fe[fe.DRAW_BUFFER7=34860]="DRAW_BUFFER7",fe[fe.DRAW_BUFFER8=34861]="DRAW_BUFFER8",fe[fe.DRAW_BUFFER9=34862]="DRAW_BUFFER9",fe[fe.DRAW_BUFFER10=34863]="DRAW_BUFFER10",fe[fe.DRAW_BUFFER11=34864]="DRAW_BUFFER11",fe[fe.DRAW_BUFFER12=34865]="DRAW_BUFFER12",fe[fe.DRAW_BUFFER13=34866]="DRAW_BUFFER13",fe[fe.DRAW_BUFFER14=34867]="DRAW_BUFFER14",fe[fe.DRAW_BUFFER15=34868]="DRAW_BUFFER15",fe[fe.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",fe[fe.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",fe[fe.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",fe[fe.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",fe[fe.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",fe[fe.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",fe[fe.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",fe[fe.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",fe[fe.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",fe[fe.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",fe[fe.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",fe[fe.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",fe[fe.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",fe[fe.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",fe[fe.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",fe[fe.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",fe[fe.SAMPLER_3D=35679]="SAMPLER_3D",fe[fe.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",fe[fe.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",fe[fe.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",fe[fe.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",fe[fe.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",fe[fe.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",fe[fe.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",fe[fe.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",fe[fe.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",fe[fe.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",fe[fe.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",fe[fe.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",fe[fe.MAX_SAMPLES=36183]="MAX_SAMPLES",fe[fe.SAMPLER_BINDING=35097]="SAMPLER_BINDING",fe[fe.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",fe[fe.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",fe[fe.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",fe[fe.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",fe[fe.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",fe[fe.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",fe[fe.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",fe[fe.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",fe[fe.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",fe[fe.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",fe[fe.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",fe[fe.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",fe[fe.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",fe[fe.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",fe[fe.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",fe[fe.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",fe[fe.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",fe[fe.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",fe[fe.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",fe[fe.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",fe[fe.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",fe[fe.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",fe[fe.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",fe[fe.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",fe[fe.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",fe[fe.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",fe[fe.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",fe[fe.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",fe[fe.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",fe[fe.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",fe[fe.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",fe[fe.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",fe[fe.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",fe[fe.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",fe[fe.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",fe[fe.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",fe[fe.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",fe[fe.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",fe[fe.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",fe[fe.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",fe[fe.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",fe[fe.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",fe[fe.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",fe[fe.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",fe[fe.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",fe[fe.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",fe[fe.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",fe[fe.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",fe[fe.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",fe[fe.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",fe[fe.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",fe[fe.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",fe[fe.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",fe[fe.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",fe[fe.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",fe[fe.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",fe[fe.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",fe[fe.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",fe[fe.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",fe[fe.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",fe[fe.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",fe[fe.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",fe[fe.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",fe[fe.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",fe[fe.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",fe[fe.UNIFORM_TYPE=35383]="UNIFORM_TYPE",fe[fe.UNIFORM_SIZE=35384]="UNIFORM_SIZE",fe[fe.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",fe[fe.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",fe[fe.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",fe[fe.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",fe[fe.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",fe[fe.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",fe[fe.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",fe[fe.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",fe[fe.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",fe[fe.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",fe[fe.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",fe[fe.OBJECT_TYPE=37138]="OBJECT_TYPE",fe[fe.SYNC_CONDITION=37139]="SYNC_CONDITION",fe[fe.SYNC_STATUS=37140]="SYNC_STATUS",fe[fe.SYNC_FLAGS=37141]="SYNC_FLAGS",fe[fe.SYNC_FENCE=37142]="SYNC_FENCE",fe[fe.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",fe[fe.UNSIGNALED=37144]="UNSIGNALED",fe[fe.SIGNALED=37145]="SIGNALED",fe[fe.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",fe[fe.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",fe[fe.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",fe[fe.WAIT_FAILED=37149]="WAIT_FAILED",fe[fe.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",fe[fe.COLOR=6144]="COLOR",fe[fe.DEPTH=6145]="DEPTH",fe[fe.STENCIL=6146]="STENCIL",fe[fe.MIN=32775]="MIN",fe[fe.MAX=32776]="MAX",fe[fe.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",fe[fe.STREAM_READ=35041]="STREAM_READ",fe[fe.STREAM_COPY=35042]="STREAM_COPY",fe[fe.STATIC_READ=35045]="STATIC_READ",fe[fe.STATIC_COPY=35046]="STATIC_COPY",fe[fe.DYNAMIC_READ=35049]="DYNAMIC_READ",fe[fe.DYNAMIC_COPY=35050]="DYNAMIC_COPY",fe[fe.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",fe[fe.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",fe[fe.INVALID_INDEX=4294967295]="INVALID_INDEX",fe[fe.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",fe[fe.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",fe[fe.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",fe[fe.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",fe[fe.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",fe[fe.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",fe[fe.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",fe[fe.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",fe[fe.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",fe[fe.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",fe[fe.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",fe[fe.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",fe[fe.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",fe[fe.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",fe[fe.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",fe[fe.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",fe[fe.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",fe[fe.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",fe[fe.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",fe[fe.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",fe[fe.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",fe[fe.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",fe[fe.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",fe[fe.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",fe[fe.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",fe[fe.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",fe[fe.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",fe[fe.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",fe[fe.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",fe[fe.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",fe[fe.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",fe[fe.RGBA32F_EXT=34836]="RGBA32F_EXT",fe[fe.RGB32F_EXT=34837]="RGB32F_EXT",fe[fe.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",fe[fe.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",fe[fe.MIN_EXT=32775]="MIN_EXT",fe[fe.MAX_EXT=32776]="MAX_EXT",fe[fe.SRGB_EXT=35904]="SRGB_EXT",fe[fe.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",fe[fe.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",fe[fe.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",fe[fe.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",fe[fe.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",fe[fe.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",fe[fe.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",fe[fe.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",fe[fe.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",fe[fe.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",fe[fe.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",fe[fe.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",fe[fe.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",fe[fe.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",fe[fe.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",fe[fe.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",fe[fe.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",fe[fe.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",fe[fe.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",fe[fe.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",fe[fe.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",fe[fe.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",fe[fe.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",fe[fe.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",fe[fe.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",fe[fe.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",fe[fe.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",fe[fe.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",fe[fe.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",fe[fe.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",fe[fe.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",fe[fe.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",fe[fe.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",fe[fe.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",fe[fe.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",fe[fe.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",fe[fe.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",fe[fe.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",fe[fe.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",fe[fe.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",fe[fe.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",fe[fe.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",fe[fe.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",fe[fe.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",fe[fe.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",fe[fe.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT";var Oe=Ae(0,0,0,0),Ce=Ae(0,0,0,1),Me=Ae(1,1,1,0),xe=Ae(1,1,1,1);function Pe(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n)return e;switch(e){case t.CompareMode.Less:return t.CompareMode.Greater;case t.CompareMode.LessEqual:return t.CompareMode.GreaterEqual;case t.CompareMode.GreaterEqual:return t.CompareMode.LessEqual;case t.CompareMode.Greater:return t.CompareMode.Less;default:return e}}function Ne(e,t){return null!=e?e:t}function Fe(e){return void 0===e?null:e}function Ie(e,t,n){e.length=t,e.fill(n)}function De(e,t){var n=t-1;return e+n&~n}function Le(e,t){return((e+t-1)/t|0)*t}function Be(e,t,n){for(var r=0,i=e.length;r<i;){var o=r+(i-r>>>1);n(t,e[o])<0?i=o:r=o+1}return r}function we(e,t,n){var r=Be(e,t,n);e.splice(r,0,t)}function ke(e,t,n){return n?e|=t:e&=~t,e}function Ue(e,t){for(var n=new Array(e),r=0;r<e;r++)n[r]=t();return n}function Ge(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";e.length<t;)e="".concat(n).concat(e);return e}function je(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function Ve(e,t){return void 0===e&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),je(e.rgbBlendState,t.rgbBlendState),je(e.alphaBlendState,t.alphaBlendState),e.channelWriteMask=t.channelWriteMask,e}function We(e,t){e.length!==t.length&&(e.length=t.length);for(var n=0;n<t.length;n++)e[n]=Ve(e[n],t[n])}function He(e,t){void 0!==t.attachmentsState&&We(e.attachmentsState,t.attachmentsState),void 0!==t.blendConstant&&Se(e.blendConstant,t.blendConstant),e.depthCompare=Ne(t.depthCompare,e.depthCompare),e.depthWrite=Ne(t.depthWrite,e.depthWrite),e.stencilCompare=Ne(t.stencilCompare,e.stencilCompare),e.stencilWrite=Ne(t.stencilWrite,e.stencilWrite),e.stencilPassOp=Ne(t.stencilPassOp,e.stencilPassOp),e.stencilRef=Ne(t.stencilRef,e.stencilRef),e.cullMode=Ne(t.cullMode,e.cullMode),e.frontFace=Ne(t.frontFace,e.frontFace),e.polygonOffset=Ne(t.polygonOffset,e.polygonOffset)}function Xe(e){var t=Object.assign({},e);return t.attachmentsState=[],We(t.attachmentsState,e.attachmentsState),t.blendConstant=Re(t.blendConstant),t}function ze(e,t){void 0!==t.channelWriteMask&&(e.channelWriteMask=t.channelWriteMask),void 0!==t.rgbBlendMode&&(e.rgbBlendState.blendMode=t.rgbBlendMode),void 0!==t.alphaBlendMode&&(e.alphaBlendState.blendMode=t.alphaBlendMode),void 0!==t.rgbBlendSrcFactor&&(e.rgbBlendState.blendSrcFactor=t.rgbBlendSrcFactor),void 0!==t.alphaBlendSrcFactor&&(e.alphaBlendState.blendSrcFactor=t.alphaBlendSrcFactor),void 0!==t.rgbBlendDstFactor&&(e.rgbBlendState.blendDstFactor=t.rgbBlendDstFactor),void 0!==t.alphaBlendDstFactor&&(e.alphaBlendState.blendDstFactor=t.alphaBlendDstFactor)}var Ye={blendMode:t.BlendMode.Add,blendSrcFactor:t.BlendFactor.One,blendDstFactor:t.BlendFactor.Zero},Ke={attachmentsState:[{channelWriteMask:t.ChannelWriteMask.RGB,rgbBlendState:Ye,alphaBlendState:Ye}],blendConstant:Re(Oe),depthWrite:!0,depthCompare:t.CompareMode.LessEqual,stencilCompare:t.CompareMode.Always,stencilWrite:!1,stencilPassOp:t.StencilOp.Keep,stencilRef:0,cullMode:t.CullMode.None,frontFace:t.FrontFaceMode.CCW,polygonOffset:!1};function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ke,n=Xe(t);return null!==e&&He(n,e),n}var Ze=qe({depthCompare:t.CompareMode.Always,depthWrite:!1},Ke);function Je(e,t){return void 0===e.attachmentsState&&(e.attachmentsState=[],We(e.attachmentsState,Ke.attachmentsState)),ze(e.attachmentsState[0],t),e}var Qe,$e={formatKind:t.SamplerFormatKind.Float,dimension:t.TextureDimension.n2D};function et(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function tt(e,t){for(var n=Array(e.length),r=0;r<e.length;r++)n[r]=t(e[r]);return n}function nt(e,t){return e.buffer===t.buffer&&e.wordCount===t.wordCount}function rt(e,t){return null===e?null===t:null!==t&&(e.sampler===t.sampler&&e.texture===t.texture)}function it(e,t){return e.samplerBindings.length===t.samplerBindings.length&&(!!et(e.samplerBindings,t.samplerBindings,rt)&&(!!et(e.uniformBufferBindings,t.uniformBufferBindings,nt)&&!!st(e.bindingLayout,t.bindingLayout)))}function ot(e,t){return e.blendMode==t.blendMode&&e.blendSrcFactor===t.blendSrcFactor&&e.blendDstFactor===t.blendDstFactor}function at(e,t){return!!ot(e.rgbBlendState,t.rgbBlendState)&&(!!ot(e.alphaBlendState,t.alphaBlendState)&&e.channelWriteMask===t.channelWriteMask)}function st(e,t){return e.numSamplers===t.numSamplers&&e.numUniformBuffers===t.numUniformBuffers}function ut(e,t){return e===t}function ct(e,t){return e.topology===t.topology&&(e.inputLayout===t.inputLayout&&(e.sampleCount===t.sampleCount&&(!!function(e,t){return!!et(e.attachmentsState,t.attachmentsState,at)&&(!!be(e.blendConstant,t.blendConstant)&&(e.depthCompare===t.depthCompare&&e.depthWrite===t.depthWrite&&e.stencilCompare===t.stencilCompare&&e.stencilWrite===t.stencilWrite&&e.stencilPassOp===t.stencilPassOp&&e.stencilRef===t.stencilRef&&e.cullMode===t.cullMode&&e.frontFace===t.frontFace&&e.polygonOffset===t.polygonOffset))}(e.megaStateDescriptor,t.megaStateDescriptor)&&(!!function(e,t){return e.id===t.id}(e.program,t.program)&&(!!et(e.bindingLayouts,t.bindingLayouts,st)&&(!!et(e.colorAttachmentFormats,t.colorAttachmentFormats,ut)&&e.depthStencilAttachmentFormat===t.depthStencilAttachmentFormat))))))}function lt(e,t){return e.bufferIndex===t.bufferIndex&&e.bufferByteOffset===t.bufferByteOffset&&e.location===t.location&&e.format===t.format}function ft(e,t){return a.isNil(e)?a.isNil(t):!a.isNil(t)&&(e.byteStride===t.byteStride&&e.frequency===t.frequency)}function ht(e,t){return e.indexBufferFormat===t.indexBufferFormat&&(!!et(e.vertexBufferDescriptors,t.vertexBufferDescriptors,ft)&&!!et(e.vertexAttributeDescriptors,t.vertexAttributeDescriptors,lt))}function dt(e,t){return e.wrapS===t.wrapS&&e.wrapT===t.wrapT&&e.minFilter===t.minFilter&&e.magFilter===t.magFilter&&e.mipFilter===t.mipFilter&&e.minLOD===t.minLOD&&e.maxLOD===t.maxLOD&&e.maxAnisotropy===t.maxAnisotropy&&e.compareMode===t.compareMode}function pt(e){return{sampler:e.sampler,texture:e.texture,lateBinding:e.lateBinding}}function vt(e){return{buffer:e.buffer,wordCount:e.wordCount}}function yt(e){return{bindingLayout:e.bindingLayout,samplerBindings:tt(e.samplerBindings,pt),uniformBufferBindings:tt(e.uniformBufferBindings,vt),pipeline:e.pipeline}}function mt(e){return{dimension:e.dimension,formatKind:e.formatKind}}function _t(e){return{numSamplers:e.numSamplers,numUniformBuffers:e.numUniformBuffers,samplerEntries:void 0!==e.samplerEntries?tt(e.samplerEntries,mt):void 0}}function gt(e){var t=tt(e.bindingLayouts,_t),n=e.inputLayout,r=e.program,i=e.topology;return{bindingLayouts:t,inputLayout:n,megaStateDescriptor:Xe(e.megaStateDescriptor),program:r,topology:i,colorAttachmentFormats:e.colorAttachmentFormats.slice(),depthStencilAttachmentFormat:e.depthStencilAttachmentFormat,sampleCount:e.sampleCount}}function Et(e){return{location:e.location,format:e.format,bufferIndex:e.bufferIndex,bufferByteOffset:e.bufferByteOffset,byteStride:e.byteStride,divisor:e.divisor}}function Tt(e){return a.isNil(e)?e:{byteStride:e.byteStride,frequency:e.frequency}}function bt(e){return{vertexAttributeDescriptors:tt(e.vertexAttributeDescriptors,Et),vertexBufferDescriptors:tt(e.vertexBufferDescriptors,Tt),indexBufferFormat:e.indexBufferFormat}}(Qe=t.Endianness||(t.Endianness={}))[Qe.LITTLE_ENDIAN=0]="LITTLE_ENDIAN",Qe[Qe.BIG_ENDIAN=1]="BIG_ENDIAN";var St,Rt=new Uint16Array([65279]),At=255==new DataView(Rt.buffer).getUint8(0)?t.Endianness.LITTLE_ENDIAN:t.Endianness.BIG_ENDIAN;var Ot=/([^[]*)(\[[0-9]+\])?/;function Ct(){var e=null;return function(t,n,r){var i=e!==r;return i&&(t.uniform1i(n,r),e=r),i}}function Mt(e,t,n,r){var i=null,o=null;return function(a,s,u){var c=t(u,n),l=c.length,f=!1;if(null===i)i=new Float32Array(l),o=l,f=!0;else{Ee(o===l,"Uniform length cannot change.");for(var h=0;h<l;++h)if(c[h]!==i[h]){f=!0;break}}return f&&(r(a,e,s,c),i.set(c)),f}}function xt(e,t,n,r){e[t](n,r)}function Pt(e,t,n,r){e[t](n,!1,r)}var Nt={},Ft={},It={},Dt=[0];function Lt(e,t,n,r){1===t&&"boolean"==typeof e&&(e=e?1:0),Number.isFinite(e)&&(Dt[0]=e,e=Dt);var i=e.length;if(e instanceof n)return e;var o=r[i];o||(o=new n(i),r[i]=o);for(var a=0;a<i;a++)o[a]=e[a];return o}function Bt(e,t){return Lt(e,t,Float32Array,Nt)}function wt(e,t){return Lt(e,t,Int32Array,Ft)}function kt(e,t){return Lt(e,t,Uint32Array,It)}var Ut=(E(St={},t.GL.FLOAT,Mt.bind(null,"uniform1fv",Bt,1,xt)),E(St,t.GL.FLOAT_VEC2,Mt.bind(null,"uniform2fv",Bt,2,xt)),E(St,t.GL.FLOAT_VEC3,Mt.bind(null,"uniform3fv",Bt,3,xt)),E(St,t.GL.FLOAT_VEC4,Mt.bind(null,"uniform4fv",Bt,4,xt)),E(St,t.GL.INT,Mt.bind(null,"uniform1iv",wt,1,xt)),E(St,t.GL.INT_VEC2,Mt.bind(null,"uniform2iv",wt,2,xt)),E(St,t.GL.INT_VEC3,Mt.bind(null,"uniform3iv",wt,3,xt)),E(St,t.GL.INT_VEC4,Mt.bind(null,"uniform4iv",wt,4,xt)),E(St,t.GL.BOOL,Mt.bind(null,"uniform1iv",wt,1,xt)),E(St,t.GL.BOOL_VEC2,Mt.bind(null,"uniform2iv",wt,2,xt)),E(St,t.GL.BOOL_VEC3,Mt.bind(null,"uniform3iv",wt,3,xt)),E(St,t.GL.BOOL_VEC4,Mt.bind(null,"uniform4iv",wt,4,xt)),E(St,t.GL.FLOAT_MAT2,Mt.bind(null,"uniformMatrix2fv",Bt,4,Pt)),E(St,t.GL.FLOAT_MAT3,Mt.bind(null,"uniformMatrix3fv",Bt,9,Pt)),E(St,t.GL.FLOAT_MAT4,Mt.bind(null,"uniformMatrix4fv",Bt,16,Pt)),E(St,t.GL.SAMPLER_2D,Ct),E(St,t.GL.SAMPLER_CUBE,Ct),E(St,t.GL.UNSIGNED_INT,Mt.bind(null,"uniform1uiv",kt,1,xt)),E(St,t.GL.UNSIGNED_INT_VEC2,Mt.bind(null,"uniform2uiv",kt,2,xt)),E(St,t.GL.UNSIGNED_INT_VEC3,Mt.bind(null,"uniform3uiv",kt,3,xt)),E(St,t.GL.UNSIGNED_INT_VEC4,Mt.bind(null,"uniform4uiv",kt,4,xt)),E(St,t.GL.FLOAT_MAT2x3,Mt.bind(null,"uniformMatrix2x3fv",Bt,6,Pt)),E(St,t.GL.FLOAT_MAT2x4,Mt.bind(null,"uniformMatrix2x4fv",Bt,8,Pt)),E(St,t.GL.FLOAT_MAT3x2,Mt.bind(null,"uniformMatrix3x2fv",Bt,6,Pt)),E(St,t.GL.FLOAT_MAT3x4,Mt.bind(null,"uniformMatrix3x4fv",Bt,12,Pt)),E(St,t.GL.FLOAT_MAT4x2,Mt.bind(null,"uniformMatrix4x2fv",Bt,8,Pt)),E(St,t.GL.FLOAT_MAT4x3,Mt.bind(null,"uniformMatrix4x3fv",Bt,12,Pt)),E(St,t.GL.SAMPLER_2D,Ct),E(St,t.GL.SAMPLER_CUBE,Ct),E(St,t.GL.SAMPLER_3D,Ct),E(St,t.GL.SAMPLER_2D_SHADOW,Ct),E(St,t.GL.SAMPLER_2D_ARRAY,Ct),E(St,t.GL.SAMPLER_2D_ARRAY_SHADOW,Ct),E(St,t.GL.SAMPLER_CUBE_SHADOW,Ct),E(St,t.GL.INT_SAMPLER_2D,Ct),E(St,t.GL.INT_SAMPLER_3D,Ct),E(St,t.GL.INT_SAMPLER_CUBE,Ct),E(St,t.GL.INT_SAMPLER_2D_ARRAY,Ct),E(St,t.GL.UNSIGNED_INT_SAMPLER_2D,Ct),E(St,t.GL.UNSIGNED_INT_SAMPLER_3D,Ct),E(St,t.GL.UNSIGNED_INT_SAMPLER_CUBE,Ct),E(St,t.GL.UNSIGNED_INT_SAMPLER_2D_ARRAY,Ct),St);var Gt=[[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]];function jt(e,t){return"#define ".concat(e," ").concat(t)}function Vt(e){var t=[],n=[];return e.replace(/\s*struct\s*(.*)\s*{((?:\s*.*\s*)*?)};/g,(function(e,t,r){var i=[];return r.trim().split("\n").forEach((function(e){var t=P(e.trim().split(/\s+/),2),n=t[0],r=t[1];i.push({type:n.trim(),name:r.replace(";","").trim()})})),n.push({type:t.trim(),uniforms:i}),""})),e.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,(function(e,r){return r.trim().split("\n").forEach((function(e){var r=e.trim().split(" "),i=r[0]||"",o=r[1]||"",a=o.indexOf("[")>-1;if(o=o.replace(";","").replace("[","").trim(),!i.startsWith("#")){if(i){var s=n.find((function(e){return i===e.type}));if(s)if(a)for(var u=function(e){s.uniforms.forEach((function(n){t.push("".concat(o,"[").concat(e,"].").concat(n.name))}))},c=0;c<5;c++)u(c);else s.uniforms.forEach((function(e){t.push("".concat(o,".").concat(e.name))}))}o&&t.push(o)}})),""})),t}function Wt(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o="#version 100"===e.glslVersion,a=!1,s=r.split("\n").map((function(e){return e.replace(/[/][/].*$/,"")})).filter((function(e){return!(!e||/^\s+$/.test(e))})),u="";null!==i&&(u=F(i.entries()).map((function(e){var t=P(e,2);return jt(t[0],t[1])})).join("\n"));var c=s.find((function(e){return e.startsWith("precision")}))||"precision mediump float;",l=s.filter((function(e){return!e.startsWith("precision")})).join("\n"),f="";if(e.viewportOrigin===t.ViewportOrigin.UpperLeft&&(f+="".concat(jt("VIEWPORT_ORIGIN_TL","1"),"\n")),e.clipSpaceNearZ===t.ClipSpaceNearZ.Zero&&(f+="".concat(jt("CLIPSPACE_NEAR_ZERO","1"),"\n")),e.explicitBindingLocations){var h=0,d=0,p=0;l=l.replace(/^(layout\((.*)\))?\s*uniform(.+{)$/gm,(function(e,t,n,r){var i=n?"".concat(n,", "):"";return"layout(".concat(i,"set = ").concat(h,", binding = ").concat(d++,") uniform ").concat(r)})),h++,d=0,Ee(e.separateSamplerTextures),l=(l=l.replace(/uniform sampler2D (.*);/g,(function(e,t){return"frag"===n?"\nlayout(set = ".concat(h,", binding = ").concat(d++,") uniform texture2D T_").concat(t,";\nlayout(set = ").concat(h,", binding = ").concat(d++,") uniform sampler S_").concat(t,";\n"):""}))).replace("frag"===n?/^\b(varying|in)\b/gm:/^\b(varying|out)\b/gm,(function(e,t){return"layout(location = ".concat(p++,") ").concat(t)})),f+="".concat(jt("gl_VertexID","gl_VertexIndex"),"\n")}l=e.separateSamplerTextures?(l=(l=(l=l.replace(/\bPD_SAMPLER_2D\((.*?)\)/g,(function(e,t){return"texture2D T_P_".concat(t,", sampler S_P_").concat(t)}))).replace(/\bPU_SAMPLER_2D\((.*?)\)/g,(function(e,t){return"SAMPLER_2D(P_".concat(t,")")}))).replace(/\bPP_SAMPLER_2D\((.*?)\)/g,(function(e,t){return"T_".concat(t,", S_").concat(t)}))).replace(/\bSAMPLER_2D\((.*?)\)/g,(function(e,t){return"sampler2D(T_".concat(t,", S_").concat(t,")")})):(l=(l=(l=l.replace(/\bPD_SAMPLER_2D\((.*?)\)/g,(function(e,t){return"sampler2D P_".concat(t)}))).replace(/\bPU_SAMPLER_2D\((.*?)\)/g,(function(e,t){return"SAMPLER_2D(P_".concat(t,")")}))).replace(/\bPP_SAMPLER_2D\((.*?)\)/g,(function(e,t){return t}))).replace(/\bSAMPLER_2D\((.*?)\)/g,(function(e,t){return t}));var v="".concat(o?"":e.glslVersion,"\n").concat(o&&a?"#extension GL_EXT_draw_buffers : require":"","\n").concat(o&&"frag"===n?"#extension GL_OES_standard_derivatives : enable":"","\n").concat(c,"\n").concat(f,"\n").concat(u,"\n").concat(l,"\n").trim();if(e.explicitBindingLocations&&"frag"===n&&(v=v.replace(/^\b(out)\b/gm,(function(e,t){return"layout(location = 0) ".concat(t)}))),o){if("frag"===n&&(v=v.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,(function(e,t,n){return"varying ".concat(t," ").concat(n,";\n")}))),"vert"===n&&(v=(v=v.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(function(e,t,n){return"varying ".concat(t," ").concat(n,";\n")}))).replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,(function(e,t,n){return"attribute ".concat(t," ").concat(n,";\n")}))),v=v.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,(function(e,t){return t.trim().replace(/^.*$/gm,(function(e){var t=e.trim();return t.startsWith("#")?t:e?"uniform ".concat(t):""}))})),"frag"===n){var y,m=(v=v.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,(function(e,t,n){return y=n,"".concat(t," ").concat(n,";\n")}))).lastIndexOf("}");v=v.substring(0,m)+"\n  gl_FragColor = vec4(".concat(y,");\n")+v.substring(m)}v=v.replace(/^\s*layout\((.*)\)/gm,"");var _,g=k(Gt);try{for(g.s();!(_=g.n()).done;){var E=P(_.value,2),T=E[0],b=E[1];v=v.replace(T,b)}}catch(S){g.e(S)}finally{g.f()}}return v}function Ht(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=Wt(e,"vert",t,r,i),a=Wt(e,"frag",n,r,i);return{vert:t,frag:n,preprocessedVert:o,preprocessedFrag:a}}function Xt(e,t){var n=void 0!==t.defines?t.defines:null,r=void 0!==t.features?t.features:null,i=void 0!==t.both?t.both+t.vert:t.vert,o=void 0!==t.both?t.both+t.frag:t.frag;return Ht(e.queryVendorInfo(),i,o,n,r)}var zt=function(){function e(){m(this,e),this.name="(unnamed)",this.preprocessedVert="",this.preprocessedFrag="",this.both="",this.vert="",this.frag="",this.defines=new Map,this.features={MRT:!0}}return g(e,[{key:"definesChanged",value:function(){this.preprocessedVert="",this.preprocessedFrag=""}},{key:"setDefineString",value:function(e,t){if(null!==t){if(this.defines.get(e)===t)return!1;this.defines.set(e,t)}else{if(!this.defines.has(e))return!1;this.defines.delete(e)}return this.definesChanged(),!0}},{key:"setDefineBool",value:function(e,t){return this.setDefineString(e,t?"1":null)}},{key:"getDefineString",value:function(e){return Fe(this.defines.get(e))}},{key:"getDefineBool",value:function(e){var t=this.getDefineString(e);return null!==t&&Ee("1"===t),null!==t}},{key:"ensurePreprocessed",value:function(e){""===this.preprocessedVert&&(this.preprocessedVert=Wt(e,"vert",this.both+this.vert,this.defines,this.features),this.preprocessedFrag=Wt(e,"frag",this.both+this.frag,this.defines,this.features))}}]),e}(),Yt=function(){function e(t){m(this,e),this.device=void 0,this.uniformBufferWordAlignment=void 0,this.uniformBufferMaxPageWordSize=void 0,this.currentBufferWordSize=-1,this.currentWordOffset=0,this.buffer=null,this.shadowBufferF32=null,this.shadowBufferU8=null,this.device=t;var n=t.queryLimits();this.uniformBufferWordAlignment=n.uniformBufferWordAlignment,this.uniformBufferMaxPageWordSize=n.uniformBufferMaxPageWordSize}return g(e,[{key:"isSupportedUBO",value:function(){return"WebGL1"!==this.device.queryVendorInfo().platformString}},{key:"findPageIndex",value:function(e){return e/this.uniformBufferMaxPageWordSize|0}},{key:"allocateChunk",value:function(e){Ee((e=Le(e,this.uniformBufferWordAlignment))<this.uniformBufferMaxPageWordSize);var t=this.currentWordOffset;return this.findPageIndex(t)!==this.findPageIndex(t+e-1)&&(t=Le(t,this.uniformBufferMaxPageWordSize)),this.currentWordOffset=t+e,this.ensureShadowBuffer(t,e),t}},{key:"ensureShadowBuffer",value:function(e,t){if(null===this.shadowBufferU8||null===this.shadowBufferF32){var n=Le(this.currentWordOffset,this.uniformBufferMaxPageWordSize);this.shadowBufferU8=new Uint8Array(4*n),this.shadowBufferF32=new Float32Array(this.shadowBufferU8.buffer)}else if(e+t>=this.shadowBufferF32.length){Ee(e<this.currentWordOffset&&e+t<=this.currentWordOffset);var r=Le(Math.max(this.currentWordOffset,2*this.shadowBufferF32.length),this.uniformBufferMaxPageWordSize),i=new Uint8Array(4*r);if(i.set(this.shadowBufferU8,0),this.shadowBufferU8=i,this.shadowBufferF32=new Float32Array(this.shadowBufferU8.buffer),!(this.currentWordOffset<=r))throw new Error("Assert fail: this.currentWordOffset [".concat(this.currentWordOffset,"] <= newWordCount [").concat(r,"]"))}}},{key:"mapBufferF32",value:function(){return Te(this.shadowBufferF32)}},{key:"prepareToRender",value:function(){if(null!==this.shadowBufferF32){var e=Te(this.shadowBufferF32);e.length!==this.currentBufferWordSize&&(this.currentBufferWordSize=e.length,null!==this.buffer&&this.buffer.destroy(),this.buffer=this.device.createBuffer({viewOrSize:this.currentBufferWordSize,usage:t.BufferUsage.UNIFORM|t.BufferUsage.COPY_DST,hint:t.BufferFrequencyHint.Dynamic}));var n=Le(this.currentWordOffset,this.uniformBufferMaxPageWordSize);if(!(n<=this.currentBufferWordSize))throw new Error("Assert fail: wordCount [".concat(n,"] (").concat(this.currentWordOffset," aligned ").concat(this.uniformBufferMaxPageWordSize,") <= this.currentBufferWordSize [").concat(this.currentBufferWordSize,"]"));if(this.isSupportedUBO())Te(this.buffer).setSubData(0,this.shadowBufferU8,0,4*n);this.currentWordOffset=0}}},{key:"destroy",value:function(){null!==this.buffer&&this.buffer.destroy(),this.shadowBufferF32=null,this.shadowBufferU8=null}}]),e}();function Kt(e,t){return e+=t,e+=e<<10,(e+=e>>>6)>>>0}function qt(e){return e+=e<<3,e^=e>>>11,(e+=e<<15)>>>0}function Zt(e){return 0}var Jt=g((function e(){m(this,e),this.keys=[],this.values=[]})),Qt=function(){function e(t,n){m(this,e),this.keyEqualFunc=void 0,this.keyHashFunc=void 0,this.buckets=new Map,this.keyEqualFunc=t,this.keyHashFunc=n}return g(e,[{key:"findBucketIndex",value:function(e,t){for(var n=0;n<e.keys.length;n++)if(this.keyEqualFunc(t,e.keys[n]))return n;return-1}},{key:"findBucket",value:function(e){var t=this.keyHashFunc(e);return this.buckets.get(t)}},{key:"get",value:function(e){var t=this.findBucket(e);if(void 0===t)return null;var n=this.findBucketIndex(t,e);return n<0?null:t.values[n]}},{key:"add",value:function(e,t){var n=this.keyHashFunc(e);void 0===this.buckets.get(n)&&this.buckets.set(n,new Jt);var r=this.buckets.get(n);r.keys.push(e),r.values.push(t)}},{key:"delete",value:function(e){var t=this.findBucket(e);if(void 0!==t){var n=this.findBucketIndex(t,e);-1!==n&&(t.keys.splice(n,1),t.values.splice(n,1))}}},{key:"clear",value:function(){this.buckets.clear()}},{key:"size",value:function(){var e,t=0,n=k(this.buckets.values());try{for(n.s();!(e=n.n()).done;){t+=e.value.values.length}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"values",value:r.mark((function e(){var t,n,i,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k(this.buckets.values()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=14;break}i=n.value,o=i.values.length-1;case 6:if(!(o>=0)){e.next=12;break}return e.next=9,i.values[o];case 9:o--,e.next=6;break;case 12:e.next=3;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),t.e(e.t0);case 19:return e.prev=19,t.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[1,16,19,22]])}))}]),e}();function $t(e,t){return Ee(""!==e.preprocessedVert&&""!==t.preprocessedVert),Ee(""!==e.preprocessedFrag&&""!==t.preprocessedFrag),e.preprocessedVert===t.preprocessedVert&&e.preprocessedFrag===t.preprocessedFrag}function en(e,t){return e=Kt(e,t.numUniformBuffers),e=Kt(e,t.numSamplers)}function tn(e,t){return e=Kt(e,t.blendMode),e=Kt(e,t.blendSrcFactor),e=Kt(e,t.blendDstFactor)}function nn(e,t){return e=tn(e,t.rgbBlendState),e=Kt(e=tn(e,t.alphaBlendState),t.channelWriteMask)}function rn(e,t){for(var n=0;n<t.attachmentsState.length;n++)e=nn(e,t.attachmentsState[n]);return e=function(e,t){return e=Kt(e,t.r<<24|t.g<<16|t.b<<8|t.a)}(e,t.blendConstant),e=Kt(e,t.depthCompare),e=Kt(e,t.depthWrite?1:0),e=Kt(e,t.stencilCompare),e=Kt(e,t.stencilPassOp),e=Kt(e,t.stencilWrite?1:0),e=Kt(e,t.cullMode),e=Kt(e,t.frontFace?1:0),e=Kt(e,t.polygonOffset?1:0)}function on(e){var t=0;t=Kt(t,e.program.id),null!==e.inputLayout&&(t=Kt(t,e.inputLayout.id));for(var n=0;n<e.bindingLayouts.length;n++)t=en(t,e.bindingLayouts[n]);t=rn(t,e.megaStateDescriptor);for(var r=0;r<e.colorAttachmentFormats.length;r++)t=Kt(t,e.colorAttachmentFormats[r]||0);return qt(t=Kt(t,e.depthStencilAttachmentFormat||0))}function an(e){for(var t=0,n=0;n<e.samplerBindings.length;n++){var r=e.samplerBindings[n];null!==r&&null!==r.texture&&(t=Kt(t,r.texture.id))}for(var i=0;i<e.uniformBufferBindings.length;i++){var o=e.uniformBufferBindings[i];null!==o&&null!==o.buffer&&(t=Kt(t,o.buffer.id),t=Kt(t,o.wordCount))}return qt(t)}var sn,un=function(){function e(t){m(this,e),this.device=void 0,this.bindingsCache=new Qt(it,an),this.renderPipelinesCache=new Qt(ct,on),this.inputLayoutsCache=new Qt(ht,Zt),this.programCache=new Qt($t,Zt),this.samplerCache=new Qt(dt,Zt),this.device=t}return g(e,[{key:"createBindings",value:function(e){var t=this.bindingsCache.get(e);if(null===t){var n=yt(e);t=this.device.createBindings(n),this.bindingsCache.add(n,t)}return t}},{key:"createRenderPipeline",value:function(e){var t=this.renderPipelinesCache.get(e);if(null===t){var n=gt(e);t=this.device.createRenderPipeline(n),this.renderPipelinesCache.add(n,t)}return t}},{key:"createInputLayout",value:function(e){var t=this.inputLayoutsCache.get(e);if(null===t){var n=bt(e);t=this.device.createInputLayout(n),this.inputLayoutsCache.add(n,t)}return t}},{key:"createProgramSimple",value:function(e){var t,n=this.programCache.get(e);if(null===n){var r={preprocessedVert:(t=e).preprocessedVert,preprocessedFrag:t.preprocessedFrag,vert:t.vert,frag:t.frag};n=this.device.createProgramSimple(r),this.programCache.add(r,n)}return n}},{key:"createProgram",value:function(e){return e.ensurePreprocessed(this.device.queryVendorInfo()),this.createProgramSimple(e)}},{key:"createSampler",value:function(e){var t=this.samplerCache.get(e);return null===t&&(t=this.device.createSampler(e),this.samplerCache.add(e,t)),t}},{key:"destroy",value:function(){var e,t=k(this.bindingsCache.values());try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(l){t.e(l)}finally{t.f()}var n,r=k(this.renderPipelinesCache.values());try{for(r.s();!(n=r.n()).done;){n.value.destroy()}}catch(l){r.e(l)}finally{r.f()}var i,o=k(this.inputLayoutsCache.values());try{for(o.s();!(i=o.n()).done;){i.value.destroy()}}catch(l){o.e(l)}finally{o.f()}var a,s=k(this.programCache.values());try{for(s.s();!(a=s.n()).done;){a.value.destroy()}}catch(l){s.e(l)}finally{s.f()}var u,c=k(this.samplerCache.values());try{for(c.s();!(u=c.n()).done;){u.value.destroy()}}catch(l){c.e(l)}finally{c.f()}this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear(),this.samplerCache.clear()}}]),e}();(sn=t.RGAttachmentSlot||(t.RGAttachmentSlot={}))[sn.Color0=0]="Color0",sn[sn.Color1=1]="Color1",sn[sn.Color2=2]="Color2",sn[sn.Color3=3]="Color3",sn[sn.ColorMax=3]="ColorMax",sn[sn.DepthStencil=4]="DepthStencil";var cn,ln={x:0,y:0,w:1,h:1},fn=function(){function e(){m(this,e),this.renderTargetIDs=[],this.resolveTextureOutputIDs=[],this.resolveTextureOutputExternalTextures=[],this.resolveTextureInputIDs=[],this.renderTargetExtraRefs=[],this.viewport=ln,this.resolveTextureInputTextures=[],this.renderTargets=[],this.descriptor={colorAttachment:[],colorResolveTo:[],colorStore:[],depthStencilAttachment:null,depthStencilResolveTo:null,depthStencilStore:!0,colorClearColor:["load"],depthClearValue:"load",stencilClearValue:"load",occlusionQueryPool:null},this.viewportX=0,this.viewportY=0,this.viewportW=0,this.viewportH=0,this.execFunc=null,this.postFunc=null,this.debugName=void 0,this.debugThumbnails=[]}return g(e,[{key:"setDebugName",value:function(e){this.debugName=e}},{key:"pushDebugThumbnail",value:function(e){this.debugThumbnails[e]=!0}},{key:"setViewport",value:function(e){this.viewport=e}},{key:"attachRenderTargetID",value:function(e,t){Ee(void 0===this.renderTargetIDs[e]),this.renderTargetIDs[e]=t}},{key:"attachResolveTexture",value:function(e){this.resolveTextureInputIDs.push(e)}},{key:"attachOcclusionQueryPool",value:function(e){this.descriptor.occlusionQueryPool=e}},{key:"resolveToExternalTexture",value:function(e,t){this.resolveTextureOutputExternalTextures[e]=t}},{key:"exec",value:function(e){Ee(null===this.execFunc),this.execFunc=e}},{key:"post",value:function(e){Ee(null===this.postFunc),this.postFunc=e}},{key:"addExtraRef",value:function(e){this.renderTargetExtraRefs[e]=!0}}]),e}(),hn=function(){function e(n,r){m(this,e),this.debugName=void 0,this.dimension=t.TextureDimension.n2D,this.depth=1,this.numLevels=1,this.pixelFormat=void 0,this.width=0,this.height=0,this.sampleCount=0,this.usage=t.TextureUsage.RenderTarget,this.immutable=!0,this.needsClear=!0,this.texture=null,this.attachment=void 0,this.age=0,this.pixelFormat=r.pixelFormat,this.width=r.width,this.height=r.height,this.sampleCount=r.sampleCount,Ee(this.sampleCount>=1),this.sampleCount>1?this.attachment=n.createRenderTarget(this):(this.texture=n.createTexture(this),this.attachment=n.createRenderTargetFromTexture(this.texture))}return g(e,[{key:"setDebugName",value:function(e,t){this.debugName=t,null!==this.texture&&e.setResourceName(this.texture,this.debugName),e.setResourceName(this.attachment,this.debugName)}},{key:"matchesDescription",value:function(e){return this.pixelFormat===e.pixelFormat&&this.width===e.width&&this.height===e.height&&this.sampleCount===e.sampleCount}},{key:"reset",value:function(e){Ee(this.matchesDescription(e)),this.age=0}},{key:"destroy",value:function(){null!==this.texture&&this.texture.destroy(),this.attachment.destroy()}}]),e}(),dn=function(){function e(n,r){m(this,e),this.dimension=t.TextureDimension.n2D,this.depth=1,this.numLevels=1,this.usage=t.TextureUsage.RenderTarget,this.pixelFormat=void 0,this.width=0,this.height=0,this.texture=void 0,this.age=0,this.immutable=!0,this.pixelFormat=r.pixelFormat,this.width=r.width,this.height=r.height,this.texture=n.createTexture(this)}return g(e,[{key:"matchesDescription",value:function(e){return this.pixelFormat===e.pixelFormat&&this.width===e.width&&this.height===e.height}},{key:"reset",value:function(e){Ee(this.matchesDescription(e)),this.age=0}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}();cn=Symbol.species;var pn,vn=g((function e(){m(this,e),this[cn]=void 0,this.renderTargetDescriptions=[],this.resolveTextureRenderTargetIDs=[],this.passes=[],this.renderTargetDebugNames=[]})),yn=function(){function e(t){m(this,e),this.device=void 0,this.currentPass=null,this.renderTargetDeadPool=[],this.singleSampledTextureDeadPool=[],this.currentGraph=null,this.renderTargetOutputCount=[],this.renderTargetResolveCount=[],this.resolveTextureUseCount=[],this.renderTargetAliveForID=[],this.singleSampledTextureForResolveTextureID=[],this.device=t}return g(e,[{key:"acquireRenderTargetForDescription",value:function(e){for(var t=0;t<this.renderTargetDeadPool.length;t++){var n=this.renderTargetDeadPool[t];if(n.matchesDescription(e))return n.reset(e),this.renderTargetDeadPool.splice(t--,1),n}return new hn(this.device,e)}},{key:"acquireSingleSampledTextureForDescription",value:function(e){for(var t=0;t<this.singleSampledTextureDeadPool.length;t++){var n=this.singleSampledTextureDeadPool[t];if(n.matchesDescription(e))return n.reset(e),this.singleSampledTextureDeadPool.splice(t--,1),n}return new dn(this.device,e)}},{key:"beginGraphBuilder",value:function(){Ee(null===this.currentGraph),this.currentGraph=new vn}},{key:"pushPass",value:function(e){var t=new fn;e(t),this.currentGraph.passes.push(t)}},{key:"createRenderTargetID",value:function(e,t){return this.currentGraph.renderTargetDebugNames.push(t),this.currentGraph.renderTargetDescriptions.push(e)-1}},{key:"createResolveTextureID",value:function(e){return this.currentGraph.resolveTextureRenderTargetIDs.push(e)-1}},{key:"findMostRecentPassThatAttachedRenderTarget",value:function(e){for(var t=this.currentGraph.passes.length-1;t>=0;t--){var n=this.currentGraph.passes[t];if(n.renderTargetIDs.includes(e))return n}return null}},{key:"resolveRenderTargetPassAttachmentSlot",value:function(e,t){var n=e;if(void 0===n.resolveTextureOutputIDs[t]){var r=n.renderTargetIDs[t],i=this.createResolveTextureID(r);n.resolveTextureOutputIDs[t]=i}return n.resolveTextureOutputIDs[t]}},{key:"findPassForResolveRenderTarget",value:function(e){var t=Te(this.findMostRecentPassThatAttachedRenderTarget(e)),n=t.renderTargetIDs.indexOf(e);return Ee(void 0===t.resolveTextureOutputExternalTextures[n]),t}},{key:"resolveRenderTarget",value:function(e){var t=this.findPassForResolveRenderTarget(e),n=t.renderTargetIDs.indexOf(e);return this.resolveRenderTargetPassAttachmentSlot(t,n)}},{key:"resolveRenderTargetToExternalTexture",value:function(e,t){var n=this.findPassForResolveRenderTarget(e),r=n.renderTargetIDs.indexOf(e);Ee(void 0===n.resolveTextureOutputIDs[r]),n.resolveTextureOutputExternalTextures[r]=t}},{key:"getRenderTargetDescription",value:function(e){return Te(this.currentGraph.renderTargetDescriptions[e])}},{key:"scheduleAddUseCount",value:function(e,t){for(var n=0;n<t.renderTargetIDs.length;n++){var r=t.renderTargetIDs[n];void 0!==r&&(this.renderTargetOutputCount[r]++,t.renderTargetExtraRefs[n]&&this.renderTargetOutputCount[r]++)}for(var i=0;i<t.resolveTextureInputIDs.length;i++){var o=t.resolveTextureInputIDs[i];if(void 0!==o){this.resolveTextureUseCount[o]++;var a=e.resolveTextureRenderTargetIDs[o];this.renderTargetResolveCount[a]++}}}},{key:"acquireRenderTargetForID",value:function(e,t){if(void 0===t)return null;if(Ee(this.renderTargetOutputCount[t]>0),!this.renderTargetAliveForID[t]){var n=e.renderTargetDescriptions[t],r=this.acquireRenderTargetForDescription(n);r.setDebugName(this.device,e.renderTargetDebugNames[t]),this.renderTargetAliveForID[t]=r}return this.renderTargetAliveForID[t]}},{key:"releaseRenderTargetForID",value:function(e,t){if(void 0===e)return null;var n=Te(this.renderTargetAliveForID[e]);return t?(Ee(this.renderTargetOutputCount[e]>0),this.renderTargetOutputCount[e]--):(Ee(this.renderTargetResolveCount[e]>0),this.renderTargetResolveCount[e]--),0===this.renderTargetOutputCount[e]&&0===this.renderTargetResolveCount[e]&&(n.needsClear=!0,delete this.renderTargetAliveForID[e],this.renderTargetDeadPool.push(n)),n}},{key:"acquireResolveTextureInputTextureForID",value:function(e,t){var n=e.resolveTextureRenderTargetIDs[t];Ee(this.resolveTextureUseCount[t]>0),this.resolveTextureUseCount[t]--;var r=Te(this.releaseRenderTargetForID(n,!1));if(void 0!==this.singleSampledTextureForResolveTextureID[t]){var i=this.singleSampledTextureForResolveTextureID[t];return 0===this.resolveTextureUseCount[t]&&this.singleSampledTextureDeadPool.push(i),i.texture}return Te(r.texture)}},{key:"determineResolveParam",value:function(e,t,n){var r=t.renderTargetIDs[n],i=t.resolveTextureOutputIDs[n],o=t.resolveTextureOutputExternalTextures[n],a=void 0!==i,s=void 0!==o;Ee(!(a&&s));var u=null,c=!1;if(this.renderTargetOutputCount[r]>1&&(c=!0),a){Ee(e.resolveTextureRenderTargetIDs[i]===r),Ee(this.resolveTextureUseCount[i]>0),Ee(this.renderTargetOutputCount[r]>0);var l=Te(this.renderTargetAliveForID[r]);if(null!==l.texture&&1===this.renderTargetOutputCount[r])u=null,c=!0;else{if(!this.singleSampledTextureForResolveTextureID[i]){var f=Te(e.renderTargetDescriptions[r]);this.singleSampledTextureForResolveTextureID[i]=this.acquireSingleSampledTextureForDescription(f),this.device.setResourceName(this.singleSampledTextureForResolveTextureID[i].texture,l.debugName+" (Resolve ".concat(i,")"))}u=this.singleSampledTextureForResolveTextureID[i].texture}}else u=s?o:null;return{resolveTo:u,store:c}}},{key:"schedulePass",value:function(e,n){for(var r=n.renderTargetIDs[t.RGAttachmentSlot.DepthStencil],i=t.RGAttachmentSlot.Color0;i<=t.RGAttachmentSlot.ColorMax;i++){var o=n.renderTargetIDs[i],a=this.acquireRenderTargetForID(e,o);n.renderTargets[i]=a,n.descriptor.colorAttachment[i]=null!==a?a.attachment:null;var s=this.determineResolveParam(e,n,i),u=s.resolveTo,c=s.store;n.descriptor.colorResolveTo[i]=u,n.descriptor.colorStore[i]=c,n.descriptor.colorClearColor[i]=null!==a&&a.needsClear?e.renderTargetDescriptions[o].colorClearColor:"load"}var l=this.acquireRenderTargetForID(e,r);n.renderTargets[t.RGAttachmentSlot.DepthStencil]=l,n.descriptor.depthStencilAttachment=null!==l?l.attachment:null;var f=this.determineResolveParam(e,n,t.RGAttachmentSlot.DepthStencil),h=f.resolveTo,d=f.store;n.descriptor.depthStencilResolveTo=h,n.descriptor.depthStencilStore=d,n.descriptor.depthClearValue=null!==l&&l.needsClear?e.renderTargetDescriptions[r].depthClearValue:"load",n.descriptor.stencilClearValue=null!==l&&l.needsClear?e.renderTargetDescriptions[r].stencilClearValue:"load";for(var p=0,v=0,y=0,m=0;m<n.renderTargets.length;m++){var _=n.renderTargets[m];_&&(0===p&&(p=_.width,v=_.height,y=_.sampleCount),Ee(_.width===p),Ee(_.height===v),Ee(_.sampleCount===y),_.needsClear=!1)}if(p>0&&v>0){var g=p*n.viewport.x,E=v*n.viewport.y,T=p*n.viewport.w,b=v*n.viewport.h;n.viewportX=g,n.viewportY=E,n.viewportW=T,n.viewportH=b}for(var S=0;S<n.resolveTextureInputIDs.length;S++){var R=n.resolveTextureInputIDs[S];n.resolveTextureInputTextures[S]=this.acquireResolveTextureInputTextureForID(e,R)}for(var A=0;A<n.renderTargetIDs.length;A++)this.releaseRenderTargetForID(n.renderTargetIDs[A],!0);for(var O=0;O<n.renderTargetExtraRefs.length;O++)n.renderTargetExtraRefs[O]&&this.releaseRenderTargetForID(n.renderTargetIDs[O],!0)}},{key:"scheduleGraph",value:function(e){Ee(0===this.renderTargetOutputCount.length),Ee(0===this.renderTargetResolveCount.length),Ee(0===this.resolveTextureUseCount.length);for(var t=0;t<this.renderTargetDeadPool.length;t++)this.renderTargetDeadPool[t].age++;for(var n=0;n<this.singleSampledTextureDeadPool.length;n++)this.singleSampledTextureDeadPool[n].age++;Ie(this.renderTargetOutputCount,e.renderTargetDescriptions.length,0),Ie(this.renderTargetResolveCount,e.renderTargetDescriptions.length,0),Ie(this.resolveTextureUseCount,e.resolveTextureRenderTargetIDs.length,0);for(var r=0;r<e.passes.length;r++)this.scheduleAddUseCount(e,e.passes[r]);for(var i=0;i<e.passes.length;i++)this.schedulePass(e,e.passes[i]);for(var o=0;o<this.renderTargetOutputCount.length;o++)Ee(0===this.renderTargetOutputCount[o]);for(var a=0;a<this.renderTargetResolveCount.length;a++)Ee(0===this.renderTargetResolveCount[a]);for(var s=0;s<this.resolveTextureUseCount.length;s++)Ee(0===this.resolveTextureUseCount[s]);for(var u=0;u<this.renderTargetAliveForID.length;u++)Ee(void 0===this.renderTargetAliveForID[u]);for(var c=0;c<this.renderTargetDeadPool.length;c++)this.renderTargetDeadPool[c].age>=1&&(this.renderTargetDeadPool[c].destroy(),this.renderTargetDeadPool.splice(c--,1));for(var l=0;l<this.singleSampledTextureDeadPool.length;l++)this.singleSampledTextureDeadPool[l].age>=1&&(this.singleSampledTextureDeadPool[l].destroy(),this.singleSampledTextureDeadPool.splice(l--,1));this.renderTargetResolveCount.length=0,this.renderTargetOutputCount.length=0,this.resolveTextureUseCount.length=0}},{key:"execPass",value:function(e){Ee(null===this.currentPass),this.currentPass=e;var t=this.device.createRenderPass(e.descriptor);t.beginDebugGroup(e.debugName),t.setViewport(e.viewportX,e.viewportY,e.viewportW,e.viewportH),null!==e.execFunc&&e.execFunc(t,this),t.endDebugGroup(),this.device.submitPass(t),null!==e.postFunc&&e.postFunc(this),this.currentPass=null}},{key:"execGraph",value:function(e){var t=this;this.scheduleGraph(e),e.passes.forEach((function(e){t.execPass(e)})),this.singleSampledTextureForResolveTextureID.length=0}},{key:"execute",value:function(){var e=Te(this.currentGraph);this.execGraph(e),this.currentGraph=null}},{key:"getDebug",value:function(){return this}},{key:"getPasses",value:function(){return this.currentGraph.passes}},{key:"getPassDebugThumbnails",value:function(e){return e.debugThumbnails}},{key:"getPassRenderTargetID",value:function(e,t){return e.renderTargetIDs[t]}},{key:"getRenderTargetIDDebugName",value:function(e){return this.currentGraph.renderTargetDebugNames[e]}},{key:"getResolveTextureForID",value:function(e){var t=this.currentPass,n=t.resolveTextureInputIDs.indexOf(e);return Ee(n>=0),Te(t.resolveTextureInputTextures[n])}},{key:"getRenderTargetAttachment",value:function(e){var t=this.currentPass.renderTargets[e];return t?t.attachment:null}},{key:"getRenderTargetTexture",value:function(e){var t=this.currentPass.renderTargets[e];return t?t.texture:null}},{key:"newGraphBuilder",value:function(){return this.beginGraphBuilder(),this}},{key:"destroy",value:function(){for(var e=0;e<this.renderTargetAliveForID.length;e++)Ee(void 0===this.renderTargetAliveForID[e]);for(var t=0;t<this.singleSampledTextureForResolveTextureID.length;t++)Ee(void 0===this.singleSampledTextureForResolveTextureID[t]);for(var n=0;n<this.renderTargetDeadPool.length;n++)this.renderTargetDeadPool[n].destroy();for(var r=0;r<this.singleSampledTextureDeadPool.length;r++)this.singleSampledTextureDeadPool[r].destroy()}}]),e}();(pn=t.RendererLayer||(t.RendererLayer={}))[pn.BACKGROUND=0]="BACKGROUND",pn[pn.ALPHA_TEST=16]="ALPHA_TEST",pn[pn.OPAQUE=32]="OPAQUE",pn[pn.TRANSLUCENT=128]="TRANSLUCENT";function mn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65536,r=a.clamp(e,0,n)/n;t&&(r=1-r);var i=65535*r;return 65535&i}function _n(e,t){return(16777215&e|(255&t)<<24)>>>0}function gn(e,t){return!!(e>>>31&1)?e:(4278190335&e|(65535&t)<<8)>>>0}function En(e,t){return _n(gn(0,t),e)}function Tn(e,t){return Ee(t>=0),(4294967040&e|t>>>8&255)>>>0}function bn(e){return _n(0,e)}function Sn(e,t){return Ee(t>=0),(4278190335&e|t<<8)>>>0}var Rn="undefined"!=typeof Float32Array?Float32Array:Array;function An(){var e=new Rn(16);return Rn!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function On(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Cn(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p,v){var y=new Rn(16);return y[0]=e,y[1]=t,y[2]=n,y[3]=r,y[4]=i,y[5]=o,y[6]=a,y[7]=s,y[8]=u,y[9]=c,y[10]=l,y[11]=f,y[12]=h,y[13]=d,y[14]=p,y[15]=v,y}function Mn(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var xn=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],v=t[12],y=t[13],m=t[14],_=t[15],g=n[0],E=n[1],T=n[2],b=n[3];return e[0]=g*r+E*s+T*f+b*v,e[1]=g*i+E*u+T*h+b*y,e[2]=g*o+E*c+T*d+b*m,e[3]=g*a+E*l+T*p+b*_,g=n[4],E=n[5],T=n[6],b=n[7],e[4]=g*r+E*s+T*f+b*v,e[5]=g*i+E*u+T*h+b*y,e[6]=g*o+E*c+T*d+b*m,e[7]=g*a+E*l+T*p+b*_,g=n[8],E=n[9],T=n[10],b=n[11],e[8]=g*r+E*s+T*f+b*v,e[9]=g*i+E*u+T*h+b*y,e[10]=g*o+E*c+T*d+b*m,e[11]=g*a+E*l+T*p+b*_,g=n[12],E=n[13],T=n[14],b=n[15],e[12]=g*r+E*s+T*f+b*v,e[13]=g*i+E*u+T*h+b*y,e[14]=g*o+E*c+T*d+b*m,e[15]=g*a+E*l+T*p+b*_,e};function Pn(e,t,n){var r=new Rn(3);return r[0]=e,r[1]=t,r[2]=n,r}var Nn,Fn;Nn=new Rn(3),Rn!=Float32Array&&(Nn[0]=0,Nn[1]=0,Nn[2]=0),Fn=Nn;!function(){var e=function(){var e=new Rn(2);return Rn!=Float32Array&&(e[0]=0,e[1]=0),e}()}();var In=Cn(1,0,0,0,0,1,0,0,0,0,2,0,0,0,-1,1);var Dn,Ln=Cn(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);function Bn(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return e[t+0]=n,e[t+1]=r,e[t+2]=i,e[t+3]=o,4}(Dn=t.RenderInstFlags||(t.RenderInstFlags={}))[Dn.Indexed=1]="Indexed",Dn[Dn.AllowSkippingIfPipelineNotReady=2]="AllowSkippingIfPipelineNotReady",Dn[Dn.Template=4]="Template",Dn[Dn.Draw=8]="Draw",Dn[Dn.InheritedFlags=3]="InheritedFlags";var wn,kn=function(){function e(){m(this,e),this.sortKey=0,this.debug=null,this.renderPipelineDescriptor=void 0,this.uniformBuffer=void 0,this.uniforms=[],this.bindingDescriptors=Ue(1,(function(){return{bindingLayout:null,samplerBindings:[],uniformBufferBindings:[]}})),this.dynamicUniformBufferByteOffsets=Ue(4,(function(){return 0})),this.flags=0,this.inputState=null,this.drawStart=0,this.drawCount=0,this.drawInstanceCount=0,this.renderPipelineDescriptor={bindingLayouts:[],inputLayout:null,megaStateDescriptor:Xe(Ke),program:null,topology:t.PrimitiveTopology.Triangles,colorAttachmentFormats:[],depthStencilAttachmentFormat:null,sampleCount:1},this.reset()}return g(e,[{key:"reset",value:function(){this.sortKey=0,this.flags=t.RenderInstFlags.AllowSkippingIfPipelineNotReady,this.inputState=null,this.renderPipelineDescriptor.inputLayout=null}},{key:"setFromTemplate",value:function(e){He(this.renderPipelineDescriptor.megaStateDescriptor,e.renderPipelineDescriptor.megaStateDescriptor),this.renderPipelineDescriptor.program=e.renderPipelineDescriptor.program,this.renderPipelineDescriptor.inputLayout=e.renderPipelineDescriptor.inputLayout,this.renderPipelineDescriptor.topology=e.renderPipelineDescriptor.topology,this.renderPipelineDescriptor.colorAttachmentFormats.length=Math.max(this.renderPipelineDescriptor.colorAttachmentFormats.length,e.renderPipelineDescriptor.colorAttachmentFormats.length);for(var n=0;n<e.renderPipelineDescriptor.colorAttachmentFormats.length;n++)this.renderPipelineDescriptor.colorAttachmentFormats[n]=e.renderPipelineDescriptor.colorAttachmentFormats[n];this.renderPipelineDescriptor.depthStencilAttachmentFormat=e.renderPipelineDescriptor.depthStencilAttachmentFormat,this.renderPipelineDescriptor.sampleCount=e.renderPipelineDescriptor.sampleCount,this.inputState=e.inputState,this.uniformBuffer=e.uniformBuffer,this.uniforms=F(e.uniforms),this.drawCount=e.drawCount,this.drawStart=e.drawStart,this.drawInstanceCount=e.drawInstanceCount,this.flags=this.flags&~t.RenderInstFlags.InheritedFlags|e.flags&t.RenderInstFlags.InheritedFlags,this.sortKey=e.sortKey;var r=this.bindingDescriptors[0],i=e.bindingDescriptors[0];null!==i.bindingLayout&&this.setBindingLayout(i.bindingLayout);for(var o=0;o<Math.min(r.uniformBufferBindings.length,i.uniformBufferBindings.length);o++)r.uniformBufferBindings[o].wordCount=e.bindingDescriptors[0].uniformBufferBindings[o].wordCount;this.setSamplerBindingsFromTextureMappings(i.samplerBindings);for(var a=0;a<e.dynamicUniformBufferByteOffsets.length;a++)this.dynamicUniformBufferByteOffsets[a]=e.dynamicUniformBufferByteOffsets[a]}},{key:"setProgram",value:function(e){this.renderPipelineDescriptor.program=e}},{key:"setMegaStateFlags",value:function(e){return He(this.renderPipelineDescriptor.megaStateDescriptor,e),this.renderPipelineDescriptor.megaStateDescriptor}},{key:"getMegaStateFlags",value:function(){return this.renderPipelineDescriptor.megaStateDescriptor}},{key:"setInputLayoutAndState",value:function(e,t){this.inputState=t,this.renderPipelineDescriptor.inputLayout=e}},{key:"setBindingLayout",value:function(e){Ee(e.numUniformBuffers<this.dynamicUniformBufferByteOffsets.length),this.renderPipelineDescriptor.bindingLayouts[0]=e,this.bindingDescriptors[0].bindingLayout=e;for(var t=this.bindingDescriptors[0].uniformBufferBindings.length;t<e.numUniformBuffers;t++)this.bindingDescriptors[0].uniformBufferBindings.push({buffer:null,wordCount:0});for(var n=this.bindingDescriptors[0].samplerBindings.length;n<e.numSamplers;n++)this.bindingDescriptors[0].samplerBindings.push({sampler:null,texture:null,lateBinding:null})}},{key:"setBindingLayouts",value:function(e){Ee(e.length<=this.bindingDescriptors.length),Ee(1===e.length),this.setBindingLayout(e[0])}},{key:"drawIndexes",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.flags=ke(this.flags,t.RenderInstFlags.Indexed,!0),this.drawCount=e,this.drawStart=n,this.drawInstanceCount=1}},{key:"drawIndexesInstanced",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.flags=ke(this.flags,t.RenderInstFlags.Indexed,!0),this.drawCount=e,this.drawStart=r,this.drawInstanceCount=n}},{key:"drawPrimitives",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.flags=ke(this.flags,t.RenderInstFlags.Indexed,!1),this.drawCount=e,this.drawStart=n,this.drawInstanceCount=1}},{key:"setUniforms",value:function(e,t){if(0!==t.length){this.uniforms[e]=t;var n=0,r=[];t.forEach((function(e){var t=e.value,i="number"==typeof t?[t]:t,o=i.length>4?4:i.length,a=4-n%4;if(4!==a)if(a>=o);else{n+=a;for(var s=0;s<a;s++)r.push(0)}n+=i.length,r.push.apply(r,F(i))}));var i=4-r.length%4;if(4!==i)for(var o=0;o<i;o++)r.push(0);for(var a=this.allocateUniformBuffer(e,r.length),s=this.mapUniformBufferF32(e),u=0;u<r.length;u+=4)a+=Bn(s,a,r[u],r[u+1],r[u+2],r[u+3])}}},{key:"setUniformBuffer",value:function(e){this.uniformBuffer=e}},{key:"allocateUniformBuffer",value:function(e,t){return Ee(this.bindingDescriptors[0].bindingLayout.numUniformBuffers<this.dynamicUniformBufferByteOffsets.length),this.dynamicUniformBufferByteOffsets[e]=this.uniformBuffer.allocateChunk(t)<<2,this.bindingDescriptors[0].uniformBufferBindings[e].wordCount=t,this.getUniformBufferOffset(e)}},{key:"getUniformBufferOffset",value:function(e){return this.dynamicUniformBufferByteOffsets[e]>>>2}},{key:"setUniformBufferOffset",value:function(e,t,n){this.dynamicUniformBufferByteOffsets[e]=t<<2,this.bindingDescriptors[0].uniformBufferBindings[e].wordCount=n}},{key:"mapUniformBufferF32",value:function(e){return this.uniformBuffer.mapBufferF32()}},{key:"getUniformBuffer",value:function(){return this.uniformBuffer}},{key:"setSamplerBindingsFromTextureMappings",value:function(e){e=e.filter((function(e){return e}));for(var t=0;t<this.bindingDescriptors[0].samplerBindings.length;t++){var n=this.bindingDescriptors[0].samplerBindings[t],r=e[t];null!=r?(n.texture=r.texture,n.sampler=r.sampler,n.lateBinding=r.lateBinding):(n.texture=null,n.sampler=null,n.lateBinding=null)}}},{key:"hasLateSamplerBinding",value:function(e){for(var t=0;t<this.bindingDescriptors[0].samplerBindings.length;t++){if(this.bindingDescriptors[0].samplerBindings[t].lateBinding===e)return!0}return!1}},{key:"resolveLateSamplerBinding",value:function(e,t){for(var n=0;n<this.bindingDescriptors[0].samplerBindings.length;n++){var r=this.bindingDescriptors[0].samplerBindings[n];r.lateBinding===e&&(null===t?(r.texture=null,r.sampler=null):(Ee(null===t.lateBinding),r.texture=t.texture,null!==t.sampler&&(r.sampler=t.sampler)),r.lateBinding=null)}}},{key:"setAllowSkippingIfPipelineNotReady",value:function(e){this.flags=ke(this.flags,t.RenderInstFlags.AllowSkippingIfPipelineNotReady,e)}},{key:"setAttachmentFormatsFromRenderPass",value:function(e,t){for(var n=e.queryRenderPass(t),r=-1,i=0;i<n.colorAttachment.length;i++){var o=null!==n.colorAttachment[i]?e.queryRenderTarget(n.colorAttachment[i]):null;this.renderPipelineDescriptor.colorAttachmentFormats[i]=null!==o?o.pixelFormat:null,null!==o&&(-1===r?r=o.sampleCount:Ee(r===o.sampleCount))}var a=null!==n.depthStencilAttachment?e.queryRenderTarget(n.depthStencilAttachment):null;this.renderPipelineDescriptor.depthStencilAttachmentFormat=null!==a?a.pixelFormat:null,null!==a&&(-1===r?r=a.sampleCount:Ee(r==a.sampleCount)),Ee(r>0),this.renderPipelineDescriptor.sampleCount=r}},{key:"drawOnPass",value:function(e,n){var r=this,i=e.device;this.setAttachmentFormatsFromRenderPass(i,n);var o=e.createRenderPipeline(this.renderPipelineDescriptor);if(!i.pipelineQueryReady(o)){if(this.flags&t.RenderInstFlags.AllowSkippingIfPipelineNotReady)return!1;i.pipelineForceReady(o)}n.setPipeline(o),n.setInputState(this.inputState);for(var a=0;a<this.bindingDescriptors[0].uniformBufferBindings.length;a++)this.bindingDescriptors[0].uniformBufferBindings[a].buffer=Te(this.uniformBuffer.buffer);this.renderPipelineDescriptor.program.gl_program&&this.uniforms.forEach((function(e){var t={};e.forEach((function(e){var n=e.name,r=e.value;t[n]=r})),r.renderPipelineDescriptor.program.setUniforms(t)}));var s=e.createBindings(p(p({},this.bindingDescriptors[0]),{},{pipeline:o}));return n.setBindings(0,s,this.dynamicUniformBufferByteOffsets),this.drawInstanceCount>1?(Ee(!!(this.flags&t.RenderInstFlags.Indexed)),n.drawIndexedInstanced(this.drawCount,this.drawStart,this.drawInstanceCount)):this.flags&t.RenderInstFlags.Indexed?n.drawIndexed(this.drawCount,this.drawStart):n.draw(this.drawCount,this.drawStart),!0}}]),e}();function Un(e,t){return e.sortKey-t.sortKey}(wn=t.RenderInstExecutionOrder||(t.RenderInstExecutionOrder={}))[wn.Forwards=0]="Forwards",wn[wn.Backwards=1]="Backwards";var Gn=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Un,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.RenderInstExecutionOrder.Forwards;m(this,e),this.renderInsts=[],this.compareFunction=void 0,this.executionOrder=void 0,this.usePostSort=!1,this.compareFunction=n,this.executionOrder=r}return g(e,[{key:"checkUsePostSort",value:function(){this.usePostSort=null!==this.compareFunction&&this.renderInsts.length>=500}},{key:"insertSorted",value:function(e){null===this.compareFunction||this.usePostSort?this.renderInsts.push(e):we(this.renderInsts,e,this.compareFunction),this.checkUsePostSort()}},{key:"submitRenderInst",value:function(e){e.flags|=t.RenderInstFlags.Draw,this.insertSorted(e)}},{key:"hasLateSamplerBinding",value:function(e){for(var t=0;t<this.renderInsts.length;t++)if(this.renderInsts[t].hasLateSamplerBinding(e))return!0;return!1}},{key:"resolveLateSamplerBinding",value:function(e,t){for(var n=0;n<this.renderInsts.length;n++)this.renderInsts[n].resolveLateSamplerBinding(e,t)}},{key:"ensureSorted",value:function(){this.usePostSort&&(0!==this.renderInsts.length&&this.renderInsts.sort(this.compareFunction),this.usePostSort=!1)}},{key:"drawOnPassRendererNoReset",value:function(e,n){this.ensureSorted();var r=0;if(this.executionOrder===t.RenderInstExecutionOrder.Forwards)for(var i=0;i<this.renderInsts.length;i++)this.renderInsts[i].drawOnPass(e,n)&&r++;else for(var o=this.renderInsts.length-1;o>=0;o--)this.renderInsts[o].drawOnPass(e,n)&&r++;return r}},{key:"reset",value:function(){this.renderInsts.length=0}},{key:"drawOnPassRenderer",value:function(e,t){this.drawOnPassRendererNoReset(e,t),this.reset()}}]),e}(),jn=function(){function e(){m(this,e),this.pool=[],this.allocCount=0}return g(e,[{key:"allocRenderInstIndex",value:function(){return this.allocCount++,this.allocCount>this.pool.length&&this.pool.push(new kn),this.allocCount-1}},{key:"popRenderInst",value:function(){this.allocCount--}},{key:"reset",value:function(){for(var e=0;e<this.pool.length;e++)this.pool[e].reset();this.allocCount=0}},{key:"destroy",value:function(){this.pool.length=0,this.allocCount=0}}]),e}(),Vn=function(){function e(t){m(this,e),this.renderCache=void 0,this.instPool=new jn,this.templatePool=new jn,this.simpleRenderInstList=new Gn,this.currentRenderInstList=this.simpleRenderInstList,this.renderCache=t}return g(e,[{key:"newRenderInst",value:function(){var e=this.templatePool.allocCount-1,t=this.instPool.allocRenderInstIndex(),n=this.instPool.pool[t];return n.debug=null,e>=0&&n.setFromTemplate(this.templatePool.pool[e]),n}},{key:"submitRenderInst",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentRenderInstList;t.submitRenderInst(e)}},{key:"setCurrentRenderInstList",value:function(e){Ee(null===this.simpleRenderInstList),this.currentRenderInstList=e}},{key:"pushTemplateRenderInst",value:function(){var e=this.templatePool.allocCount-1,n=this.templatePool.allocRenderInstIndex(),r=this.templatePool.pool[n];return e>=0&&r.setFromTemplate(this.templatePool.pool[e]),r.flags|=t.RenderInstFlags.Template,r}},{key:"popTemplateRenderInst",value:function(){this.templatePool.popRenderInst()}},{key:"getTemplateRenderInst",value:function(){var e=this.templatePool.allocCount-1;return this.templatePool.pool[e]}},{key:"resetRenderInsts",value:function(){this.instPool.reset(),null!==this.simpleRenderInstList&&this.simpleRenderInstList.reset(),Ee(0===this.templatePool.allocCount)}},{key:"destroy",value:function(){this.instPool.destroy(),this.renderCache.destroy()}},{key:"disableSimpleMode",value:function(){this.simpleRenderInstList=null}},{key:"drawOnPassRenderer",value:function(e){Te(this.simpleRenderInstList).drawOnPassRenderer(this.renderCache,e)}},{key:"drawOnPassRendererNoReset",value:function(e){Te(this.simpleRenderInstList).drawOnPassRendererNoReset(this.renderCache,e)}}]),e}();t.RenderHelper=function(){function e(){m(this,e),this.renderCache=void 0,this.renderGraph=void 0,this.renderInstManager=void 0,this.uniformBuffer=void 0,this.device=void 0}return g(e,[{key:"getDevice",value:function(){return this.device}},{key:"setDevice",value:function(e){this.device=e,this.renderCache=new un(e),this.renderGraph=new yn(this.device),this.renderInstManager=new Vn(this.renderCache),this.uniformBuffer=new Yt(this.device)}},{key:"pushTemplateRenderInst",value:function(){var e=this.renderInstManager.pushTemplateRenderInst();return e.setUniformBuffer(this.uniformBuffer),e}},{key:"prepareToRender",value:function(){this.uniformBuffer.prepareToRender()}},{key:"destroy",value:function(){this.uniformBuffer&&this.uniformBuffer.destroy(),this.renderInstManager&&this.renderInstManager.destroy(),this.renderCache.destroy(),this.renderGraph.destroy()}},{key:"getCache",value:function(){return this.renderCache}}]),e}(),t.RenderHelper=o.__decorate([i.singleton()],t.RenderHelper);var Wn=function(){function e(t){m(this,e),this.pixelFormat=void 0,this.width=0,this.height=0,this.sampleCount=0,this.colorClearColor="load",this.depthClearValue="load",this.stencilClearValue="load",this.pixelFormat=t}return g(e,[{key:"setDimensions",value:function(e,t,n){this.width=e,this.height=t,this.sampleCount=n}},{key:"copyDimensions",value:function(e){this.width=e.width,this.height=e.height,this.sampleCount=e.sampleCount}}]),e}();function Hn(e){return{colorClearColor:e,depthClearValue:1,stencilClearValue:0}}var Xn,zn=Hn(Ae(.88,.88,.88,1)),Yn=Hn(Ce),Kn=Hn(xe);function qn(e,n){var r=function(e){return e.antialiasingMode===t.AntialiasingMode.MSAAx4?4:1}(n);e.setDimensions(n.backbufferWidth,n.backbufferHeight,r)}function Zn(e,n,r){var i=function(e){if(e===t.RGAttachmentSlot.Color0)return t.Format.U8_RGBA_RT;if(e===t.RGAttachmentSlot.DepthStencil)return t.Format.D24_S8;throw new Error("whoops")}(e),o=new Wn(i);return qn(o,n),null!==r&&(o.colorClearColor=r.colorClearColor,o.depthClearValue=r.depthClearValue,o.stencilClearValue=r.stencilClearValue),o}(Xn=t.AntialiasingMode||(t.AntialiasingMode={}))[Xn.None=0]="None",Xn[Xn.FXAA=1]="FXAA",Xn[Xn.MSAAx4=2]="MSAAx4";var Jn=function(){function e(){m(this,e),this.name=void 0,this.texture=null,this.sampler=null,this.lateBinding=null,this.width=0,this.height=0,this.lodBias=0}return g(e,[{key:"reset",value:function(){this.texture=null,this.sampler=null,this.lateBinding=null,this.width=0,this.height=0,this.lodBias=0}},{key:"copy",value:function(e){this.texture=e.texture,this.sampler=e.sampler,this.lateBinding=e.lateBinding,this.width=e.width,this.height=e.height,this.lodBias=e.lodBias}}]),e}(),Qn=function(){function e(){m(this,e),this.inputTexture=null,this.outputTexture=null}return g(e,[{key:"setDescription",value:function(e,t){this.inputTexture!==this.outputTexture&&(null!==this.inputTexture&&this.inputTexture.destroy(),this.inputTexture=this.outputTexture),Ee(this.inputTexture===this.outputTexture),null!==this.outputTexture&&this.outputTexture.matchesDescription(t)||(this.outputTexture=new dn(e,t),null===this.inputTexture&&(this.inputTexture=this.outputTexture))}},{key:"getTextureForSampling",value:function(){return null!==this.inputTexture?this.inputTexture.texture:null}},{key:"getTextureForResolving",value:function(){var e;return null===(e=this.outputTexture)||void 0===e?void 0:e.texture}},{key:"destroy",value:function(){null!==this.outputTexture&&this.outputTexture!==this.inputTexture&&(this.outputTexture.destroy(),this.outputTexture=null),null!==this.inputTexture&&(this.inputTexture.destroy(),this.inputTexture=null)}}]),e}();t.TexturePool=function(){function e(){m(this,e),this.offscreenCanvas=void 0,this.renderingService=void 0,this.canvasConfig=void 0,this.textureCache={},this.gradientCache={}}return g(e,[{key:"getOrCreateTexture",value:function(e,n,r,i){var o=this,s="string"==typeof n?n:n.src||"";if(this.textureCache[s])this.textureCache[s].emit(t.TextureEvent.LOADED);else if(this.textureCache[s]=e.createTexture(p({pixelFormat:t.Format.U8_RGBA_NORM,width:1,height:1,depth:1,numLevels:1,dimension:t.TextureDimension.n2D,usage:t.TextureUsage.Sampled,pixelStore:{unpackFlipY:!1},immutable:!1},r)),"string"!=typeof n)this.textureCache[s].setImageData(n),this.textureCache[s].emit(t.TextureEvent.LOADED),this.renderingService.dirtify();else{var u,c=this.canvasConfig.createImage;c?u=c(n):a.isBrowser&&(u=new window.Image),u&&(u.onload=function(){o.textureCache[s].setImageData(u),o.textureCache[s].emit(t.TextureEvent.LOADED),o.renderingService.dirtify(),i&&i(o.textureCache[s])},u.onerror=function(){},u.crossOrigin="Anonymous",u.src=n)}return this.textureCache[s]}},{key:"getOrCreateCanvas",value:function(){return this.offscreenCanvas.getOrCreateCanvas(this.canvasConfig.offscreenCanvas)}},{key:"getOrCreateGradient",value:function(e){var t=this.generateCacheKey(e),n=e.type,r=e.x0,i=e.y0,o=e.x1,s=e.y1,u=e.steps,c=e.width,l=e.height,f=this.gradientCache[t],h=this.offscreenCanvas.getOrCreateCanvas(this.canvasConfig.offscreenCanvas),d=this.offscreenCanvas.getOrCreateContext(this.canvasConfig.offscreenCanvas);if(!f){if(h.width=c,h.height=l,n===a.GradientPatternType.LinearGradient)f=d.createLinearGradient(r*c,i*l,o*c,s*l);else if(n===a.GradientPatternType.RadialGradient){var p=Math.sqrt(c*c+l*l)/2;f=d.createRadialGradient(r*c,i*l,0,o*c,s*l,e.r1*p)}u.forEach((function(e){var t,n=P(e,2),r=n[0],i=n[1];null===(t=f)||void 0===t||t.addColorStop(Number(r),i)})),this.gradientCache[t]=f}h.src=t,f&&(d.fillStyle=f,d.fillRect(0,0,c,l))}},{key:"generateCacheKey",value:function(e){var t=e.type,n=e.x0,r=e.y0,i=e.x1,o=e.y1,a=e.r1,s=e.steps,u=e.width,c=e.height;return"gradient-".concat(t,"-").concat(n,"-").concat(r,"-").concat(i,"-").concat(o,"-").concat(a||0,"-").concat(u,"-").concat(c,"-").concat(s.map((function(e){return e.join("")})).join("-"))}},{key:"destroy",value:function(){for(var e in this.textureCache)this.textureCache[e].destroy();this.textureCache={},this.gradientCache={}}}]),e}(),o.__decorate([i.inject(a.OffscreenCanvasCreator),o.__metadata("design:type",a.OffscreenCanvasCreator)],t.TexturePool.prototype,"offscreenCanvas",void 0),o.__decorate([i.inject(a.RenderingService),o.__metadata("design:type",a.RenderingService)],t.TexturePool.prototype,"renderingService",void 0),o.__decorate([i.inject(a.CanvasConfig),o.__metadata("design:type",Object)],t.TexturePool.prototype,"canvasConfig",void 0),t.TexturePool=o.__decorate([i.singleton()],t.TexturePool);var $n=function(){function e(){m(this,e),this.lights=[],this.fog=void 0}return g(e,[{key:"addLight",value:function(e){this.lights.push(e),this.sortLights()}},{key:"removeLight",value:function(e){var t=this.lights.indexOf(e);this.lights.splice(t,1),this.sortLights()}},{key:"addFog",value:function(e){this.fog=e}},{key:"removeFog",value:function(e){this.fog=null}},{key:"getFog",value:function(){return this.fog}},{key:"getAllLights",value:function(){return this.lights}},{key:"getDefines",value:function(){var e={USE_LIGHT:!!this.lights.length};return this.lights.forEach((function(t){e[t.define]||(e[t.define]=0),e[t.define]++})),e}},{key:"sortLights",value:function(){this.lights.sort((function(e,t){return e.order-t.order}))}}]),e}();$n=o.__decorate([i.singleton()],$n);var er=i.Syringe.defineToken("RendererFactory"),tr=i.Syringe.defineToken("ShapeRenderer"),nr=i.Syringe.defineToken("MeshFactory"),rr=1,ir=function(){function e(){m(this,e),this.renderHelper=void 0,this.rendererFactory=void 0,this.meshFactory=void 0,this.device=void 0,this.renderingService=void 0,this.meshes=[],this.pendingUpdatePatches={},this.stencilRefCache={}}return g(e,[{key:"render",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n||this.updatePendingPatches(),this.meshes.forEach((function(r){r.init(t.device,t.renderingService);var i=r.objects;r.clipPathTarget&&(i=[r.clipPath]);var o=t.renderHelper.renderInstManager.newRenderInst();o.setAllowSkippingIfPipelineNotReady(!1),r.applyRenderInst(o,i),t.renderHelper.renderInstManager.submitRenderInst(o,e),n||r.objects.forEach((function(e){e.renderable.dirty=!1}))}))}},{key:"attach",value:function(e,t){this.device=e,this.renderingService=t}},{key:"add",value:function(e){var t=this,n=e.renderable3D;if(n&&!n.meshes.length){var r=this.rendererFactory(e.nodeName);r&&r.meshes.forEach((function(i,o){if(n.meshes[o]=void 0,r.shouldSubmitRenderInst(e,o)){var a=t.meshes.find((function(t){return i===t.constructor&&t.index===o&&t.shouldMerge(e,o)}));a||((a=t.meshFactory(i)).renderer=r,a.index=o,t.meshes.push(a)),a&&(a.objects.push(e),n.meshes[o]=a,a.geometryDirty=!0)}}))}}},{key:"remove",value:function(e){var t=this,n=e.renderable3D;n&&(n.meshes.forEach((function(n){if(n){var r=n.objects.indexOf(e);r>-1&&(n.objects.splice(r,1),n.geometryDirty=!0),0===n.objects.length&&t.meshes.splice(t.meshes.indexOf(n),1)}})),n.meshes=[])}},{key:"updateAttribute",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.renderable3D,a=this.rendererFactory(e.nodeName);a&&a.meshes.forEach((function(s,u){var c=a.shouldSubmitRenderInst(e,u),l=o.meshes.find((function(e){return e&&e.index===u&&e.constructor===s}));if(c!==!!l&&(l&&(l.objects.splice(l.objects.indexOf(e),1),l.geometryDirty=!0,0===l.objects.length&&r.meshes.splice(r.meshes.indexOf(l),1),o.meshes[o.meshes.indexOf(l)]=void 0),c&&((l=r.meshes.find((function(t){return s===t.constructor&&t.index===u&&t.shouldMerge(e,u)})))||((l=r.meshFactory(s)).renderer=a,l.index=u,l.init(r.device,r.renderingService),r.meshes.push(l)),l&&(l.objects.push(e),o.meshes[u]=l))),c&&l&&l.inited&&!l.geometryDirty){var f=l.objects.indexOf(e);if(i)e.parsedStyle[t]=n,l.updateAttribute([e],f,t,n);else{var h=l.id+t;r.pendingUpdatePatches[h]||(r.pendingUpdatePatches[h]={instance:l,objectIndices:[],name:t,value:n}),-1===r.pendingUpdatePatches[h].objectIndices.indexOf(f)&&r.pendingUpdatePatches[h].objectIndices.push(f)}}}))}},{key:"changeRenderOrder",value:function(e,t){var n=e.renderable3D;n&&n.meshes.length&&n.meshes.forEach((function(n){n&&n.inited&&!n.geometryDirty&&(n.renderer.shouldSubmitRenderInst(e,n.index)&&n.inited&&n.changeRenderOrder(e,t))}))}},{key:"getStencilRef",value:function(e){return this.stencilRefCache[e.entity]||(this.stencilRefCache[e.entity]=rr++),this.stencilRefCache[e.entity]}},{key:"updatePendingPatches",value:function(){var e=this;Object.keys(this.pendingUpdatePatches).forEach((function(t){var n=e.pendingUpdatePatches[t],r=n.instance,i=n.objectIndices,o=n.name,a=n.value;i.sort((function(e,t){return e-t}));var s=[];i.forEach((function(e){var t=s[s.length-1];t&&e===t[t.length-1]+1?t.push(e):s.push([e])})),s.forEach((function(e){r.updateAttribute(r.objects.slice(e[0],e[0]+e.length),e[0],o,a)}))})),this.pendingUpdatePatches={}}}]),e}();o.__decorate([i.inject(t.RenderHelper),o.__metadata("design:type",t.RenderHelper)],ir.prototype,"renderHelper",void 0),o.__decorate([i.inject(er),o.__metadata("design:type",Function)],ir.prototype,"rendererFactory",void 0),o.__decorate([i.inject(nr),o.__metadata("design:type",Function)],ir.prototype,"meshFactory",void 0),ir=o.__decorate([i.singleton()],ir);var or=1;function ar(e,n,r){var i=e.createBuffer({viewOrSize:De(r.byteLength,4)/4,usage:n,hint:t.BufferFrequencyHint.Static});return i.setSubData(0,new Uint8Array(r)),i}t.Batch=function(){function e(){m(this,e),this.renderHelper=void 0,this.texturePool=void 0,this.camera=void 0,this.lightPool=void 0,this.batchManager=void 0,this.device=void 0,this.renderingService=void 0,this.id=or++,this.meshes=[],this.clipPathMeshCreated=!1}return g(e,[{key:"shouldSubmitRenderInst",value:function(e,t){return!0}},{key:"beforeUploadUBO",value:function(e,t,n){}},{key:"beforeInitMesh",value:function(e){}},{key:"afterInitMesh",value:function(e){}}]),e}(),o.__decorate([i.inject(t.RenderHelper),o.__metadata("design:type",t.RenderHelper)],t.Batch.prototype,"renderHelper",void 0),o.__decorate([i.inject(t.TexturePool),o.__metadata("design:type",t.TexturePool)],t.Batch.prototype,"texturePool",void 0),o.__decorate([i.inject(a.DefaultCamera),o.__metadata("design:type",a.Camera)],t.Batch.prototype,"camera",void 0),o.__decorate([i.inject($n),o.__metadata("design:type",$n)],t.Batch.prototype,"lightPool",void 0),o.__decorate([i.inject(ir),o.__metadata("design:type",ir)],t.Batch.prototype,"batchManager",void 0),t.Batch=o.__decorate([i.injectable()],t.Batch),(t.GeometryEvent||(t.GeometryEvent={})).CHANGED="changed";var sr=function(e){T(r,e);var n=C(r);function r(e){var i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return m(this,r),(i=n.call(this)).device=void 0,i.props=void 0,i.drawMode=t.PrimitiveTopology.Triangles,i.vertexBuffers=[],i.vertices=[],i.indexBuffer=void 0,i.indices=void 0,i.inputLayoutDescriptor={vertexBufferDescriptors:[],vertexAttributeDescriptors:[],indexBufferFormat:t.Format.U32_R},i.vertexCount=0,i.instancedCount=0,i.indexStart=0,i.primitiveStart=0,i.dirty=!0,i.meshes=[],i.device=e,i.props=o,i}return g(r,[{key:"validate",value:function(e){return!0}},{key:"build",value:function(e){}},{key:"computeBoundingBox",value:function(){return new a.AABB}},{key:"setIndexBuffer",value:function(e){return this.indexBuffer&&this.indexBuffer.destroy(),this.indexBuffer=ar(this.device,t.BufferUsage.INDEX|t.BufferUsage.COPY_DST,new Uint32Array(ArrayBuffer.isView(e)?e.buffer:e).buffer),this.indices=e,this}},{key:"setVertexBuffer",value:function(e){var n=this,r=e.bufferIndex,i=e.byteStride,o=e.frequency,a=e.attributes,s=e.data;this.inputLayoutDescriptor.vertexBufferDescriptors[r]={byteStride:i,frequency:o},this.vertices[r]=s,a.forEach((function(e){var t=e.format,i=e.bufferByteOffset,o=e.location,a=e.divisor,s=e.byteStride,u=n.inputLayoutDescriptor.vertexAttributeDescriptors.find((function(e){return e.bufferIndex===r&&e.location===o}));u?(u.format=t,u.bufferByteOffset=i,u.byteStride=s,u.divisor=a):n.inputLayoutDescriptor.vertexAttributeDescriptors.push({format:t,bufferIndex:r,bufferByteOffset:i,location:o,byteStride:s,divisor:a})})),this.vertexBuffers[r]&&this.vertexBuffers[r].destroy();var u=ar(this.device,t.BufferUsage.VERTEX|t.BufferUsage.COPY_DST,s.buffer);return this.vertexBuffers[r]=u,this}},{key:"getVertexBuffer",value:function(e){return this.vertexBuffers[e]}},{key:"updateVertexBuffer",value:function(e,n,r,i){var o=this.inputLayoutDescriptor.vertexBufferDescriptors[e].byteStride,a=this.inputLayoutDescriptor.vertexAttributeDescriptors.find((function(e){return e.location===n}));if(a){var s=r*o;this.getVertexBuffer(e).setSubData(a.bufferByteOffset+s,i)}this.emit(t.GeometryEvent.CHANGED)}},{key:"updateIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.indexBuffer&&this.indexBuffer.setSubData(t,ArrayBuffer.isView(e)?e:new Uint32Array(e)),this}},{key:"destroy",value:function(){this.vertexBuffers.forEach((function(e){e&&e.destroy()})),this.indexBuffer&&this.indexBuffer.destroy(),this.inputLayoutDescriptor.vertexAttributeDescriptors=[],this.inputLayoutDescriptor.vertexBufferDescriptors=[],this.indexBuffer=void 0,this.vertexBuffers=[],this.indices=void 0,this.vertices=[],this.vertexCount=0,this.instancedCount=0}}]),r}(s.EventEmitter);(t.MaterialEvent||(t.MaterialEvent={})).CHANGED="changed";var ur=function(e){T(r,e);var n=C(r);function r(e,i){var o;m(this,r),(o=n.call(this)).device=void 0,o.props={},o.meshes=[],o.defines={},o.uniforms={},o.uniformNames=void 0,o.uboBuffer=[],o.textures={},o.samplers=[],o.programDirty=!0,o.textureDirty=!0,o.geometryDirty=!0;var a=Xe(Ke),s=a.cullMode,u=a.depthCompare,c=a.depthWrite,l=a.stencilCompare,f=a.stencilWrite,h=a.stencilPassOp,d=a.frontFace,v=a.polygonOffset,y=a.attachmentsState;return o.device=e,o.props=p({cullMode:s,depthTest:!0,depthCompare:u,depthWrite:c,stencilCompare:l,stencilWrite:f,stencilPassOp:h,frontFace:d,polygonOffset:v,attachmentsState:y,blendEquation:t.BlendMode.Add,blendEquationAlpha:t.BlendMode.Add,blendSrc:t.BlendFactor.SrcAlpha,blendDst:t.BlendFactor.OneMinusSrcAlpha,blendSrcAlpha:t.BlendFactor.Zero,blendDstAlpha:t.BlendFactor.One,dithering:!1,wireframe:!1,wireframeColor:"black",wireframeLineWidth:1,vertexShader:"",fragmentShader:""},i),o.compile(),o}return g(r,[{key:"cullMode",get:function(){return this.props.cullMode},set:function(e){this.props.cullMode=e}},{key:"frontFace",get:function(){return this.props.frontFace},set:function(e){this.props.frontFace=e}},{key:"blendEquation",get:function(){return this.props.blendEquation},set:function(e){this.props.blendEquation=e}},{key:"blendEquationAlpha",get:function(){return this.props.blendEquationAlpha},set:function(e){this.props.blendEquationAlpha=e}},{key:"blendSrc",get:function(){return this.props.blendSrc},set:function(e){this.props.blendSrc=e}},{key:"blendDst",get:function(){return this.props.blendDst},set:function(e){this.props.blendDst=e}},{key:"blendSrcAlpha",get:function(){return this.props.blendSrcAlpha},set:function(e){this.props.blendSrcAlpha=e}},{key:"blendDstAlpha",get:function(){return this.props.blendDstAlpha},set:function(e){this.props.blendDstAlpha=e}},{key:"depthCompare",get:function(){return this.props.depthCompare},set:function(e){this.props.depthCompare=e}},{key:"depthTest",get:function(){return this.props.depthTest},set:function(e){this.props.depthTest=e}},{key:"depthWrite",get:function(){return this.props.depthWrite},set:function(e){this.props.depthWrite=e}},{key:"stencilCompare",get:function(){return this.props.stencilCompare},set:function(e){this.props.stencilCompare=e}},{key:"stencilWrite",get:function(){return this.props.stencilWrite},set:function(e){this.props.stencilWrite=e}},{key:"stencilPassOp",get:function(){return this.props.stencilPassOp},set:function(e){this.props.stencilPassOp=e}},{key:"stencilRef",get:function(){return this.props.stencilRef},set:function(e){this.props.stencilRef=e}},{key:"polygonOffset",get:function(){return this.props.polygonOffset},set:function(e){this.props.polygonOffset=e}},{key:"dithering",get:function(){return this.props.dithering},set:function(e){this.props.dithering=e}},{key:"wireframe",get:function(){return this.props.wireframe},set:function(e){this.props.wireframe!==e&&(this.geometryDirty=!0,this.programDirty=!0,this.props.wireframe=e,this.dispatchMutationEvent()),this.defines.USE_WIREFRAME=!!e}},{key:"wireframeColor",get:function(){return this.props.wireframeColor},set:function(e){this.props.wireframeColor=e}},{key:"wireframeLineWidth",get:function(){return this.props.wireframeLineWidth},set:function(e){this.props.wireframeLineWidth=e}},{key:"vertexShader",get:function(){return this.props.vertexShader},set:function(e){this.props.vertexShader!==e&&(this.programDirty=!0,this.props.vertexShader=e,this.compile())}},{key:"fragmentShader",get:function(){return this.props.fragmentShader},set:function(e){this.props.fragmentShader!==e&&(this.programDirty=!0,this.props.fragmentShader=e,this.compile())}},{key:"compile",value:function(){var e=this;this.props.fragmentShader.replace(/^\s*uniform\s*sampler2D\s*(.*)\s*;$/gm,(function(t,n){return e.samplers.push(n),""})),this.uniformNames=Vt(this.props.fragmentShader)}},{key:"setUniforms",value:function(e){var n=this,r=!1;Object.keys(e).forEach((function(i){var o,s=e[i],u=n.textures[i];u&&u!==s&&(n.textureDirty=!0),(o=s)&&o.type?(n.textures[i]=s,n.textureDirty=!0,s.on(t.TextureEvent.LOADED,(function(){n.dispatchMutationEvent()}))):(n.uniforms[i]=s,r=!0),a.isNil(e[i])&&(delete n.textures[i],delete n.uniforms[i])})),r&&this.dispatchMutationEvent()}},{key:"dispatchMutationEvent",value:function(){this.emit(t.MaterialEvent.CHANGED)}}]),r}(s.EventEmitter),cr=function(e){T(n,e);var t=C(n);function n(e,r){var i;return m(this,n),(i=t.call(this,e,p({},r))).defines=p(p({},i.defines),{},{USE_UV:!1,USE_MAP:!1,USE_WIREFRAME:!1,USE_FOG:!1,USE_LIGHT:!1}),i}return g(n)}(ur);function lr(e){var t={};return Object.keys(e).forEach((function(n){"number"==typeof e[n]&&(t[n]=e[n])})),t}function fr(e,t){var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return e[n]===t[n]}))}var hr,dr,pr=1;(hr=t.VertexAttributeBufferIndex||(t.VertexAttributeBufferIndex={}))[hr.MODEL_MATRIX=0]="MODEL_MATRIX",hr[hr.FILL_STROKE=1]="FILL_STROKE",hr[hr.PACKED_STYLE=2]="PACKED_STYLE",hr[hr.PICKING_COLOR=3]="PICKING_COLOR",hr[hr.POSITION=4]="POSITION",hr[hr.NORMAL=5]="NORMAL",hr[hr.UV=6]="UV",hr[hr.BARYCENTRIC=7]="BARYCENTRIC",hr[hr.MAX=8]="MAX",(dr=t.VertexAttributeLocation||(t.VertexAttributeLocation={}))[dr.MODEL_MATRIX0=0]="MODEL_MATRIX0",dr[dr.MODEL_MATRIX1=1]="MODEL_MATRIX1",dr[dr.MODEL_MATRIX2=2]="MODEL_MATRIX2",dr[dr.MODEL_MATRIX3=3]="MODEL_MATRIX3",dr[dr.COLOR=4]="COLOR",dr[dr.STROKE_COLOR=5]="STROKE_COLOR",dr[dr.PACKED_STYLE1=6]="PACKED_STYLE1",dr[dr.PACKED_STYLE2=7]="PACKED_STYLE2",dr[dr.PICKING_COLOR=8]="PICKING_COLOR",dr[dr.POSITION=9]="POSITION",dr[dr.NORMAL=10]="NORMAL",dr[dr.UV=11]="UV",dr[dr.BARYCENTRIC=12]="BARYCENTRIC",dr[dr.MAX=13]="MAX",t.Instanced=function(){function e(){m(this,e),this.id=pr++,this.renderer=void 0,this.index=-1,this.renderHelper=void 0,this.texturePool=void 0,this.camera=void 0,this.lightPool=void 0,this.device=void 0,this.renderingService=void 0,this.objects=[],this.material=void 0,this.geometry=void 0,this.clipPath=void 0,this.clipPathTarget=void 0,this.inputState=void 0,this.program=new zt,this.programDescriptorSimpleWithOrig=void 0,this.geometryDirty=!0,this.materialDirty=!0,this.inputStateDirty=!0,this.textureMappings=[],this.samplerEntries=void 0,this.inited=!1}return g(e,[{key:"instance",get:function(){return this.objects[0]}},{key:"init",value:function(e,n){this.inited||(this.renderer.beforeInitMesh(this),this.device=e,this.renderingService=n,this.material=new cr(this.device),this.material.defines=p(p({},lr(t.VertexAttributeLocation)),this.material.defines),this.geometry=new sr(this.device),this.geometry.meshes=this.objects,this.material.meshes=this.objects,this.observeGeometryChanged(),this.observeMaterialChanged(),this.inited=!0,this.renderer.afterInitMesh(this))}},{key:"observeGeometryChanged",value:function(){var e=this;this.geometry.on(t.GeometryEvent.CHANGED,(function(){e.geometry.meshes.forEach((function(e){e.renderable.dirty=!0})),e.renderingService.dirtify()}))}},{key:"observeMaterialChanged",value:function(){var e=this;this.material.on(t.MaterialEvent.CHANGED,(function(){e.material.meshes.forEach((function(e){e.renderable.dirty=!0})),e.renderingService.dirtify()}))}},{key:"shouldMerge",value:function(e,t){return!this.instance||this.instance.nodeName===e.nodeName&&!e.parsedStyle.clipPath}},{key:"createGeometry",value:function(e){var n=this,r=An(),i=An(),o=[],s=[],u=[],c=[];e.forEach((function(e){var t,l=e.parsedStyle,f=l.fill,h=l.stroke,d=l.opacity,p=l.fillOpacity,v=l.strokeOpacity,y=l.lineWidth,m=l.anchor,_=l.visibility,g=l.increasedLineWidthForHitTesting,E=[0,0,0,0];f instanceof a.CSSRGB&&(E=[Number(f.r)/255,Number(f.g)/255,Number(f.b)/255,Number(f.alpha)]);var T=[0,0,0,0];h instanceof a.CSSRGB&&(T=[Number(h.r)/255,Number(h.g)/255,Number(h.b)/255,Number(h.alpha)]),n.clipPathTarget?(On(r,e.getLocalTransform()),E=[1,1,1,1],xn(r,n.clipPathTarget.getWorldTransform(),r)):On(r,e.getWorldTransform()),xn(i,n.camera.getViewTransform(),r);var b=e.isInteractive()&&(null===(t=e.renderable3D)||void 0===t?void 0:t.encodedPickingColor)||[0,0,0];o.push.apply(o,F(r)),s.push.apply(s,F(E).concat(F(T))),u.push(d.value,p.value,v.value,y.value,"visible"===_.value?1:0,m[0].value,m[1].value,(null==g?void 0:g.value)||0),c.push.apply(c,F(b).concat([.005*e.sortable.renderOrder]))})),this.geometry.instancedCount=e.length,this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.MODEL_MATRIX,byteStride:64,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGBA,bufferByteOffset:0,location:t.VertexAttributeLocation.MODEL_MATRIX0,divisor:1},{format:t.Format.F32_RGBA,bufferByteOffset:16,location:t.VertexAttributeLocation.MODEL_MATRIX1,divisor:1},{format:t.Format.F32_RGBA,bufferByteOffset:32,location:t.VertexAttributeLocation.MODEL_MATRIX2,divisor:1},{format:t.Format.F32_RGBA,bufferByteOffset:48,location:t.VertexAttributeLocation.MODEL_MATRIX3,divisor:1}],data:new Float32Array(o)}),this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.FILL_STROKE,byteStride:32,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGBA,bufferByteOffset:0,location:t.VertexAttributeLocation.COLOR,divisor:1},{format:t.Format.F32_RGBA,bufferByteOffset:16,location:t.VertexAttributeLocation.STROKE_COLOR,divisor:1}],data:new Float32Array(s)}),this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.PACKED_STYLE,byteStride:32,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGBA,bufferByteOffset:0,location:t.VertexAttributeLocation.PACKED_STYLE1,divisor:1},{format:t.Format.F32_RGBA,bufferByteOffset:16,location:t.VertexAttributeLocation.PACKED_STYLE2,divisor:1}],data:new Float32Array(u)}),this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.PICKING_COLOR,byteStride:16,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGBA,bufferByteOffset:0,location:t.VertexAttributeLocation.PICKING_COLOR,divisor:1}],data:new Float32Array(c)})}},{key:"destroy",value:function(){this.geometry&&this.geometry.destroy(),this.inputState&&this.inputState.destroy()}},{key:"applyRenderInst",value:function(e,n){var r=this,i=this.lightPool.getAllLights(),o=!!this.lightPool.getFog(),a=!!i.length,s=p({},this.material.defines);if(this.material.defines.USE_FOG=o,this.material.defines.USE_LIGHT=a,this.material.defines=p(p({},this.material.defines),this.lightPool.getDefines()),this.clipPathTarget||this.clipPath?this.clipPathTarget?(this.material.stencilWrite=!0,this.material.depthWrite=!1,this.material.stencilCompare=t.CompareMode.Always,this.material.stencilPassOp=t.StencilOp.Replace):(this.material.stencilWrite=!1,this.material.depthWrite=!0,this.material.stencilCompare=t.CompareMode.Equal,this.material.stencilPassOp=t.StencilOp.Keep):this.material.stencilWrite=!1,(this.materialDirty||this.material.programDirty)&&this.createMaterial(n),this.material.textureDirty){this.textureMappings=[];var u=this.createFillGradientTextureMapping(n);u&&this.textureMappings.push(u),Object.keys(this.material.textures).sort((function(e,t){return r.material.samplers.indexOf(e)-r.material.samplers.indexOf(t)})).forEach((function(e){var n=new Jn;n.name=e,n.texture=r.material.textures[e],r.device.setResourceName(n.texture,"Material Texture "+e),n.sampler=r.renderHelper.getCache().createSampler({wrapS:t.WrapMode.Clamp,wrapT:t.WrapMode.Clamp,minFilter:t.TexFilterMode.Point,magFilter:t.TexFilterMode.Bilinear,mipFilter:t.MipFilterMode.Linear,minLOD:0,maxLOD:0}),r.textureMappings.push(n)})),this.textureMappings.length?(this.material.defines.USE_UV=!0,this.material.defines.USE_MAP=!0):(this.material.defines.USE_UV=!1,this.material.defines.USE_MAP=!1),this.material.textureDirty=!1}(fr(s,this.material.defines)||this.material.programDirty||this.materialDirty)&&(this.material.defines=p(p({},this.material.defines),lr(t.VertexAttributeLocation)),Object.keys(this.material.defines).forEach((function(e){var t=r.material.defines[e];"number"==typeof t?r.program.setDefineString(e,"".concat(t)):r.program.setDefineBool(e,t)})),this.program.vert=this.material.vertexShader,this.program.frag=this.material.fragmentShader,this.programDescriptorSimpleWithOrig=Xt(this.device,this.program),this.material.programDirty=!1,this.materialDirty=!1),this.material.geometryDirty&&(this.geometryDirty=!0,this.inputStateDirty=!0,this.material.geometryDirty=!1),(this.geometryDirty||this.geometry.dirty)&&(this.geometry&&this.geometry.destroy(),this.createGeometry(n),this.material.wireframe&&this.generateWireframe(this.geometry),this.geometryDirty=!1,this.geometry.dirty=!1,this.inputStateDirty=!0);var c=this.renderHelper.getCache().createInputLayout(this.geometry.inputLayoutDescriptor),l=this.renderHelper.getCache().createProgramSimple(this.programDescriptorSimpleWithOrig),f=!!this.geometry.indexBuffer;this.inputStateDirty&&(this.inputState&&this.inputState.destroy(),this.inputState=this.device.createInputState(c,this.geometry.vertexBuffers.map((function(e){return{buffer:e,byteOffset:0}})),f?{buffer:this.geometry.indexBuffer,byteOffset:0}:null,l),this.inputStateDirty=!1),e.renderPipelineDescriptor.topology=this.geometry.drawMode,e.setProgram(l),e.setInputLayoutAndState(c,this.inputState),this.renderer.beforeUploadUBO(e,this,this.index),this.uploadUBO(e),f?e.drawIndexesInstanced(this.geometry.vertexCount,this.geometry.instancedCount,this.geometry.indexStart):e.drawPrimitives(this.geometry.vertexCount,this.geometry.primitiveStart),e.sortKey=En(t.RendererLayer.OPAQUE,n[0].sortable.renderOrder)}},{key:"updateBatchedAttribute",value:function(e,n,r,i){if("fill"===r||"stroke"===r){var o=[];e.forEach((function(e){var t=e.parsedStyle,n=t.fill,r=t.stroke,i=[0,0,0,0];n instanceof a.CSSRGB&&(i=[Number(n.r)/255,Number(n.g)/255,Number(n.b)/255,Number(n.alpha)]);var s=[0,0,0,0];r instanceof a.CSSRGB&&(s=[Number(r.r)/255,Number(r.g)/255,Number(r.b)/255,Number(r.alpha)]),o.push.apply(o,F(i).concat(F(s)))})),this.geometry.updateVertexBuffer(t.VertexAttributeBufferIndex.FILL_STROKE,t.VertexAttributeLocation.COLOR,n,new Uint8Array(new Float32Array(o).buffer));var s=this.instance.parsedStyle.fill,u=this.textureMappings.findIndex((function(e){return"FillTextureMapping"===e.name}));if(s instanceof a.CSSRGB)u>=0&&(this.textureMappings.splice(u,-1),this.material.textureDirty=!0);else{var c=this.createFillGradientTextureMapping([this.instance]);u>=0&&this.textureMappings.splice(u,1,c),this.material.textureDirty=!0}}else if(["opacity","fillOpacity","strokeOpacity","lineWidth","visibility","anchor","increasedLineWidthForHitTesting"].indexOf(r)>-1){var l=[];e.forEach((function(e){var t=e.parsedStyle,n=t.opacity,r=t.fillOpacity,i=t.strokeOpacity,o=t.lineWidth,a=t.visibility,s=t.anchor,u=t.increasedLineWidthForHitTesting;l.push(n.value,r.value,i.value,o.value,"visible"===a.value?1:0,s[0].value,s[1].value,(null==u?void 0:u.value)||0)})),this.geometry.updateVertexBuffer(t.VertexAttributeBufferIndex.PACKED_STYLE,t.VertexAttributeLocation.PACKED_STYLE1,n,new Uint8Array(new Float32Array(l).buffer))}else if("modelMatrix"===r){var f=[];e.forEach((function(e){var t=On(An(),e.getWorldTransform());f.push.apply(f,F(t))})),this.geometry.updateVertexBuffer(t.VertexAttributeBufferIndex.MODEL_MATRIX,t.VertexAttributeLocation.MODEL_MATRIX0,n,new Uint8Array(new Float32Array(f).buffer))}else if("pointerEvents"===r){var h=[];e.forEach((function(e){var t,n=i&&e.isInteractive()&&(null===(t=e.renderable3D)||void 0===t?void 0:t.encodedPickingColor)||[0,0,0];h.push.apply(h,F(n).concat([.005*e.sortable.renderOrder]))})),this.geometry.updateVertexBuffer(t.VertexAttributeBufferIndex.PICKING_COLOR,t.VertexAttributeLocation.PICKING_COLOR,n,new Uint8Array(new Float32Array(h).buffer))}}},{key:"updateAttribute",value:function(e,t,n,r){"clipPath"===n&&this.clipPath&&(this.geometryDirty=!0)}},{key:"changeRenderOrder",value:function(e,n){var r,i=this.objects.indexOf(e),o=e.isInteractive()&&(null===(r=e.renderable3D)||void 0===r?void 0:r.encodedPickingColor)||[0,0,0];this.geometry.updateVertexBuffer(t.VertexAttributeBufferIndex.PICKING_COLOR,t.VertexAttributeLocation.PICKING_COLOR,i,new Uint8Array(new Float32Array([].concat(F(o),[.005*n])).buffer))}},{key:"generateWireframe",value:function(e){for(var n=e.indices,r=e.indices.length,i=e.vertices.map((function(e){return e.slice()})),o=t.VertexAttributeBufferIndex.PICKING_COLOR;o<e.vertexBuffers.length;o++){var a=e.inputLayoutDescriptor.vertexBufferDescriptors[o].byteStride;e.vertices[o]=new Float32Array(a/4*r)}for(var s=0,u=new Uint32Array(r),c=0;c<r;c++){for(var l=n[c],f=1;f<e.vertices.length;f++)for(var h=e.inputLayoutDescriptor.vertexBufferDescriptors[f].byteStride/4,d=0;d<h;d++)e.vertices[f][s*h+d]=i[f][l*h+d];u[c]=s,s++}for(var p=function(t){var n=e.inputLayoutDescriptor.vertexBufferDescriptors[t],r=n.frequency,i=n.byteStride,o=e.inputLayoutDescriptor.vertexAttributeDescriptors.find((function(e){return e.bufferIndex===t}));if(o){var a=o.location,s=o.bufferIndex,u=o.bufferByteOffset,c=o.format,l=o.divisor;e.setVertexBuffer({bufferIndex:s,byteStride:i,frequency:r,attributes:[{format:c,bufferByteOffset:u,location:a,divisor:l}],data:e.vertices[t]})}},v=t.VertexAttributeBufferIndex.PICKING_COLOR+1;v<e.vertexBuffers.length;v++)p(v);for(var y=new Float32Array(3*r),m=0;m<r;)for(var _=0;_<3;_++){y[3*u[m++]+_]=1}e.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.BARYCENTRIC,byteStride:12,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RGB,bufferByteOffset:0,location:Number(t.VertexAttributeLocation.BARYCENTRIC)}],data:y}),e.setIndexBuffer(u)}},{key:"beforeUploadUBO",value:function(e,t,n){}},{key:"uploadUBO",value:function(e){var n=this,r=this.material,i=this.lightPool.getAllLights(),o=this.lightPool.getFog(),s=!!o,u=!!i.length,c=r.defines.USE_WIREFRAME,l=[];if(c){var f=a.parseColor(r.wireframeColor);l.push({name:"u_WireframeLineColor",value:[Number(f.r)/255,Number(f.g)/255,Number(f.b)/255]}),l.push({name:"u_WireframeLineWidth",value:r.wireframeLineWidth})}if(s&&this.uploadFog(l,o),this.uploadMaterial(l,r),u){var h={};i.forEach((function(e){h[e.define]||(h[e.define]=-1),h[e.define]++,e.uploadUBO(l,h[e.define])}))}l.sort((function(e,t){return n.material.uniformNames.indexOf(e.name)-n.material.uniformNames.indexOf(t.name)})),e.setUniforms(1,l);var d=r.depthCompare,p=r.depthWrite,v=r.stencilCompare,y=r.stencilWrite,m=r.stencilPassOp,_=r.stencilRef,g=r.cullMode,E=r.frontFace,T=r.polygonOffset,b=r.blendEquation,S=r.blendEquationAlpha,R=r.blendSrc,A=r.blendDst,O=r.blendSrcAlpha,C=r.blendDstAlpha;e.setMegaStateFlags({attachmentsState:[{channelWriteMask:this.material.stencilWrite?t.ChannelWriteMask.None:t.ChannelWriteMask.AllChannels,rgbBlendState:{blendMode:b,blendSrcFactor:R,blendDstFactor:A},alphaBlendState:{blendMode:S,blendSrcFactor:O,blendDstFactor:C}}],depthCompare:d,depthWrite:p,stencilCompare:v,stencilWrite:y,stencilPassOp:m,stencilRef:_,cullMode:g,frontFace:E,polygonOffset:T}),e.setBindingLayouts([{numUniformBuffers:1,numSamplers:this.textureMappings.length,samplerEntries:this.samplerEntries}]),e.setSamplerBindingsFromTextureMappings(this.textureMappings)}},{key:"uploadFog",value:function(e,t){var n=t.parsedStyle,r=n.type,i=n.fill,o=n.start,s=n.end,u=n.density;if(i instanceof a.CSSRGB){var c=[Number(i.r)/255,Number(i.g)/255,Number(i.b)/255,Number(i.alpha)];e.push({name:"u_FogInfos",value:[r,o,s,u]}),e.push({name:"u_FogColor",value:c})}}},{key:"uploadMaterial",value:function(e,t){var n=Object.keys(t.uniforms).map((function(e){return{name:e,value:t.uniforms[e]}}));e.push.apply(e,F(n))}},{key:"createFillGradientTextureMapping",value:function(e){var n=e[0],r=n.nodeName===a.Shape.LINE?n.parsedStyle.stroke:n.parsedStyle.fill;if(r&&r instanceof a.CSSGradientValue){var i;r.type===a.GradientPatternType.LinearGradient||r.type===a.GradientPatternType.RadialGradient?(this.program.setDefineBool("USE_PATTERN",!1),this.texturePool.getOrCreateGradient(p(p({type:r.type},r.value),{},{width:128,height:128})),i=this.texturePool.getOrCreateCanvas()):(this.program.setDefineBool("USE_PATTERN",!0),i=r.value.src);var o=new Jn;return o.name="FillTextureMapping",o.texture=this.texturePool.getOrCreateTexture(this.device,i,de(t.Format.U8_RGBA_NORM,1,1,1)),o.texture.on("loaded",(function(){e.forEach((function(e){e.renderable.dirty=!0}))})),this.device.setResourceName(o.texture,"Fill Texture"+this.id),o.sampler=this.renderHelper.getCache().createSampler({wrapS:t.WrapMode.Repeat,wrapT:t.WrapMode.Repeat,minFilter:t.TexFilterMode.Point,magFilter:t.TexFilterMode.Bilinear,mipFilter:t.MipFilterMode.Linear,minLOD:0,maxLOD:0}),o}return null}}]),e}(),o.__decorate([i.inject(t.RenderHelper),o.__metadata("design:type",t.RenderHelper)],t.Instanced.prototype,"renderHelper",void 0),o.__decorate([i.inject(t.TexturePool),o.__metadata("design:type",t.TexturePool)],t.Instanced.prototype,"texturePool",void 0),o.__decorate([i.inject(a.DefaultCamera),o.__metadata("design:type",a.Camera)],t.Instanced.prototype,"camera",void 0),o.__decorate([i.inject($n),o.__metadata("design:type",$n)],t.Instanced.prototype,"lightPool",void 0),t.Instanced=o.__decorate([i.injectable()],t.Instanced);var vr,yr;!function(e){e[e.PACKED_STYLE=5]="PACKED_STYLE"}(vr||(vr={})),function(e){e[e.PACKED_STYLE3=13]="PACKED_STYLE3",e[e.SIZE=14]="SIZE"}(yr||(yr={}));var mr=[a.Shape.CIRCLE,a.Shape.ELLIPSE];t.SDFMesh=function(e){T(r,e);var n=C(r);function r(){return m(this,r),n.apply(this,arguments)}return g(r,[{key:"shouldMerge",value:function(e,t){var n=x(b(r.prototype),"shouldMerge",this).call(this,e,t);if(!n)return!1;if(this.needDrawStrokeSeparately(e)||this.needDrawStrokeSeparately(this.instance))return!1;var i=this.instance.parsedStyle.fill,o=e.parsedStyle.fill;return i.isNone===o.isNone}},{key:"createMaterial",value:function(e){this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = POSITION) in vec2 a_Extrude;\nlayout(location = PACKED_STYLE3) in vec4 a_StylePacked3;\nlayout(location = SIZE) in vec2 a_Size;\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\n\nout vec4 v_Data;\nout vec2 v_Radius;\nout vec4 v_StylePacked3;\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n  float strokeWidth;\n  if (u_IsPicking > 0.5) {\n    strokeWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\n  } else {\n    strokeWidth = u_StrokeWidth;\n  }\n\n  float antialiasblur = 1.0 / (a_Size.x + strokeWidth);\n\n  bool omitStroke = a_StylePacked3.z == 1.0;\n  vec2 radius = a_Size + vec2(omitStroke ? 0.0 : strokeWidth / 2.0);\n  vec2 offset = (a_Extrude + vec2(1.0) - 2.0 * u_Anchor.xy) * radius;\n\n  gl_Position = project(vec4(offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n  \n  v_Radius = radius;\n  v_Data = vec4(a_Extrude, antialiasblur, a_StylePacked3.x);\n  v_StylePacked3 = a_StylePacked3;\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nin vec4 v_Data;\nin vec2 v_Radius;\nin vec4 v_StylePacked3;\n\nout vec4 outputColor;\n\n/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\n// @see http://www.iquilezles.org/www/articles/ellipsoids/ellipsoids.htm\nfloat sdEllipsoidApproximated(vec2 p, vec2 r) {\n  float k0 = length(p / r);\n  float k1 = length(p / (r * r));\n  return k0 * (k0 - 1.0) / k1;\n}\n\nvoid main() {\n  int shape = int(floor(v_Data.w + 0.5));\n  float epsilon = 0.00001;\n\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n  #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n  bool omitStroke = v_StylePacked3.z == 1.0;\n\n  float antialiasblur = v_Data.z;\n  float antialiased_blur = -max(0.0, antialiasblur);\n  vec2 r = (v_Radius - (omitStroke ? 0.0 : u_StrokeWidth)) / v_Radius;\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'ellipse', 'rect'\n  if (shape == 0) {\n    outer_df = sdCircle(v_Data.xy, 1.0);\n    inner_df = sdCircle(v_Data.xy, r.x);\n  } else if (shape == 1) {\n    outer_df = sdEllipsoidApproximated(v_Data.xy, vec2(1.0));\n    inner_df = sdEllipsoidApproximated(v_Data.xy, r);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n\n  float color_t = u_StrokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n\n  // vec2 imagecoord = mod(v_Uv, 0.1);\n  // vec4 texel = texture(SAMPLER_2D(u_Map), imagecoord);\n  // u_Color = texel;\n\n  vec4 diffuseColor;\n  vec4 strokeColor;\n  if (u_IsPicking > 0.5) {\n    diffuseColor = vec4(u_PickingColor, 1.0);\n    strokeColor = vec4(u_PickingColor, 1.0);\n  } else {\n    diffuseColor = u_Color;\n    strokeColor = (u_StrokeColor == vec4(0) || omitStroke) ? vec4(0.0) : u_StrokeColor;\n  }\n\n  outputColor = mix(vec4(diffuseColor.rgb, diffuseColor.a * u_FillOpacity), strokeColor * u_StrokeOpacity, color_t);\n  outputColor.a = outputColor.a * u_Opacity * opacity_t;\n\n  if (outputColor.a < epsilon)\n    discard;\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n  }\n}",this.material.defines=p(p({},this.material.defines),lr(yr))}},{key:"createGeometry",value:function(e){var n=this;x(b(r.prototype),"createGeometry",this).call(this,e);var i=[],o=[],a=[];e.forEach((function(e,t){var r=e,s=4*t,u=r.parsedStyle.radius,c=n.shouldOmitStroke(r.parsedStyle),l=n.getSize(e.parsedStyle,r.nodeName);o.push.apply(o,F(l).concat([mr.indexOf(r.nodeName),u||0,c?1:0,0])),i.push(-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1),a.push(0+s,2+s,1+s,0+s,3+s,2+s)})),this.geometry.setIndexBuffer(new Uint32Array(a)),this.geometry.vertexCount=6,this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.POSITION,byteStride:16,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,location:t.VertexAttributeLocation.POSITION},{format:t.Format.F32_RG,bufferByteOffset:8,location:t.VertexAttributeLocation.UV}],data:new Float32Array(i)}),this.geometry.setVertexBuffer({bufferIndex:vr.PACKED_STYLE,byteStride:24,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,location:yr.SIZE,divisor:1},{format:t.Format.F32_RGBA,bufferByteOffset:8,location:yr.PACKED_STYLE3,divisor:1}],data:new Float32Array(o)})}},{key:"updateAttribute",value:function(e,t,n,i){var o=this;if(x(b(r.prototype),"updateAttribute",this).call(this,e,t,n,i),this.updateBatchedAttribute(e,t,n,i),"r"===n||"rx"===n||"ry"===n||"lineWidth"===n||"stroke"===n||"lineDash"===n||"strokeOpacity"===n){var a=[];e.forEach((function(e){var t=e,n=o.shouldOmitStroke(t.parsedStyle),r=P(o.getSize(e.parsedStyle,e.nodeName),2),i=[r[0],r[1]];a.push.apply(a,i.concat([mr.indexOf(e.nodeName),e.parsedStyle.radius||0,n?1:0,0]))})),this.geometry.updateVertexBuffer(vr.PACKED_STYLE,yr.SIZE,t,new Uint8Array(new Float32Array(a).buffer))}}},{key:"getSize",value:function(e,t){var n=[0,0];if(t===a.Shape.CIRCLE){var r=e.r;n=[r.value,r.value]}else if(t===a.Shape.ELLIPSE){var i=e.rx,o=e.ry;n=[i.value,o.value]}return n}},{key:"shouldOmitStroke",value:function(e){var t=e.lineDash,n=e.stroke,r=e.strokeOpacity;return!(!n||!(t&&t.length&&t.every((function(e){return 0!==e.value}))||1!==r.value))}},{key:"needDrawStrokeSeparately",value:function(e){var t=e.parsedStyle,n=t.stroke,r=t.lineDash,i=t.lineWidth,o=t.strokeOpacity;return n&&i.value>0&&(o.value<1||r&&r.length&&r.every((function(e){return 0!==e.value})))}}]),r}(t.Instanced),t.SDFMesh=o.__decorate([i.injectable()],t.SDFMesh);var _r,gr,Er,Tr=[0,-.5,0,0,0,1,-.5,1,1,0,1,.5,1,1,1,0,.5,0,0,1];!function(e){e[e.POINT=8]="POINT",e[e.CAP=9]="CAP",e[e.DASH=10]="DASH"}(gr||(gr={})),function(e){e[e.POSITION=9]="POSITION",e[e.UV=11]="UV",e[e.POINTA=10]="POINTA",e[e.POINTB=12]="POINTB",e[e.CAP=13]="CAP",e[e.DASH=14]="DASH"}(Er||(Er={}));var br=(E(_r={},a.LineCap.BUTT,1),E(_r,a.LineCap.ROUND,2),E(_r,a.LineCap.SQUARE,3),_r);function Sr(e,t,n,r){var i=e-n,o=t-r;return Math.sqrt(i*i+o*o)}t.InstancedLineMesh=function(e){T(r,e);var n=C(r);function r(){return m(this,r),n.apply(this,arguments)}return g(r,[{key:"shouldMerge",value:function(e,t){var n=x(b(r.prototype),"shouldMerge",this).call(this,e,t);if(!n)return!1;var i=this.instance;if(i.nodeName===a.Shape.LINE){var o=i.parsedStyle.stroke,s=e.parsedStyle.stroke;if(o.toString()!==s.toString())return!1}return!0}},{key:"createMaterial",value:function(e){this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = POSITION) in vec3 a_Position;\nlayout(location = POINTA) in vec3 a_PointA;\nlayout(location = POINTB) in vec3 a_PointB;\nlayout(location = CAP) in float a_Cap;\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\nlayout(location = DASH) in vec4 a_Dash;\n\nout vec4 v_Dash;\n// out vec2 v_Normal;\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n  float strokeWidth;\n  if (u_IsPicking > 0.5) {\n    strokeWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\n  } else {\n    strokeWidth = u_StrokeWidth;\n  }\n\n  float isBillboard = a_Dash.w;\n  if (isBillboard < 0.5) {\n    vec2 xBasis = a_PointB.xy - a_PointA.xy;\n    vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n\n    vec2 point = a_PointA.xy + xBasis * a_Position.x + yBasis * strokeWidth * a_Position.y;\n    point = point - u_Anchor.xy * abs(xBasis);\n\n    // round & square\n    if (a_Cap > 1.0) {\n      point += sign(a_Position.x - 0.5) * normalize(xBasis) * vec2(strokeWidth / 2.0);\n    }\n\n    gl_Position = project(vec4(point, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n  } else {\n    // clip space\n    vec4 clip0 = project(vec4(a_PointA, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n    vec4 clip1 = project(vec4(a_PointB, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n    // screen space\n    vec2 screen0 = u_Viewport * (0.5 * clip0.xy / clip0.w + 0.5);\n    vec2 screen1 = u_Viewport * (0.5 * clip1.xy / clip1.w + 0.5);\n    vec2 xBasis = normalize(screen1 - screen0);\n    vec2 yBasis = vec2(-xBasis.y, xBasis.x);\n    vec2 pt0 = screen0 + strokeWidth * (a_Position.x * xBasis + a_Position.y * yBasis);\n    vec2 pt1 = screen1 + strokeWidth * (a_Position.x * xBasis + a_Position.y * yBasis);\n    vec2 pt = mix(pt0, pt1, a_Position.z);\n    vec4 clip = mix(clip0, clip1, a_Position.z);\n    gl_Position = vec4(clip.w * (2.0 * pt / u_Viewport - 1.0), clip.z, clip.w);\n  }\n\n  v_Dash = vec4(a_Position.x, a_Dash.xyz);\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nin vec4 v_Dash;\n// in vec2 v_Normal;\n\nout vec4 outputColor;\n\nvoid main() {\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n  #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(u_PickingColor, 1.0);\n  } else {\n    outputColor = u_StrokeColor;\n    #ifdef USE_MAP\n        outputColor = u_Color;\n    #endif\n\n    // float blur = 1. - smoothstep(0.98, 1., length(v_Normal));\n    float u_dash_offset = v_Dash.y;\n    float u_dash_array = v_Dash.z;\n    float u_dash_ratio = v_Dash.w;\n    outputColor.a = outputColor.a\n      // * blur\n      * u_Opacity * u_StrokeOpacity\n      * ceil(mod(v_Dash.x + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));\n  }\n}",this.material.defines=p(p({},this.material.defines),lr(Er))}},{key:"createGeometry",value:function(e){var n=this;x(b(r.prototype),"createGeometry",this).call(this,e);var i=[],o=[],a=[],s=[],u=0;e.forEach((function(e){var t=e.parsedStyle,r=t.x1,c=t.y1,l=t.x2,f=t.y2,h=t.z1,d=t.z2,p=t.defX,v=t.defY,y=t.lineCap,m=t.isBillboard,_=n.calcDash(e),g=_.dashOffset,E=_.dashSegmentPercent,T=_.dashRatioInEachSegment;o.push(br[y.value]),a.push(g,E,T,m?1:0),i.push(r.value-p,c.value-v,h.value,l.value-p,f.value-v,d.value),s.push(0+u,2+u,1+u,0+u,3+u,2+u),u+=4})),this.geometry.setIndexBuffer(new Uint32Array(s)),this.geometry.vertexCount=6,this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.POSITION,byteStride:20,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGB,bufferByteOffset:0,location:Er.POSITION,divisor:0},{format:t.Format.F32_RG,bufferByteOffset:12,location:Er.UV,divisor:0}],data:new Float32Array(Tr)}),this.geometry.setVertexBuffer({bufferIndex:gr.POINT,byteStride:24,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGB,bufferByteOffset:0,location:Er.POINTA,divisor:1},{format:t.Format.F32_RGB,bufferByteOffset:12,location:Er.POINTB,divisor:1}],data:new Float32Array(i)}),this.geometry.setVertexBuffer({bufferIndex:gr.CAP,byteStride:4,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_R,bufferByteOffset:0,location:Er.CAP,divisor:1}],data:new Float32Array(o)}),this.geometry.setVertexBuffer({bufferIndex:gr.DASH,byteStride:16,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RGBA,bufferByteOffset:0,location:Er.DASH,divisor:1}],data:new Float32Array(a)})}},{key:"updateAttribute",value:function(e,t,n,i){var o=this;if(x(b(r.prototype),"updateAttribute",this).call(this,e,t,n,i),this.updateBatchedAttribute(e,t,n,i),"x1"===n||"y1"===n||"x2"===n||"y2"===n||"z1"===n||"z2"===n){var a=[];e.forEach((function(e){var t=e.parsedStyle,n=t.x1,r=t.y1,i=t.x2,o=t.y2,s=t.z1,u=t.z2,c=t.defX,l=t.defY;a.push(n.value-c,r.value-l,s.value,i.value-c,o.value-l,u.value)})),this.geometry.updateVertexBuffer(gr.POINT,Er.POINTA,t,new Uint8Array(new Float32Array(a).buffer))}else if("lineDashOffset"===n||"lineDash"===n){var s=[];e.forEach((function(e){var t=o.calcDash(e),n=t.dashOffset,r=t.dashSegmentPercent,i=t.dashRatioInEachSegment;s.push(n,r,i,e.parsedStyle.isBillboard?1:0)})),this.geometry.updateVertexBuffer(gr.DASH,Er.DASH,t,new Uint8Array(new Float32Array(s).buffer))}else if("lineCap"===n){var u=[];e.forEach((function(e){var t=e.parsedStyle.lineCap;u.push(br[t])})),this.geometry.updateVertexBuffer(gr.CAP,Er.CAP,t,new Uint8Array(new Float32Array(u).buffer))}}},{key:"calcDash",value:function(e){var t=e.parsedStyle,n=t.lineDash,r=t.lineDashOffset,i=e.getTotalLength(),o=0,a=1,s=0;if(n&&n.length){o=(r&&r.value||0)/i;var u=n.reduce((function(e,t){return e+t.value}),0);a=u/i,s=n[1].value/u}return{dashOffset:o,dashSegmentPercent:a,dashRatioInEachSegment:s}}}]),r}(t.Instanced),t.InstancedLineMesh=o.__decorate([i.injectable()],t.InstancedLineMesh);var Rr=function(e,t,n,r,i){return{x:(1-i)*e+i*n,y:(1-i)*t+i*r}};function Ar(e,t,n,r,i){var o=1-i;return o*o*o*e+3*t*i*o*o+3*n*i*i*o+r*i*i*i}function Or(e,t,n,r,i,o,a,s,u){var c=Ar(e,n,i,a,u),l=Ar(t,r,o,s,u),f=Rr(e,t,n,r,u),h=Rr(n,r,i,o,u),d=Rr(i,o,a,s,u),p=Rr(f.x,f.y,h.x,h.y,u),v=Rr(h.x,h.y,d.x,d.y,u);return[[e,t,f.x,f.y,p.x,p.y,c,l],[c,l,v.x,v.y,d.x,d.y,a,s]]}function Cr(e,t,n,r,i,a,s,u,c){if(0===c)return function(e,t){for(var n=0,r=e.length,i=0;i<r;i++){n+=Sr(e[i],t[i],e[(i+1)%r],t[(i+1)%r])}return n/2}([e,n,i,s],[t,r,a,u]);var l=Or(e,t,n,r,i,a,s,u,.5),f=o.__spreadArray(o.__spreadArray([],o.__read(l[0]),!1),[c-1],!1),h=o.__spreadArray(o.__spreadArray([],o.__read(l[1]),!1),[c-1],!1);return Cr.apply(void 0,o.__spreadArray([],o.__read(f),!1))+Cr.apply(void 0,o.__spreadArray([],o.__read(h),!1))}var Mr,xr=function(e,t,n,r,i,o,a,s){return Cr(e,t,n,r,i,o,a,s,3)};(Mr=t.JOINT_TYPE||(t.JOINT_TYPE={}))[Mr.NONE=0]="NONE",Mr[Mr.FILL=1]="FILL",Mr[Mr.JOINT_BEVEL=4]="JOINT_BEVEL",Mr[Mr.JOINT_MITER=8]="JOINT_MITER",Mr[Mr.JOINT_ROUND=12]="JOINT_ROUND",Mr[Mr.JOINT_CAP_BUTT=16]="JOINT_CAP_BUTT",Mr[Mr.JOINT_CAP_SQUARE=18]="JOINT_CAP_SQUARE",Mr[Mr.JOINT_CAP_ROUND=20]="JOINT_CAP_ROUND",Mr[Mr.FILL_EXPAND=24]="FILL_EXPAND",Mr[Mr.CAP_BUTT=32]="CAP_BUTT",Mr[Mr.CAP_SQUARE=64]="CAP_SQUARE",Mr[Mr.CAP_ROUND=96]="CAP_ROUND",Mr[Mr.CAP_BUTT2=128]="CAP_BUTT2";var Pr,Nr,Fr;function Ir(e,t,n,r,i,o,a){var s=a[a.length-2],u=a[a.length-1];a.length-=2;var c=function(e){var t=Math.ceil(e/10);t<8?t=8:t>2048&&(t=2048);return t}(xr(s,u,e,t,n,r,i,o)),l=0,f=0,h=0,d=0,p=0;a.push(s,u);for(var v=1,y=0;v<=c;++v)h=(f=(l=1-(y=v/c))*l)*l,p=(d=y*y)*y,a.push(h*s+3*f*y*e+3*l*d*n+p*i,h*u+3*f*y*t+3*l*d*r+p*o)}!function(e){e[e.PACKED=0]="PACKED",e[e.VERTEX_NUM=1]="VERTEX_NUM",e[e.TRAVEL=2]="TRAVEL"}(Pr||(Pr={})),function(e){e[e.PREV=0]="PREV",e[e.POINT1=1]="POINT1",e[e.POINT2=2]="POINT2",e[e.NEXT=3]="NEXT",e[e.VERTEX_JOINT=4]="VERTEX_JOINT",e[e.VERTEX_NUM=5]="VERTEX_NUM",e[e.TRAVEL=6]="TRAVEL"}(Nr||(Nr={})),(Fr=t.Uniform||(t.Uniform={})).MODEL_MATRIX="u_ModelMatrix",Fr.COLOR="u_Color",Fr.STROKE_COLOR="u_StrokeColor",Fr.STROKE_WIDTH="u_StrokeWidth",Fr.INCREASED_LINE_WIDTH_FOR_HIT_TESTING="u_IncreasedLineWidthForHitTesting",Fr.OPACITY="u_Opacity",Fr.FILL_OPACITY="u_FillOpacity",Fr.STROKE_OPACITY="u_StrokeOpacity",Fr.EXPAND="u_Expand",Fr.MITER_LIMIT="u_MiterLimit",Fr.SCALE_MODE="u_ScaleMode",Fr.ALIGNMENT="u_Alignment",Fr.PICKING_COLOR="u_PickingColor",Fr.DASH="u_Dash",Fr.GAP="u_Gap",Fr.DASH_OFFSET="u_DashOffset",Fr.VISIBLE="u_Visible",Fr.Z_INDEX="u_ZIndex",t.LineMesh=function(e){T(r,e);var n=C(r);function r(){return m(this,r),n.apply(this,arguments)}return g(r,[{key:"shouldMerge",value:function(e,t){return!1}},{key:"updateAttribute",value:function(e,n,i,o){var s=this;x(b(r.prototype),"updateAttribute",this).call(this,e,n,i,o),e.forEach((function(e){var n=e.parsedStyle,r=n.stroke,u=n.opacity,c=n.fillOpacity,l=n.strokeOpacity,f=n.lineWidth,h=n.increasedLineWidthForHitTesting,d=n.anchor,p=n.lineDash,v=n.lineDashOffset,y=n.visibility;if("lineJoin"===i||"lineCap"===i||e.nodeName===a.Shape.CIRCLE&&"r"===i||e.nodeName===a.Shape.ELLIPSE&&("rx"===i||"ry"===i)||e.nodeName===a.Shape.RECT&&("width"===i||"height"===i||"radius"===i)||e.nodeName===a.Shape.LINE&&("x1"===i||"y1"===i||"x2"===i||"y2"===i)||e.nodeName===a.Shape.POLYLINE&&"points"===i||e.nodeName===a.Shape.POLYGON&&"points"===i||e.nodeName===a.Shape.PATH&&"path"===i)s.material.geometryDirty=!0,s.material.programDirty=!0;else if("stroke"===i){var m=[0,0,0,0];r instanceof a.CSSRGB&&(m=[Number(r.r)/255,Number(r.g)/255,Number(r.b)/255,Number(r.alpha)]),s.material.setUniforms(E({},t.Uniform.STROKE_COLOR,m))}else if("opacity"===i)s.material.setUniforms(E({},t.Uniform.OPACITY,u.value));else if("fillOpacity"===i)s.material.setUniforms(E({},t.Uniform.FILL_OPACITY,c.value));else if("strokeOpacity"===i)s.material.setUniforms(E({},t.Uniform.STROKE_OPACITY,l.value));else if("lineWidth"===i)s.material.setUniforms(E({},t.Uniform.STROKE_WIDTH,f.value));else if("increasedLineWidthForHitTesting"===i)s.material.setUniforms(E({},t.Uniform.INCREASED_LINE_WIDTH_FOR_HIT_TESTING,h.value));else if("anchor"===i||"modelMatrix"===i){var _=0,g=0,T=e.getGeometryBounds();if(T){var b=T.halfExtents;_=-b[0]*d[0].value*2,g=-b[1]*d[1].value*2}var S=An();xn(S,e.getWorldTransform(),Mn(S,Pn(_,g,0))),s.material.setUniforms(E({},t.Uniform.MODEL_MATRIX,S))}else if("visibility"===i)s.material.setUniforms(E({},t.Uniform.VISIBLE,"visible"===y.value?1:0));else if("lineDash"===i){var R;s.material.setUniforms((E(R={},t.Uniform.DASH,p[0].value||0),E(R,t.Uniform.GAP,p[1].value||0),R))}else if("lineDashOffset"===i)s.material.setUniforms(E({},t.Uniform.DASH_OFFSET,v&&v.value||0));else if("pointerEvents"===i){var A,O=o&&e.isInteractive()&&(null===(A=e.renderable3D)||void 0===A?void 0:A.encodedPickingColor)||[0,0,0];s.material.setUniforms(E({},t.Uniform.PICKING_COLOR,O))}}))}},{key:"changeRenderOrder",value:function(e,n){this.material&&this.material.setUniforms(E({},t.Uniform.Z_INDEX,.005*n))}},{key:"createMaterial",value:function(e){var n,r,i,o;this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_Color;\n  vec4 u_StrokeColor;\n  float u_StrokeWidth;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_StrokeOpacity;\n  float u_Expand;\n  float u_MiterLimit;\n  float u_ScaleMode;\n  float u_Alignment;\n  vec3 u_PickingColor;\n  float u_Dash;\n  float u_Gap;\n  float u_DashOffset;\n  float u_Visible;\n  float u_ZIndex;\n  float u_IncreasedLineWidthForHitTesting;\n};\n\nlayout(location = PREV) in vec2 a_Prev;\nlayout(location = POINT1) in vec2 a_Point1;\nlayout(location = POINT2) in vec2 a_Point2;\nlayout(location = NEXT) in vec2 a_Next;\nlayout(location = VERTEX_JOINT) in float a_VertexJoint;\nlayout(location = VERTEX_NUM) in float a_VertexNum;\nlayout(location = TRAVEL) in float a_Travel;\n\nconst float FILL = 1.0;\nconst float BEVEL = 4.0;\nconst float MITER = 8.0;\nconst float ROUND = 12.0;\nconst float JOINT_CAP_BUTT = 16.0;\nconst float JOINT_CAP_SQUARE = 18.0;\nconst float JOINT_CAP_ROUND = 20.0;\nconst float FILL_EXPAND = 24.0;\nconst float CAP_BUTT = 1.0;\nconst float CAP_SQUARE = 2.0;\nconst float CAP_ROUND = 3.0;\nconst float CAP_BUTT2 = 4.0;\n\nout vec4 v_Distance;\nout vec4 v_Arc;\nout float v_Type;\nout float v_Travel;\n\nvec2 doBisect(\n  vec2 norm, float len, vec2 norm2, float len2, float dy, float inner\n) {\n  vec2 bisect = (norm + norm2) / 2.0;\n  bisect /= dot(norm, bisect);\n  vec2 shift = dy * bisect;\n  if (inner > 0.5) {\n    if (len < len2) {\n      if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {\n        return dy * norm;\n      }\n    } else {\n      if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {\n        return dy * norm;\n      }\n    }\n  }\n  return dy * bisect;\n}\n\nvoid main() {\n  vec2 pointA = (u_ModelMatrix * vec4(a_Point1, 0., 1.0)).xy;\n  vec2 pointB = (u_ModelMatrix * vec4(a_Point2, 0., 1.0)).xy;\n\n  vec2 xBasis = pointB - pointA;\n  float len = length(xBasis);\n  vec2 forward = xBasis / len;\n  vec2 norm = vec2(forward.y, -forward.x);\n\n  float type = a_VertexJoint;\n\n  float lineWidth;\n  if (u_IsPicking > 0.5) {\n    lineWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\n  } else {\n    lineWidth = u_StrokeWidth;\n  }\n\n  if (u_ScaleMode > 2.5) {\n      lineWidth *= length(u_ModelMatrix * vec4(1.0, 0.0, 0.0, 0.0));\n  } else if (u_ScaleMode > 1.5) {\n      lineWidth *= length(u_ModelMatrix * vec4(0.0, 1.0, 0.0, 0.0));\n  } else if (u_ScaleMode > 0.5) {\n      vec2 avgDiag = (u_ModelMatrix * vec4(1.0, 1.0, 0.0, 0.0)).xy;\n      lineWidth *= sqrt(dot(avgDiag, avgDiag) * 0.5);\n  }\n  float capType = floor(type / 32.0);\n  type -= capType * 32.0;\n  v_Arc = vec4(0.0);\n  lineWidth *= 0.5;\n  float lineAlignment = 2.0 * u_Alignment - 1.0;\n\n  vec2 pos;\n\n  if (capType == CAP_ROUND) {\n      if (a_VertexNum < 3.5) {\n      gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n      }\n      type = JOINT_CAP_ROUND;\n      capType = 0.0;\n  }\n\n  if (type >= BEVEL) {\n      float dy = lineWidth + u_Expand;\n      float inner = 0.0;\n      if (a_VertexNum >= 1.5) {\n      dy = -dy;\n      inner = 1.0;\n      }\n\n      vec2 base, next, xBasis2, bisect;\n      float flag = 0.0;\n      float sign2 = 1.0;\n      if (a_VertexNum < 0.5 || a_VertexNum > 2.5 && a_VertexNum < 3.5) {\n      next = (u_ModelMatrix * vec4(a_Prev, 0.0, 1.0)).xy;\n      base = pointA;\n      flag = type - floor(type / 2.0) * 2.0;\n      sign2 = -1.0;\n\n      } else {\n      next = (u_ModelMatrix * vec4(a_Next, 0.0, 1.0)).xy;\n      base = pointB;\n      if (type >= MITER && type < MITER + 3.5) {\n          flag = step(MITER + 1.5, type);\n          // check miter limit here?\n      }\n      }\n      xBasis2 = next - base;\n      float len2 = length(xBasis2);\n      vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;\n      float D = norm.x * norm2.y - norm.y * norm2.x;\n      if (D < 0.0) {\n      inner = 1.0 - inner;\n      }\n      norm2 *= sign2;\n\n      if (abs(lineAlignment) > 0.01) {\n      float shift = lineWidth * lineAlignment;\n      pointA += norm * shift;\n      pointB += norm * shift;\n      if (abs(D) < 0.01) {\n          base += norm * shift;\n      } else {\n          base += doBisect(norm, len, norm2, len2, shift, 0.0);\n      }\n      }\n\n      float collinear = step(0.0, dot(norm, norm2));\n      v_Type = 0.0;\n      float dy2 = -1000.0;\n      float dy3 = -1000.0;\n      if (abs(D) < 0.01 && collinear < 0.5) {\n      if (type >= ROUND && type < ROUND + 1.5) {\n          type = JOINT_CAP_ROUND;\n      }\n      //TODO: BUTT here too\n      }\n\n      if (a_VertexNum < 3.5) {\n      if (abs(D) < 0.01) {\n          pos = dy * norm;\n      } else {\n          if (flag < 0.5 && inner < 0.5) {\n          pos = dy * norm;\n          } else {\n          pos = doBisect(norm, len, norm2, len2, dy, inner);\n          }\n      }\n      if (capType >= CAP_BUTT && capType < CAP_ROUND) {\n          float extra = step(CAP_SQUARE, capType) * lineWidth;\n          vec2 back = -forward;\n          if (a_VertexNum < 0.5 || a_VertexNum > 2.5) {\n          pos += back * (u_Expand + extra);\n          dy2 = u_Expand;\n          } else {\n          dy2 = dot(pos + base - pointA, back) - extra;\n          }\n      }\n      if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {\n          float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;\n          if (a_VertexNum < 0.5 || a_VertexNum > 2.5) {\n          dy3 = dot(pos + base - pointB, forward) - extra;\n          } else {\n          pos += forward * (u_Expand + extra);\n          dy3 = u_Expand;\n          if (capType >= CAP_BUTT) {\n              dy2 -= u_Expand + extra;\n          }\n          }\n      }\n      } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {\n      if (inner > 0.5) {\n          dy = -dy;\n          inner = 0.0;\n      }\n      vec2 d2 = abs(dy) * forward;\n      if (a_VertexNum < 4.5) {\n          dy = -dy;\n          pos = dy * norm;\n      } else if (a_VertexNum < 5.5) {\n          pos = dy * norm;\n      } else if (a_VertexNum < 6.5) {\n          pos = dy * norm + d2;\n          v_Arc.x = abs(dy);\n      } else {\n          dy = -dy;\n          pos = dy * norm + d2;\n          v_Arc.x = abs(dy);\n      }\n      dy2 = 0.0;\n      v_Arc.y = dy;\n      v_Arc.z = 0.0;\n      v_Arc.w = lineWidth;\n      v_Type = 3.0;\n      } else if (abs(D) < 0.01) {\n      pos = dy * norm;\n      } else {\n      if (type >= ROUND && type < ROUND + 1.5) {\n          if (inner > 0.5) {\n          dy = -dy;\n          inner = 0.0;\n          }\n          if (a_VertexNum < 4.5) {\n          pos = doBisect(norm, len, norm2, len2, -dy, 1.0);\n          } else if (a_VertexNum < 5.5) {\n          pos = dy * norm;\n          } else if (a_VertexNum > 7.5) {\n          pos = dy * norm2;\n          } else {\n          pos = doBisect(norm, len, norm2, len2, dy, 0.0);\n          float d2 = abs(dy);\n          if (length(pos) > abs(dy) * 1.5) {\n              if (a_VertexNum < 6.5) {\n              pos.x = dy * norm.x - d2 * norm.y;\n              pos.y = dy * norm.y + d2 * norm.x;\n              } else {\n              pos.x = dy * norm2.x + d2 * norm2.y;\n              pos.y = dy * norm2.y - d2 * norm2.x;\n              }\n          }\n          }\n          vec2 norm3 = normalize(norm + norm2);\n          float sign = step(0.0, dy) * 2.0 - 1.0;\n          v_Arc.x = sign * dot(pos, norm3);\n          v_Arc.y = pos.x * norm3.y - pos.y * norm3.x;\n          v_Arc.z = dot(norm, norm3) * lineWidth;\n          v_Arc.w = lineWidth;\n          dy = -sign * dot(pos, norm);\n          dy2 = -sign * dot(pos, norm2);\n          dy3 = v_Arc.z - v_Arc.x;\n          v_Type = 3.0;\n      } else {\n          float hit = 0.0;\n          if (type >= BEVEL && type < BEVEL + 1.5) {\n          if (dot(norm, norm2) > 0.0) {\n              type = MITER;\n          }\n          }\n          if (type >= MITER && type < MITER + 3.5) {\n          if (inner > 0.5) {\n              dy = -dy;\n              inner = 0.0;\n          }\n          float sign = step(0.0, dy) * 2.0 - 1.0;\n          pos = doBisect(norm, len, norm2, len2, dy, 0.0);\n          if (length(pos) > abs(dy) * u_MiterLimit) {\n              type = BEVEL;\n          } else {\n              if (a_VertexNum < 4.5) {\n              dy = -dy;\n              pos = doBisect(norm, len, norm2, len2, dy, 1.0);\n              } else if (a_VertexNum < 5.5) {\n              pos = dy * norm;\n              } else if (a_VertexNum > 6.5) {\n              pos = dy * norm2;\n              }\n              v_Type = 1.0;\n              dy = -sign * dot(pos, norm);\n              dy2 = -sign * dot(pos, norm2);\n              hit = 1.0;\n          }\n          }\n          if (type >= BEVEL && type < BEVEL + 1.5) {\n          if (inner > 0.5) {\n              dy = -dy;\n              inner = 0.0;\n          }\n          float d2 = abs(dy);\n          vec2 pos3 = vec2(dy * norm.x - d2 * norm.y, dy * norm.y + d2 * norm.x);\n          vec2 pos4 = vec2(dy * norm2.x + d2 * norm2.y, dy * norm2.y - d2 * norm2.x);\n          if (a_VertexNum < 4.5) {\n              pos = doBisect(norm, len, norm2, len2, -dy, 1.0);\n          } else if (a_VertexNum < 5.5) {\n              pos = dy * norm;\n          } else if (a_VertexNum > 7.5) {\n              pos = dy * norm2;\n          } else {\n              if (a_VertexNum < 6.5) {\n              pos = pos3;\n              } else {\n              pos = pos4;\n              }\n          }\n          vec2 norm3 = normalize(norm + norm2);\n          float sign = step(0.0, dy) * 2.0 - 1.0;\n          dy = -sign * dot(pos, norm);\n          dy2 = -sign * dot(pos, norm2);\n          dy3 = (-sign * dot(pos, norm3)) + lineWidth;\n          v_Type = 4.0;\n          hit = 1.0;\n          }\n          if (hit < 0.5) {\n          gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n          return;\n          }\n      }\n      }\n      pos += base;\n      v_Distance = vec4(dy, dy2, dy3, lineWidth) * u_DevicePixelRatio;\n      v_Arc = v_Arc * u_DevicePixelRatio;\n      v_Travel = a_Travel + dot(pos - pointA, vec2(-norm.y, norm.x));\n  }\n\n  gl_Position = u_ProjectionMatrix * u_ViewMatrix * vec4(pos, u_ZIndex, 1.0);\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_Color;\n  vec4 u_StrokeColor;\n  float u_StrokeWidth;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_StrokeOpacity;\n  float u_Expand;\n  float u_MiterLimit;\n  float u_ScaleMode;\n  float u_Alignment;\n  vec3 u_PickingColor;\n  float u_Dash;\n  float u_Gap;\n  float u_DashOffset;\n  float u_Visible;\n  float u_ZIndex;\n  float u_IncreasedLineWidthForHitTesting;\n};\n\nin vec4 v_Distance;\nin vec4 v_Arc;\nin float v_Type;\nin float v_Travel;\n\nout vec4 outputColor;\n\n#define COLOR_SCALE 1. / 255.\n\nvoid main(){\n  if (u_Visible < 0.5) {\n    discard;\n  }\n\n  float alpha = 1.0;\n  float lineWidth = v_Distance.w;\n  if (v_Type < 0.5) {\n    float left = max(v_Distance.x - 0.5, -v_Distance.w);\n    float right = min(v_Distance.x + 0.5, v_Distance.w);\n    float near = v_Distance.y - 0.5;\n    float far = min(v_Distance.y + 0.5, 0.0);\n    float top = v_Distance.z - 0.5;\n    float bottom = min(v_Distance.z + 0.5, 0.0);\n    alpha = max(right - left, 0.0) * max(bottom - top, 0.0) * max(far - near, 0.0);\n  } else if (v_Type < 1.5) {\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\n    alpha = a2 * b2 - a1 * b1;\n  } else if (v_Type < 2.5) {\n    alpha *= max(min(v_Distance.x + 0.5, 1.0), 0.0);\n    alpha *= max(min(v_Distance.y + 0.5, 1.0), 0.0);\n    alpha *= max(min(v_Distance.z + 0.5, 1.0), 0.0);\n  } else if (v_Type < 3.5) {\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\n    float alpha_miter = a2 * b2 - a1 * b1;\n    float alpha_plane = max(min(v_Distance.z + 0.5, 1.0), 0.0);\n    float d = length(v_Arc.xy);\n    float circle_hor = max(min(v_Arc.w, d + 0.5) - max(-v_Arc.w, d - 0.5), 0.0);\n    float circle_vert = min(v_Arc.w * 2.0, 1.0);\n    float alpha_circle = circle_hor * circle_vert;\n    alpha = min(alpha_miter, max(alpha_circle, alpha_plane));\n  } else {\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\n    alpha = a2 * b2 - a1 * b1;\n    alpha *= max(min(v_Distance.z + 0.5, 1.0), 0.0);\n  }\n\n  if (u_Dash + u_Gap > 1.0) {\n    float travel = mod(v_Travel + u_Gap * 0.5 + u_DashOffset, u_Dash + u_Gap) - (u_Gap * 0.5);\n    float left = max(travel - 0.5, -0.5);\n    float right = min(travel + 0.5, u_Gap + 0.5);\n    alpha *= max(0.0, right - left);\n  }\n\n  if (u_IsPicking > 0.5) {\n    vec3 pickingColor = COLOR_SCALE * u_PickingColor;\n    if (pickingColor.x == 0.0 && pickingColor.y == 0.0 && pickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(pickingColor, 1.0);\n  } else {\n    outputColor = u_StrokeColor;\n    outputColor.a *= alpha * u_Opacity * u_StrokeOpacity;\n  }\n}",this.material.defines=p(p({},this.material.defines),lr(Nr));var s=e[0],u=s.parsedStyle,c=u.fill,l=u.stroke,f=u.opacity,h=u.fillOpacity,d=u.strokeOpacity,v=u.lineWidth,y=u.increasedLineWidthForHitTesting,m=u.anchor,_=u.lineDash,g=u.lineDashOffset,T=u.visibility,b=[0,0,0,0];c instanceof a.CSSRGB&&(b=[Number(c.r)/255,Number(c.g)/255,Number(c.b)/255,Number(c.alpha)]);var S=[0,0,0,0];l instanceof a.CSSRGB&&(S=[Number(l.r)/255,Number(l.g)/255,Number(l.b)/255,Number(l.alpha)]);var R=s.isInteractive()&&(null===(n=s.renderable3D)||void 0===n?void 0:n.encodedPickingColor)||[0,0,0],A=0,O=0,C=s.getGeometryBounds();if(C){var M=C.halfExtents;A=-M[0]*m[0].value*2,O=-M[1]*m[1].value*2}var x=An();xn(x,s.getWorldTransform(),Mn(x,Pn(A,O,0))),this.material.setUniforms((E(o={},t.Uniform.MODEL_MATRIX,x),E(o,t.Uniform.COLOR,b),E(o,t.Uniform.STROKE_COLOR,S),E(o,t.Uniform.STROKE_WIDTH,v.value),E(o,t.Uniform.INCREASED_LINE_WIDTH_FOR_HIT_TESTING,y.value),E(o,t.Uniform.OPACITY,f.value),E(o,t.Uniform.FILL_OPACITY,h.value),E(o,t.Uniform.STROKE_OPACITY,d.value),E(o,t.Uniform.EXPAND,1),E(o,t.Uniform.MITER_LIMIT,5),E(o,t.Uniform.SCALE_MODE,1),E(o,t.Uniform.ALIGNMENT,.5),E(o,t.Uniform.PICKING_COLOR,R),E(o,t.Uniform.DASH,_&&(null===(r=_[0])||void 0===r?void 0:r.value)||0),E(o,t.Uniform.GAP,_&&(null===(i=_[1])||void 0===i?void 0:i.value)||0),E(o,t.Uniform.DASH_OFFSET,g&&g.value||0),E(o,t.Uniform.VISIBLE,"visible"===T.value?1:0),E(o,t.Uniform.Z_INDEX,.005*s.sortable.renderOrder),o)),this.material.cullMode=t.CullMode.None}},{key:"createGeometry",value:function(e){var n=Dr(e[0]),r=n.pointsBuffer,i=n.travelBuffer,o=n.instancedCount;this.geometry.setVertexBuffer({bufferIndex:Pr.PACKED,byteStride:48,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,byteStride:12,location:Nr.PREV,divisor:1},{format:t.Format.F32_RG,bufferByteOffset:12,byteStride:12,location:Nr.POINT1,divisor:1},{format:t.Format.F32_R,bufferByteOffset:20,byteStride:12,location:Nr.VERTEX_JOINT,divisor:1},{format:t.Format.F32_RG,bufferByteOffset:24,byteStride:12,location:Nr.POINT2,divisor:1},{format:t.Format.F32_RG,bufferByteOffset:36,byteStride:12,location:Nr.NEXT,divisor:1}],data:new Float32Array(r)}),this.geometry.setVertexBuffer({bufferIndex:Pr.VERTEX_NUM,byteStride:4,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_R,bufferByteOffset:0,byteStride:4,location:Nr.VERTEX_NUM,divisor:0}],data:new Float32Array([0,1,2,3,4,5,6,7,8])}),this.geometry.setVertexBuffer({bufferIndex:Pr.TRAVEL,byteStride:4,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_R,bufferByteOffset:0,byteStride:4,location:Nr.TRAVEL,divisor:1}],data:new Float32Array(i)}),this.geometry.vertexCount=15,this.geometry.instancedCount=o,this.geometry.setIndexBuffer(new Uint32Array([0,2,1,0,3,2,4,6,5,4,7,6,4,7,8]))}}]),r}(t.Instanced),t.LineMesh=o.__decorate([i.injectable()],t.LineMesh);function Dr(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.parsedStyle,i=r.lineCap,o=r.lineJoin,s=e.parsedStyle,u=s.defX,c=s.defY,l=[],h=[];if(e.nodeName===a.Shape.POLYLINE||e.nodeName===a.Shape.POLYGON){if(l=e.parsedStyle.points.points.reduce((function(e,t){return e.push(t[0]-u,t[1]-c),e}),[]),e.nodeName===a.Shape.POLYGON){if(n)return h=f.default(l,[],2),{pointsBuffer:l,travelBuffer:[],triangles:h,instancedCount:Math.round(l.length/2)};var d;l.push(l[0],l[1]),(d=l).push.apply(d,F(wr(l[0],l[1],l[2],l[3])))}}else if(e.nodeName===a.Shape.PATH||e.nodeName===a.Shape.CIRCLE||e.nodeName===a.Shape.ELLIPSE||e.nodeName===a.Shape.RECT){var p;e.nodeName!==a.Shape.PATH?(p=a.parsePath(a.convertToPath(e,!1),e),u=p.rect.x,c=p.rect.y):p=e.parsedStyle.path;var v=p,y=v.zCommandIndexes,m=F(p.curve).map((function(e,t){return y.includes(t)?["Z"]:e})),_=-1;if(m.forEach((function(t){var n=N(t),r=n[0],i=n.slice(1);if("M"===r)_=l.length,l.push(i[0]-u,i[1]-c);else if("C"===r)Ir(i[0]-u,i[1]-c,i[2]-u,i[3]-c,i[4]-u,i[5]-c,l);else if("Z"===r&&(e.nodeName===a.Shape.PATH||e.nodeName===a.Shape.RECT)){var o;l.push(l[_],l[_+1]),(o=l).push.apply(o,F(wr(l[_],l[_+1],l[_+2],l[_+3])))}})),n)return h=f.default(l,[],2),{pointsBuffer:l,travelBuffer:[],triangles:h,instancedCount:Math.round(l.length/2)}}var g=Lr(o.value),E=Br(i.value),T=E;E===t.JOINT_TYPE.CAP_ROUND&&(T=t.JOINT_TYPE.JOINT_CAP_ROUND),E===t.JOINT_TYPE.CAP_BUTT&&(T=t.JOINT_TYPE.JOINT_CAP_BUTT),E===t.JOINT_TYPE.CAP_SQUARE&&(T=t.JOINT_TYPE.JOINT_CAP_SQUARE);for(var b=3*(Math.round(0)+2),S=0,R=[],A=[],O=0;O<l.length;O+=2)O>1&&(S+=Math.sqrt(Math.pow(l[O]-l[O-2],2)+Math.pow(l[O+1]-l[O+1-2],2))),A.push(S),R[b++]=l[O],R[b++]=l[O+1],R[b]=g,0==O&&E!==t.JOINT_TYPE.CAP_ROUND&&(R[b]+=E),O+4>=l.length?R[b]+=T-g:O+2>=l.length&&(R[b]=0),b++;R[b++]=l[l.length-4],R[b++]=l[l.length-3],R[b++]=0,R[0]=l[0],R[1]=l[1],R[2]=0,R[3]=l[2],R[4]=l[3],R[5]=E===t.JOINT_TYPE.CAP_ROUND?E:0;var C=Math.round(l.length/2);return{pointsBuffer:R,travelBuffer:A,triangles:h,instancedCount:C}}function Lr(e){var n;switch(e){case a.LineJoin.BEVEL:n=t.JOINT_TYPE.JOINT_BEVEL;break;case a.LineJoin.ROUND:n=t.JOINT_TYPE.JOINT_ROUND;break;default:n=t.JOINT_TYPE.JOINT_MITER}return n}function Br(e){var n;switch(e){case a.LineCap.SQUARE:n=t.JOINT_TYPE.CAP_SQUARE;break;case a.LineCap.ROUND:n=t.JOINT_TYPE.CAP_ROUND;break;default:n=t.JOINT_TYPE.CAP_BUTT}return n}function wr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,i=[n-e,r-t],o=.01;return[e+i[0]*o,t+i[1]*o]}t.FillMesh=function(e){T(r,e);var n=C(r);function r(){return m(this,r),n.apply(this,arguments)}return g(r,[{key:"shouldMerge",value:function(e,t){return!1}},{key:"createGeometry",value:function(e){var n=Dr(e[0],!0),r=n.triangles,i=n.pointsBuffer;this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.POSITION,byteStride:8,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,byteStride:8,location:t.VertexAttributeLocation.POSITION}],data:new Float32Array(i)}),this.geometry.vertexCount=r.length,this.geometry.setIndexBuffer(new Uint32Array(r))}},{key:"createMaterial",value:function(e){var n,r;this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_Color;\n  vec3 u_PickingColor;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_Visible;\n  float u_ZIndex;\n};\n\nlayout(location = POSITION) in vec2 a_Position;\n\nvoid main() {\n  gl_Position = u_ProjectionMatrix * u_ViewMatrix * u_ModelMatrix * vec4(a_Position, u_ZIndex, 1.0);\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  mat4 u_ModelMatrix;\n  vec4 u_Color;\n  vec3 u_PickingColor;\n  float u_Opacity;\n  float u_FillOpacity;\n  float u_Visible;\n  float u_ZIndex;\n};\n\nout vec4 outputColor;\n\n#define COLOR_SCALE 1. / 255.\n\nvoid main(){\n  if (u_Visible < 0.5) {\n    discard;\n  }\n\n  if (u_IsPicking > 0.5) {\n    vec3 pickingColor = COLOR_SCALE * u_PickingColor;\n    if (pickingColor.x == 0.0 && pickingColor.y == 0.0 && pickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(pickingColor, 1.0);\n  } else {\n    outputColor = u_Color;\n    outputColor.a = outputColor.a * u_Opacity * u_FillOpacity;\n  }\n}";var i=e[0],o=i.parsedStyle,s=o.fill,u=o.opacity,c=o.fillOpacity,l=o.anchor,f=o.visibility,h=[0,0,0,0];s instanceof a.CSSRGB&&(h=[Number(s.r)/255,Number(s.g)/255,Number(s.b)/255,Number(s.alpha)]);var d=i.isInteractive()&&(null===(n=i.renderable3D)||void 0===n?void 0:n.encodedPickingColor)||[0,0,0],p=0,v=0,y=i.getGeometryBounds();if(y){var m=y.halfExtents;p=-m[0]*l[0].value*2,v=-m[1]*l[1].value*2}var _=An();xn(_,i.getWorldTransform(),Mn(_,Pn(p,v,0))),this.material.setUniforms((E(r={},t.Uniform.MODEL_MATRIX,_),E(r,t.Uniform.COLOR,h),E(r,t.Uniform.PICKING_COLOR,d),E(r,t.Uniform.OPACITY,u.value),E(r,t.Uniform.FILL_OPACITY,c.value),E(r,t.Uniform.VISIBLE,"visible"===f.value?1:0),E(r,t.Uniform.Z_INDEX,.005*i.sortable.renderOrder),r))}},{key:"updateAttribute",value:function(e,n,i,o){var s=this;x(b(r.prototype),"updateAttribute",this).call(this,e,n,i,o),e.forEach((function(e){var n=e.parsedStyle,r=n.fill,u=n.opacity,c=n.fillOpacity,l=n.anchor,f=n.visibility;if("lineJoin"===i||"lineCap"===i||e.nodeName===a.Shape.RECT&&("width"===i||"height"===i||"radius"===i)||e.nodeName===a.Shape.LINE&&("x1"===i||"y1"===i||"x2"===i||"y2"===i)||e.nodeName===a.Shape.POLYLINE&&"points"===i||e.nodeName===a.Shape.POLYGON&&"points"===i||e.nodeName===a.Shape.PATH&&"path"===i)s.material.geometryDirty=!0,s.material.programDirty=!0;else if("fill"===i){var h=[0,0,0,0];r instanceof a.CSSRGB&&(h=[Number(r.r)/255,Number(r.g)/255,Number(r.b)/255,Number(r.alpha)]),s.material.setUniforms(E({},t.Uniform.COLOR,h))}else if("opacity"===i)s.material.setUniforms(E({},t.Uniform.OPACITY,u.value));else if("fillOpacity"===i)s.material.setUniforms(E({},t.Uniform.FILL_OPACITY,c.value));else if("anchor"===i||"modelMatrix"===i){var d=0,p=0,v=e.getGeometryBounds();if(v){var y=v.halfExtents;d=-y[0]*l[0].value*2,p=-y[1]*l[1].value*2}var m=An();xn(m,e.getWorldTransform(),Mn(m,Pn(d,p,0))),s.material.setUniforms(E({},t.Uniform.MODEL_MATRIX,m))}else if("visibility"===i)s.material.setUniforms(E({},t.Uniform.VISIBLE,"visible"===f.value?1:0));else if("pointerEvents"===i){var _,g=o&&e.isInteractive()&&(null===(_=e.renderable3D)||void 0===_?void 0:_.encodedPickingColor)||[0,0,0];s.material.setUniforms(E({},t.Uniform.PICKING_COLOR,g))}}))}},{key:"changeRenderOrder",value:function(e,n){this.material&&this.material.setUniforms(E({},t.Uniform.Z_INDEX,.005*n))}}]),r}(t.Instanced),t.FillMesh=o.__decorate([i.injectable()],t.FillMesh);function kr(e,t,n,r){var i=t.width,o=t.height;if(r){if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return e.width=i,e.height=o,e.data=r,e}function Ur(e,t,n,r,i,o){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=e.data,s=t.data,u=0;u<i.height;u++)for(var c=((n.y+u)*e.width+n.x)*o,l=((r.y+u)*t.width+r.x)*o,f=0;f<i.width*o;f++)s[l+f]=a[c+f];return t}t.ImageMesh=function(e){T(r,e);var n=C(r);function r(){return m(this,r),n.apply(this,arguments)}return g(r,[{key:"shouldMerge",value:function(e,t){var n=x(b(r.prototype),"shouldMerge",this).call(this,e,t);return!!n&&this.instance.parsedStyle.img===e.parsedStyle.img}},{key:"createMaterial",value:function(e){var t=e[0].parsedStyle.img;this.material.defines=p({},this.material.defines),this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = POSITION) in vec2 a_Size;\n\n#ifdef USE_UV\n  layout(location = UV) in vec2 a_Uv;\n  out vec2 v_Uv;\n#endif\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n\n  vec2 offset = (a_Uv - u_Anchor.xy) * a_Size;\n\n  gl_Position = project(vec4(offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n\n  #ifdef USE_UV\n  v_Uv = a_Uv;\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_Uv.y = 1.0 - v_Uv.y;\n  #endif\n#endif\n\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n#ifdef USE_UV\n  in vec2 v_Uv;\n#endif\n#ifdef USE_MAP\n  uniform sampler2D u_Map;\n#endif\n\nout vec4 outputColor;\n\nvoid main() {\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n  #ifdef USE_MAP\n  #ifdef USE_PATTERN\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #else\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\n    u_Color = texelColor;\n  #endif\n#endif\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(u_PickingColor, 1.0);\n  } else {\n    outputColor = u_Color;\n    outputColor.a = outputColor.a * u_Opacity;\n  }\n}";var n=this.texturePool.getOrCreateTexture(this.device,t);this.material.setUniforms({u_Map:n})}},{key:"createGeometry",value:function(e){x(b(r.prototype),"createGeometry",this).call(this,e);var n=[],i=[],o=[];e.forEach((function(e,t){var r=4*t,a=e.parsedStyle,s=a.width,u=a.height;n.push(s.value,u.value),i.push(0,0,1,0,1,1,0,1),o.push(0+r,2+r,1+r,0+r,3+r,2+r)})),this.geometry.setIndexBuffer(new Uint32Array(o)),this.geometry.vertexCount=6,this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.POSITION,byteStride:8,frequency:t.VertexBufferFrequency.PerInstance,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,location:t.VertexAttributeLocation.POSITION}],data:new Float32Array(n)}),this.geometry.setVertexBuffer({bufferIndex:t.VertexAttributeBufferIndex.UV,byteStride:8,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,location:t.VertexAttributeLocation.UV}],data:new Float32Array(i)})}},{key:"updateAttribute",value:function(e,n,i,o){if(x(b(r.prototype),"updateAttribute",this).call(this,e,n,i,o),this.updateBatchedAttribute(e,n,i,o),"width"===i||"height"===i){var a=[];e.forEach((function(e){var t=e.parsedStyle,n=t.width,r=t.height;a.push(n.value,r.value)})),this.geometry.updateVertexBuffer(t.VertexAttributeBufferIndex.POSITION,t.VertexAttributeLocation.POSITION,n,new Uint8Array(new Float32Array(a).buffer))}else if("img"===i){var s=this.texturePool.getOrCreateTexture(this.device,o);this.material.setUniforms({u_Map:s})}}}]),r}(t.Instanced),t.ImageMesh=o.__decorate([i.injectable()],t.ImageMesh);var Gr=function(){function e(t,n){m(this,e),this.width=void 0,this.height=void 0,this.data=void 0,kr(this,t,1,n)}return g(e,[{key:"resize",value:function(e){!function(e,t,n){var r=t.width,i=t.height;if(r!==e.width||i!==e.height){var o=kr({},{width:r,height:i},n);Ur(e,o,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,r),height:Math.min(e.height,i)},n),e.width=r,e.height=i,e.data=o.data}}(this,e,1)}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,n,r,i){Ur(e,t,n,r,i,1)}}]),e}();var jr=g((function e(t){m(this,e),this.image=void 0,this.positions=void 0;var n={},r=[];for(var i in t){var o=t[i],a=n[i]={};for(var s in o){var u=o[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};r.push(c),a[s]={rect:c,metrics:u.metrics}}}}var l=function(e){var t,n=0,r=0,i=k(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;n+=o.w*o.h,r=Math.max(r,o.w)}}catch(v){i.e(v)}finally{i.f()}e.sort((function(e,t){return t.h-e.h}));var a,s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),r),h:1/0}],u=0,c=0,l=k(e);try{for(l.s();!(a=l.n()).done;)for(var f=a.value,h=s.length-1;h>=0;h--){var d=s[h];if(!(f.w>d.w||f.h>d.h)){if(f.x=d.x,f.y=d.y,c=Math.max(c,f.y+f.h),u=Math.max(u,f.x+f.w),f.w===d.w&&f.h===d.h){var p=s.pop();h<s.length&&(s[h]=p)}else f.h===d.h?(d.x+=f.w,d.w-=f.w):f.w===d.w?(d.y+=f.h,d.h-=f.h):(s.push({x:d.x+f.w,y:d.y,w:d.w-f.w,h:f.h}),d.y+=f.h,d.h-=f.h);break}}}catch(v){l.e(v)}finally{l.f()}return{w:u,h:c,fill:n/(u*c)||0}}(r),f=l.w,h=l.h,d=new Gr({width:f||1,height:h||1});for(var p in t){var v=t[p];for(var y in v){var _=v[+y];if(_&&0!==_.bitmap.width&&0!==_.bitmap.height){var g=n[p][y].rect;Gr.copy(_.bitmap,d,{x:0,y:0},{x:g.x+1,y:g.y+1},_.bitmap)}}}this.image=d,this.positions=n}));function Vr(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}var Wr=function(){function e(){m(this,e),this.sdfGeneratorCache={},this.textMetricsCache={},this.glyphAtlas=void 0,this.glyphMap={},this.glyphAtlasTexture=void 0}return g(e,[{key:"getMap",value:function(){return this.glyphMap}},{key:"getAtlas",value:function(){return this.glyphAtlas}},{key:"getAtlasTexture",value:function(){return this.glyphAtlasTexture}},{key:"layout",value:function(e,t,n,r,i,o,a){var s=this,u=[],c=o,l=a,f="right"===r||"end"===r?1:"left"===r||"start"===r?0:.5;return e.forEach((function(e){var r=u.length;Array.from(e).forEach((function(e){var n=s.glyphMap[t],r=e.charCodeAt(0),o=n&&n[r];o&&(u.push({glyph:r,x:c,y:l,scale:1,fontStack:t}),c+=o.metrics.advance+i)}));for(var o=c-i,a=r;a<u.length;a++)u[a].x=u[a].x-f*o;c=0,l+=n})),u}},{key:"generateAtlas",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,u=[];this.glyphMap[n]||(u=Vr());var c=Object.keys(this.glyphMap[n]||{});if(Array.from(new Set(a.split(""))).forEach((function(e){-1===c.indexOf(e.charCodeAt(0).toString())&&u.push(e)})),u.length){var l=u.map((function(t){return e.generateSDF(n,r,i,o,t)})).reduce((function(e,t){return e[t.id]=t,e}),{});this.glyphMap[n]=p(p({},this.glyphMap[n]),l),this.glyphAtlas=new jr(this.glyphMap);var f=this.glyphAtlas.image,h=f.width,d=f.height,v=f.data;this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.glyphAtlasTexture=s.createTexture(p(p({},de(t.Format.ALPHA,h,d,1)),{},{pixelStore:{unpackFlipY:!1,unpackAlignment:1},immutable:!1})),this.glyphAtlasTexture.setImageData([v],0)}}},{key:"generateSDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=i.charCodeAt(0),a=this.sdfGeneratorCache[e];a||(a=this.sdfGeneratorCache[e]=new h.default({fontSize:24,fontFamily:t,fontWeight:n,fontStyle:r,buffer:3,radius:8,cutoff:.25})),this.textMetricsCache[e]||(this.textMetricsCache[e]={}),this.textMetricsCache[e][i]||(this.textMetricsCache[e][i]=a.ctx.measureText(i).width);var s=a.draw(i),u=s.data,c=s.width,l=s.height,f=s.glyphWidth,d=s.glyphHeight,p=s.glyphLeft,v=s.glyphTop,y=s.glyphAdvance;return{id:o,bitmap:new Gr({width:c,height:l},u),metrics:{width:f,height:d,left:p,top:v-24+3,advance:y}}}}]),e}();Wr=o.__decorate([i.injectable()],Wr);var Hr,Xr;!function(e){e[e.TEX=13]="TEX",e[e.OFFSET=14]="OFFSET"}(Hr||(Hr={})),(Xr=t.TextUniform||(t.TextUniform={})).SDF_MAP="u_SDFMap",Xr.SDF_MAP_SIZE="u_SDFMapSize",Xr.FONT_SIZE="u_FontSize",Xr.GAMMA_SCALE="u_GammaScale",Xr.STROKE_BLUR="u_StrokeBlur",Xr.HAS_STROKE="u_HasStroke",t.TextMesh=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return(e=n.call.apply(n,[this].concat(i))).glyphManager=void 0,e}return g(r,[{key:"shouldMerge",value:function(e,t){var n=x(b(r.prototype),"shouldMerge",this).call(this,e,t);if(!n)return!1;if(this.index!==t)return!1;var i=this.instance;return i.parsedStyle.fontSize.value===e.parsedStyle.fontSize.value&&(i.parsedStyle.metrics.font===e.parsedStyle.metrics.font&&!["fontFamily","fontWeight","textBaseline","letterSpacing"].some((function(t){return i.parsedStyle[t]!==e.parsedStyle[t]})))}},{key:"createGeometry",value:function(e){var n=this,r=this.instance.parsedStyle,i=r.textBaseline,o=r.fontSize,s=r.letterSpacing,u=void 0===s?0:s,c=24/o.value,l=[],f=[],h=[],d=0;e.forEach((function(e){var t=e.parsedStyle,r=t.metrics,o=t.dx,s=t.dy,p=r.font,v=r.lines,y=r.height,m=r.lineHeight,_=0,g=0;o&&o.unit===a.UnitType.kPixels&&(_+=o.value),s&&s.unit===a.UnitType.kPixels&&(g+=s.value);var E=0;"middle"===i.value?E=-y/2:"bottom"===i.value?E=-y:"top"===i.value||"hanging"===i.value?E=0:"alphabetic"===i.value?E=.25*m-y:"ideographic"===i.value&&(E=-y);var T=n.glyphManager.getAtlas(),b=n.buildTextBuffers({object:e,lines:v,fontStack:p,lineHeight:c*m,offsetX:c*_,offsetY:c*(E+g),letterSpacing:c*u,glyphAtlas:T,indicesOffset:d}),S=b.indicesOffset,R=b.indexBuffer,A=b.charUVOffsetBuffer,O=b.charPackedBuffer;d=S,h.push.apply(h,F(O)),f.push.apply(f,F(A)),l.push.apply(l,F(R))})),this.geometry.vertexCount=l.length,this.geometry.setIndexBuffer(new Uint32Array(l)),this.geometry.setVertexBuffer({bufferIndex:0,byteStride:144,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RGBA,bufferByteOffset:0,location:t.VertexAttributeLocation.MODEL_MATRIX0},{format:t.Format.F32_RGBA,bufferByteOffset:16,location:t.VertexAttributeLocation.MODEL_MATRIX1},{format:t.Format.F32_RGBA,bufferByteOffset:32,location:t.VertexAttributeLocation.MODEL_MATRIX2},{format:t.Format.F32_RGBA,bufferByteOffset:48,location:t.VertexAttributeLocation.MODEL_MATRIX3},{format:t.Format.F32_RGBA,bufferByteOffset:64,location:t.VertexAttributeLocation.COLOR},{format:t.Format.F32_RGBA,bufferByteOffset:80,location:t.VertexAttributeLocation.STROKE_COLOR},{format:t.Format.F32_RGBA,bufferByteOffset:96,location:t.VertexAttributeLocation.PACKED_STYLE1},{format:t.Format.F32_RGBA,bufferByteOffset:112,location:t.VertexAttributeLocation.PACKED_STYLE2},{format:t.Format.F32_RGBA,bufferByteOffset:128,location:t.VertexAttributeLocation.PICKING_COLOR}],data:new Float32Array(h)}),this.geometry.setVertexBuffer({bufferIndex:1,byteStride:16,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,location:Hr.TEX},{format:t.Format.F32_RG,bufferByteOffset:8,location:Hr.OFFSET}],data:new Float32Array(f)})}},{key:"createMaterial",value:function(e){var n;this.material.vertexShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  vec2 u_SDFMapSize;\n  float u_FontSize;\n  float u_GammaScale;\n  float u_StrokeBlur;\n  float u_HasStroke;\n};\n\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\nlayout(location = COLOR) in vec4 a_Color;\nlayout(location = STROKE_COLOR) in vec4 a_StrokeColor;\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\n\nout vec4 v_PickingResult;\nout vec4 v_Color;\nout vec4 v_StrokeColor;\nout vec4 v_StylePacked1;\nout vec4 v_StylePacked2;\n\n#define COLOR_SCALE 1. / 255.\nvoid setPickingColor(vec3 pickingColor) {\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\n  return pm * vm * mm * pos;\n}\n\nlayout(location = TEX) in vec2 a_Tex;\nlayout(location = OFFSET) in vec2 a_Offset;\n\nout vec2 v_UV;\nout float v_GammaScale;\n\nvoid main() {\n  mat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\nvec4 u_StrokeColor = a_StrokeColor;\nfloat u_Opacity = a_StylePacked1.x;\nfloat u_FillOpacity = a_StylePacked1.y;\nfloat u_StrokeOpacity = a_StylePacked1.z;\nfloat u_StrokeWidth = a_StylePacked1.w;\nfloat u_ZIndex = a_PickingColor.w;\nvec2 u_Anchor = a_StylePacked2.yz;\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\n\nsetPickingColor(a_PickingColor.xyz);\n\nv_Color = a_Color;\nv_StrokeColor = a_StrokeColor;\nv_StylePacked1 = a_StylePacked1;\nv_StylePacked2 = a_StylePacked2;\n\n#ifdef CLIPSPACE_NEAR_ZERO\n    gl_Position.z = gl_Position.z * 0.5 + 0.5;\n#endif\n\n  v_UV = a_Tex / u_SDFMapSize;\n\n  float fontScale = u_FontSize / 24.;\n\n  gl_Position = project(vec4(a_Offset * fontScale, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\n  v_GammaScale = gl_Position.w;\n}",this.material.fragmentShader="#define GLSLIFY 1\nlayout(std140) uniform ub_SceneParams {\n  mat4 u_ProjectionMatrix;\n  mat4 u_ViewMatrix;\n  vec3 u_CameraPosition;\n  float u_DevicePixelRatio;\n  vec2 u_Viewport;\n  float u_IsOrtho;\n  float u_IsPicking;\n};\nlayout(std140) uniform ub_ObjectParams {\n  vec2 u_SDFMapSize;\n  float u_FontSize;\n  float u_GammaScale;\n  float u_StrokeBlur;\n  float u_HasStroke;\n};\n\nin vec4 v_PickingResult;\nin vec4 v_Color;\nin vec4 v_StrokeColor;\nin vec4 v_StylePacked1;\nin vec4 v_StylePacked2;\n\nuniform sampler2D u_SDFMap;\n\n#define SDF_PX 8.0\n\nin vec2 v_UV;\nin float v_GammaScale;\n\nout vec4 outputColor;\n\nvoid main() {\n  vec4 u_Color = v_Color;\nvec4 u_StrokeColor = v_StrokeColor;\nfloat u_Opacity = v_StylePacked1.x;\nfloat u_FillOpacity = v_StylePacked1.y;\nfloat u_StrokeOpacity = v_StylePacked1.z;\nfloat u_StrokeWidth = v_StylePacked1.w;\nfloat u_Visible = v_StylePacked2.x;\nvec3 u_PickingColor = v_PickingResult.xyz;\n\nif (u_Visible < 0.5) {\n    discard;\n}\n\n  float dist = texture(SAMPLER_2D(u_SDFMap), v_UV).a;\n\n  float EDGE_GAMMA = 0.105 / u_DevicePixelRatio;\n  float fontScale = u_FontSize / 24.0;\n  highp float gamma = EDGE_GAMMA / (fontScale * u_GammaScale);\n  lowp vec4 color = u_Color;\n  lowp float buff = (256.0 - 64.0) / 256.0;\n  float opacity = u_FillOpacity;\n  if (u_HasStroke > 0.5 && u_StrokeWidth > 0.0) {\n    color = u_StrokeColor;\n    gamma = (u_StrokeBlur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_GammaScale);\n    buff = (6.0 - u_StrokeWidth / fontScale / 2.0) / SDF_PX;\n    opacity = u_StrokeOpacity;\n  }\n\n  highp float gamma_scaled = gamma * v_GammaScale;\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n  opacity *= alpha * u_Opacity;\n\n  if (u_IsPicking > 0.5) {\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\n      discard;\n    }\n    outputColor = vec4(u_PickingColor, 1.0);\n  } else {\n\n    if (opacity < 0.001) {\n      discard;\n    }\n\n    outputColor = color;\n    outputColor.a *= opacity;\n  }\n}",this.material.cullMode=t.CullMode.Back,this.material.defines=p(p({},this.material.defines),lr(Hr));var r=this.instance.parsedStyle,i=r.fontSize,o=r.fontFamily,a=void 0===o?"":o,s=r.fontWeight,u=r.fontStyle,c=r.metrics.font,l=e.map((function(e){return e.parsedStyle.text})).join("");this.glyphManager.generateAtlas(c,a,s.toString(),u.toString(),l,this.device);var f=this.glyphManager.getAtlasTexture(),h=this.glyphManager.getAtlas();this.device.setResourceName(f,"TextSDF Texture");var d=h.image,v=d.width,y=d.height;this.material.setUniforms((E(n={},t.TextUniform.SDF_MAP,f),E(n,t.TextUniform.SDF_MAP_SIZE,[v,y]),E(n,t.TextUniform.FONT_SIZE,i.value),E(n,t.TextUniform.GAMMA_SCALE,1),E(n,t.TextUniform.STROKE_BLUR,.2),E(n,t.TextUniform.HAS_STROKE,this.index),n))}},{key:"changeRenderOrder",value:function(e,t){this.material&&(this.material.programDirty=!0,this.material.geometryDirty=!0)}},{key:"updateAttribute",value:function(e,t,n,r){"text"===n||"fontFamily"===n||"fontSize"===n||"fontWeight"===n||"fontStyle"===n||"fontVariant"===n||"textBaseline"===n||"letterSpacing"===n||"wordWrapWidth"===n||"lineHeight"===n||"wordWrap"===n||"textAlign"===n||"modelMatrix"===n||"visibility"===n||"dx"===n||"dy"===n?(this.material.programDirty=!0,this.material.geometryDirty=!0,this.material.textureDirty=!0):"fill"!==n&&"fillOpacity"!==n&&"stroke"!==n&&"strokeOpacity"!==n&&"opacity"!==n&&"lineWidth"!==n&&"visibility"!==n&&"pointerEvents"!==n||(this.material.geometryDirty=!0)}},{key:"buildTextBuffers",value:function(e){var t,n=e.object,r=e.lines,i=e.fontStack,o=e.lineHeight,s=e.letterSpacing,u=e.offsetX,c=e.offsetY,l=e.glyphAtlas,f=e.indicesOffset,h=n.parsedStyle,d=h.textAlign,p=h.fill,v=h.stroke,y=h.opacity,m=h.fillOpacity,_=h.strokeOpacity,g=h.lineWidth,E=h.visibility,T=[0,0,0,0];p instanceof a.CSSRGB&&(T=[Number(p.r)/255,Number(p.g)/255,Number(p.b)/255,Number(p.alpha)]);var b=[0,0,0,0];v instanceof a.CSSRGB&&(b=[Number(v.r)/255,Number(v.g)/255,Number(v.b)/255,Number(v.alpha)]);var S=n.isInteractive()&&(null===(t=n.renderable3D)||void 0===t?void 0:t.encodedPickingColor)||[0,0,0],R=On(An(),n.getWorldTransform()),A=[],O=[],C=[],M=f;return function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=t[i.fontStack],a=o&&o[i.glyph];if(a){var s=a.rect;if(s){var u=a.metrics.advance*i.scale/2,c=[i.x+u,i.y],l=(a.metrics.left-4)*i.scale-u+c[0],f=(-a.metrics.top-4)*i.scale+c[1],h=l+s.w*i.scale,d=f+s.h*i.scale,p={x:l,y:f},v={x:h,y:f},y={x:l,y:d},m={x:h,y:d};n.push({tl:p,tr:v,bl:y,br:m,tex:s,glyphOffset:[0,0]})}}}return n}(this.glyphManager.layout(r,i,o,d.value,s,u,c),l.positions).forEach((function(e){var t=[].concat(F(R),F(T),F(b),[y.value,m.value,_.value,g.value,"visible"===E.value?1:0,0,0,0],F(S),[.005*n.sortable.renderOrder]);A.push.apply(A,F(t).concat(F(t),F(t),F(t))),O.push(e.tex.x,e.tex.y,e.tl.x,e.tl.y),O.push(e.tex.x+e.tex.w,e.tex.y,e.tr.x,e.tr.y),O.push(e.tex.x+e.tex.w,e.tex.y+e.tex.h,e.br.x,e.br.y),O.push(e.tex.x,e.tex.y+e.tex.h,e.bl.x,e.bl.y),C.push(0+M,2+M,1+M),C.push(2+M,0+M,3+M),M+=4})),{indexBuffer:C,charUVOffsetBuffer:O,charPackedBuffer:A,indicesOffset:M}}}]),r}(t.Instanced),o.__decorate([i.inject(Wr),o.__metadata("design:type",Wr)],t.TextMesh.prototype,"glyphManager",void 0),t.TextMesh=o.__decorate([i.injectable()],t.TextMesh),t.MeshMesh=function(e){T(n,e);var t=C(n);function n(){return m(this,n),t.apply(this,arguments)}return g(n,[{key:"shouldMerge",value:function(e,t){var r=x(b(n.prototype),"shouldMerge",this).call(this,e,t);return!!r&&(this.instance.nodeName!==a.Shape.MESH||this.instance.parsedStyle.material===e.parsedStyle.material&&this.instance.parsedStyle.geometry===e.parsedStyle.geometry)}},{key:"updateAttribute",value:function(e,t,r,i){x(b(n.prototype),"updateAttribute",this).call(this,e,t,r,i),this.updateBatchedAttribute(e,t,r,i)}},{key:"createMaterial",value:function(e){var t=this.instance.parsedStyle.material;this.material=t,this.observeMaterialChanged()}},{key:"createGeometry",value:function(e){var t=this.instance.parsedStyle.geometry;this.geometry=t,x(b(n.prototype),"createGeometry",this).call(this,e),this.geometry.build(e),this.observeGeometryChanged()}}]),n}(t.Instanced),t.MeshMesh=o.__decorate([i.injectable()],t.MeshMesh);var zr=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).meshes=[t.SDFMesh,t.LineMesh],e}return g(r,[{key:"shouldSubmitRenderInst",value:function(e,t){if(0===t&&e.parsedStyle.fill.isNone)return!1;return 1!==t||this.needDrawStrokeSeparately(e)}},{key:"needDrawStrokeSeparately",value:function(e){var t=e.parsedStyle,n=t.fill,r=t.stroke,i=t.lineDash,o=t.lineWidth,a=t.strokeOpacity,s=n&&!n.isNone,u=r&&!r.isNone,c=i&&i.length&&i.every((function(e){return 0!==e.value}));return!s||u&&o.value>0&&(a.value<1||c)}}]),r}(t.Batch);zr=o.__decorate([i.injectable({token:[{token:tr,named:a.Shape.CIRCLE},{token:tr,named:a.Shape.ELLIPSE}]})],zr);var Yr=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).meshes=[t.FillMesh,t.LineMesh],e}return g(r,[{key:"shouldSubmitRenderInst",value:function(e,t){var n=e.parsedStyle,r=n.fill,i=n.strokeOpacity,o=n.lineDash,s=n.lineWidth,u=e.nodeName;if(0===t&&(e.nodeName===a.Shape.POLYLINE||r.isNone))return!1;if(1===t){if(0===i.value||0===s.value)return!1;var c=o&&o.length&&o.every((function(e){return 0!==e.value}));if(u===a.Shape.CIRCLE||u===a.Shape.ELLIPSE)return c}return!0}}]),r}(t.Batch);Yr=o.__decorate([i.injectable({token:[{token:tr,named:a.Shape.POLYLINE},{token:tr,named:a.Shape.PATH},{token:tr,named:a.Shape.POLYGON},{token:tr,named:a.Shape.RECT}]})],Yr);var Kr=function(e){T(n,e);var t=C(n);function n(){var e;m(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).meshes=[],e}return g(n,[{key:"shouldSubmitRenderInst",value:function(e,t){return!0}}]),n}(t.Batch);Kr=o.__decorate([i.injectable({token:[{token:tr,named:a.Shape.GROUP}]})],Kr);var qr=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).meshes=[t.ImageMesh],e}return g(r,[{key:"shouldSubmitRenderInst",value:function(e,t){return!0}}]),r}(t.Batch);qr=o.__decorate([i.injectable({token:[{token:tr,named:a.Shape.IMAGE}]})],qr);var Zr=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).meshes=[t.TextMesh,t.TextMesh],e}return g(r,[{key:"shouldSubmitRenderInst",value:function(e,t){var n=e.parsedStyle,r=n.stroke,i=n.lineWidth;return!(!(r&&i&&i.value)&&0===t)}},{key:"beforeUploadUBO",value:function(e,n,r){n.material.setUniforms(E({},t.TextUniform.HAS_STROKE,1-n.index))}}]),r}(t.Batch);Zr=o.__decorate([i.injectable({token:[{token:tr,named:a.Shape.TEXT}]})],Zr);var Jr=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).meshes=[t.InstancedLineMesh],e}return g(r,[{key:"shouldSubmitRenderInst",value:function(e,t){return!0}}]),r}(t.Batch);Jr=o.__decorate([i.injectable({token:{token:tr,named:a.Shape.LINE}})],Jr);var Qr=function(e){T(r,e);var n=C(r);function r(){var e;m(this,r);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).meshes=[t.MeshMesh],e}return g(r)}(t.Batch);Qr=o.__decorate([i.injectable({token:[{token:tr,named:a.Shape.MESH}]})],Qr);var $r=["style"],ei=function(e){T(n,e);var t=C(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.style,i=R(e,$r);return m(this,n),t.call(this,p({type:n.tag,style:p({intensity:Math.PI},r)},i))}return g(n)}(a.DisplayObject);ei.tag="light";var ti,ni=["style"];(ti=t.FogType||(t.FogType={}))[ti.NONE=0]="NONE",ti[ti.EXP=1]="EXP",ti[ti.EXP2=2]="EXP2",ti[ti.LINEAR=3]="LINEAR";var ri=function(e){T(r,e);var n=C(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.style,o=R(e,ni);return m(this,r),n.call(this,p({type:r.tag,style:p({type:t.FogType.NONE,fill:"black",start:1,end:1e3,density:0},i)},o))}return g(r)}(a.DisplayObject);ri.tag="fog";var ii,oi,ai,si,ui,ci=i.Syringe.defineToken("DeviceContribution");!function(e){e.PROJECTION_MATRIX="u_ProjectionMatrix",e.VIEW_MATRIX="u_ViewMatrix",e.CAMERA_POSITION="u_CameraPosition",e.DEVICE_PIXEL_RATIO="u_DevicePixelRatio",e.VIEWPORT="u_Viewport",e.IS_ORTHO="u_IsOrtho",e.IS_PICKING="u_IsPicking"}(ai||(ai={})),t.RenderGraphPlugin=((ii=function(){function e(){m(this,e),this.canvasConfig=void 0,this.contextService=void 0,this.renderingContext=void 0,this.camera=void 0,this.renderHelper=void 0,this.lightPool=void 0,this.texturePool=void 0,this.batchManager=void 0,this.deviceContribution=void 0,this.device=void 0,this.swapChain=void 0,this.renderLists={world:new Gn,picking:new Gn},this.builder=void 0}return g(e,[{key:"getDevice",value:function(){return this.device}},{key:"getSwapChain",value:function(){return this.swapChain}},{key:"getRenderLists",value:function(){return this.renderLists}},{key:"apply",value:function(e){var n=this,i=function(e){var t=e.target;if(t.nodeName!==ei.tag)if(t.nodeName!==ri.tag){var r=new U;t.renderable3D=r,n.batchManager.add(t)}else n.lightPool.addFog(t);else n.lightPool.addLight(t)},o=function(e){var t=e.target;t.nodeName!==ei.tag?t.nodeName!==ri.tag?(n.batchManager.remove(t),delete t.renderable3D):n.lightPool.removeFog(t):n.lightPool.removeLight(t)},s=function(e){var t=e.target,r=e.attrName,i=e.newValue;n.batchManager.updateAttribute(t,r,i)},u=function(e){var t=e.target,r=e.detail.renderOrder;n.batchManager.changeRenderOrder(t,r)};e.hooks.init.tapPromise(oi.tag,y(r.mark((function t(){var c,l,f,h;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.renderingContext.root.addEventListener(a.ElementEvent.MOUNTED,i),n.renderingContext.root.addEventListener(a.ElementEvent.UNMOUNTED,o),n.renderingContext.root.addEventListener(a.ElementEvent.ATTR_MODIFIED,s),n.renderingContext.root.addEventListener(a.ElementEvent.RENDER_ORDER_CHANGED,u),n.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering=!1,c=n.contextService.getDomElement(),l=n.canvasConfig,f=l.width,h=l.height,n.contextService.resize(f,h),t.next=10,n.deviceContribution.createSwapChain(c);case 10:n.swapChain=t.sent,n.device=n.swapChain.getDevice(),n.renderHelper.setDevice(n.device),n.renderHelper.renderInstManager.disableSimpleMode(),n.swapChain.configureSwapChain(c.width,c.height),n.renderingContext.root.ownerDocument.defaultView.on(a.CanvasEvent.RESIZE,(function(){n.swapChain.configureSwapChain(c.width,c.height)})),n.batchManager.attach(n.device,e);case 17:case"end":return t.stop()}}),t)})))),e.hooks.destroy.tap(oi.tag,(function(){n.renderHelper.destroy(),n.renderingContext.root.removeEventListener(a.ElementEvent.MOUNTED,i),n.renderingContext.root.removeEventListener(a.ElementEvent.UNMOUNTED,o),n.renderingContext.root.removeEventListener(a.ElementEvent.ATTR_MODIFIED,s),n.renderingContext.root.removeEventListener(a.ElementEvent.RENDER_ORDER_CHANGED,u)})),e.hooks.beginFrame.tap(oi.tag,(function(){var e=n.swapChain.getCanvas(),r=n.renderHelper.renderInstManager;n.builder=n.renderHelper.renderGraph.newGraphBuilder();var i=a.parseColor(n.canvasConfig.background),o=n.canvasConfig.background?Ae(Number(i.r)/255,Number(i.g)/255,Number(i.b)/255,Number(i.alpha)):Me,s={backbufferWidth:e.width,backbufferHeight:e.height,antialiasingMode:t.AntialiasingMode.None},u=Zn(t.RGAttachmentSlot.Color0,s,Hn(o)),c=Zn(t.RGAttachmentSlot.DepthStencil,s,Kn),l=n.builder.createRenderTargetID(u,"Main Color"),f=n.builder.createRenderTargetID(c,"Main Depth");n.builder.pushPass((function(e){e.setDebugName("Main Render Pass"),e.attachRenderTargetID(t.RGAttachmentSlot.Color0,l),e.attachRenderTargetID(t.RGAttachmentSlot.DepthStencil,f),e.exec((function(e){n.renderLists.world.drawOnPassRenderer(r.renderCache,e)}))})),n.builder.resolveRenderTargetToExternalTexture(l,n.swapChain.getOnscreenTexture())})),e.hooks.endFrame.tap(oi.tag,(function(){var e=n.renderHelper.renderInstManager,r=n.renderHelper.pushTemplateRenderInst();r.setBindingLayouts([{numUniformBuffers:2,numSamplers:0}]),r.setMegaStateFlags(Je({depthWrite:!0},{rgbBlendMode:t.BlendMode.Add,alphaBlendMode:t.BlendMode.Add,rgbBlendSrcFactor:t.BlendFactor.SrcAlpha,alphaBlendSrcFactor:t.BlendFactor.Zero,rgbBlendDstFactor:t.BlendFactor.OneMinusSrcAlpha,alphaBlendDstFactor:t.BlendFactor.One}));var i=n.canvasConfig,o=i.width,a=i.height;r.setUniforms(0,[{name:ai.PROJECTION_MATRIX,value:n.camera.getPerspective()},{name:ai.VIEW_MATRIX,value:n.camera.getViewTransform()},{name:ai.CAMERA_POSITION,value:n.camera.getPosition()},{name:ai.DEVICE_PIXEL_RATIO,value:n.contextService.getDPR()},{name:ai.VIEWPORT,value:[o,a]},{name:ai.IS_ORTHO,value:n.camera.isOrtho()?1:0},{name:ai.IS_PICKING,value:0}]),n.batchManager.render(n.renderLists.world),e.popTemplateRenderInst(),n.renderHelper.prepareToRender(),n.renderHelper.renderGraph.execute(),e.resetRenderInsts(),n.swapChain.present()}))}},{key:"loadTexture",value:function(e,t,n){return this.texturePool.getOrCreateTexture(this.device,e,t,(function(e){n&&n(e)}))}}]),e}()).tag="RenderGraph",oi=ii),o.__decorate([i.inject(a.CanvasConfig),o.__metadata("design:type",Object)],t.RenderGraphPlugin.prototype,"canvasConfig",void 0),o.__decorate([i.inject(a.ContextService),o.__metadata("design:type",Object)],t.RenderGraphPlugin.prototype,"contextService",void 0),o.__decorate([i.inject(a.RenderingContext),o.__metadata("design:type",Object)],t.RenderGraphPlugin.prototype,"renderingContext",void 0),o.__decorate([i.inject(a.DefaultCamera),o.__metadata("design:type",a.Camera)],t.RenderGraphPlugin.prototype,"camera",void 0),o.__decorate([i.inject(t.RenderHelper),o.__metadata("design:type",t.RenderHelper)],t.RenderGraphPlugin.prototype,"renderHelper",void 0),o.__decorate([i.inject($n),o.__metadata("design:type",$n)],t.RenderGraphPlugin.prototype,"lightPool",void 0),o.__decorate([i.inject(t.TexturePool),o.__metadata("design:type",t.TexturePool)],t.RenderGraphPlugin.prototype,"texturePool",void 0),o.__decorate([i.inject(ir),o.__metadata("design:type",ir)],t.RenderGraphPlugin.prototype,"batchManager",void 0),o.__decorate([i.inject(ci),o.__metadata("design:type",Object)],t.RenderGraphPlugin.prototype,"deviceContribution",void 0),t.RenderGraphPlugin=oi=o.__decorate([i.singleton({contrib:a.RenderingPluginContribution})],t.RenderGraphPlugin);var li=((si=function(){function e(){m(this,e),this.canvasConfig=void 0,this.sceneGraphService=void 0,this.contextService=void 0,this.renderingContext=void 0,this.renderHelper=void 0,this.renderGraphPlugin=void 0,this.pickingIdGenerator=void 0,this.camera=void 0,this.batchManager=void 0}var n;return g(e,[{key:"apply",value:function(e){var t=this,n=function(e){var n=e.target,r=n.renderable3D;if(r){var i=t.pickingIdGenerator.getId(n);r.pickingId=i,r.encodedPickingColor=t.pickingIdGenerator.encodePickingColor(i)}};e.hooks.init.tapPromise(ui.tag,y(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.renderingContext.root.addEventListener(a.ElementEvent.MOUNTED,n);case 1:case"end":return e.stop()}}),e)})))),e.hooks.destroy.tap(ui.tag,(function(){t.renderingContext.root.removeEventListener(a.ElementEvent.MOUNTED,n)})),e.hooks.pick.tapPromise(ui.tag,function(){var e=y(r.mark((function e(n){var i,o,s,u,c,l,f,h,d,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.topmost,o=n.position,s=o.viewportX,u=o.viewportY,c=t.contextService.getDPR(),l=t.canvasConfig.width*c,f=t.canvasConfig.height*c,d=u*c,!((h=s*c)>l||h<0||d>f||d<0)){e.next=10;break}return n.picked=[],e.abrupt("return",n);case 10:return e.next=12,t.pickByRectangleInDepth(new a.Rectangle(a.clamp(Math.round(h),0,l-1),a.clamp(Math.round(d),0,f-1),1,1),i?1:100);case 12:return p=e.sent,n.picked=p,e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"pickByRectangleInDepth",value:(n=y(r.mark((function e(t){var n,i,o,a,s=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=s.length>1&&void 0!==s[1]?s[1]:100,i=null,o=1,a=[];case 4:return e.next=6,this.pickByRectangle(t,i);case 6:if(!(i=e.sent)){e.next=12;break}o++,a.push(i),e.next=13;break;case 12:return e.abrupt("break",14);case 13:if(i&&o<=n){e.next=4;break}case 14:return n>1&&this.restorePickingColor(a),e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"restorePickingColor",value:function(e){var t=this;e.forEach((function(e){t.batchManager.updateAttribute(e,"pointerEvents",!0,!0)}))}},{key:"pickByRectangle",value:function(e,n){var r=this,i=this.renderGraphPlugin.getDevice(),o=this.renderGraphPlugin.getRenderLists(),a=this.renderHelper.renderInstManager,s=this.renderHelper.renderGraph.newGraphBuilder(),u=Me,c=e.x,l=e.y,f=e.width,h=e.height,d={backbufferWidth:f,backbufferHeight:h,antialiasingMode:t.AntialiasingMode.None},v=Zn(t.RGAttachmentSlot.Color0,d,Hn(u)),y=s.createRenderTargetID(v,"Picking Color"),m=Zn(t.RGAttachmentSlot.DepthStencil,d,Kn),_=s.createRenderTargetID(m,"Picking Depth"),g=p({},this.camera.getView());return new Promise((function(e){r.renderHelper.renderGraph.renderTargetDeadPool.forEach((function(e){e.age=-1})),s.pushPass((function(n){n.setDebugName("Picking Pass"),n.attachRenderTargetID(t.RGAttachmentSlot.Color0,y),n.attachRenderTargetID(t.RGAttachmentSlot.DepthStencil,_),n.exec((function(e){o.picking.drawOnPassRenderer(a.renderCache,e)})),n.post((function(n){var o=n.getRenderTargetTexture(t.RGAttachmentSlot.Color0),a=i.createReadback();g&&g.enabled?r.camera.setViewOffset(g.fullWidth,g.fullHeight,g.offsetX,g.offsetY,g.width,g.height):r.camera.clearViewOffset(),r.camera.setEnableUpdate(!0),a.readTexture(o,0,0,f,h,new Uint8Array(f*h*4)).then((function(t){var n,i=-1;if(!t||0===t[0]&&0===t[1]&&0===t[2]||(i=r.pickingIdGenerator.decodePickingColor(t)),i>-1){var o=r.pickingIdGenerator.getById(i);o&&o.isVisible()&&o.isInteractive()&&(n=o)}a.destroy(),e(n)}))}))}));var u=r.renderHelper.pushTemplateRenderInst();u.setBindingLayouts([{numUniformBuffers:2,numSamplers:0}]),u.setMegaStateFlags(Je({depthWrite:!0},{rgbBlendMode:t.BlendMode.Add,rgbBlendSrcFactor:t.BlendFactor.One,rgbBlendDstFactor:t.BlendFactor.Zero,alphaBlendMode:t.BlendMode.Add,alphaBlendSrcFactor:t.BlendFactor.One,alphaBlendDstFactor:t.BlendFactor.Zero}));var d=r.canvasConfig,p=d.width,v=d.height,m=r.contextService.getDPR();r.camera.setEnableUpdate(!1),r.camera.setViewOffset(p*m,v*m,c,l,f,h),u.setUniforms(0,[{name:ai.PROJECTION_MATRIX,value:r.camera.getPerspective()},{name:ai.VIEW_MATRIX,value:r.camera.getViewTransform()},{name:ai.CAMERA_POSITION,value:r.camera.getPosition()},{name:ai.DEVICE_PIXEL_RATIO,value:r.contextService.getDPR()},{name:ai.VIEWPORT,value:[p,v]},{name:ai.IS_ORTHO,value:r.camera.isOrtho()?1:0},{name:ai.IS_PICKING,value:1}]),n&&r.batchManager.updateAttribute(n,"pointerEvents",!1,!0),r.batchManager.render(o.picking,!0),a.popTemplateRenderInst(),r.renderHelper.prepareToRender(),r.renderHelper.renderGraph.execute(),a.resetRenderInsts()}))}}]),e}()).tag="WebGLPicker",ui=si);o.__decorate([i.inject(a.CanvasConfig),o.__metadata("design:type",Object)],li.prototype,"canvasConfig",void 0),o.__decorate([i.inject(a.SceneGraphService),o.__metadata("design:type",Object)],li.prototype,"sceneGraphService",void 0),o.__decorate([i.inject(a.ContextService),o.__metadata("design:type",Object)],li.prototype,"contextService",void 0),o.__decorate([i.inject(a.RenderingContext),o.__metadata("design:type",Object)],li.prototype,"renderingContext",void 0),o.__decorate([i.inject(t.RenderHelper),o.__metadata("design:type",t.RenderHelper)],li.prototype,"renderHelper",void 0),o.__decorate([i.inject(t.RenderGraphPlugin),o.__metadata("design:type",t.RenderGraphPlugin)],li.prototype,"renderGraphPlugin",void 0),o.__decorate([i.inject(he),o.__metadata("design:type",he)],li.prototype,"pickingIdGenerator",void 0),o.__decorate([i.inject(a.DefaultCamera),o.__metadata("design:type",a.Camera)],li.prototype,"camera",void 0),o.__decorate([i.inject(ir),o.__metadata("design:type",ir)],li.prototype,"batchManager",void 0),li=ui=o.__decorate([i.singleton({contrib:a.RenderingPluginContribution})],li);var fi=["style"],hi=function(e){T(n,e);var t=C(n);function n(e){var r,i=e.style,o=R(e,fi);return m(this,n),(r=t.call(this,p({type:a.Shape.MESH,style:p({x:"",y:"",z:"",lineWidth:0},i)},o))).cullable.enable=!1,r.style.geometry.meshes.push(A(r)),r.style.material.meshes.push(A(r)),r}return g(n,[{key:"destroy",value:function(){x(b(n.prototype),"destroy",this).call(this);var e=this.style.geometry.meshes,t=e.indexOf(this);e.splice(t,1),t=(e=this.style.material.meshes).indexOf(this),e.splice(t,1)}}]),n}(a.DisplayObject),di=function(){function e(){m(this,e)}return g(e,[{key:"update",value:function(e){return e.geometry.computeBoundingBox(),{width:0,height:0,depth:0}}}]),e}();di=o.__decorate([i.singleton({token:{token:a.GeometryAABBUpdater,named:a.Shape.MESH}})],di);var pi,vi,yi,mi="#define GLSLIFY 1\nlayout(location = 0) in vec2 a_Position;\n\nout vec2 v_TexCoord;\n\nvoid main() {\n  v_TexCoord = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n\n  #ifdef VIEWPORT_ORIGIN_TL\n    v_TexCoord.y = 1.0 - v_TexCoord.y;\n  #endif\n}",_i="#define GLSLIFY 1\nuniform sampler2D u_Texture;\nin vec2 v_TexCoord;\n\nout vec4 outputColor;\n\nvoid main() {\n  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);\n}",gi=function(e){T(n,e);var t=C(n);function n(){var e;m(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).vert=mi,e.frag=_i,e.features={},e}return g(n)}(zt),Ei="#define GLSLIFY 1\nuniform sampler2D u_Texture;\nin vec2 v_TexCoord;\n\nout vec4 outputColor;\n\nfloat MonochromeNTSC(vec3 t_Color) {\n  // NTSC primaries.\n  return dot(t_Color.rgb, vec3(0.299, 0.587, 0.114));\n}\n\nvec4 FXAA(PD_SAMPLER_2D(t_Texture), in vec2 t_PixelCenter, in vec2 t_InvResolution) {\n  // FXAA v2, based on implementations:\n  // http://www.geeks3d.com/20110405/fxaa-fast-approximate-anti-aliasing-demo-glsl-opengl-test-radeon-geforce/\n  // https://github.com/mitsuhiko/webgl-meincraft\n\n  float lumaMM = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy).rgb);\n\n  #if 1\n    vec2 t_PixelTopLeft = t_PixelCenter.xy - t_InvResolution.xy * 0.5;\n    float lumaNW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy)             .rgb);\n    float lumaNE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy + vec2(1.0, 0.0)).rgb);\n    float lumaSW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy + vec2(0.0, 1.0)).rgb);\n    float lumaSE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy + vec2(1.0, 1.0)).rgb);\n  #else\n    // We're at the pixel center -- pixel edges are 0.5 units away.\n    // NOTE(jstpierre): mitsuhiko's port seems to get this wrong?\n    vec2 t_PixelSize = t_InvResolution.xy * 0.5;\n\n    float lumaNW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2(-1.0, -1.0)).rgb);\n    float lumaNE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2( 1.0, -1.0)).rgb);\n    float lumaSW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2(-1.0,  1.0)).rgb);\n    float lumaSE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2( 1.0,  1.0)).rgb);\n  #endif\n\n  vec2 dir; \n  dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n  dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n  const float FXAA_REDUCE_MIN = 1.0/128.0;\n  const float FXAA_REDUCE_MUL = 1.0/8.0;\n  const float FXAA_SPAN_MAX = 8.0;\n\n  float dirReduce = max(\n      (lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL),\n      FXAA_REDUCE_MIN);\n\n  float rcpDirMin = 1.0/(min(abs(dir.x), abs(dir.y)) + dirReduce);\n  dir = min(vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * u_InvResolution.xy;\n\n  float lumaMin = min(lumaMM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n  float lumaMax = max(lumaMM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n  vec4 rgbA = (1.0/2.0) * (\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (1.0/3.0 - 0.5)) +\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (2.0/3.0 - 0.5)));\n  vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (0.0/3.0 - 0.5)) +\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (3.0/3.0 - 0.5)));\n  float lumaB = MonochromeNTSC(rgbB.rgb);\n\n  vec4 rgbOutput = ((lumaB < lumaMin) || (lumaB > lumaMax)) ? rgbA : rgbB;\n  return rgbOutput;\n}\n\nvoid main() {\n  outputColor = FXAA(PP_SAMPLER_2D(u_Texture), v_TexCoord.xy, u_InvResolution.xy);\n}",Ti=function(e){T(n,e);var t=C(n);function n(){var e;m(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).features={},e.both="\nlayout(std140) uniform ub_Params {\n    vec4 u_Misc[1];\n};\n#define u_InvResolution (u_Misc[0].xy)\n",e.vert=mi,e.frag=Ei,e}return g(n)}(zt),bi=Ue(1,(function(){return new Jn}));var Si=i.Module((function(e){e(t.RenderHelper),e(t.TexturePool),e($n),e(Wr),e(he),e(ir),e(t.RenderGraphPlugin),e(li),e(t.SDFMesh),e(t.InstancedLineMesh),e(t.LineMesh),e(t.FillMesh),e(t.ImageMesh),e(t.TextMesh),e(t.MeshMesh),e({token:nr,useFactory:function(e){return function(t){return e.container.isBound(t)&&e.container.get(t)||null}}}),e(zr),e(Yr),e(qr),e(Jr),e(Zr),e(Qr),e({token:er,useFactory:function(e){var t={};return function(n){return t[n]||e.container.isBoundNamed(tr,n)&&(t[n]=e.container.getNamed(tr,n)),t[n]||null}}})})),Ri=function(){function e(){m(this,e),this.name="device-renderer",this.container=void 0}return g(e,[{key:"init",value:function(e){i.GlobalContainer.isBound(di)||i.GlobalContainer.register(di),this.container=e,e.load(Si,!0)}},{key:"destroy",value:function(e){i.GlobalContainer.isBound(di)&&i.GlobalContainer.remove(di),e.unload(Si)}},{key:"getDevice",value:function(){return this.container.get(t.RenderGraphPlugin).getDevice()}},{key:"loadTexture",value:function(e,n,r){return this.container.get(t.RenderGraphPlugin).loadTexture(e,n,r)}}]),e}();t.BufferGeometry=sr,t.CopyProgram=gi,t.DeviceContribution=ci,t.DeviceProgram=zt,t.DynamicUniformBuffer=Yt,t.Fog=ri,t.HashMap=Qt,t.IdentityViewportCoords=ln,t.IsDepthReversed=!0,t.Light=ei,t.Material=ur,t.Mesh=hi,t.OpaqueBlack=Ce,t.OpaqueWhite=xe,t.Plugin=Ri,t.RenderCache=un,t.RenderInst=kn,t.RenderInstList=Gn,t.RenderInstManager=Vn,t.Renderable3D=U,t.ShaderMaterial=cr,t.SingleSampledTexture=dn,t.TemporalTexture=Qn,t.TextureMapping=Jn,t.TransparentBlack=Oe,t.TransparentWhite=Me,t.UNIFORM_SETTERS=Ut,t.align=De,t.alignNonPowerOfTwo=Le,t.arrayCopy=tt,t.arrayEqual=et,t.assert=Ee,t.assertExists=Te,t.bindingLayoutDescriptorCopy=_t,t.bindingLayoutDescriptorEqual=function(e,t){return e.numSamplers===t.numSamplers&&e.numUniformBuffers===t.numUniformBuffers},t.bindingLayoutSamplerDescriptorCopy=mt,t.bindingsDescriptorCopy=yt,t.bindingsDescriptorEquals=it,t.bisectRight=Be,t.bufferBindingCopy=vt,t.colorCopy=Se,t.colorEqual=be,t.colorNewCopy=Re,t.colorNewFromRGBA=Ae,t.compareDefines=fr,t.compareDepthValues=function(e,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if((r=Pe(r,i))===t.CompareMode.Less)return e<n;if(r===t.CompareMode.LessEqual)return e<=n;if(r===t.CompareMode.Greater)return e>n;if(r===t.CompareMode.GreaterEqual)return e>=n;throw new Error("whoops")},t.containerModule=Si,t.copyAttachmentState=Ve,t.copyAttachmentStateFromSimple=ze,t.copyMegaState=Xe,t.defaultBindingLayoutSamplerDescriptor=$e,t.defaultMegaState=Ke,t.enumToObject=lr,t.fallbackUndefined=Ne,t.fillArray=Ie,t.fillColor=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.a;return e[t+0]=n.r,e[t+1]=n.g,e[t+2]=n.b,e[t+3]=r,4},t.fillMatrix4x4=function(e,t,n){return e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],16},t.fillVec3v=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=r,4},t.fillVec4=Bn,t.fillVec4v=function(e,t,n){return e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],4},t.fullscreenMegaState=Ze,t.getAttributeLocations=function(e,t){var n=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,(function(e,r,i){var o=Number(r);return n.push({location:isNaN(o)?t[r]:o,name:i}),""})),n},t.getDefines=function(e){var t={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,(function(e,n,r){var i=Number(r);return t[n]=isNaN(i)?r:i,""})),t},t.getFormatByteSize=function(e){return ge(me(e))*ye(e)},t.getFormatCompByteSize=function(e){return ge(me(e))},t.getFormatCompFlags=ye,t.getFormatCompFlagsComponentCount=pe,t.getFormatComponentCount=function(e){return ye(e)},t.getFormatFlags=_e,t.getFormatSamplerKind=function(e){var n=_e(e);if(n&t.FormatFlags.Depth)return t.SamplerFormatKind.Depth;if(n&t.FormatFlags.Normalized)return t.SamplerFormatKind.Float;var r=me(e);if(r===t.FormatTypeFlags.F16||r===t.FormatTypeFlags.F32)return t.SamplerFormatKind.Float;if(r===t.FormatTypeFlags.U8||r===t.FormatTypeFlags.U16||r===t.FormatTypeFlags.U32)return t.SamplerFormatKind.Uint;if(r===t.FormatTypeFlags.S8||r===t.FormatTypeFlags.S16||r===t.FormatTypeFlags.S32)return t.SamplerFormatKind.Sint;throw new Error("whoops")},t.getFormatTypeFlags=me,t.getFormatTypeFlagsByteSize=ge,t.getSortKeyDepth=function(e){return!!(e>>>31&1)?e>>>8&65535:e>>>8&65532|3&e},t.getSortKeyLayer=function(e){return e>>>24&255},t.getSystemEndianness=function(){return At},t.getUniformSetter=function(e,t,n){var r=Ut[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,e,t)},t.getUniforms=Vt,t.hashCodeNumberFinish=qt,t.hashCodeNumberUpdate=Kt,t.inputLayoutBufferDescriptorCopy=Tt,t.inputLayoutBufferDescriptorEquals=ft,t.inputLayoutDescriptorCopy=bt,t.inputLayoutDescriptorEquals=ht,t.isPowerOfTwo=function(e){return e&&0==(e&e-1)},t.leftPad=Ge,t.makeAttachmentClearDescriptor=Hn,t.makeBackbufferDescSimple=Zn,t.makeDepthKey=mn,t.makeFormat=ve,t.makeMegaState=qe,t.makeSortKey=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e&t.RendererLayer.TRANSLUCENT?bn(e):En(e,n)},t.makeSortKeyOpaque=En,t.makeSortKeyTranslucent=bn,t.makeStaticDataBuffer=ar,t.makeTextureDescriptor2D=de,t.nArray=Ue,t.nullHashFunc=Zt,t.nullify=Fe,t.opaqueBlackFullClearRenderPassDescriptor=Yn,t.opaqueWhiteFullClearRenderPassDescriptor=Kn,t.parseUniformName=function(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};var t=e.match(Ot);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:Number(t[2])||1,isArray:Boolean(t[2])}},t.prependLineNo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.split("\n");return n.map((function(e,n){return"".concat(Ge(""+(t+n),4," "),"  ").concat(e)})).join("\n")},t.preprocessProgramObj_GLSL=Xt,t.preprocessProgram_GLSL=Ht,t.preprocessShader_GLSL=Wt,t.projectionMatrixConvertClipSpaceNearZ=function(e,n,r){n!==r&&(n===t.ClipSpaceNearZ.NegativeOne?function(e){xn(e,In,e)}(e):n===t.ClipSpaceNearZ.Zero&&function(e){xn(e,Ln,e)}(e))},t.pushFXAAPass=function(e,n,r,i){e.pushPass((function(o){o.setDebugName("FXAA"),o.attachRenderTargetID(t.RGAttachmentSlot.Color0,i);var a=e.resolveRenderTarget(i);o.attachResolveTexture(a);var s=n.renderInstManager.newRenderInst();s.setUniformBuffer(n.uniformBuffer),s.setAllowSkippingIfPipelineNotReady(!1),s.setMegaStateFlags(Ze),s.setBindingLayouts([{numUniformBuffers:1,numSamplers:1}]),s.drawPrimitives(3);var u=s.allocateUniformBuffer(0,4);Bn(s.mapUniformBufferF32(0),u,1/r.backbufferWidth,1/r.backbufferHeight);var c=new Ti,l=n.renderCache.createProgram(c);s.setProgram(l),pi||((pi=new sr(n.getDevice())).setVertexBuffer({bufferIndex:0,byteStride:8,frequency:t.VertexBufferFrequency.PerVertex,attributes:[{format:t.Format.F32_RG,bufferByteOffset:0,location:0}],data:new Float32Array([-4,-4,4,-4,0,4])}),pi.vertexCount=3,yi=n.getCache().createInputLayout(pi.inputLayoutDescriptor),vi=n.getDevice().createInputState(yi,pi.vertexBuffers.map((function(e){return{buffer:e,byteOffset:0}})),null,l)),o.exec((function(e,t){bi[0].texture=t.getResolveTextureForID(a),s.setSamplerBindingsFromTextureMappings(bi),s.setInputLayoutAndState(yi,vi),s.drawOnPass(n.renderCache,e)}))}))},t.range=function(e,t){for(var n=[],r=e;r<e+t;r++)n.push(r);return n},t.renderInstCompareNone=null,t.renderInstCompareSortKey=Un,t.renderPipelineDescriptorCopy=gt,t.renderPipelineDescriptorEquals=ct,t.reverseDepthForClearValue=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?1-e:e},t.reverseDepthForCompareMode=Pe,t.reverseDepthForDepthOffset=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?-e:e},t.reverseDepthForOrthographicProjectionMatrix=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(e[10]=-e[10],e[14]=1-e[14])},t.reverseDepthForPerspectiveProjectionMatrix=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(e[10]=-e[10],e[14]=-e[14])},t.samplerBindingCopy=pt,t.samplerBindingNew=function(){return{sampler:null,texture:null,lateBinding:null}},t.samplerDescriptorEquals=dt,t.segmentInstanceGeometry=Tr,t.setAttachmentStateSimple=Je,t.setBackbufferDescSimple=qn,t.setBitFlagEnabled=ke,t.setFormatComponentCount=function(e,t){return 4294902015&e|t<<8},t.setFormatFlags=function(e,t){return 4294967040&e|t},t.setMegaStateFlags=He,t.setSortKeyBias=function(e,t){return!!(e>>>31&1)?(4294967040&e|255&t)>>>0:e},t.setSortKeyDepth=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65536,r=!!(e>>>31&1),i=mn(t,r,n);return r?Sn(e,i):Tn(e,i)},t.setSortKeyDepthKey=function(e,t){return!!(e>>>31&1)?Sn(e,t):Tn(e,t)},t.setSortKeyLayer=_n,t.setSortKeyOpaqueDepth=Tn,t.setSortKeyProgramKey=gn,t.setSortKeyTranslucentDepth=Sn,t.spliceBisectRight=we,t.standardFullClearRenderPassDescriptor=zn,t.updateBuffer=Dr,t.vertexAttributeDescriptorCopy=Et,t.vertexAttributeDescriptorEquals=lt},function(e,t){e.exports=function(e){return"function"==typeof e}},function(e,t,n){var r=n(49),i=Function.prototype,o=i.bind,a=i.call,s=r&&o.bind(a,a);e.exports=r?function(e){return e&&s(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STACK_OVERFLOW=t.CIRCULAR_DEPENDENCY_IN_FACTORY=t.POST_CONSTRUCT_ERROR=t.MULTIPLE_POST_CONSTRUCT_METHODS=t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=t.ARGUMENTS_LENGTH_MISMATCH=t.INVALID_DECORATOR_OPERATION=t.INVALID_TO_SELF_VALUE=t.INVALID_FUNCTION_BINDING=t.INVALID_MIDDLEWARE_RETURN=t.NO_MORE_SNAPSHOTS_AVAILABLE=t.INVALID_BINDING_TYPE=t.NOT_IMPLEMENTED=t.CIRCULAR_DEPENDENCY=t.UNDEFINED_INJECT_ANNOTATION=t.MISSING_INJECT_ANNOTATION=t.MISSING_INJECTABLE_ANNOTATION=t.NOT_REGISTERED=t.CANNOT_UNBIND=t.AMBIGUOUS_MATCH=t.KEY_NOT_FOUND=t.NULL_ARGUMENT=t.DUPLICATED_METADATA=t.DUPLICATED_INJECTABLE_DECORATOR=void 0,t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]};t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},function(e,t,n){"use strict";var r=n(2),i=n(41),o=n(64),a=n(28),s=n(112),u=n(30),c=n(9),l=r.RangeError,f=r.Int8Array,h=f&&f.prototype,d=h&&h.set,p=o.aTypedArray,v=o.exportTypedArrayMethod,y=!c((function(){var e=new Uint8ClampedArray(2);return i(d,e,{length:1,0:3},1),3!==e[1]})),m=y&&o.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var e=new f(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));v("set",(function(e){p(this);var t=s(arguments.length>1?arguments[1]:void 0,1),n=u(e);if(y)return i(d,this,n,t);var r=this.length,o=a(n),c=0;if(o+t>r)throw l("Wrong length");for(;c<o;)this[t+c]=n[c++]}),!y||m)},function(e,t,n){"use strict";var r=n(2),i=n(6),o=n(9),a=n(37),s=n(76),u=n(64),c=n(78),l=n(79),f=n(42),h=n(80),d=r.Array,p=u.aTypedArray,v=u.exportTypedArrayMethod,y=r.Uint16Array,m=y&&i(y.prototype.sort),_=!(!m||o((function(){m(new y(2),null)}))&&o((function(){m(new y(2),{})}))),g=!!m&&!o((function(){if(f)return f<74;if(c)return c<67;if(l)return!0;if(h)return h<602;var e,t,n=new y(516),r=d(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(m(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));v("sort",(function(e){return void 0!==e&&a(e),g?m(this,e):s(p(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!g||_)},function(e,t,n){"use strict";n.r(t),n.d(t,"ManaSyringe",(function(){return c})),n.d(t,"layoutEngine",(function(){return nh})),n.d(t,"Shape",(function(){return ca})),n.d(t,"LineCap",(function(){return la})),n.d(t,"LineJoin",(function(){return fa})),n.d(t,"TextTransform",(function(){return ha})),n.d(t,"TextAlign",(function(){return da})),n.d(t,"CanvasConfig",(function(){return pa})),n.d(t,"StyleValueRegistry",(function(){return to})),n.d(t,"UnitType",(function(){return ms})),n.d(t,"UnitCategory",(function(){return _s})),n.d(t,"ValueRange",(function(){return gs})),n.d(t,"Nested",(function(){return Es})),n.d(t,"ParenLess",(function(){return Ts})),n.d(t,"CSSColorValue",(function(){return Vs})),n.d(t,"CSSKeywordValue",(function(){return Ws})),n.d(t,"CSSMathOperator",(function(){return Us})),n.d(t,"isComparison",(function(){return Hs})),n.d(t,"BaseType",(function(){return Gs})),n.d(t,"unitTypeToBaseType",(function(){return Xs})),n.d(t,"baseTypeToString",(function(){return zs})),n.d(t,"CSSNumericValueType",(function(){return Ys})),n.d(t,"CSSNumericValue",(function(){return Ks})),n.d(t,"CSSUnitValue",(function(){return eu})),n.d(t,"CSSMathValue",(function(){return tu})),n.d(t,"CSSMathInvert",(function(){return nu})),n.d(t,"CSSMathNegate",(function(){return ru})),n.d(t,"typeCheck",(function(){return iu})),n.d(t,"CSSMathVariadic",(function(){return au})),n.d(t,"CSSMathMin",(function(){return su})),n.d(t,"CSSMathMax",(function(){return uu})),n.d(t,"CSSMathSum",(function(){return cu})),n.d(t,"CSSMathProduct",(function(){return lu})),n.d(t,"Opx",(function(){return fu})),n.d(t,"Odeg",(function(){return hu})),n.d(t,"CSSRGB",(function(){return du})),n.d(t,"GradientPatternType",(function(){return ou})),n.d(t,"CSSGradientValue",(function(){return vu})),n.d(t,"CSSStyleValueType",(function(){return ws})),n.d(t,"CSSStyleValue",(function(){return js})),n.d(t,"CSSTransformValue",(function(){return yu})),n.d(t,"CSSTranslate",(function(){return mu})),n.d(t,"parseColor",(function(){return Zu})),n.d(t,"mergeColors",(function(){return Ju})),n.d(t,"parseDimension",(function(){return Qu})),n.d(t,"parseLength",(function(){return $u})),n.d(t,"parserPercentage",(function(){return ec})),n.d(t,"parseLengthOrPercentage",(function(){return tc})),n.d(t,"parseAngle",(function(){return nc})),n.d(t,"mergeDimensions",(function(){return rc})),n.d(t,"convertAngleUnit",(function(){return ic})),n.d(t,"parseDimensionArray",(function(){return oc})),n.d(t,"mergeDimensionList",(function(){return ac})),n.d(t,"convertPercentUnit",(function(){return sc})),n.d(t,"numberToString",(function(){return uc})),n.d(t,"parseNumber",(function(){return cc})),n.d(t,"parseNumberList",(function(){return lc})),n.d(t,"mergeNumbers",(function(){return fc})),n.d(t,"clampedMergeNumbers",(function(){return hc})),n.d(t,"mergeNumberLists",(function(){return dc})),n.d(t,"parsePath",(function(){return Gc})),n.d(t,"mergePaths",(function(){return jc})),n.d(t,"parsePoints",(function(){return Vc})),n.d(t,"parseParam",(function(){return Yc})),n.d(t,"parseFilter",(function(){return qc})),n.d(t,"parseTransform",(function(){return Al})),n.d(t,"mergeTransforms",(function(){return Ml})),n.d(t,"parseTransformOrigin",(function(){return xl})),n.d(t,"CSSPropertyLengthOrPercentage",(function(){return Il})),n.d(t,"CSSPropertyLocalPosition",(function(){return Dl})),n.d(t,"CSSPropertyOpacity",(function(){return Ll})),n.d(t,"CSSPropertyColor",(function(){return Bl})),n.d(t,"CSSPropertyFilter",(function(){return wl})),n.d(t,"CSSPropertyLineDash",(function(){return kl})),n.d(t,"CSSPropertyShadowBlur",(function(){return Ul})),n.d(t,"CSSPropertyOffsetPath",(function(){return Gl})),n.d(t,"CSSPropertyOffsetDistance",(function(){return jl})),n.d(t,"CSSPropertyAnchor",(function(){return Vl})),n.d(t,"CSSPropertyZIndex",(function(){return Wl})),n.d(t,"CSSPropertyTransform",(function(){return Hl})),n.d(t,"CSSPropertyTransformOrigin",(function(){return Xl})),n.d(t,"CSSPropertyPath",(function(){return zl})),n.d(t,"CSSPropertyPoints",(function(){return Yl})),n.d(t,"CSSPropertyClipPath",(function(){return Kl})),n.d(t,"CSSPropertyText",(function(){return ql})),n.d(t,"CSSPropertyTextTransform",(function(){return Zl})),n.d(t,"FragmentResultFactory",(function(){return nl})),n.d(t,"FragmentResultOptions",(function(){return rl})),n.d(t,"ContextNode",(function(){return il})),n.d(t,"FragmentResult",(function(){return ol})),n.d(t,"LayoutChildrenFactory",(function(){return al})),n.d(t,"LayoutChildrenOptions",(function(){return sl})),n.d(t,"LayoutChildren",(function(){return ul})),n.d(t,"LayoutContextFactory",(function(){return Qc})),n.d(t,"LayoutContextOptions",(function(){return $c})),n.d(t,"LayoutContext",(function(){return tl})),n.d(t,"AbstractLayoutDefinition",(function(){return cl})),n.d(t,"LayoutEdgesFactory",(function(){return ll})),n.d(t,"LayoutEdgesOptions",(function(){return fl})),n.d(t,"LayoutEdges",(function(){return dl})),n.d(t,"LayoutEngine",(function(){return yl})),n.d(t,"LayoutFragmentFactory",(function(){return ml})),n.d(t,"LayoutFragmentOptions",(function(){return _l})),n.d(t,"LayoutFragment",(function(){return gl})),n.d(t,"LayoutRegistry",(function(){return pl})),n.d(t,"LayoutObject",(function(){return Jc})),n.d(t,"LayoutTaskType",(function(){return Wc})),n.d(t,"PropertyName",(function(){return zc})),n.d(t,"CSS",(function(){return El})),n.d(t,"PropertySyntax",(function(){return $l})),n.d(t,"BUILT_IN_PROPERTIES",(function(){return ef})),n.d(t,"DefaultStyleValueRegistry",(function(){return tf})),n.d(t,"ElementEvent",(function(){return vi})),n.d(t,"DELEGATION_SPLITTER",(function(){return qa})),n.d(t,"EventTarget",(function(){return Za})),n.d(t,"Node",(function(){return Ja})),n.d(t,"Element",(function(){return is})),n.d(t,"Document",(function(){return nf})),n.d(t,"FederatedEvent",(function(){return xi})),n.d(t,"FederatedMouseEvent",(function(){return rf})),n.d(t,"FederatedPointerEvent",(function(){return of})),n.d(t,"FederatedWheelEvent",(function(){return af})),n.d(t,"Animation",(function(){return ss})),n.d(t,"AnimationEvent",(function(){return os})),n.d(t,"AnimationEffectTiming",(function(){return ls})),n.d(t,"CustomEvent",(function(){return Ka})),n.d(t,"MutationEvent",(function(){return Pi})),n.d(t,"Registration",(function(){return lf})),n.d(t,"MutationObserver",(function(){return ff})),n.d(t,"MutationRecord",(function(){return sf})),n.d(t,"makeTiming",(function(){return ps})),n.d(t,"normalizeTimingInput",(function(){return vs})),n.d(t,"numericTimingToObject",(function(){return ys})),n.d(t,"KeyframeEffect",(function(){return bs})),n.d(t,"normalizeKeyframes",(function(){return fs})),n.d(t,"compareAnimations",(function(){return us})),n.d(t,"AnimationTimeline",(function(){return cs})),n.d(t,"CustomElementRegistry",(function(){return Ef})),n.d(t,"DefaultCamera",(function(){return Uf})),n.d(t,"CameraType",(function(){return mf})),n.d(t,"CameraTrackingMode",(function(){return _f})),n.d(t,"CameraProjectionMode",(function(){return gf})),n.d(t,"CameraEvent",(function(){return jf})),n.d(t,"Camera",(function(){return Hf})),n.d(t,"DisplayObject",(function(){return Rs})),n.d(t,"CustomElement",(function(){return As})),n.d(t,"Circle",(function(){return Os})),n.d(t,"Ellipse",(function(){return Cs})),n.d(t,"Group",(function(){return Ms})),n.d(t,"Image",(function(){return xs})),n.d(t,"Line",(function(){return Ps})),n.d(t,"Path",(function(){return Ns})),n.d(t,"Polygon",(function(){return Fs})),n.d(t,"Polyline",(function(){return Is})),n.d(t,"Rect",(function(){return Ds})),n.d(t,"Text",(function(){return Ls})),n.d(t,"HTML",(function(){return Bs})),n.d(t,"Geometry",(function(){return Qa})),n.d(t,"Renderable",(function(){return $a})),n.d(t,"Transform",(function(){return es})),n.d(t,"Strategy",(function(){return Xa})),n.d(t,"Cullable",(function(){return ts})),n.d(t,"Sortable",(function(){return ns})),n.d(t,"AbstractRenderer",(function(){return Xf})),n.d(t,"CanvasEvent",(function(){return Gf})),n.d(t,"Canvas",(function(){return th})),n.d(t,"DisplayObjectPool",(function(){return h})),n.d(t,"sortByZIndex",(function(){return Ua})),n.d(t,"dirtifyToRoot",(function(){return Ga})),n.d(t,"SceneGraphService",(function(){return Va})),n.d(t,"DefaultSceneGraphService",(function(){return Wa})),n.d(t,"ContextService",(function(){return Ha})),n.d(t,"RenderReason",(function(){return ja})),n.d(t,"RenderingContext",(function(){return za})),n.d(t,"RenderingPluginContribution",(function(){return Tf})),n.d(t,"RenderingService",(function(){return bf})),n.d(t,"EventService",(function(){return Rf})),n.d(t,"SceneGraphSelectorFactory",(function(){return Ai})),n.d(t,"SceneGraphSelector",(function(){return Oi})),n.d(t,"DefaultSceneGraphSelector",(function(){return Mi})),n.d(t,"TextService",(function(){return Pf})),n.d(t,"OffscreenCanvasCreator",(function(){return Af})),n.d(t,"GeometryUpdaterFactory",(function(){return Jl})),n.d(t,"GeometryAABBUpdater",(function(){return Ql})),n.d(t,"CircleUpdater",(function(){return Nf})),n.d(t,"EllipseUpdater",(function(){return Ff})),n.d(t,"RectUpdater",(function(){return If})),n.d(t,"TextUpdater",(function(){return Df})),n.d(t,"LineUpdater",(function(){return Lf})),n.d(t,"PolylineUpdater",(function(){return Bf})),n.d(t,"PathUpdater",(function(){return wf})),n.d(t,"AABB",(function(){return fi})),n.d(t,"BoundingSphere",(function(){return di})),n.d(t,"Mask",(function(){return ni})),n.d(t,"Frustum",(function(){return yi})),n.d(t,"Plane",(function(){return pi})),n.d(t,"Ray",(function(){return bi})),n.d(t,"Point",(function(){return Si})),n.d(t,"Rectangle",(function(){return Ri})),n.d(t,"DCHECK",(function(){return Ni})),n.d(t,"DCHECK_EQ",(function(){return Fi})),n.d(t,"DCHECK_NE",(function(){return Ii})),n.d(t,"isUndefined",(function(){return Di})),n.d(t,"isNil",(function(){return Li})),n.d(t,"isNumber",(function(){return Bi})),n.d(t,"isFunction",(function(){return wi})),n.d(t,"isBoolean",(function(){return ki})),n.d(t,"isObject",(function(){return Ui})),n.d(t,"clamp",(function(){return Gi})),n.d(t,"getAngle",(function(){return ji})),n.d(t,"createVec3",(function(){return Vi})),n.d(t,"deg2rad",(function(){return Wi})),n.d(t,"rad2deg",(function(){return Hi})),n.d(t,"grad2deg",(function(){return Xi})),n.d(t,"deg2turn",(function(){return zi})),n.d(t,"turn2deg",(function(){return Yi})),n.d(t,"getScaling",(function(){return Ki})),n.d(t,"getTranslation",(function(){return qi})),n.d(t,"getRotationInRadians",(function(){return Zi})),n.d(t,"getEuler",(function(){return Ji})),n.d(t,"fromRotationTranslationScale",(function(){return Qi})),n.d(t,"makePerspective",(function(){return $i})),n.d(t,"decompose",(function(){return eo})),n.d(t,"convertEffectInput",(function(){return Wo})),n.d(t,"formatAttribute",(function(){return Ko})),n.d(t,"equalizeSegments",(function(){return ma})),n.d(t,"getDrawDirection",(function(){return _a})),n.d(t,"getPathArea",(function(){return Ea})),n.d(t,"reverseCurve",(function(){return Ta})),n.d(t,"clonePath",(function(){return ba})),n.d(t,"getRotatedCurve",(function(){return Sa})),n.d(t,"convertToPath",(function(){return Aa})),n.d(t,"toFontString",(function(){return Ca})),n.d(t,"camelCase",(function(){return jo})),n.d(t,"isString",(function(){return Vo})),n.d(t,"MOUSE_POINTER_ID",(function(){return Ma})),n.d(t,"TOUCH_TO_POINTER",(function(){return xa})),n.d(t,"cleanExistedCanvas",(function(){return Fa})),n.d(t,"isBrowser",(function(){return Ia})),n.d(t,"makeQuerablePromise",(function(){return Da})),n.d(t,"Deferred",(function(){return La})),n.d(t,"equalSet",(function(){return Ba})),n.d(t,"ObjectTyped",(function(){return wa})),n.d(t,"setDOMSize",(function(){return ka}));var r={};n.r(r),n.d(r,"create",(function(){return y})),n.d(r,"fromMat4",(function(){return m})),n.d(r,"clone",(function(){return _})),n.d(r,"copy",(function(){return g})),n.d(r,"fromValues",(function(){return E})),n.d(r,"set",(function(){return T})),n.d(r,"identity",(function(){return b})),n.d(r,"transpose",(function(){return S})),n.d(r,"invert",(function(){return R})),n.d(r,"adjoint",(function(){return A})),n.d(r,"determinant",(function(){return O})),n.d(r,"multiply",(function(){return C})),n.d(r,"translate",(function(){return M})),n.d(r,"rotate",(function(){return x})),n.d(r,"scale",(function(){return P})),n.d(r,"fromTranslation",(function(){return N})),n.d(r,"fromRotation",(function(){return F})),n.d(r,"fromScaling",(function(){return I})),n.d(r,"fromMat2d",(function(){return D})),n.d(r,"fromQuat",(function(){return L})),n.d(r,"normalFromMat4",(function(){return B})),n.d(r,"projection",(function(){return w})),n.d(r,"str",(function(){return k})),n.d(r,"frob",(function(){return U})),n.d(r,"add",(function(){return G})),n.d(r,"subtract",(function(){return j})),n.d(r,"multiplyScalar",(function(){return V})),n.d(r,"multiplyScalarAndAdd",(function(){return W})),n.d(r,"exactEquals",(function(){return H})),n.d(r,"equals",(function(){return X})),n.d(r,"mul",(function(){return z})),n.d(r,"sub",(function(){return Y}));var i={};n.r(i),n.d(i,"create",(function(){return K})),n.d(i,"clone",(function(){return q})),n.d(i,"copy",(function(){return Z})),n.d(i,"fromValues",(function(){return J})),n.d(i,"set",(function(){return Q})),n.d(i,"identity",(function(){return $})),n.d(i,"transpose",(function(){return ee})),n.d(i,"invert",(function(){return te})),n.d(i,"adjoint",(function(){return ne})),n.d(i,"determinant",(function(){return re})),n.d(i,"multiply",(function(){return ie})),n.d(i,"translate",(function(){return oe})),n.d(i,"scale",(function(){return ae})),n.d(i,"rotate",(function(){return se})),n.d(i,"rotateX",(function(){return ue})),n.d(i,"rotateY",(function(){return ce})),n.d(i,"rotateZ",(function(){return le})),n.d(i,"fromTranslation",(function(){return fe})),n.d(i,"fromScaling",(function(){return he})),n.d(i,"fromRotation",(function(){return de})),n.d(i,"fromXRotation",(function(){return pe})),n.d(i,"fromYRotation",(function(){return ve})),n.d(i,"fromZRotation",(function(){return ye})),n.d(i,"fromRotationTranslation",(function(){return me})),n.d(i,"fromQuat2",(function(){return _e})),n.d(i,"getTranslation",(function(){return ge})),n.d(i,"getScaling",(function(){return Ee})),n.d(i,"getRotation",(function(){return Te})),n.d(i,"fromRotationTranslationScale",(function(){return be})),n.d(i,"fromRotationTranslationScaleOrigin",(function(){return Se})),n.d(i,"fromQuat",(function(){return Re})),n.d(i,"frustum",(function(){return Ae})),n.d(i,"perspectiveNO",(function(){return Oe})),n.d(i,"perspective",(function(){return Ce})),n.d(i,"perspectiveZO",(function(){return Me})),n.d(i,"perspectiveFromFieldOfView",(function(){return xe})),n.d(i,"orthoNO",(function(){return Pe})),n.d(i,"ortho",(function(){return Ne})),n.d(i,"orthoZO",(function(){return Fe})),n.d(i,"lookAt",(function(){return Ie})),n.d(i,"targetTo",(function(){return De})),n.d(i,"str",(function(){return Le})),n.d(i,"frob",(function(){return Be})),n.d(i,"add",(function(){return we})),n.d(i,"subtract",(function(){return ke})),n.d(i,"multiplyScalar",(function(){return Ue})),n.d(i,"multiplyScalarAndAdd",(function(){return Ge})),n.d(i,"exactEquals",(function(){return je})),n.d(i,"equals",(function(){return Ve})),n.d(i,"mul",(function(){return We})),n.d(i,"sub",(function(){return He}));var o={};n.r(o),n.d(o,"create",(function(){return Xe})),n.d(o,"clone",(function(){return ze})),n.d(o,"length",(function(){return Ye})),n.d(o,"fromValues",(function(){return Ke})),n.d(o,"copy",(function(){return qe})),n.d(o,"set",(function(){return Ze})),n.d(o,"add",(function(){return Je})),n.d(o,"subtract",(function(){return Qe})),n.d(o,"multiply",(function(){return $e})),n.d(o,"divide",(function(){return et})),n.d(o,"ceil",(function(){return tt})),n.d(o,"floor",(function(){return nt})),n.d(o,"min",(function(){return rt})),n.d(o,"max",(function(){return it})),n.d(o,"round",(function(){return ot})),n.d(o,"scale",(function(){return at})),n.d(o,"scaleAndAdd",(function(){return st})),n.d(o,"distance",(function(){return ut})),n.d(o,"squaredDistance",(function(){return ct})),n.d(o,"squaredLength",(function(){return lt})),n.d(o,"negate",(function(){return ft})),n.d(o,"inverse",(function(){return ht})),n.d(o,"normalize",(function(){return dt})),n.d(o,"dot",(function(){return pt})),n.d(o,"cross",(function(){return vt})),n.d(o,"lerp",(function(){return yt})),n.d(o,"hermite",(function(){return mt})),n.d(o,"bezier",(function(){return _t})),n.d(o,"random",(function(){return gt})),n.d(o,"transformMat4",(function(){return Et})),n.d(o,"transformMat3",(function(){return Tt})),n.d(o,"transformQuat",(function(){return bt})),n.d(o,"rotateX",(function(){return St})),n.d(o,"rotateY",(function(){return Rt})),n.d(o,"rotateZ",(function(){return At})),n.d(o,"angle",(function(){return Ot})),n.d(o,"zero",(function(){return Ct})),n.d(o,"str",(function(){return Mt})),n.d(o,"exactEquals",(function(){return xt})),n.d(o,"equals",(function(){return Pt})),n.d(o,"sub",(function(){return Ft})),n.d(o,"mul",(function(){return It})),n.d(o,"div",(function(){return Dt})),n.d(o,"dist",(function(){return Lt})),n.d(o,"sqrDist",(function(){return Bt})),n.d(o,"len",(function(){return wt})),n.d(o,"sqrLen",(function(){return kt})),n.d(o,"forEach",(function(){return Ut}));var a={};n.r(a),n.d(a,"create",(function(){return Gt})),n.d(a,"clone",(function(){return jt})),n.d(a,"fromValues",(function(){return Vt})),n.d(a,"copy",(function(){return Wt})),n.d(a,"set",(function(){return Ht})),n.d(a,"add",(function(){return Xt})),n.d(a,"subtract",(function(){return zt})),n.d(a,"multiply",(function(){return Yt})),n.d(a,"divide",(function(){return Kt})),n.d(a,"ceil",(function(){return qt})),n.d(a,"floor",(function(){return Zt})),n.d(a,"min",(function(){return Jt})),n.d(a,"max",(function(){return Qt})),n.d(a,"round",(function(){return $t})),n.d(a,"scale",(function(){return en})),n.d(a,"scaleAndAdd",(function(){return tn})),n.d(a,"distance",(function(){return nn})),n.d(a,"squaredDistance",(function(){return rn})),n.d(a,"length",(function(){return on})),n.d(a,"squaredLength",(function(){return an})),n.d(a,"negate",(function(){return sn})),n.d(a,"inverse",(function(){return un})),n.d(a,"normalize",(function(){return cn})),n.d(a,"dot",(function(){return ln})),n.d(a,"cross",(function(){return fn})),n.d(a,"lerp",(function(){return hn})),n.d(a,"random",(function(){return dn})),n.d(a,"transformMat4",(function(){return pn})),n.d(a,"transformQuat",(function(){return vn})),n.d(a,"zero",(function(){return yn})),n.d(a,"str",(function(){return mn})),n.d(a,"exactEquals",(function(){return _n})),n.d(a,"equals",(function(){return gn})),n.d(a,"sub",(function(){return En})),n.d(a,"mul",(function(){return Tn})),n.d(a,"div",(function(){return bn})),n.d(a,"dist",(function(){return Sn})),n.d(a,"sqrDist",(function(){return Rn})),n.d(a,"len",(function(){return An})),n.d(a,"sqrLen",(function(){return On})),n.d(a,"forEach",(function(){return Cn}));var s={};n.r(s),n.d(s,"create",(function(){return Mn})),n.d(s,"identity",(function(){return xn})),n.d(s,"setAxisAngle",(function(){return Pn})),n.d(s,"getAxisAngle",(function(){return Nn})),n.d(s,"getAngle",(function(){return Fn})),n.d(s,"multiply",(function(){return In})),n.d(s,"rotateX",(function(){return Dn})),n.d(s,"rotateY",(function(){return Ln})),n.d(s,"rotateZ",(function(){return Bn})),n.d(s,"calculateW",(function(){return wn})),n.d(s,"exp",(function(){return kn})),n.d(s,"ln",(function(){return Un})),n.d(s,"pow",(function(){return Gn})),n.d(s,"slerp",(function(){return jn})),n.d(s,"random",(function(){return Vn})),n.d(s,"invert",(function(){return Wn})),n.d(s,"conjugate",(function(){return Hn})),n.d(s,"fromMat3",(function(){return Xn})),n.d(s,"fromEuler",(function(){return zn})),n.d(s,"str",(function(){return Yn})),n.d(s,"clone",(function(){return er})),n.d(s,"fromValues",(function(){return tr})),n.d(s,"copy",(function(){return nr})),n.d(s,"set",(function(){return rr})),n.d(s,"add",(function(){return ir})),n.d(s,"mul",(function(){return or})),n.d(s,"scale",(function(){return ar})),n.d(s,"dot",(function(){return sr})),n.d(s,"lerp",(function(){return ur})),n.d(s,"length",(function(){return cr})),n.d(s,"len",(function(){return lr})),n.d(s,"squaredLength",(function(){return fr})),n.d(s,"sqrLen",(function(){return hr})),n.d(s,"normalize",(function(){return dr})),n.d(s,"exactEquals",(function(){return pr})),n.d(s,"equals",(function(){return vr})),n.d(s,"rotationTo",(function(){return yr})),n.d(s,"sqlerp",(function(){return mr})),n.d(s,"setAxes",(function(){return _r}));var u={};n.r(u),n.d(u,"create",(function(){return gr})),n.d(u,"clone",(function(){return Er})),n.d(u,"fromValues",(function(){return Tr})),n.d(u,"copy",(function(){return br})),n.d(u,"set",(function(){return Sr})),n.d(u,"add",(function(){return Rr})),n.d(u,"subtract",(function(){return Ar})),n.d(u,"multiply",(function(){return Or})),n.d(u,"divide",(function(){return Cr})),n.d(u,"ceil",(function(){return Mr})),n.d(u,"floor",(function(){return xr})),n.d(u,"min",(function(){return Pr})),n.d(u,"max",(function(){return Nr})),n.d(u,"round",(function(){return Fr})),n.d(u,"scale",(function(){return Ir})),n.d(u,"scaleAndAdd",(function(){return Dr})),n.d(u,"distance",(function(){return Lr})),n.d(u,"squaredDistance",(function(){return Br})),n.d(u,"length",(function(){return wr})),n.d(u,"squaredLength",(function(){return kr})),n.d(u,"negate",(function(){return Ur})),n.d(u,"inverse",(function(){return Gr})),n.d(u,"normalize",(function(){return jr})),n.d(u,"dot",(function(){return Vr})),n.d(u,"cross",(function(){return Wr})),n.d(u,"lerp",(function(){return Hr})),n.d(u,"random",(function(){return Xr})),n.d(u,"transformMat2",(function(){return zr})),n.d(u,"transformMat2d",(function(){return Yr})),n.d(u,"transformMat3",(function(){return Kr})),n.d(u,"transformMat4",(function(){return qr})),n.d(u,"rotate",(function(){return Zr})),n.d(u,"angle",(function(){return Jr})),n.d(u,"zero",(function(){return Qr})),n.d(u,"str",(function(){return $r})),n.d(u,"exactEquals",(function(){return ei})),n.d(u,"equals",(function(){return ti})),n.d(u,"len",(function(){return ri})),n.d(u,"sub",(function(){return ii})),n.d(u,"mul",(function(){return oi})),n.d(u,"div",(function(){return ai})),n.d(u,"dist",(function(){return si})),n.d(u,"sqrDist",(function(){return ui})),n.d(u,"sqrLen",(function(){return ci})),n.d(u,"forEach",(function(){return li}));n(63);var c=n(1),l=n(0),f=n(34),h=function(){function e(){this.pool={}}return e.prototype.getByEntity=function(e){return this.pool[e]},e.prototype.add=function(e,t){this.pool[e]=t},e.prototype.remove=function(e){delete this.pool[e]},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),d=(n(11),n(12),n(24),1e-6),p="undefined"!=typeof Float32Array?Float32Array:Array,v=Math.random;Math.PI;function y(){var e=new p(9);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function m(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function _(e){var t=new p(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function g(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function E(e,t,n,r,i,o,a,s,u){var c=new p(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function T(e,t,n,r,i,o,a,s,u,c){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e}function b(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function S(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function R(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=l*a-s*c,h=-l*o+s*u,d=c*o-a*u,p=n*f+r*h+i*d;return p?(p=1/p,e[0]=f*p,e[1]=(-l*r+i*c)*p,e[2]=(s*r-i*a)*p,e[3]=h*p,e[4]=(l*n-i*u)*p,e[5]=(-s*n+i*o)*p,e[6]=d*p,e[7]=(-c*n+r*u)*p,e[8]=(a*n-r*o)*p,e):null}function A(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=a*l-s*c,e[1]=i*c-r*l,e[2]=r*s-i*a,e[3]=s*u-o*l,e[4]=n*l-i*u,e[5]=i*o-n*s,e[6]=o*c-a*u,e[7]=r*u-n*c,e[8]=n*a-r*o,e}function O(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)}function C(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=n[0],d=n[1],p=n[2],v=n[3],y=n[4],m=n[5],_=n[6],g=n[7],E=n[8];return e[0]=h*r+d*a+p*c,e[1]=h*i+d*s+p*l,e[2]=h*o+d*u+p*f,e[3]=v*r+y*a+m*c,e[4]=v*i+y*s+m*l,e[5]=v*o+y*u+m*f,e[6]=_*r+g*a+E*c,e[7]=_*i+g*s+E*l,e[8]=_*o+g*u+E*f,e}function M(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=n[0],d=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=h*r+d*a+c,e[7]=h*i+d*s+l,e[8]=h*o+d*u+f,e}function x(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=Math.sin(n),d=Math.cos(n);return e[0]=d*r+h*a,e[1]=d*i+h*s,e[2]=d*o+h*u,e[3]=d*a-h*r,e[4]=d*s-h*i,e[5]=d*u-h*o,e[6]=c,e[7]=l,e[8]=f,e}function P(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function N(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function F(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function I(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function D(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function L(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,y=o*s,m=o*u;return e[0]=1-f-p,e[3]=l-m,e[6]=h+y,e[1]=l+m,e[4]=1-c-p,e[7]=d-v,e[2]=h-y,e[5]=d+v,e[8]=1-c-f,e}function B(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],y=t[14],m=t[15],_=n*s-r*a,g=n*u-i*a,E=n*c-o*a,T=r*u-i*s,b=r*c-o*s,S=i*c-o*u,R=l*v-f*p,A=l*y-h*p,O=l*m-d*p,C=f*y-h*v,M=f*m-d*v,x=h*m-d*y,P=_*x-g*M+E*C+T*O-b*A+S*R;return P?(P=1/P,e[0]=(s*x-u*M+c*C)*P,e[1]=(u*O-a*x-c*A)*P,e[2]=(a*M-s*O+c*R)*P,e[3]=(i*M-r*x-o*C)*P,e[4]=(n*x-i*O+o*A)*P,e[5]=(r*O-n*M-o*R)*P,e[6]=(v*S-y*b+m*T)*P,e[7]=(y*E-p*S-m*g)*P,e[8]=(p*b-v*E+m*_)*P,e):null}function w(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function k(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function U(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function G(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function j(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function V(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}function W(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e}function H(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function X(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=t[0],h=t[1],p=t[2],v=t[3],y=t[4],m=t[5],_=t[6],g=t[7],E=t[8];return Math.abs(n-f)<=d*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-p)<=d*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-v)<=d*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-y)<=d*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-_)<=d*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-E)<=d*Math.max(1,Math.abs(l),Math.abs(E))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var z=C,Y=j;function K(){var e=new p(16);return p!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function q(e){var t=new p(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Z(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function J(e,t,n,r,i,o,a,s,u,c,l,f,h,d,v,y){var m=new p(16);return m[0]=e,m[1]=t,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=a,m[7]=s,m[8]=u,m[9]=c,m[10]=l,m[11]=f,m[12]=h,m[13]=d,m[14]=v,m[15]=y,m}function Q(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p,v,y){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=f,e[11]=h,e[12]=d,e[13]=p,e[14]=v,e[15]=y,e}function $(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ee(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function te(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],y=t[14],m=t[15],_=n*s-r*a,g=n*u-i*a,E=n*c-o*a,T=r*u-i*s,b=r*c-o*s,S=i*c-o*u,R=l*v-f*p,A=l*y-h*p,O=l*m-d*p,C=f*y-h*v,M=f*m-d*v,x=h*m-d*y,P=_*x-g*M+E*C+T*O-b*A+S*R;return P?(P=1/P,e[0]=(s*x-u*M+c*C)*P,e[1]=(i*M-r*x-o*C)*P,e[2]=(v*S-y*b+m*T)*P,e[3]=(h*b-f*S-d*T)*P,e[4]=(u*O-a*x-c*A)*P,e[5]=(n*x-i*O+o*A)*P,e[6]=(y*E-p*S-m*g)*P,e[7]=(l*S-h*E+d*g)*P,e[8]=(a*M-s*O+c*R)*P,e[9]=(r*O-n*M-o*R)*P,e[10]=(p*b-v*E+m*_)*P,e[11]=(f*E-l*b-d*_)*P,e[12]=(s*A-a*C-u*R)*P,e[13]=(n*C-r*A+i*R)*P,e[14]=(v*g-p*T-y*_)*P,e[15]=(l*T-f*g+h*_)*P,e):null}function ne(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],d=t[11],p=t[12],v=t[13],y=t[14],m=t[15];return e[0]=s*(h*m-d*y)-f*(u*m-c*y)+v*(u*d-c*h),e[1]=-(r*(h*m-d*y)-f*(i*m-o*y)+v*(i*d-o*h)),e[2]=r*(u*m-c*y)-s*(i*m-o*y)+v*(i*c-o*u),e[3]=-(r*(u*d-c*h)-s*(i*d-o*h)+f*(i*c-o*u)),e[4]=-(a*(h*m-d*y)-l*(u*m-c*y)+p*(u*d-c*h)),e[5]=n*(h*m-d*y)-l*(i*m-o*y)+p*(i*d-o*h),e[6]=-(n*(u*m-c*y)-a*(i*m-o*y)+p*(i*c-o*u)),e[7]=n*(u*d-c*h)-a*(i*d-o*h)+l*(i*c-o*u),e[8]=a*(f*m-d*v)-l*(s*m-c*v)+p*(s*d-c*f),e[9]=-(n*(f*m-d*v)-l*(r*m-o*v)+p*(r*d-o*f)),e[10]=n*(s*m-c*v)-a*(r*m-o*v)+p*(r*c-o*s),e[11]=-(n*(s*d-c*f)-a*(r*d-o*f)+l*(r*c-o*s)),e[12]=-(a*(f*y-h*v)-l*(s*y-u*v)+p*(s*h-u*f)),e[13]=n*(f*y-h*v)-l*(r*y-i*v)+p*(r*h-i*f),e[14]=-(n*(s*y-u*v)-a*(r*y-i*v)+p*(r*u-i*s)),e[15]=n*(s*h-u*f)-a*(r*h-i*f)+l*(r*u-i*s),e}function re(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],d=e[12],p=e[13],v=e[14],y=e[15];return(t*a-n*o)*(f*y-h*v)-(t*s-r*o)*(l*y-h*p)+(t*u-i*o)*(l*v-f*p)+(n*s-r*a)*(c*y-h*d)-(n*u-i*a)*(c*v-f*d)+(r*u-i*s)*(c*p-l*d)}function ie(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],v=t[12],y=t[13],m=t[14],_=t[15],g=n[0],E=n[1],T=n[2],b=n[3];return e[0]=g*r+E*s+T*f+b*v,e[1]=g*i+E*u+T*h+b*y,e[2]=g*o+E*c+T*d+b*m,e[3]=g*a+E*l+T*p+b*_,g=n[4],E=n[5],T=n[6],b=n[7],e[4]=g*r+E*s+T*f+b*v,e[5]=g*i+E*u+T*h+b*y,e[6]=g*o+E*c+T*d+b*m,e[7]=g*a+E*l+T*p+b*_,g=n[8],E=n[9],T=n[10],b=n[11],e[8]=g*r+E*s+T*f+b*v,e[9]=g*i+E*u+T*h+b*y,e[10]=g*o+E*c+T*d+b*m,e[11]=g*a+E*l+T*p+b*_,g=n[12],E=n[13],T=n[14],b=n[15],e[12]=g*r+E*s+T*f+b*v,e[13]=g*i+E*u+T*h+b*y,e[14]=g*o+E*c+T*d+b*m,e[15]=g*a+E*l+T*p+b*_,e}function oe(e,t,n){var r,i,o,a,s,u,c,l,f,h,d,p,v=n[0],y=n[1],m=n[2];return t===e?(e[12]=t[0]*v+t[4]*y+t[8]*m+t[12],e[13]=t[1]*v+t[5]*y+t[9]*m+t[13],e[14]=t[2]*v+t[6]*y+t[10]*m+t[14],e[15]=t[3]*v+t[7]*y+t[11]*m+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=h,e[10]=d,e[11]=p,e[12]=r*v+s*y+f*m+t[12],e[13]=i*v+u*y+h*m+t[13],e[14]=o*v+c*y+d*m+t[14],e[15]=a*v+l*y+p*m+t[15]),e}function ae(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function se(e,t,n,r){var i,o,a,s,u,c,l,f,h,p,v,y,m,_,g,E,T,b,S,R,A,O,C,M,x=r[0],P=r[1],N=r[2],F=Math.hypot(x,P,N);return F<d?null:(x*=F=1/F,P*=F,N*=F,i=Math.sin(n),a=1-(o=Math.cos(n)),s=t[0],u=t[1],c=t[2],l=t[3],f=t[4],h=t[5],p=t[6],v=t[7],y=t[8],m=t[9],_=t[10],g=t[11],E=x*x*a+o,T=P*x*a+N*i,b=N*x*a-P*i,S=x*P*a-N*i,R=P*P*a+o,A=N*P*a+x*i,O=x*N*a+P*i,C=P*N*a-x*i,M=N*N*a+o,e[0]=s*E+f*T+y*b,e[1]=u*E+h*T+m*b,e[2]=c*E+p*T+_*b,e[3]=l*E+v*T+g*b,e[4]=s*S+f*R+y*A,e[5]=u*S+h*R+m*A,e[6]=c*S+p*R+_*A,e[7]=l*S+v*R+g*A,e[8]=s*O+f*C+y*M,e[9]=u*O+h*C+m*M,e[10]=c*O+p*C+_*M,e[11]=l*O+v*C+g*M,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ue(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+f*r,e[7]=u*i+h*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=f*i-s*r,e[11]=h*i-u*r,e}function ce(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-f*r,e[3]=u*i-h*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+f*i,e[11]=u*r+h*i,e}function le(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+f*r,e[3]=u*i+h*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=f*i-s*r,e[7]=h*i-u*r,e}function fe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function he(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function de(e,t,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.hypot(a,s,u);return c<d?null:(a*=c=1/c,s*=c,u*=c,r=Math.sin(t),o=1-(i=Math.cos(t)),e[0]=a*a*o+i,e[1]=s*a*o+u*r,e[2]=u*a*o-s*r,e[3]=0,e[4]=a*s*o-u*r,e[5]=s*s*o+i,e[6]=u*s*o+a*r,e[7]=0,e[8]=a*u*o+s*r,e[9]=s*u*o-a*r,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function pe(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ve(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ye(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function me(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,f=r*u,h=r*c,d=i*u,p=i*c,v=o*c,y=a*s,m=a*u,_=a*c;return e[0]=1-(d+v),e[1]=f+_,e[2]=h-m,e[3]=0,e[4]=f-_,e[5]=1-(l+v),e[6]=p+y,e[7]=0,e[8]=h+m,e[9]=p-y,e[10]=1-(l+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function _e(e,t){var n=new p(3),r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=r*r+i*i+o*o+a*a;return f>0?(n[0]=2*(s*a+l*r+u*o-c*i)/f,n[1]=2*(u*a+l*i+c*r-s*o)/f,n[2]=2*(c*a+l*o+s*i-u*r)/f):(n[0]=2*(s*a+l*r+u*o-c*i),n[1]=2*(u*a+l*i+c*r-s*o),n[2]=2*(c*a+l*o+s*i-u*r)),me(e,t,n),e}function ge(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Ee(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(u,c,l),e}function Te(e,t){var n=new p(3);Ee(n,t);var r=1/n[0],i=1/n[1],o=1/n[2],a=t[0]*r,s=t[1]*i,u=t[2]*o,c=t[4]*r,l=t[5]*i,f=t[6]*o,h=t[8]*r,d=t[9]*i,v=t[10]*o,y=a+l+v,m=0;return y>0?(m=2*Math.sqrt(y+1),e[3]=.25*m,e[0]=(f-d)/m,e[1]=(h-u)/m,e[2]=(s-c)/m):a>l&&a>v?(m=2*Math.sqrt(1+a-l-v),e[3]=(f-d)/m,e[0]=.25*m,e[1]=(s+c)/m,e[2]=(h+u)/m):l>v?(m=2*Math.sqrt(1+l-a-v),e[3]=(h-u)/m,e[0]=(s+c)/m,e[1]=.25*m,e[2]=(f+d)/m):(m=2*Math.sqrt(1+v-a-l),e[3]=(s-c)/m,e[0]=(h+u)/m,e[1]=(f+d)/m,e[2]=.25*m),e}function be(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,c=o+o,l=a+a,f=i*u,h=i*c,d=i*l,p=o*c,v=o*l,y=a*l,m=s*u,_=s*c,g=s*l,E=r[0],T=r[1],b=r[2];return e[0]=(1-(p+y))*E,e[1]=(h+g)*E,e[2]=(d-_)*E,e[3]=0,e[4]=(h-g)*T,e[5]=(1-(f+y))*T,e[6]=(v+m)*T,e[7]=0,e[8]=(d+_)*b,e[9]=(v-m)*b,e[10]=(1-(f+p))*b,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function Se(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],u=t[3],c=o+o,l=a+a,f=s+s,h=o*c,d=o*l,p=o*f,v=a*l,y=a*f,m=s*f,_=u*c,g=u*l,E=u*f,T=r[0],b=r[1],S=r[2],R=i[0],A=i[1],O=i[2],C=(1-(v+m))*T,M=(d+E)*T,x=(p-g)*T,P=(d-E)*b,N=(1-(h+m))*b,F=(y+_)*b,I=(p+g)*S,D=(y-_)*S,L=(1-(h+v))*S;return e[0]=C,e[1]=M,e[2]=x,e[3]=0,e[4]=P,e[5]=N,e[6]=F,e[7]=0,e[8]=I,e[9]=D,e[10]=L,e[11]=0,e[12]=n[0]+R-(C*R+P*A+I*O),e[13]=n[1]+A-(M*R+N*A+D*O),e[14]=n[2]+O-(x*R+F*A+L*O),e[15]=1,e}function Re(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,y=o*s,m=o*u;return e[0]=1-f-p,e[1]=l+m,e[2]=h-y,e[3]=0,e[4]=l-m,e[5]=1-c-p,e[6]=d+v,e[7]=0,e[8]=h+y,e[9]=d-v,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ae(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}function Oe(e,t,n,r,i){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}var Ce=Oe;function Me(e,t,n,r,i){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=i*o,e[14]=i*r*o):(e[10]=-1,e[14]=-r),e}function xe(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function Pe(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e}var Ne=Pe;function Fe(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=o*c,e[15]=1,e}function Ie(e,t,n,r){var i,o,a,s,u,c,l,f,h,p,v=t[0],y=t[1],m=t[2],_=r[0],g=r[1],E=r[2],T=n[0],b=n[1],S=n[2];return Math.abs(v-T)<d&&Math.abs(y-b)<d&&Math.abs(m-S)<d?$(e):(l=v-T,f=y-b,h=m-S,i=g*(h*=p=1/Math.hypot(l,f,h))-E*(f*=p),o=E*(l*=p)-_*h,a=_*f-g*l,(p=Math.hypot(i,o,a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),s=f*a-h*o,u=h*i-l*a,c=l*o-f*i,(p=Math.hypot(s,u,c))?(s*=p=1/p,u*=p,c*=p):(s=0,u=0,c=0),e[0]=i,e[1]=s,e[2]=l,e[3]=0,e[4]=o,e[5]=u,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=h,e[11]=0,e[12]=-(i*v+o*y+a*m),e[13]=-(s*v+u*y+c*m),e[14]=-(l*v+f*y+h*m),e[15]=1,e)}function De(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=r[0],u=r[1],c=r[2],l=i-n[0],f=o-n[1],h=a-n[2],d=l*l+f*f+h*h;d>0&&(l*=d=1/Math.sqrt(d),f*=d,h*=d);var p=u*h-c*f,v=c*l-s*h,y=s*f-u*l;return(d=p*p+v*v+y*y)>0&&(p*=d=1/Math.sqrt(d),v*=d,y*=d),e[0]=p,e[1]=v,e[2]=y,e[3]=0,e[4]=f*y-h*v,e[5]=h*p-l*y,e[6]=l*v-f*p,e[7]=0,e[8]=l,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function Le(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Be(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function we(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function ke(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Ue(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function Ge(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function je(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Ve(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],p=e[11],v=e[12],y=e[13],m=e[14],_=e[15],g=t[0],E=t[1],T=t[2],b=t[3],S=t[4],R=t[5],A=t[6],O=t[7],C=t[8],M=t[9],x=t[10],P=t[11],N=t[12],F=t[13],I=t[14],D=t[15];return Math.abs(n-g)<=d*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-E)<=d*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(i-T)<=d*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(o-b)<=d*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-S)<=d*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-R)<=d*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(u-A)<=d*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(c-O)<=d*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(l-C)<=d*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(f-M)<=d*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(h-x)<=d*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(p-P)<=d*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(v-N)<=d*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(y-F)<=d*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(m-I)<=d*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(_-D)<=d*Math.max(1,Math.abs(_),Math.abs(D))}var We=ie,He=ke;function Xe(){var e=new p(3);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ze(e){var t=new p(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Ye(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function Ke(e,t,n){var r=new p(3);return r[0]=e,r[1]=t,r[2]=n,r}function qe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ze(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Je(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Qe(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function $e(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function et(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function tt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function nt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function rt(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function it(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function ot(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function at(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function st(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function ut(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function ct(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function lt(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function ft(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ht(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function dt(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function pt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vt(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}function yt(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}function mt(e,t,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return e[0]=t[0]*s+n[0]*u+r[0]*c+i[0]*l,e[1]=t[1]*s+n[1]*u+r[1]*c+i[1]*l,e[2]=t[2]*s+n[2]*u+r[2]*c+i[2]*l,e}function _t(e,t,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,f=3*u*a,h=u*o;return e[0]=t[0]*c+n[0]*l+r[0]*f+i[0]*h,e[1]=t[1]*c+n[1]*l+r[1]*f+i[1]*h,e[2]=t[2]*c+n[2]*l+r[2]*f+i[2]*h,e}function gt(e,t){t=t||1;var n=2*v()*Math.PI,r=2*v()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function Et(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}function Tt(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}function bt(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],c=t[2],l=i*c-o*u,f=o*s-r*c,h=r*u-i*s,d=i*h-o*f,p=o*l-r*h,v=r*f-i*l,y=2*a;return l*=y,f*=y,h*=y,d*=2,p*=2,v*=2,e[0]=s+l+d,e[1]=u+f+p,e[2]=c+h+v,e}function St(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}function Rt(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}function At(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}function Ot(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],a=t[1],s=t[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&pt(e,t)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function Ct(e){return e[0]=0,e[1]=0,e[2]=0,e}function Mt(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function xt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Pt(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],a=t[1],s=t[2];return Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}var Nt,Ft=Qe,It=$e,Dt=et,Lt=ut,Bt=ct,wt=Ye,kt=lt,Ut=(Nt=Xe(),function(e,t,n,r,i,o){var a,s;for(t||(t=3),n||(n=0),s=r?Math.min(r*t+n,e.length):e.length,a=n;a<s;a+=t)Nt[0]=e[a],Nt[1]=e[a+1],Nt[2]=e[a+2],i(Nt,Nt,o),e[a]=Nt[0],e[a+1]=Nt[1],e[a+2]=Nt[2];return e});function Gt(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function jt(e){var t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Vt(e,t,n,r){var i=new p(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function Wt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ht(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function Xt(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function zt(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function Yt(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function Kt(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function qt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Zt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Jt(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function Qt(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function $t(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function en(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function tn(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function nn(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.hypot(n,r,i,o)}function rn(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function on(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function an(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function sn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function un(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function cn(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a,e}function ln(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function fn(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],l=t[0],f=t[1],h=t[2],d=t[3];return e[0]=f*c-h*u+d*s,e[1]=-l*c+h*a-d*o,e[2]=l*u-f*a+d*i,e[3]=-l*s+f*o-h*i,e}function hn(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e}function dn(e,t){var n,r,i,o,a,s;t=t||1;do{a=(n=2*v()-1)*n+(r=2*v()-1)*r}while(a>=1);do{s=(i=2*v()-1)*i+(o=2*v()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*i*u,e[3]=t*o*u,e}function pn(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}function vn(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,d=-a*r-s*i-u*o;return e[0]=l*c+d*-a+f*-u-h*-s,e[1]=f*c+d*-s+h*-a-l*-u,e[2]=h*c+d*-u+l*-s-f*-a,e[3]=t[3],e}function yn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function mn(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function _n(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function gn(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))}var En=zt,Tn=Yt,bn=Kt,Sn=nn,Rn=rn,An=on,On=an,Cn=function(){var e=Gt();return function(t,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();function Mn(){var e=new p(4);return p!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function xn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Pn(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Nn(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>d?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function Fn(e,t){var n=sr(e,t);return Math.acos(2*n*n-1)}function In(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],c=n[2],l=n[3];return e[0]=r*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-r*c,e[2]=o*l+a*c+r*u-i*s,e[3]=a*l-r*s-i*u-o*c,e}function Dn(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e}function Ln(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e}function Bn(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e}function wn(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function kn(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=Math.sqrt(n*n+r*r+i*i),s=Math.exp(o),u=a>0?s*Math.sin(a)/a:0;return e[0]=n*u,e[1]=r*u,e[2]=i*u,e[3]=s*Math.cos(a),e}function Un(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=Math.sqrt(n*n+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return e[0]=n*s,e[1]=r*s,e[2]=i*s,e[3]=.5*Math.log(n*n+r*r+i*i+o*o),e}function Gn(e,t,n){return Un(e,t),ar(e,e,n),kn(e,e),e}function jn(e,t,n,r){var i,o,a,s,u,c=t[0],l=t[1],f=t[2],h=t[3],p=n[0],v=n[1],y=n[2],m=n[3];return(o=c*p+l*v+f*y+h*m)<0&&(o=-o,p=-p,v=-v,y=-y,m=-m),1-o>d?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*c+u*p,e[1]=s*l+u*v,e[2]=s*f+u*y,e[3]=s*h+u*m,e}function Vn(e){var t=v(),n=v(),r=v(),i=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=o*Math.sin(2*Math.PI*r),e[3]=o*Math.cos(2*Math.PI*r),e}function Wn(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e}function Hn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Xn(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e}function zn(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r);return e[0]=o*u*l-a*s*c,e[1]=a*s*l+o*u*c,e[2]=a*u*c-o*s*l,e[3]=a*u*l+o*s*c,e}function Yn(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Kn,qn,Zn,Jn,Qn,$n,er=jt,tr=Vt,nr=Wt,rr=Ht,ir=Xt,or=In,ar=en,sr=ln,ur=hn,cr=on,lr=cr,fr=an,hr=fr,dr=cn,pr=_n,vr=gn,yr=(Kn=Xe(),qn=Ke(1,0,0),Zn=Ke(0,1,0),function(e,t,n){var r=pt(t,n);return r<-.999999?(vt(Kn,qn,t),wt(Kn)<1e-6&&vt(Kn,Zn,t),dt(Kn,Kn),Pn(e,Kn,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(vt(Kn,t,n),e[0]=Kn[0],e[1]=Kn[1],e[2]=Kn[2],e[3]=1+r,dr(e,e))}),mr=(Jn=Mn(),Qn=Mn(),function(e,t,n,r,i,o){return jn(Jn,t,i,o),jn(Qn,n,r,o),jn(e,Jn,Qn,2*o*(1-o)),e}),_r=($n=y(),function(e,t,n,r){return $n[0]=n[0],$n[3]=n[1],$n[6]=n[2],$n[1]=r[0],$n[4]=r[1],$n[7]=r[2],$n[2]=-t[0],$n[5]=-t[1],$n[8]=-t[2],dr(e,Xn(e,$n))});function gr(){var e=new p(2);return p!=Float32Array&&(e[0]=0,e[1]=0),e}function Er(e){var t=new p(2);return t[0]=e[0],t[1]=e[1],t}function Tr(e,t){var n=new p(2);return n[0]=e,n[1]=t,n}function br(e,t){return e[0]=t[0],e[1]=t[1],e}function Sr(e,t,n){return e[0]=t,e[1]=n,e}function Rr(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function Ar(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function Or(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function Cr(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function Mr(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function xr(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Pr(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function Nr(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function Fr(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Ir(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function Dr(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function Lr(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function Br(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function wr(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function kr(e){var t=e[0],n=e[1];return t*t+n*n}function Ur(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Gr(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function jr(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Vr(e,t){return e[0]*t[0]+e[1]*t[1]}function Wr(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function Hr(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}function Xr(e,t){t=t||1;var n=2*v()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function zr(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}function Yr(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function Kr(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}function qr(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}function Zr(e,t,n,r){var i=t[0]-n[0],o=t[1]-n[1],a=Math.sin(r),s=Math.cos(r);return e[0]=i*s-o*a+n[0],e[1]=i*a+o*s+n[1],e}function Jr(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),s=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function Qr(e){return e[0]=0,e[1]=0,e}function $r(e){return"vec2("+e[0]+", "+e[1]+")"}function ei(e,t){return e[0]===t[0]&&e[1]===t[1]}function ti(e,t){var n=e[0],r=e[1],i=t[0],o=t[1];return Math.abs(n-i)<=d*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))}var ni,ri=wr,ii=Ar,oi=Or,ai=Cr,si=Lr,ui=Br,ci=kr,li=function(){var e=gr();return function(t,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),fi=function(){function e(e,t){this.min=o.create(),this.max=o.create(),this.update(e,t)}return e.isEmpty=function(e){return!e||0===e.halfExtents[0]&&0===e.halfExtents[1]&&0===e.halfExtents[2]},e.prototype.update=function(e,t){this.center=o.copy(o.create(),e||o.create()),this.halfExtents=o.copy(o.create(),t||o.fromValues(0,0,0)),this.min=o.sub(this.min,this.center,this.halfExtents),this.max=o.add(this.max,this.center,this.halfExtents)},e.prototype.setMinMax=function(e,t){o.add(this.center,t,e),o.scale(this.center,this.center,.5),o.sub(this.halfExtents,t,e),o.scale(this.halfExtents,this.halfExtents,.5),o.copy(this.min,e),o.copy(this.max,t)},e.prototype.getMin=function(){return this.min},e.prototype.getMax=function(){return this.max},e.prototype.add=function(t){if(!e.isEmpty(t))if(e.isEmpty(this))this.setMinMax(t.getMin(),t.getMax());else{var n=this.center,r=n[0],i=n[1],o=n[2],a=this.halfExtents,s=a[0],u=a[1],c=a[2],l=r-s,f=r+s,h=i-u,d=i+u,p=o-c,v=o+c,y=t.center,m=y[0],_=y[1],g=y[2],E=t.halfExtents,T=E[0],b=E[1],S=E[2],R=m-T,A=m+T,O=_-b,C=_+b,M=g-S,x=g+S;R<l&&(l=R),A>f&&(f=A),O<h&&(h=O),C>d&&(d=C),M<p&&(p=M),x>v&&(v=x),n[0]=.5*(l+f),n[1]=.5*(h+d),n[2]=.5*(p+v),a[0]=.5*(f-l),a[1]=.5*(d-h),a[2]=.5*(v-p),this.min[0]=l,this.min[1]=h,this.min[2]=p,this.max[0]=f,this.max[1]=d,this.max[2]=v}},e.prototype.setFromTransformedAABB=function(e,t){var n=this.center,r=this.halfExtents,i=e.center,a=e.halfExtents,s=t[0],u=t[4],c=t[8],l=t[1],f=t[5],h=t[9],d=t[2],p=t[6],v=t[10],y=Math.abs(s),m=Math.abs(u),_=Math.abs(c),g=Math.abs(l),E=Math.abs(f),T=Math.abs(h),b=Math.abs(d),S=Math.abs(p),R=Math.abs(v);o.set(n,t[12]+s*i[0]+u*i[1]+c*i[2],t[13]+l*i[0]+f*i[1]+h*i[2],t[14]+d*i[0]+p*i[1]+v*i[2]),o.set(r,y*a[0]+m*a[1]+_*a[2],g*a[0]+E*a[1]+T*a[2],b*a[0]+S*a[1]+R*a[2]),this.min=o.sub(this.min,n,r),this.max=o.add(this.max,n,r)},e.prototype.intersects=function(e){var t=this.getMax(),n=this.getMin(),r=e.getMax(),i=e.getMin();return n[0]<=r[0]&&t[0]>=i[0]&&n[1]<=r[1]&&t[1]>=i[1]&&n[2]<=r[2]&&t[2]>=i[2]},e.prototype.intersection=function(t){if(!this.intersects(t))return null;var n=new e,r=o.max(o.create(),this.getMin(),t.getMin()),i=o.min(o.create(),this.getMax(),t.getMax());return n.setMinMax(r,i),n},e.prototype.containsPoint=function(e){var t=this.getMin(),n=this.getMax();return!(e[0]<t[0]||e[0]>n[0]||e[1]<t[1]||e[1]>n[1]||e[2]<t[2]||e[2]>n[2])},e.prototype.getNegativeFarPoint=function(e){return 273===e.pnVertexFlag?o.copy(o.create(),this.min):272===e.pnVertexFlag?o.fromValues(this.min[0],this.min[1],this.max[2]):257===e.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.min[2]):256===e.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.max[2]):17===e.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.min[2]):16===e.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.max[2]):1===e.pnVertexFlag?o.fromValues(this.max[0],this.max[1],this.min[2]):o.fromValues(this.max[0],this.max[1],this.max[2])},e.prototype.getPositiveFarPoint=function(e){return 273===e.pnVertexFlag?o.copy(o.create(),this.max):272===e.pnVertexFlag?o.fromValues(this.max[0],this.max[1],this.min[2]):257===e.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.max[2]):256===e.pnVertexFlag?o.fromValues(this.max[0],this.min[1],this.min[2]):17===e.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.max[2]):16===e.pnVertexFlag?o.fromValues(this.min[0],this.max[1],this.min[2]):1===e.pnVertexFlag?o.fromValues(this.min[0],this.min[1],this.max[2]):o.fromValues(this.min[0],this.min[1],this.min[2])},e}(),hi=o.create(),di=function(){function e(e,t){this.center=e||o.create(),this.radius=t||.5}return e.prototype.containsPoint=function(e){return o.sub(hi,e,this.center),o.length(hi)<this.radius*this.radius},e.prototype.intersects=function(e){o.sub(hi,e.center,this.center);var t=e.radius+this.radius;return o.length(hi)<=t*t},e}(),pi=function(){function e(e,t){this.distance=e||0,this.normal=t||o.fromValues(0,1,0),this.updatePNVertexFlag()}return e.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)},e.prototype.distanceToPoint=function(e){return o.dot(e,this.normal)-this.distance},e.prototype.normalize=function(){var e=1/o.len(this.normal);o.scale(this.normal,this.normal,e),this.distance*=e},e.prototype.intersectsLine=function(e,t,n){var r=this.distanceToPoint(e),i=r/(r-this.distanceToPoint(t)),a=i>=0&&i<=1;return a&&n&&o.lerp(n,e,t,i),a},e}();!function(e){e[e.OUTSIDE=4294967295]="OUTSIDE",e[e.INSIDE=0]="INSIDE",e[e.INDETERMINATE=2147483647]="INDETERMINATE"}(ni||(ni={}));var vi,yi=function(){function e(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new pi)}return e.prototype.extractFromVPMatrix=function(e){var t=Object(l.__read)(e,16),n=t[0],r=t[1],i=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],h=t[8],d=t[9],p=t[10],v=t[11],y=t[12],m=t[13],_=t[14],g=t[15];o.set(this.planes[0].normal,a-n,f-s,v-h),this.planes[0].distance=g-y,o.set(this.planes[1].normal,a+n,f+s,v+h),this.planes[1].distance=g+y,o.set(this.planes[2].normal,a+r,f+u,v+d),this.planes[2].distance=g+m,o.set(this.planes[3].normal,a-r,f-u,v-d),this.planes[3].distance=g-m,o.set(this.planes[4].normal,a-i,f-c,v-p),this.planes[4].distance=g-_,o.set(this.planes[5].normal,a+i,f+c,v+p),this.planes[5].distance=g+_,this.planes.forEach((function(e){e.normalize(),e.updatePNVertexFlag()}))},e}(),mi=o.create(),_i=o.create(),gi=o.create(),Ei=o.create(),Ti=o.create(),bi=function(){function e(e,t){this.origin=e||o.create(),this.direction=t||o.fromValues(0,0,-1)}return e.prototype.intersectsAABB=function(e,t){return t?this.intersectAABBWithIntersection(e,t):this.intersectsAABBWithoutIntersection(e)},e.prototype.intersectsSphere=function(e,t){var n=o.sub(mi,this.origin,e.center);o.normalize(_i,o.copy(_i,this.direction));var r=o.dot(n,_i),i=o.dot(n,n)-e.radius*e.radius;if(i>0&&r>0)return null;var a=r*r-i;if(a<0)return!1;var s=Math.abs(-r-Math.sqrt(a));return t&&(o.copy(t,this.direction),o.scaleAndAdd(t,this.origin,t,s)),!0},e.prototype.intersectsPlane=function(e,t){var n=(e.distance-o.dot(e.normal,this.origin))/o.dot(e.normal,this.direction),r=n>=0;return r&&t&&o.scaleAndAdd(t,this.origin,this.direction,n),r},e.prototype.intersectsAABBWithoutIntersection=function(e){var t=mi,n=_i,r=gi,i=Ei,a=Ti,s=this.direction;return o.sub(t,this.origin,e.center),o.set(i,Math.abs(t[0]),Math.abs(t[1]),Math.abs(t[2])),o.mul(r,t,s),!(i[0]>e.halfExtents[0]&&r[0]>=0||i[1]>e.halfExtents[1]&&r[1]>=0||i[2]>e.halfExtents[2]&&r[2]>=0)&&(o.set(a,Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2])),o.cross(n,s,t),o.set(n,Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2])),!(n[0]>e.halfExtents[1]*a[2]+e.halfExtents[2]*a[1]||n[1]>e.halfExtents[0]*a[2]+e.halfExtents[2]*a[0]||n[2]>e.halfExtents[0]*a[1]+e.halfExtents[1]*a[0]))},e.prototype.intersectAABBWithIntersection=function(e,t){var n=o.copy(o.create(),e.getMin());o.sub(n,n,this.origin);var r=o.copy(o.create(),e.getMax());o.sub(r,r,this.origin);var i=this.direction;0===i[0]?(n[0]=n[0]<0?-Number.MAX_VALUE:Number.MAX_VALUE,r[0]=r[0]<0?-Number.MAX_VALUE:Number.MAX_VALUE):(n[0]/=i[0],r[0]/=i[0]),0===i[1]?(n[1]=n[1]<0?-Number.MAX_VALUE:Number.MAX_VALUE,r[1]=r[1]<0?-Number.MAX_VALUE:Number.MAX_VALUE):(n[1]/=i[1],r[1]/=i[1]),0===i[2]?(n[2]=n[2]<0?-Number.MAX_VALUE:Number.MAX_VALUE,r[2]=r[2]<0?-Number.MAX_VALUE:Number.MAX_VALUE):(n[2]/=i[2],r[2]/=i[2]);var a=o.set(gi,Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.min(n[2],r[2])),s=o.set(Ei,Math.max(n[0],r[0]),Math.max(n[1],r[1]),Math.max(n[2],r[2])),u=Math.min(Math.min(s[0],s[1]),s[2]),c=Math.max(Math.max(a[0],a[1]),a[2]),l=u>=c&&c>=0;return l&&(o.copy(t,this.direction),o.scaleAndAdd(t,this.origin,t,c)),l},e}(),Si=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},e}(),Ri=function(){function e(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r,this.left=e,this.right=e+n,this.top=t,this.bottom=t+r}return e.prototype.toJSON=function(){},e}(),Ai=c.Syringe.defineToken("SceneGraphSelectorFactory"),Oi=c.Syringe.defineToken("SceneGraphSelector",{multiple:!1}),Ci=/\[\s*name=(.*)\s*\]/,Mi=function(){function e(){}return e.prototype.selectOne=function(e,t){if(e.startsWith("."))return t.find((function(t){return t.className===e.substring(1)}));if(e.startsWith("#"))return t.find((function(t){return t.id===e.substring(1)}));if(e.startsWith("[name=")){var n=e.match(Ci);if(n&&n.length>1){var r=n[1].replace(/"/g,"");return t.find((function(e){return t!==e&&e.name===r}))}return null}return t.find((function(n){return t!==n&&n.nodeName===e}))},e.prototype.selectAll=function(e,t){if(e.startsWith("."))return t.findAll((function(n){return t!==n&&n.className===e.substring(1)}));if(e.startsWith("#"))return t.findAll((function(n){return t!==n&&n.id===e.substring(1)}));if(e.startsWith("[name=")){var n=e.match(Ci);if(n&&n.length>1){var r=n[1].replace(/"/g,"");return t.findAll((function(e){return t!==e&&e.name===r}))}return[]}return t.findAll((function(n){return t!==n&&n.nodeName===e}))},e.prototype.is=function(){return!0},e=Object(l.__decorate)([Object(c.singleton)({token:Oi})],e)}();!function(e){e.DESTROY="destroy",e.ATTR_MODIFIED="DOMAttrModified",e.INSERTED="DOMNodeInserted",e.CHILD_INSERTED="child-inserted",e.REMOVED="removed",e.CHILD_REMOVED="child-removed",e.MOUNTED="DOMNodeInsertedIntoDocument",e.UNMOUNTED="DOMNodeRemovedFromDocument",e.BOUNDS_CHANGED="bounds-changed",e.GEOMETRY_BOUNDS_CHANGED="geometry-bounds-changed",e.RENDER_ORDER_CHANGED="render-order-changed"}(vi||(vi={}));var xi=function(){function e(t){this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Si,this.page=new Si,this.canvas=new Si,this.viewport=new Si,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),e.prototype.composedPath=function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(e.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},e.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.initEvent=function(){},e.prototype.initUIEvent=function(){},e}(),Pi=function(e){function t(t,n,r,i,o,a,s,u){var c=e.call(this,null)||this;return c.relatedNode=n,c.prevValue=r,c.newValue=i,c.attrName=o,c.attrChange=a,c.prevParsedValue=s,c.newParsedValue=u,c.type=t,c}return Object(l.__extends)(t,e),t.ADDITION=2,t.MODIFICATION=1,t.REMOVAL=3,t}(xi);function Ni(e){if(!e)throw new Error}function Fi(e,t){if(e!==t)throw new Error}function Ii(e,t){if(e===t)throw new Error}function Di(e){return void 0===e}function Li(e){return null==e}function Bi(e){return"number"==typeof e}function wi(e){return"function"==typeof e}function ki(e){return"boolean"==typeof e}function Ui(e){return"[object Object]"===Object.prototype.toString.call(e)}function Gi(e,t,n){return n?Math.min(e,t)===e?t:Math.max(e,n)===e?n:e:Math.max(e,t)===t?e:t}function ji(e){return void 0===e?0:e>360||e<-360?e%360:e}function Vi(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),Bi(e)?o.fromValues(e,t,n):Array.isArray(e)&&3===e.length?o.clone(e):o.fromValues(e[0],e[1]||t,e[2]||n)}function Wi(e){return e*(Math.PI/180)}function Hi(e){return e*(180/Math.PI)}function Xi(e){return(e%=400)<0&&(e+=400),e/400*360}function zi(e){return e/360}function Yi(e){return 360*e}function Ki(e,t){var n=t[0],r=t[1],i=t[3],o=t[4];return e[0]=Math.hypot(n,r),e[1]=Math.hypot(i,o),e}function qi(e,t){return e[0]=t[6],e[1]=t[7],e}function Zi(e){return Math.atan2(e[1],e[4])}function Ji(e,t){return 16===t.length?function(e,t){var n,r,a=.5*Math.PI,s=Object(l.__read)(i.getScaling(o.create(),t),3),u=s[0],c=s[1],f=s[2],h=Math.asin(-t[2]/u);return h<a?h>-a?(n=Math.atan2(t[6]/c,t[10]/f),r=Math.atan2(t[1]/u,t[0]/u)):(r=0,n=-Math.atan2(t[4]/c,t[5]/c)):(r=0,n=Math.atan2(t[4]/c,t[5]/c)),e[0]=n,e[1]=h,e[2]=r,e}(e,t):function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=r*r,s=i*i,u=o*o,c=n*n+a+s+u,l=n*o-r*i;return l>.499995*c?(e[0]=Math.PI/2,e[1]=2*Math.atan2(r,n),e[2]=0):l<-.499995*c?(e[0]=-Math.PI/2,e[1]=2*Math.atan2(r,n),e[2]=0):(e[0]=Math.asin(2*(n*i-o*r)),e[1]=Math.atan2(2*(n*o+r*i),1-2*(s+u)),e[2]=Math.atan2(2*(n*r+i*o),1-2*(a+s))),e}(e,t)}function Qi(e,t,n,i,o){var a=Math.cos(e),s=Math.sin(e);return r.fromValues(i*a,o*s,0,-i*s,o*a,0,t,n,1)}function $i(e,t,n,r,i,o,a){var s=2*o/(n-t),u=2*o/(r-i),c=(n+t)/(n-t),l=(r+i)/(r-i),f=-(a+o)/(a-o),h=-2*a*o/(a-o);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=c,e[9]=l,e[10]=f,e[11]=-1,e[12]=0,e[13]=0,e[14]=h,e[15]=0,e}function eo(e){var t=e[0],n=e[1],r=e[3],i=e[4],o=Math.sqrt(t*t+n*n),a=Math.sqrt(r*r+i*i);t*i-n*r<0&&(t<i?o=-o:a=-a),o&&(t*=1/o,n*=1/o),a&&(r*=1/a,i*=1/a);var s=Hi(Math.atan2(n,t));return[e[6],e[7],o,a,s]}n(15);var to=c.Syringe.defineToken("StyleValueRegistry"),no="function"==typeof Float32Array,ro=function(e,t){return 1-3*t+3*e},io=function(e,t){return 3*t-6*e},oo=function(e){return 3*e},ao=function(e,t,n){return((ro(t,n)*e+io(t,n))*e+oo(t))*e},so=function(e,t,n){return 3*ro(t,n)*e*e+2*io(t,n)*e+oo(t)},uo=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return function(e){return e};for(var i=no?new Float32Array(11):new Array(11),o=0;o<11;++o)i[o]=ao(.1*o,e,n);var a=function(t){for(var r=0,o=1;10!==o&&i[o]<=t;++o)r+=.1;--o;var a=r+.1*((t-i[o])/(i[o+1]-i[o])),s=so(a,e,n);return s>=.001?function(e,t,n,r){for(var i=0;i<4;++i){var o=so(t,n,r);if(0===o)return t;t-=(ao(t,n,r)-e)/o}return t}(t,a,e,n):0===s?a:function(e,t,n,r,i){var o,a,s=0;do{(o=ao(a=t+(n-t)/2,r,i)-e)>0?n=a:t=a}while(Math.abs(o)>1e-7&&++s<10);return a}(t,r,r+.1,e,n)};return function(e){return 0===e||1===e?e:ao(a(e),t,r)}},co=function(e){return"-"===(e=e.replace(/([A-Z])/g,(function(e){return"-".concat(e.toLowerCase())}))).charAt(0)?e.substr(1):e},lo=function(e,t,n){return Math.min(Math.max(e,t),n)},fo=function(e){return Math.pow(e,2)},ho=function(e){return Math.pow(e,3)},po=function(e){return Math.pow(e,4)},vo=function(e){return Math.pow(e,5)},yo=function(e){return Math.pow(e,6)},mo=function(e){return 1-Math.cos(e*Math.PI/2)},_o=function(e){return 1-Math.sqrt(1-e*e)},go=function(e){return e*e*(3*e-2)},Eo=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)},To=function(e,t){void 0===t&&(t=[]);var n=Object(l.__read)(t,2),r=n[0],i=void 0===r?1:r,o=n[1],a=void 0===o?.5:o,s=lo(Number(i),1,10),u=lo(Number(a),.1,2);return 0===e||1===e?e:-s*Math.pow(2,10*(e-1))*Math.sin((e-1-u/(2*Math.PI)*Math.asin(1/s))*(2*Math.PI)/u)},bo=function(e,t,n){void 0===t&&(t=[]);var r=Object(l.__read)(t,4),i=r[0],o=void 0===i?1:i,a=r[1],s=void 0===a?100:a,u=r[2],c=void 0===u?10:u,f=r[3],h=void 0===f?0:f;o=lo(o,.1,1e3),s=lo(s,.1,1e3),c=lo(c,.1,1e3),h=lo(h,.1,1e3);var d=Math.sqrt(s/o),p=c/(2*Math.sqrt(s*o)),v=p<1?d*Math.sqrt(1-p*p):0,y=p<1?(p*d-h)/v:-h+d,m=n?n*e/1e3:e;return m=p<1?Math.exp(-m*p*d)*(1*Math.cos(v*m)+y*Math.sin(v*m)):(1+y*m)*Math.exp(-m*d),0===e||1===e?e:1-m},So=(new Map,function(e,t){void 0===t&&(t=[]);var n=Object(l.__read)(t,2),r=n[0],i=void 0===r?10:r;return("start"==n[1]?Math.ceil:Math.floor)(lo(e,0,1)*i)/i}),Ro=function(e,t){void 0===t&&(t=[]);var n=Object(l.__read)(t,4),r=n[0],i=n[1],o=n[2],a=n[3];return uo(r,i,o,a)(e)},Ao=uo(.42,0,1,1),Oo=function(e){return function(t,n,r){return void 0===n&&(n=[]),1-e(1-t,n,r)}},Co=function(e){return function(t,n,r){return void 0===n&&(n=[]),t<.5?e(2*t,n,r)/2:1-e(-2*t+2,n,r)/2}},Mo=function(e){return function(t,n,r){return void 0===n&&(n=[]),t<.5?(1-e(1-2*t,n,r))/2:(e(2*t-1,n,r)+1)/2}},xo={steps:So,"step-start":function(e){return So(e,[1,"start"])},"step-end":function(e){return So(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":Ro,ease:function(e){return Ro(e,[.25,.1,.25,1])},in:Ao,out:Oo(Ao),"in-out":Co(Ao),"out-in":Mo(Ao),"in-quad":fo,"out-quad":Oo(fo),"in-out-quad":Co(fo),"out-in-quad":Mo(fo),"in-cubic":ho,"out-cubic":Oo(ho),"in-out-cubic":Co(ho),"out-in-cubic":Mo(ho),"in-quart":po,"out-quart":Oo(po),"in-out-quart":Co(po),"out-in-quart":Mo(po),"in-quint":vo,"out-quint":Oo(vo),"in-out-quint":Co(vo),"out-in-quint":Mo(vo),"in-expo":yo,"out-expo":Oo(yo),"in-out-expo":Co(yo),"out-in-expo":Mo(yo),"in-sine":mo,"out-sine":Oo(mo),"in-out-sine":Co(mo),"out-in-sine":Mo(mo),"in-circ":_o,"out-circ":Oo(_o),"in-out-circ":Co(_o),"out-in-circ":Mo(_o),"in-back":go,"out-back":Oo(go),"in-out-back":Co(go),"out-in-back":Mo(go),"in-bounce":Eo,"out-bounce":Oo(Eo),"in-out-bounce":Co(Eo),"out-in-bounce":Mo(Eo),"in-elastic":To,"out-elastic":Oo(To),"in-out-elastic":Co(To),"out-in-elastic":Mo(To),spring:bo,"spring-in":bo,"spring-out":Oo(bo),"spring-in-out":Co(bo),"spring-out-in":Mo(bo)},Po=function(e){return xo[function(e){return co(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()}(e)]||xo.linear},No=function(e){return e};function Fo(e,t){return function(n){if(n>=1)return 1;var r=1/e;return(n+=t*r)-n%r}}var Io="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Do=new RegExp("cubic-bezier\\("+Io+","+Io+","+Io+","+Io+"\\)"),Lo=/steps\(\s*(\d+)\s*\)/,Bo=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function wo(e){var t=Do.exec(e);if(t)return uo.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(t.slice(1).map(Number)),!1));var n=Lo.exec(e);if(n)return Fo(Number(n[1]),0);var r=Bo.exec(e);return r?Fo(Number(r[1]),{start:1,middle:.5,end:0}[r[2]]):Po(e)}function ko(e){return Math.abs(function(e){var t;if(0===e.duration||0===e.iterations)return 0;return("auto"===e.duration?0:Number(e.duration))*(null!==(t=e.iterations)&&void 0!==t?t:1)}(e)/(e.playbackRate||1))}function Uo(e,t,n){var r=function(e,t,n){if(null===t)return 0;var r=n.endTime;return t<Math.min(n.delay,r)?1:t>=Math.min(n.delay+e+n.endDelay,r)?2:3}(e,t,n),i=function(e,t,n,r,i){switch(r){case 1:return"backwards"===t||"both"===t?0:null;case 3:return n-i;case 2:return"forwards"===t||"both"===t?e:null;case 0:return null}}(e,n.fill,t,r,n.delay);if(null===i)return null;var o="auto"===n.duration?0:n.duration,a=function(e,t,n,r,i){var o=i;return 0===e?1!==t&&(o+=n):o+=r/e,o}(o,r,n.iterations,i,n.iterationStart),s=function(e,t,n,r,i,o){var a=e===1/0?t%1:e%1;return 0!==a||2!==n||0===r||0===i&&0!==o||(a=1),a}(a,n.iterationStart,r,n.iterations,i,o),u=function(e,t,n,r){return 2===e&&t===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,s,a),c=function(e,t,n){var r=e;if("normal"!==e&&"reverse"!==e){var i=t;"alternate-reverse"===e&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,u,s);return n.currentIteration=u,n.progress=c,n.easingFunction(c)}var Go={in:"ease-in",out:"ease-out","in-out":"ease-in-out","in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","in-out-expo":"cubic-bezier(1, 0, 0, 1)","in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"};Object.keys(Go);function jo(e){return void 0===e&&(e=""),e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}function Vo(e){return!Li(e)&&"string"==typeof e}function Wo(e,t,n){var r=function(e,t){for(var n={},r=0;r<e.length;r++)for(var i in e[r])if(Ho(i)){var o={offset:e[r].offset,computedOffset:e[r].computedOffset,easing:e[r].easing,easingFunction:wo(e[r].easing)||t.easingFunction,value:e[r][i]};n[i]=n[i]||[],n[i].push(o)}return n}(e,t),i=function(e,t){var n=[];for(var r in e)for(var i=e[r],o=0;o<i.length-1;o++){var a=o,s=o+1,u=i[a].computedOffset,c=i[s].computedOffset,l=u,f=c;0===o&&(l=-1/0,0===c&&(s=a)),o===i.length-2&&(f=1/0,1===u&&(a=s)),n.push({applyFrom:l,applyTo:f,startOffset:i[a].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[a].easingFunction,property:r,interpolation:zo(r,i[a].value,i[s].value,t)})}return n.sort((function(e,t){return e.startOffset-t.startOffset})),n}(r,n);return function(e,t){if(null!==t)i.filter((function(e){return t>=e.applyFrom&&t<e.applyTo})).forEach((function(n){var r=t-n.startOffset,i=n.endOffset-n.startOffset,o=0===i?0:n.easingFunction(r/i);e.style[n.property]=n.interpolation(o)}));else for(var n in r)Ho(n)&&(e.style[n]=null)}}function Ho(e){return"offset"!==e&&"easing"!==e&&"composite"!==e&&"computedOffset"!==e}var Xo=function(e,t,n){return function(r){return n(function e(t,n,r){if("number"==typeof t&&"number"==typeof n)return t*(1-r)+n*r;if("boolean"==typeof t&&"boolean"==typeof n||"string"==typeof t&&"string"==typeof n)return r<.5?t:n;if(Array.isArray(t)&&Array.isArray(n)&&t.length===n.length){for(var i=[],o=0;o<t.length;o++)i.push(e(t[o],n[o],r));return i}throw new Error("Mismatched interpolation arguments "+t+":"+n)}(e,t,r))}};function zo(e,t,n,r){var i=t,o=n,a=c.GlobalContainer.get(to).getMetadata(e);if(a&&a.handler&&a.interpolable){var s=c.GlobalContainer.get(a.handler);if(s){s.parser&&(i=s.parser(t,r),o=s.parser(n,r));var u=s.mixer(i,o,r);if(u){var f=Xo.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(u),!1));return function(e){return 0===e?t:1===e?n:f(e)}}}}return Xo(!1,!0,(function(e){return e?n:t}))}var Yo={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign",values:{middle:"center"}},src:{alias:"img"}};function Ko(e,t){var n,r=jo(e),i=Yo[r];return[r=(null==i?void 0:i.alias)||r,(null===(n=null==i?void 0:i.values)||void 0===n?void 0:n[t])||t]}n(33),n(152),n(158);function qo(e,t,n,r){var i=e-n,o=t-r;return Math.sqrt(i*i+o*o)}function Zo(e,t){return Math.abs(e-t)<.001}function Jo(e,t){var n=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(e),!1)),r=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(t),!1));return{x:n,y:r,width:Math.max.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(e),!1))-n,height:Math.max.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(t),!1))-r}}function Qo(e){return(e+2*Math.PI)%(2*Math.PI)}var $o={box:function(e,t,n,r){return Jo([e,n],[t,r])},length:function(e,t,n,r){return qo(e,t,n,r)},pointAt:function(e,t,n,r,i){return{x:(1-i)*e+i*n,y:(1-i)*t+i*r}},pointDistance:function(e,t,n,r,i,o){var a=(n-e)*(i-e)+(r-t)*(o-t);return a<0?qo(e,t,i,o):a>(n-e)*(n-e)+(r-t)*(r-t)?qo(n,r,i,o):this.pointToLine(e,t,n,r,i,o)},pointToLine:function(e,t,n,r,i,o){var a=[n-e,r-t];if(u.exactEquals(a,[0,0]))return Math.sqrt((i-e)*(i-e)+(o-t)*(o-t));var s=[-a[1],a[0]];u.normalize(s,s);var c=[i-e,o-t];return Math.abs(u.dot(c,s))},tangentAngle:function(e,t,n,r){return Math.atan2(r-t,n-e)}};function ea(e,t,n,r,i,o){var a=-1,s=1/0,u=[n,r],c=20;o&&o>200&&(c=o/10);for(var f=1/c,h=f/10,d=0;d<=c;d++){var p=d*f,v=[i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(e.concat([p])),!1)),i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(t.concat([p])),!1))];(g=qo(u[0],u[1],v[0],v[1]))<s&&(a=p,s=g)}if(0===a)return{x:e[0],y:t[0]};if(1===a){var y=e.length;return{x:e[y-1],y:t[y-1]}}s=1/0;for(d=0;d<32&&!(h<1e-4);d++){var m=a-h,_=a+h,g=(v=[i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(e.concat([m])),!1)),i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(t.concat([m])),!1))],qo(u[0],u[1],v[0],v[1]));if(m>=0&&g<s)a=m,s=g;else{var E=[i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(e.concat([_])),!1)),i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(t.concat([_])),!1))],T=qo(u[0],u[1],E[0],E[1]);_<=1&&T<s?(a=_,s=T):h*=.5}}return{x:i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(e.concat([a])),!1)),y:i.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(t.concat([a])),!1))}}function ta(e,t,n,r,i){var o=1-i;return o*o*o*e+3*t*i*o*o+3*n*i*i*o+r*i*i*i}function na(e,t,n,r,i){var o=1-i;return 3*(o*o*(t-e)+2*o*i*(n-t)+i*i*(r-n))}function ra(e,t,n,r){var i,o,a,s=-3*e+9*t-9*n+3*r,u=6*e-12*t+6*n,c=3*t-3*e,l=[];if(Zo(s,0))Zo(u,0)||(i=-c/u)>=0&&i<=1&&l.push(i);else{var f=u*u-4*s*c;Zo(f,0)?l.push(-u/(2*s)):f>0&&(o=(-u-(a=Math.sqrt(f)))/(2*s),(i=(-u+a)/(2*s))>=0&&i<=1&&l.push(i),o>=0&&o<=1&&l.push(o))}return l}function ia(e,t,n,r,i,o,a,s,u){var c=ta(e,n,i,a,u),l=ta(t,r,o,s,u),f=$o.pointAt(e,t,n,r,u),h=$o.pointAt(n,r,i,o,u),d=$o.pointAt(i,o,a,s,u),p=$o.pointAt(f.x,f.y,h.x,h.y,u),v=$o.pointAt(h.x,h.y,d.x,d.y,u);return[[e,t,f.x,f.y,p.x,p.y,c,l],[c,l,v.x,v.y,d.x,d.y,a,s]]}function oa(e,t,n,r,i,o,a,s,u){if(0===u)return function(e,t){for(var n=0,r=e.length,i=0;i<r;i++){n+=qo(e[i],t[i],e[(i+1)%r],t[(i+1)%r])}return n/2}([e,n,i,a],[t,r,o,s]);var c=ia(e,t,n,r,i,o,a,s,.5),f=Object(l.__spreadArray)(Object(l.__spreadArray)([],Object(l.__read)(c[0]),!1),[u-1],!1),h=Object(l.__spreadArray)(Object(l.__spreadArray)([],Object(l.__read)(c[1]),!1),[u-1],!1);return oa.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(f),!1))+oa.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(h),!1))}var aa={extrema:ra,box:function(e,t,n,r,i,o,a,s){for(var u=[e,a],c=[t,s],l=ra(e,n,i,a),f=ra(t,r,o,s),h=0;h<l.length;h++)u.push(ta(e,n,i,a,l[h]));for(h=0;h<f.length;h++)c.push(ta(t,r,o,s,f[h]));return Jo(u,c)},length:function(e,t,n,r,i,o,a,s){return oa(e,t,n,r,i,o,a,s,3)},nearestPoint:function(e,t,n,r,i,o,a,s,u,c,l){return ea([e,n,i,a],[t,r,o,s],u,c,ta,l)},pointDistance:function(e,t,n,r,i,o,a,s,u,c,l){var f=this.nearestPoint(e,t,n,r,i,o,a,s,u,c,l);return qo(f.x,f.y,u,c)},interpolationAt:ta,pointAt:function(e,t,n,r,i,o,a,s,u){return{x:ta(e,n,i,a,u),y:ta(t,r,o,s,u)}},divide:function(e,t,n,r,i,o,a,s,u){return ia(e,t,n,r,i,o,a,s,u)},tangentAngle:function(e,t,n,r,i,o,a,s,u){var c=na(e,n,i,a,u),l=na(t,r,o,s,u);return Qo(Math.atan2(l,c))}};function sa(e){if(e.length<2)return 0;for(var t=0,n=0;n<e.length-1;n++){var r=e[n],i=e[n+1];t+=qo(r[0],r[1],i[0],i[1])}return t}var ua=function(e){return sa(e)};var ca,la,fa,ha,da;!function(e){e.GROUP="g",e.CIRCLE="circle",e.ELLIPSE="ellipse",e.IMAGE="image",e.RECT="rect",e.LINE="line",e.POLYLINE="polyline",e.POLYGON="polygon",e.TEXT="text",e.PATH="path",e.HTML="html",e.MESH="mesh"}(ca||(ca={})),function(e){e.BUTT="butt",e.ROUND="round",e.SQUARE="square"}(la||(la={})),function(e){e.BEVEL="bevel",e.ROUND="round",e.MITER="miter"}(fa||(fa={})),function(e){e.CAPITALIZE="capitalize",e.UPPERCASE="uppercase",e.LOWERCASE="lowercase",e.NONE="none"}(ha||(ha={})),function(e){e.START="start",e.CENTER="center",e.END="end",e.LEFT="left",e.RIGHT="right"}(da||(da={}));var pa=c.Syringe.defineToken("CanvasConfig");function va(e,t,n){var r=e[0],i=e[1];return[r+(t[0]-r)*n,i+(t[1]-i)*n]}function ya(e){return e.map((function(e,t,n){var r=t&&n[t-1].slice(-2).concat(e.slice(1)),i=t?aa.length.apply(aa,Object(l.__spreadArray)([],Object(l.__read)(r),!1)):0;return{s:e,ss:t?i?function(e,t){void 0===t&&(t=.5);var n=e.slice(0,2),r=e.slice(2,4),i=e.slice(4,6),o=e.slice(6,8),a=va(n,r,t),s=va(r,i,t),u=va(i,o,t),c=va(a,s,t),l=va(s,u,t),f=va(c,l,t);return[["C"].concat(a,c,f),["C"].concat(l,u,o)]}(r):[e,e]:[e],l:i}}))}function ma(e,t,n){var r=ya(e),i=ya(t),o=r.length,a=i.length,s=r.filter((function(e){return e.l})).length,u=i.filter((function(e){return e.l})).length,c=r.filter((function(e){return e.l})).reduce((function(e,t){return e+t.l}),0)/s||0,l=i.filter((function(e){return e.l})).reduce((function(e,t){return e+t.l}),0)/u||0,f=n||Math.max(o,a),h=[c,l],d=[f-o,f-a],p=0,v=[r,i].map((function(e,t){return e.l===f?e.map((function(e){return e.s})):e.map((function(e,n){return p=n&&d[t]&&e.l>=h[t],d[t]-=p?1:0,p?e.ss:[e.s]})).flat()}));return v[0].length===v[1].length?v:ma(v[0],v[1],f)}function _a(e){return Ea(e)>=0}function ga(e,t,n,r,i,o,a,s){return 3*((s-t)*(n+i)-(a-e)*(r+o)+r*(e-i)-n*(t-o)+s*(i+e/3)-a*(o+t/3))/20}function Ea(e){var t=0,n=0,r=0,i=0,o=0;return e.map((function(e){var a;switch(e[0]){case"M":case"Z":return r="M"===e[0]?e[1]:r,i="M"===e[0]?e[2]:i,t=r,n=i,0;default:return o=ga.apply(0,[t,n].concat(e.slice(1))),a=Object(l.__read)(e.slice(-2),2),t=a[0],n=a[1],o}})).reduce((function(e,t){return e+t}),0)}function Ta(e){var t=e.slice(1).map((function(t,n,r){return n?r[n-1].slice(-2).concat(t.slice(1)):e[0].slice(1).concat(t.slice(1))})).map((function(e){return e.map((function(t,n){return e[e.length-n-2*(1-n%2)]}))})).reverse();return[["M"].concat(t[0].slice(0,2))].concat(t.map((function(e){return["C"].concat(e.slice(2))})))}function ba(e){return e.map((function(e){return Array.isArray(e)?ba(e):Number.isNaN(+e)?e:+e}))}function Sa(e,t){var n=e.length-1,r=[],i=0,o=function(e){var t=e.length,n=t-1;return e.map((function(r,i){return e.map((function(r,o){var a,s=i+o;return 0===o||e[s]&&"M"===e[s][0]?(a=e[s],["M"].concat(a.slice(-2))):(s>=t&&(s-=n),e[s])}))}))}(e);return o.forEach((function(o,a){e.slice(1).forEach((function(r,o){i+=function(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}(e[(a+o)%n].slice(-2),t[o%n].slice(-2))})),r[a]=i,i=0})),o[r.indexOf(Math.min.apply(null,r))]}function Ra(e,t,n,r){var i=(-1+Math.sqrt(2))/3*4,o=e*i,a=t*i,s=n-e,u=n+e,c=r-t,l=r+t;return[["M",s,r],["C",s,r-a,n-o,c,n,c],["C",n+o,c,u,r-a,u,r],["C",u,r+a,n+o,l,n,l],["C",n-o,l,s,r+a,s,r],["Z"]]}function Aa(e,t){void 0===t&&(t=!0);var n=[];switch(e.nodeName){case ca.LINE:var r=e.parsedStyle,i=r.x1,a=r.y1,s=r.x2,u=r.y2;n=function(e,t,n,r){return[["M",e,t],["L",n,r]]}(i.value,a.value,s.value,u.value);break;case ca.CIRCLE:var c=e.parsedStyle,f=c.r,h=c.cx,d=c.cy;n=Ra(f.value,f.value,h.value,d.value);break;case ca.ELLIPSE:var p=e.parsedStyle,v=p.rx,y=p.ry;h=p.cx,d=p.cy;n=Ra(v.value,y.value,h.value,d.value);break;case ca.POLYLINE:case ca.POLYGON:var m=e.parsedStyle.points;n=function(e,t){var n=e.map((function(e,t){return[0===t?"M":"L",e[0],e[1]]}));return t&&n.push(["Z"]),n}(m.points,e.nodeName===ca.POLYGON);break;case ca.RECT:var _=e.parsedStyle,g=_.width,E=_.height,T=_.x,b=_.y,S=_.radius;n=function(e,t,n,r,i){return i?[["M",n,i+r],["A",i,i,0,0,1,i+n,r],["L",e-i+n,r],["A",i,i,0,0,1,e+n,i+r],["L",e+n,t-i+r],["A",i,i,0,0,1,e-i+n,t+r],["L",i+n,t+r],["A",i,i,0,0,1,n,t-i+r],["Z"]]:[["M",n,r],["L",n+e,r],["L",n+e,r+t],["L",n,r+t],["Z"]]}(g.value,E.value,T.value,b.value,(null==S?void 0:S.value)||0);break;case ca.PATH:var R=e.parsedStyle.path,A=R.curve,O=R.zCommandIndexes;n=Object(l.__spreadArray)([],Object(l.__read)(A),!1),O.forEach((function(e,t){n.splice(e+t,1,["Z"])}))}if(n.length)return function(e,t,n){var r;void 0===n&&(n=!0),n&&(r=t.getLocalTransform());var i=t.parsedStyle,a=i.defX,s=void 0===a?0:a,u=i.defY,c=void 0===u?0:u;return e.reduce((function(e,t){var i="";if("M"===t[0]||"L"===t[0]){var a=o.fromValues(t[1]-s,t[2]-c,0);n&&o.transformMat4(a,a,r),i="".concat(t[0]).concat(a[0],",").concat(a[1])}else if("Z"===t[0])i=t[0];else if("C"===t[0]){var u=o.fromValues(t[1]-s,t[2]-c,0),l=o.fromValues(t[3]-s,t[4]-c,0),f=o.fromValues(t[5]-s,t[6]-c,0);n&&(o.transformMat4(u,u,r),o.transformMat4(l,l,r),o.transformMat4(f,f,r)),i="".concat(t[0]).concat(u[0],",").concat(u[1],",").concat(l[0],",").concat(l[1],",").concat(f[0],",").concat(f[1])}else if("A"===t[0]){var h=o.fromValues(t[6]-s,t[7]-c,0);n&&o.transformMat4(h,h,r),i="".concat(t[0]).concat(t[1],",").concat(t[2],",").concat(t[3],",").concat(t[4],",").concat(t[5],",").concat(h[0],",").concat(h[1])}return e+i}),"")}(n,e,t)}var Oa=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ca(e){for(var t=e.fontSize,n=e.fontFamily,r=e.fontStyle,i=e.fontVariant,o=e.fontWeight,a=Bi(t)?"".concat(t,"px"):t.toString(),s=Vo(n)?n.split(","):[n.value],u=s.length-1;u>=0;u--){var c=s[u].trim();!/([\"\'])[^\'\"]+\1/.test(c)&&Oa.indexOf(c)<0&&(c='"'.concat(c,'"')),s[u]=c}return"".concat(r," ").concat(i," ").concat(o," ").concat(a," ").concat(s.join(","))}var Ma=1,xa={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Pa={},Na=0;function Fa(e,t){if(e){var n="string"==typeof e?e:e.id||Na++;Pa[n]&&Pa[n].destroy(),Pa[n]=t}}var Ia="undefined"!=typeof window&&void 0!==window.document,Da=function(e){if(e.isRejected||e.isFulfilled)return e;var t,n=!0,r=!1,i=!1,o=e.then((function(e){return i=!0,n=!1,t=e,e}),(function(e){throw r=!0,n=!1,e}));return o.isFulfilled=function(){return i},o.isPending=function(){return n},o.isRejected=function(){return r},o.getFullFilledValue=function(){return t},o},La=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},Ba=function(e,t){var n,r;if(e.size!==t.size)return!1;try{for(var i=Object(l.__values)(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(!t.has(a))return!1}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!0},wa={keys:Object.keys,values:Object.values,entries:Object.entries};function ka(e,t,n){Ia&&e.style&&(e.style.width=t+"px",e.style.height=n+"px")}function Ua(e,t){var n=Number(e.style.zIndex),r=Number(t.style.zIndex);if(n===r){var i=e.parentNode;if(i){var o=i.childNodes||[];return o.indexOf(e)-o.indexOf(t)}}return n-r}function Ga(e,t){void 0===t&&(t=!1);for(var n=e;n;){var r=n.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0),n=n.parentNode}e.emit(vi.BOUNDS_CHANGED,{affectChildren:t})}var ja,Va=c.Syringe.defineToken("SceneGraphService"),Wa=function(){function e(){var e,t,n,r,a,u=this;this.rotate=(e=s.create(),function(t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof n&&(n=o.fromValues(n,r,i));var a=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var c=s.create();s.fromEuler(c,n[0],n[1],n[2]);var l=u.getRotation(t),f=u.getRotation(t.parentNode);s.copy(e,f),s.invert(e,e),s.multiply(c,e,c),s.multiply(a.localRotation,c,l),s.normalize(a.localRotation,a.localRotation),u.dirtifyLocal(t,a)}else u.rotateLocal(t,n)}),this.rotateLocal=(t=s.create(),function(e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof n&&(n=o.fromValues(n,r,i));var a=e.transformable;s.fromEuler(t,n[0],n[1],n[2]),s.mul(a.localRotation,a.localRotation,t),u.dirtifyLocal(e,a)}),this.setEulerAngles=(n=s.create(),function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof t&&(t=o.fromValues(t,r,i));var a=e.transformable;if(null!==e.parentNode&&e.parentNode.transformable){s.fromEuler(a.localRotation,t[0],t[1],t[2]);var c=u.getRotation(e.parentNode);s.copy(n,s.invert(s.create(),c)),s.mul(a.localRotation,a.localRotation,n),u.dirtifyLocal(e,a)}else u.setLocalEulerAngles(e,t)}),this.translateLocal=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof t&&(t=o.fromValues(t,n,r));var i=e.transformable;o.equals(t,o.create())||(o.transformQuat(t,t,i.localRotation),o.add(i.localPosition,i.localPosition,t),u.dirtifyLocal(e,i))},this.setPosition=(r=i.create(),function(e,t){var n=e.transformable;if(t=o.fromValues(t[0],t[1],t[2]||0),!o.equals(u.getPosition(e),t)){if(n.position=t,null!==e.parentNode&&e.parentNode.transformable){var a=e.parentNode.transformable;i.copy(r,a.worldTransform),i.invert(r,r),o.transformMat4(n.localPosition,t,r)}else o.copy(n.localPosition,t);u.dirtifyLocal(e,n)}}),this.translate=(a=o.create(),function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof t&&(t=o.fromValues(t,n,r)),o.equals(t,o.create())||(o.add(a,u.getPosition(e),t),u.setPosition(e,a))}),this.setRotation=function(){var e=s.create();return function(t,n,r,i,o){var a=t.transformable;if("number"==typeof n&&(n=s.fromValues(n,r,i,o)),null!==t.parentNode&&t.parentNode.transformable){var c=u.getRotation(t.parentNode);s.copy(e,c),s.invert(e,e),s.multiply(a.localRotation,e,n),s.normalize(a.localRotation,a.localRotation),u.dirtifyLocal(t,a)}else u.setLocalRotation(t,n)}}}return e.prototype.matches=function(e,t){return this.sceneGraphSelectorFactory().is(e,t)},e.prototype.querySelector=function(e,t){return this.sceneGraphSelectorFactory().selectOne(e,t)},e.prototype.querySelectorAll=function(e,t){return this.sceneGraphSelectorFactory().selectAll(e,t)},e.prototype.attach=function(e,t,n){e.parentNode&&this.detach(e),e.parentNode=t,Li(n)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(n,0,e);var r=t.sortable;r&&(r.dirty=!0);var i=e.transformable;i&&this.dirtifyWorld(e,i),i.frozen&&this.unfreezeParentToRoot(e)},e.prototype.detach=function(e){if(e.parentNode){var t=e.transformable,n=e.parentNode.sortable;n&&(n.dirty=!0);var r=e.parentNode.childNodes.indexOf(e);r>-1&&e.parentNode.childNodes.splice(r,1),t&&this.dirtifyWorld(e,t),e.parentNode=null}},e.prototype.getOrigin=function(e){return e.transformable.origin},e.prototype.setOrigin=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof t&&(t=o.fromValues(t,n,r));var i=e.transformable;if(!o.equals(t,i.origin)){var a=i.origin;a[0]=t[0],a[1]=t[1],a[2]=t[2]||0,this.dirtifyLocal(e,i)}},e.prototype.setLocalEulerAngles=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof t&&(t=o.fromValues(t,n,r));var i=e.transformable;s.fromEuler(i.localRotation,t[0],t[1],t[2]),this.dirtifyLocal(e,i)},e.prototype.setLocalPosition=function(e,t){var n=e.transformable;t=o.fromValues(t[0],t[1],t[2]||0),o.equals(n.localPosition,t)||(o.copy(n.localPosition,t),this.dirtifyLocal(e,n))},e.prototype.scaleLocal=function(e,t){var n=e.transformable;o.multiply(n.localScale,n.localScale,o.fromValues(t[0],t[1],t[2]||1)),this.dirtifyLocal(e,n)},e.prototype.setLocalScale=function(e,t){var n=e.transformable,r=o.fromValues(t[0],t[1],t[2]||n.localScale[2]);o.equals(r,n.localScale)||(o.copy(n.localScale,r),this.dirtifyLocal(e,n))},e.prototype.setLocalRotation=function(e,t,n,r,i){"number"==typeof t&&(t=s.fromValues(t,n,r,i));var o=e.transformable;s.copy(o.localRotation,t),this.dirtifyLocal(e,o)},e.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},e.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),Ga(e,!0)},e.prototype.getPosition=function(e){var t=e.transformable;return i.getTranslation(t.position,this.getWorldTransform(e,t))},e.prototype.getRotation=function(e){var t=e.transformable;return i.getRotation(t.rotation,this.getWorldTransform(e,t))},e.prototype.getScale=function(e){var t=e.transformable;return i.getScaling(t.scaling,this.getWorldTransform(e,t))},e.prototype.getWorldTransform=function(e,t){return void 0===t&&(t=e.transformable),t.localDirtyFlag||t.dirtyFlag?(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t),t.worldTransform):t.worldTransform},e.prototype.getLocalPosition=function(e){return e.transformable.localPosition},e.prototype.getLocalRotation=function(e){return e.transformable.localRotation},e.prototype.getLocalScale=function(e){return e.transformable.localScale},e.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(i.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,t.localScale,t.origin),t.localDirtyFlag=!1),t.localTransform},e.prototype.setLocalTransform=function(e,t){var n=i.getTranslation(o.create(),t),r=i.getRotation(s.create(),t),a=i.getScaling(o.create(),t);this.setLocalScale(e,a),this.setLocalPosition(e,n),this.setLocalRotation(e,r)},e.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0])},e.prototype.getTransformedGeometryBounds=function(e,t){void 0===t&&(t=!1);var n=this.getGeometryBounds(e,t);if(fi.isEmpty(n))return null;var r=new fi;return r.setFromTransformedAABB(n,this.getWorldTransform(e)),r},e.prototype.getGeometryBounds=function(e,t){void 0===t&&(t=!1);var n=e.geometry,r=t?n.renderBounds:n.contentBounds||null;return r&&new fi(r.center,r.halfExtents)||new fi},e.prototype.getBounds=function(e,t){var n=this;void 0===t&&(t=!1);var r=e.renderable;if(!r.boundsDirty&&!t&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&t&&r.renderBounds)return r.renderBounds;var i=this.getTransformedGeometryBounds(e,t);e.childNodes.forEach((function(e){var r=n.getBounds(e,t);r&&(i?i.add(r):(i=new fi).update(r.center,r.halfExtents))}));var o=e.style.clipPath;if(o){var a=this.getTransformedGeometryBounds(o,!0),s=void 0;a&&(s=new fi).setFromTransformedAABB(a,this.getWorldTransform(e)),i?s&&(i=s.intersection(i)):i=s}return i&&(t?r.renderBounds=i:r.bounds=i),t?r.renderBoundsDirty=!1:r.boundsDirty=!1,i||new fi},e.prototype.getLocalBounds=function(e){if(e.parentNode){var t=i.create();e.parentNode.transformable&&(t=i.invert(i.create(),this.getWorldTransform(e.parentNode)));var n=this.getBounds(e);if(!fi.isEmpty(n)){var r=new fi;return r.setFromTransformedAABB(n,t),r}}return this.getBounds(e)},e.prototype.getBoundingClientRect=function(e){var t,n,r,i=this.getGeometryBounds(e);fi.isEmpty(i)||(r=new fi).setFromTransformedAABB(i,this.getWorldTransform(e));var o=null===(n=null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===n?void 0:n.getContextService().getBoundingClientRect();if(r){var a=Object(l.__read)(r.getMin(),2),s=a[0],u=a[1],c=Object(l.__read)(r.getMax(),2),f=c[0],h=c[1];return new Ri(s+((null==o?void 0:o.left)||0),u+((null==o?void 0:o.top)||0),f-s,h-u)}return new Ri((null==o?void 0:o.left)||0,(null==o?void 0:o.top)||0,0,0)},e.prototype.dirtifyWorldInternal=function(e,t){var n=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach((function(e){var t=e.transformable;t.dirtyFlag||n.dirtifyWorldInternal(e,t)}));var r=e.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0),e.dispatchEvent(new Pi(vi.ATTR_MODIFIED,e,null,null,"modelMatrix",Pi.MODIFICATION,null,null))}},e.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var n=e.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r])}},e.prototype.sync=function(e,t){if(t.localDirtyFlag&&(i.fromRotationTranslationScaleOrigin(t.localTransform,t.localRotation,t.localPosition,t.localScale,t.origin),t.localDirtyFlag=!1),t.dirtyFlag){var n=e.parentNode,r=n&&n.transformable;null!==n&&r?i.multiply(t.worldTransform,r.worldTransform,t.localTransform):i.copy(t.worldTransform,t.localTransform),t.dirtyFlag=!1}},e.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var n=t.transformable;n&&(n.frozen=!1),t=t.parentNode}},Object(l.__decorate)([Object(c.inject)(Ai),Object(l.__metadata)("design:type",Function)],e.prototype,"sceneGraphSelectorFactory",void 0),e=Object(l.__decorate)([Object(c.singleton)({token:Va})],e)}(),Ha=c.Syringe.defineToken("ContextService",{multiple:!1});!function(e){e[e.CAMERA_CHANGED=0]="CAMERA_CHANGED",e[e.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",e[e.NONE=2]="NONE"}(ja||(ja={}));var Xa,za=c.Syringe.defineToken("RenderingContext"),Ya=n(164),Ka=function(e){function t(t,n){var r=e.call(this,null)||this;return r.type=t,r.detail=n,Object.assign(r,n),r}return Object(l.__extends)(t,e),t}(xi),qa=":",Za=function(){function e(){this.emitter=new f.EventEmitter}return e.prototype.on=function(e,t,n){return this.addEventListener(e,t,n),this},e.prototype.addEventListener=function(e,t,n){var r=ki(n)&&n||Ui(n)&&n.capture,i=Ui(n)&&n.once,o=wi(t)?void 0:t,a=!1,s="";if(e.indexOf(qa)>-1){var u=Object(l.__read)(e.split(qa),2),c=u[0];e=u[1],s=c,a=!0}if(e=r?"".concat(e,"capture"):e,t=wi(t)?t:t.handleEvent,a){var f=t;t=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(null===(e=t[0].target)||void 0===e?void 0:e.name)===s&&f.apply(void 0,Object(l.__spreadArray)([],Object(l.__read)(t),!1))}}return i?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},e.prototype.off=function(e,t,n){return e?this.removeEventListener(e,t,n):this.removeAllEventListeners(),this},e.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},e.prototype.removeEventListener=function(e,t,n){var r=ki(n)&&n||Ui(n)&&n.capture,i=wi(t)?void 0:t;return e=r?"".concat(e,"capture"):e,t=wi(t)?t:null==t?void 0:t.handleEvent,this.emitter.off(e,t,i),this},e.prototype.emit=function(e,t){this.dispatchEvent(new Ka(e,t))},e.prototype.dispatchEvent=function(e){var t,n;if(!(e instanceof xi))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var r=this.ownerDocument||this.document;return r&&(e.manager=(null===(t=r.defaultView)||void 0===t?void 0:t.getEventService())||null,e.defaultPrevented=!1,e.path=[],e.target=this,null===(n=e.manager)||void 0===n||n.dispatchEvent(e)),!e.defaultPrevented},e}(),Ja=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return Object(l.__extends)(t,e),t.isNode=function(e){return!!e.childNodes},Object.defineProperty(t.prototype,"textContent",{get:function(){var e,t,n="";this.nodeName===ca.TEXT&&(n+=this.style.text);try{for(var r=Object(l.__values)(this.childNodes),i=r.next();!i.done;i=r.next()){var o=i.value;o.nodeName===ca.TEXT?n+=o.nodeValue:n+=o.textContent}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},set:function(e){var t=this;this.childNodes.slice().forEach((function(e){t.removeChild(e,!0)})),this.nodeName===ca.TEXT&&(this.style.text="".concat(e))},enumerable:!1,configurable:!0}),t.prototype.getRootNode=function(e){return void 0===e&&(e={}),this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this},t.prototype.hasChildNodes=function(){return this.childNodes.length>0},t.prototype.isDefaultNamespace=function(e){throw new Error("Method not implemented.")},t.prototype.lookupNamespaceURI=function(e){throw new Error("Method not implemented.")},t.prototype.lookupPrefix=function(e){throw new Error("Method not implemented.")},t.prototype.normalize=function(){throw new Error("Method not implemented.")},t.prototype.isEqualNode=function(e){return this===e},t.prototype.isSameNode=function(e){return this.isEqualNode(e)},Object.defineProperty(t.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),t.prototype.compareDocumentPosition=function(e){var n;if(e===this)return 0;if(!(e instanceof t))throw new TypeError("Node.compareDocumentPosition: Argument 1 does not implement interface Node.");for(var r=e,i=this,o=[r],a=[i];null!==(n=r.parentNode)&&void 0!==n?n:i.parentNode;)r=r.parentNode?(o.push(r.parentNode),r.parentNode):r,i=i.parentNode?(a.push(i.parentNode),i.parentNode):i;if(r!==i)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var s=o.length>a.length?o:a,u=s===o?a:o;if(s[s.length-u.length]===u[0])return s===o?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var c=s.length-u.length,l=u.length-1;l>=0;l--){var f=u[l],h=s[c+l];if(h!==f){var d=f.parentNode.childNodes;return d.indexOf(f)<d.indexOf(h)?u===o?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING:s===o?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING}}return t.DOCUMENT_POSITION_FOLLOWING},t.prototype.contain=function(e){return this.contains(e)},t.prototype.contains=function(e){for(var t=e;t&&this!==t;)t=t.parentNode;return!!t},t.prototype.getAncestor=function(e){for(var t=this;e>0&&t;)t=t.parentNode,e--;return t},t.prototype.forEach=function(e){e(this)||this.childNodes.forEach((function(t){t.forEach(e)}))},t.DOCUMENT_POSITION_DISCONNECTED=1,t.DOCUMENT_POSITION_PRECEDING=2,t.DOCUMENT_POSITION_FOLLOWING=4,t.DOCUMENT_POSITION_CONTAINS=8,t.DOCUMENT_POSITION_CONTAINED_BY=16,t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,t}(Za),Qa=function(){function e(){}return e.tag="c-geometry",e}(),$a=function(){function e(){this.boundsDirty=!0,this.renderBoundsDirty=!0,this.dirty=!1}return e.tag="c-renderable",e}(),es=function(){function e(){this.dirtyFlag=!1,this.localDirtyFlag=!1,this.frozen=!1,this.localPosition=o.fromValues(0,0,0),this.localRotation=s.fromValues(0,0,0,1),this.localScale=o.fromValues(1,1,1),this.localTransform=i.create(),this.position=o.fromValues(0,0,0),this.rotation=s.fromValues(0,0,0,1),this.scaling=o.fromValues(1,1,1),this.worldTransform=i.create(),this.origin=o.fromValues(0,0,0)}return e.tag="c-transform",e}();!function(e){e[e.Standard=0]="Standard"}(Xa||(Xa={}));var ts=function(){function e(){this.strategy=Xa.Standard,this.visibilityPlaneMask=-1,this.visible=!0,this.enable=!0}return e.prototype.isCulled=function(){return this.enable&&!this.visible},e.tag="c-cullable",e}(),ns=function(){function e(){this.dirty=!1,this.renderOrder=0}return e.tag="c-sortable",e}(),rs=0,is=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneGraphService=c.GlobalContainer.get(Va),t.entity=rs++,t.renderable=new $a,t.cullable=new ts,t.transformable=new es,t.sortable=new ns,t.geometry=new Qa,t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return Object(l.__extends)(t,e),t.isElement=function(e){return!!e.getAttribute},Object.defineProperty(t.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(e){this.setAttribute("class",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classList",{get:function(){return this.className.split(" ").filter((function(e){return""!==e}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null}return null},enumerable:!1,configurable:!0}),t.prototype.cloneNode=function(e){throw new Error("Method not implemented.")},t.prototype.appendChild=function(e,t){return this.sceneGraphService.attach(e,this,t),this.emit(vi.CHILD_INSERTED,{child:e}),e.dispatchEvent(new Pi(vi.INSERTED,this,"","","",0,"","")),e},t.prototype.insertBefore=function(e,t){if(t){var n=this.childNodes.indexOf(t);this.appendChild(e,n-1)}else this.appendChild(e);return e},t.prototype.replaceChild=function(e,t,n){var r=this.childNodes.indexOf(t);return this.removeChild(t,n),this.appendChild(e,r),t},t.prototype.removeChild=function(e,t){return void 0===t&&(t=!0),e.dispatchEvent(new Pi(vi.REMOVED,this,"","","",0,"","")),t&&(e.emit(vi.DESTROY,{}),e.destroyed=!0),this.emit(vi.CHILD_REMOVED,{child:e}),this.sceneGraphService.detach(e),t&&e.emitter.removeAllListeners(),e},t.prototype.removeChildren=function(e){var t=this;void 0===e&&(e=!0),this.childNodes.slice().forEach((function(n){t.removeChild(n,e)}))},t.prototype.matches=function(e){return this.sceneGraphService.matches(e,this)},t.prototype.getElementById=function(e){return this.sceneGraphService.querySelector("#".concat(e),this)},t.prototype.getElementsByName=function(e){return this.sceneGraphService.querySelectorAll('[name="'.concat(e,'"]'),this)},t.prototype.getElementsByClassName=function(e){return this.sceneGraphService.querySelectorAll(".".concat(e),this)},t.prototype.getElementsByTagName=function(e){return this.sceneGraphService.querySelectorAll(e,this)},t.prototype.querySelector=function(e){return this.sceneGraphService.querySelector(e,this)},t.prototype.querySelectorAll=function(e){return this.sceneGraphService.querySelectorAll(e,this)},t.prototype.find=function(e){var t=this,n=null;return this.forEach((function(r){return!(r===t||!e(r))&&(n=r,!0)})),n},t.prototype.findAll=function(e){var t=this,n=[];return this.forEach((function(r){r!==t&&e(r)&&n.push(r)})),n},t.prototype.after=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.parentNode){var r=this.parentNode.childNodes.indexOf(this);t.forEach((function(t,n){var i;return null===(i=e.parentNode)||void 0===i?void 0:i.appendChild(t,r+n+1)}))}},t.prototype.before=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.parentNode){var r=this.parentNode.childNodes.indexOf(this),i=Object(l.__read)(t),o=i[0],a=i.slice(1);this.parentNode.appendChild(o,r),(e=o).after.apply(e,Object(l.__spreadArray)([],Object(l.__read)(a),!1))}},t.prototype.replaceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.after.apply(this,Object(l.__spreadArray)([],Object(l.__read)(e),!1)),this.remove()},t.prototype.append=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){return e.appendChild(t)}))},t.prototype.prepend=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t,n){return e.appendChild(t,n)}))},t.prototype.replaceChildren=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,Object(l.__spreadArray)([],Object(l.__read)(e),!1))},t.prototype.remove=function(e){return void 0===e&&(e=!0),this.parentNode?this.parentNode.removeChild(this,e):this},t.prototype.destroy=function(){this.emit(vi.DESTROY,{}),this.remove(!1),this.emitter.removeAllListeners(),this.destroyed=!0},t.prototype.getGeometryBounds=function(){return this.sceneGraphService.getGeometryBounds(this)},t.prototype.getRenderBounds=function(){return this.sceneGraphService.getBounds(this,!0)},t.prototype.getBounds=function(){return this.sceneGraphService.getBounds(this)},t.prototype.getLocalBounds=function(){return this.sceneGraphService.getLocalBounds(this)},t.prototype.getBoundingClientRect=function(){return this.sceneGraphService.getBoundingClientRect(this)},t.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},t.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},t.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},t.prototype.getAttribute=function(e){var t=Object(l.__read)(Ko(e.toString(),""),1)[0],n=this.attributes[t];return Li(n)?null:n},t.prototype.hasAttribute=function(e){return this.getAttributeNames().includes(e)},t.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},t.prototype.removeAttribute=function(e){this.setAttribute(e,null),delete this.attributes[e]},t.prototype.setAttribute=function(e,t,n){void 0===n&&(n=!1),this.attributes[e]=t},t.prototype.getAttributeNS=function(e,t){throw new Error("Method not implemented.")},t.prototype.getAttributeNode=function(e){throw new Error("Method not implemented.")},t.prototype.getAttributeNodeNS=function(e,t){throw new Error("Method not implemented.")},t.prototype.hasAttributeNS=function(e,t){throw new Error("Method not implemented.")},t.prototype.removeAttributeNS=function(e,t){throw new Error("Method not implemented.")},t.prototype.removeAttributeNode=function(e){throw new Error("Method not implemented.")},t.prototype.setAttributeNS=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.setAttributeNode=function(e){throw new Error("Method not implemented.")},t.prototype.setAttributeNodeNS=function(e){throw new Error("Method not implemented.")},t.prototype.toggleAttribute=function(e,t){throw new Error("Method not implemented.")},t}(Ja),os=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.currentTime=r,o.timelineTime=i,o.target=n,o.type="finish",o.bubbles=!1,o.currentTarget=n,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=r,o.timelineTime=i,o}return Object(l.__extends)(t,e),t}(xi),as=0,ss=function(){function e(e,t){this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(as++),this._inEffect=!!this.effect.update(0),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(e.prototype,"pending",{get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise((function(t,n){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){n(new Error)}})),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise((function(t,n){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){n(new Error)}})),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var t;e=Number(e),isNaN(e)||(this.timeline.restart(),this._paused||null===this._startTime||(this._startTime=Number(null===(t=this.timeline)||void 0===t?void 0:t.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(null!==e){if(this.updatePromises(),e=Number(e),isNaN(e))return;if(this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==t&&(this.currentTime=t),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this.totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalDuration",{get:function(){var e;return Number(null===(e=this.effect)||void 0===e?void 0:e.getComputedTiming().endTime)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_needsTick",{get:function(){return this.pending||"running"===this.playState||!this._finishedFlag},enumerable:!1,configurable:!0}),e.prototype.updatePromises=function(){var e=this.oldPlayState,t=this.pending?"pending":this.playState;return this.readyPromise&&t!==e&&("idle"===t?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===e?this.resolveReadyPromise():"pending"===t&&(this.readyPromise=void 0)),this.finishedPromise&&t!==e&&("idle"===t?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===t?this.resolveFinishedPromise():"finished"===e&&(this.finishedPromise=void 0)),this.oldPlayState=t,this.readyPromise||this.finishedPromise},e.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()},e.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()},e.prototype.finish=function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this.totalDuration:0,this._startTime=this.totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},e.prototype.cancel=function(){this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises())},e.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),null!==e&&(this.currentTime=e),this.updatePromises()},e.prototype.updatePlaybackRate=function(e){this.playbackRate=e},e.prototype.targetAnimations=function(){var e;return(null===(e=this.effect)||void 0===e?void 0:e.target).getAnimations()},e.prototype.markTarget=function(){var e=this.targetAnimations();-1===e.indexOf(this)&&e.push(this)},e.prototype.unmarkTarget=function(){var e=this.targetAnimations(),t=e.indexOf(this);-1!==t&&e.splice(t,1)},e.prototype.tick=function(e,t){this._idle||this._paused||(null===this._startTime?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))},e.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this.totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this.totalDuration}},e.prototype.persist=function(){throw new Error("Method not implemented.")},e.prototype.addEventListener=function(e,t,n){throw new Error("Method not implemented.")},e.prototype.removeEventListener=function(e,t,n){throw new Error("Method not implemented.")},e.prototype.dispatchEvent=function(e){throw new Error("Method not implemented.")},e.prototype.commitStyles=function(){throw new Error("Method not implemented.")},e.prototype.ensureAlive=function(){var e,t;this.playbackRate<0&&0===this.currentTime?this._inEffect=!!(null===(e=this.effect)||void 0===e?void 0:e.update(-1)):this._inEffect=!!(null===(t=this.effect)||void 0===t?void 0:t.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))},e.prototype.tickCurrentTime=function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this.totalDuration:0),this.ensureAlive())},e.prototype.fireEvents=function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new os(null,this,this.currentTime,e);setTimeout((function(){t.onfinish&&t.onfinish(n)}))}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var r=new os(null,this,this.currentTime,e);this.onframe(r)}this._finishedFlag=!1}},e}();function us(e,t){return Number(e.id)-Number(t.id)}var cs=function(){function e(e){var t=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(e){t.currentTime=e,t.discardAnimations(),0===t.animations.length?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(e){var n=t.rafCallbacks;t.rafCallbacks=[],e<Number(t.currentTime)&&(e=Number(t.currentTime)),t.animations.sort(us),t.animations=t.tick(e,!0,t.animations)[0],n.forEach((function(t){t[1](e)})),t.applyPendingEffects()}}return e.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},e.prototype.isTicking=function(){return this.inTick},e.prototype.play=function(e){var t=new ss(e,this);return this.animations.push(t),this.restartWebAnimationsNextTick(),t.updatePromises(),t.play(),t.updatePromises(),t},e.prototype.applyDirtiedAnimation=function(e){var t=this;if(!this.inTick){e.markTarget();var n=e.targetAnimations();n.sort(us),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach((function(e){var n=t.animations.indexOf(e);-1!==n&&t.animations.splice(n,1)})),this.applyPendingEffects()}},e.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame((function(){})),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},e.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},e.prototype.applyPendingEffects=function(){this.pendingEffects.forEach((function(e){null==e||e.applyInterpolations()})),this.pendingEffects=[]},e.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter((function(e){return e.updatePromises()}))},e.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter((function(e){return"finished"!==e.playState&&"idle"!==e.playState}))},e.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},e.prototype.rAF=function(e){var t=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t},e.prototype.requestAnimationFrame=function(e){var t=this;return this.rAF((function(n){t.updateAnimationsPromises(),e(n),t.updateAnimationsPromises()}))},e.prototype.tick=function(e,t,n){var r,i,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var a=[],s=[],u=[],c=[];return n.forEach((function(n){n.tick(e,t),n._inEffect?(s.push(n.effect),n.markTarget()):(a.push(n.effect),n.unmarkTarget()),n._needsTick&&(o.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?u.push(n):c.push(n)})),(r=this.pendingEffects).push.apply(r,Object(l.__spreadArray)([],Object(l.__read)(a),!1)),(i=this.pendingEffects).push.apply(i,Object(l.__spreadArray)([],Object(l.__read)(s),!1)),this.ticking&&this.requestAnimationFrame((function(){})),this.inTick=!1,[u,c]},e}(),ls=function(){function e(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=No,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(e.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=wo(e),this._easing=e},enumerable:!1,configurable:!0}),e}();function fs(e,t){if(null===e)return[];Array.isArray(e)||(e=function(e){var t=[];for(var n in e)if(!(n in["easing","offset","composite"])){var r=e[n];Array.isArray(r)||(r=[r]);for(var i=r.length,o=0;o<i;o++){if(!t[o]){var a={};"offset"in e&&(a.offset=Number(e.offset)),"easing"in e&&(a.easing=e.easing),"composite"in e&&(a.composite=e.composite),t[o]=a}void 0!==r[o]&&null!==r[o]&&(t[o][n]=r[o])}}return t.sort((function(e,t){return(e.computedOffset||0)-(t.computedOffset||0)})),t}(e));for(var n=e.map((function(e){var n={};for(var r in(null==t?void 0:t.composite)&&(n.composite="auto"),e){var i=e[r];if("offset"===r){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error("".concat(i," compositing is not supported"));n[r]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==t?void 0:t.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n})),r=!0,i=-1/0,o=0;o<n.length;o++){var a=n[o].offset;if(null!=a){if(a<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=a}else r=!1}return n=n.filter((function(e){return Number(e.offset)>=0&&Number(e.offset)<=1})),r||function(){var e,t,r=n.length;n[r-1].computedOffset=Number(null!==(e=n[r-1].offset)&&void 0!==e?e:1),r>1&&(n[0].computedOffset=Number(null!==(t=n[0].offset)&&void 0!==t?t:0));for(var i=0,o=Number(n[0].computedOffset),a=1;a<r;a++){var s=Number(n[a].computedOffset);if(null!=s&&null!=o){for(var u=1;u<a-i;u++)n[i+u].computedOffset=o+(s-o)*u/(a-i);i=a,o=s}}}(),n}var hs="backwards|forwards|both|none".split("|"),ds="reverse|alternate|alternate-reverse".split("|");function ps(e,t){var n=new ls;return t&&(n.fill="both",n.duration="auto"),"number"!=typeof e||isNaN(e)?void 0!==e&&Object.keys(e).forEach((function(t){if(void 0!==e[t]&&null!==e[t]&&"auto"!==e[t]){if(("number"==typeof n[t]||"duration"===t)&&("number"!=typeof e[t]||isNaN(e[t])))return;if("fill"===t&&-1===hs.indexOf(e[t]))return;if("direction"===t&&-1===ds.indexOf(e[t]))return;n[t]=e[t]}})):n.duration=e,n}function vs(e,t){return ps(e=ys(null!=e?e:{duration:"auto"}),t)}function ys(e){return"number"==typeof e&&(e=isNaN(e)?{duration:"auto"}:{duration:e}),e}var ms,_s,gs,Es,Ts,bs=function(){function e(e,t,n){var r=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=vs(n,!1),this.timing.effect=this,this.timing.activeDuration=ko(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=fs(t,this.timing),this.interpolations=Wo(this.normalizedKeyframes,this.timing,this.target),this.computedTiming=new Proxy(this.timing,{get:function(e,t){return"duration"===t?"auto"===e.duration?0:e.duration:"fill"===t?"auto"===e.fill?"none":e.fill:"localTime"===t?r.animation&&r.animation.currentTime||null:"currentIteration"===t?r.animation&&"running"===r.animation.playState?e.currentIteration||0:null:"progress"===t?r.animation&&"running"===r.animation.playState?e.progress||0:null:e[t]},set:function(){return!0}})}return e.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},e.prototype.update=function(e){return null!==e&&(this.timeFraction=Uo(this.timing.activeDuration,e,this.timing),null!==this.timeFraction)},e.prototype.getKeyframes=function(){return this.normalizedKeyframes},e.prototype.setKeyframes=function(e){this.normalizedKeyframes=fs(e)},e.prototype.getComputedTiming=function(){return this.computedTiming},e.prototype.getTiming=function(){return this.timing},e.prototype.updateTiming=function(e){var t=this;Object.keys(e||{}).forEach((function(n){t.timing=e[n]}))},e}(),Ss={anchor:[0,0],opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"0",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:""},Rs=function(e){function t(t){var n,r,i,o=this;return(o=e.call(this)||this).styleValueRegistry=c.GlobalContainer.get(to),o.activeAnimations=[],o.config=t,o.config.interactive=null!==(n=o.config.capture)&&void 0!==n?n:o.config.interactive,o.id=o.config.id||"",o.name=o.config.name||"",(o.config.className||o.config.class)&&(o.className=o.config.className||o.config.class),o.nodeName=o.config.type||ca.GROUP,o.config.style=Object(l.__assign)(Object(l.__assign)(Object(l.__assign)(Object(l.__assign)({},Ss),{zIndex:null!==(r=o.config.zIndex)&&void 0!==r?r:0,interactive:null===(i=o.config.interactive)||void 0===i||i}),o.config.style),o.config.attrs),null!=o.config.visible&&(o.config.style.visibility=!1===o.config.visible?"hidden":"visible"),null!=o.config.interactive&&(o.config.style.pointerEvents=!1===o.config.interactive?"none":"auto"),o.style=new Proxy(Object(l.__assign)(Object(l.__assign)({},o.attributes),{setProperty:function(e,t){o.setAttribute(e,t)},getPropertyValue:function(e){return o.getAttribute(e)},removeProperty:function(e){o.removeAttribute(e)},item:function(){return""}}),{get:function(e,t){return t in e?e[t]:o.getAttribute(t)},set:function(e,t,n){return o.setAttribute(t,n),!0}}),o.initAttributes(o.config.style),c.GlobalContainer.get(h).add(o.entity,o),o}return Object(l.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),c.GlobalContainer.get(h).remove(this.entity),this.getAnimations().forEach((function(e){e.cancel()}))},t.prototype.cloneNode=function(e){var t=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:Object(l.__assign)({},this.attributes)});return e&&this.children.forEach((function(n){var r=n.cloneNode(e);t.appendChild(r)})),t},t.prototype.initAttributes=function(e){void 0===e&&(e={});var t=this.renderable;this.styleValueRegistry.processProperties(this,e),t.dirty=!0},t.prototype.setAttribute=function(t,n,r){void 0===r&&(r=!1);var i=Object(l.__read)(Ko(t,n),2),o=i[0],a=i[1];Di(n)||(r||a!=this.attributes[o])&&(this.internalSetAttribute(o,a),e.prototype.setAttribute.call(this,o,a))},t.prototype.internalSetAttribute=function(e,t,n){var r,i=this;void 0===n&&(n={});var o=this.renderable,a=this.attributes[e],s=this.parsedStyle[e];this.styleValueRegistry.processProperties(this,((r={})[e]=t,r),n),this.attributes.clipPathTargets&&this.attributes.clipPathTargets.length&&this.attributes.clipPathTargets.forEach((function(e){Ga(e),e.dispatchEvent(new Pi(vi.ATTR_MODIFIED,e,i,i,"clipPath",Pi.MODIFICATION,i,i))})),o.dirty=!0,this.dispatchEvent(new Pi(vi.ATTR_MODIFIED,this,a,t,e,Pi.MODIFICATION,s,this.parsedStyle[e]))},t.prototype.getBBox=function(){var e=this.getBounds(),t=Object(l.__read)(e.getMin(),2),n=t[0],r=t[1],i=Object(l.__read)(e.getMax(),2),o=i[0],a=i[1];return new Ri(n,r,o-n,a-r)},t.prototype.setOrigin=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.sceneGraphService.setOrigin(this,Vi(e,t,n)),this},t.prototype.getOrigin=function(){return this.sceneGraphService.getOrigin(this)},t.prototype.setPosition=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.sceneGraphService.setPosition(this,Vi(e,t,n)),this},t.prototype.setLocalPosition=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.sceneGraphService.setLocalPosition(this,Vi(e,t,n)),this},t.prototype.translate=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.sceneGraphService.translate(this,Vi(e,t,n)),this},t.prototype.translateLocal=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.sceneGraphService.translateLocal(this,Vi(e,t,n)),this},t.prototype.getPosition=function(){return this.sceneGraphService.getPosition(this)},t.prototype.getLocalPosition=function(){return this.sceneGraphService.getLocalPosition(this)},t.prototype.scale=function(e,t,n){return this.scaleLocal(e,t,n)},t.prototype.scaleLocal=function(e,t,n){return"number"==typeof e&&(e=Vi(e,t=t||e,n=n||e)),this.sceneGraphService.scaleLocal(this,e),this},t.prototype.setLocalScale=function(e,t,n){return"number"==typeof e&&(e=Vi(e,t=t||e,n=n||e)),this.sceneGraphService.setLocalScale(this,e),this},t.prototype.getLocalScale=function(){return this.sceneGraphService.getLocalScale(this)},t.prototype.getScale=function(){return this.sceneGraphService.getScale(this)},t.prototype.getEulerAngles=function(){var e=Object(l.__read)(Ji(o.create(),this.sceneGraphService.getWorldTransform(this)),3);e[0],e[1];return Hi(e[2])},t.prototype.getLocalEulerAngles=function(){var e=Object(l.__read)(Ji(o.create(),this.sceneGraphService.getLocalRotation(this)),3);e[0],e[1];return Hi(e[2])},t.prototype.setEulerAngles=function(e){return this.sceneGraphService.setEulerAngles(this,0,0,e),this},t.prototype.setLocalEulerAngles=function(e){return this.sceneGraphService.setLocalEulerAngles(this,0,0,e),this},t.prototype.rotateLocal=function(e,t,n){return Li(t)&&Li(n)?this.sceneGraphService.rotateLocal(this,0,0,e):this.sceneGraphService.rotateLocal(this,e,t,n),this},t.prototype.rotate=function(e,t,n){return Li(t)&&Li(n)?this.sceneGraphService.rotate(this,0,0,e):this.sceneGraphService.rotate(this,e,t,n),this},t.prototype.setRotation=function(e,t,n,r){return this.sceneGraphService.setRotation(this,e,t,n,r),this},t.prototype.setLocalRotation=function(e,t,n,r){return this.sceneGraphService.setLocalRotation(this,e,t,n,r),this},t.prototype.getRotation=function(){return this.sceneGraphService.getRotation(this)},t.prototype.getLocalRotation=function(){return this.sceneGraphService.getLocalRotation(this)},t.prototype.getLocalTransform=function(){return this.sceneGraphService.getLocalTransform(this)},t.prototype.getWorldTransform=function(){return this.sceneGraphService.getWorldTransform(this)},t.prototype.setLocalTransform=function(e){return this.sceneGraphService.setLocalTransform(this,e),this},t.prototype.resetLocalTransform=function(){this.sceneGraphService.resetLocalTransform(this)},t.prototype.getAnimations=function(){return this.activeAnimations},t.prototype.animate=function(e,t){var n,r,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;this.attributes.clipPathTargets&&this.attributes.clipPathTargets.length&&(i=null===(r=this.attributes.clipPathTargets[0].ownerDocument)||void 0===r?void 0:r.timeline);return delete this.parsedStyle.transform,i?i.play(new bs(this,e,t)):null},t.prototype.show=function(){this.style.visibility="visible"},t.prototype.hide=function(){this.style.visibility="hidden"},t.prototype.isVisible=function(){var e,t;return"visible"===(null===(t=null===(e=this.parsedStyle)||void 0===e?void 0:e.visibility)||void 0===t?void 0:t.value)},Object.defineProperty(t.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(e){this.style.pointerEvents=e?"auto":"none"},enumerable:!1,configurable:!0}),t.prototype.isInteractive=function(){var e,t;return"none"!==(null===(t=null===(e=this.parsedStyle)||void 0===e?void 0:e.pointerEvents)||void 0===t?void 0:t.value)},t.prototype.isCulled=function(){return!(!this.cullable||!this.cullable.isCulled())},t.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(this.parentNode.children.map((function(e){return Number(e.style.zIndex)}))),!1))+1),this},t.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(this.parentNode.children.map((function(e){return Number(e.style.zIndex)}))),!1))-1),this},t.prototype.getCount=function(){return this.childElementCount},t.prototype.getParent=function(){return this.parentElement},t.prototype.getChildren=function(){return this.children},t.prototype.getFirst=function(){return this.firstElementChild},t.prototype.getLast=function(){return this.lastElementChild},t.prototype.getChildByIndex=function(e){return this.children[e]||null},t.prototype.add=function(e,t){return this.appendChild(e,t)},t.prototype.setClip=function(e){this.style.clipPath=e},t.prototype.getClip=function(){return this.style.clipPath||null},t.prototype.set=function(e,t){this.config[e]=t},t.prototype.get=function(e){return this.config[e]},t.prototype.getConfig=function(){return this.config},t.prototype.attr=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Object(l.__read)(t,2),i=r[0],o=r[1];return i?Ui(i)?(Object.keys(i).forEach((function(t){e.setAttribute(t,i[t])})),this):2===t.length?(this.setAttribute(i,o),this):this.attributes[i]:this.attributes},t.prototype.moveTo=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.setPosition(e,t,n),this},t.prototype.move=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this.setPosition(e,t,n),this},t.prototype.setZIndex=function(e){return this.style.zIndex=e,this},t.prototype.getMatrix=function(e){var t=e||this.getWorldTransform(),n=Object(l.__read)(i.getTranslation(o.create(),t),2),r=n[0],a=n[1],u=Object(l.__read)(i.getScaling(o.create(),t),2),c=u[0],f=u[1],h=i.getRotation(s.create(),t),d=Object(l.__read)(Ji(o.create(),h),3),p=d[0],v=(d[1],d[2]);return Qi(p||v,r,a,c,f)},t.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},t.prototype.setMatrix=function(e){var t=Object(l.__read)(eo(e),5),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4];this.setEulerAngles(a).setPosition(n,r).setLocalScale(i,o)},t.prototype.setLocalMatrix=function(e){var t=Object(l.__read)(eo(e),5),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4];this.setLocalEulerAngles(a).setLocalPosition(n,r).setLocalScale(i,o)},t}(is),As=function(e){function t(t){void 0===t&&(t={});var n=this,r=t.style,i=Object(l.__rest)(t,["style"]);return(n=e.call(this,Object(l.__assign)({style:Object(l.__assign)({x:"",y:""},r)},i))||this).handleMounted=function(e){e.target===e.currentTarget&&n.connectedCallback&&n.connectedCallback()},n.handleUnmounted=function(e){e.target===e.currentTarget&&n.disconnectedCallback&&n.disconnectedCallback()},n.handleAttributeChanged=function(e){if(e.target===n){var t=e.attrName,r=e.prevValue,i=e.newValue;n.attributeChangedCallback&&n.attributeChangedCallback(t,r,i)}},n.attributeChangedCallback&&n.addEventListener(vi.ATTR_MODIFIED,n.handleAttributeChanged),n.connectedCallback&&n.addEventListener(vi.MOUNTED,n.handleMounted),n.disconnectedCallback&&n.addEventListener(vi.UNMOUNTED,n.handleUnmounted),n}return Object(l.__extends)(t,e),t}(Rs),Os=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.CIRCLE,style:Object(l.__assign)({cx:"",cy:"",r:"",anchor:[.5,.5],transformOrigin:"center",lineWidth:"0"},n)},r))||this}return Object(l.__extends)(t,e),t}(Rs),Cs=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.ELLIPSE,style:Object(l.__assign)({cx:"",cy:"",rx:"",ry:"",anchor:[.5,.5],transformOrigin:"center",lineWidth:"0"},n)},r))||this}return Object(l.__extends)(t,e),t}(Rs),Ms=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.GROUP,style:Object(l.__assign)({x:"",y:"",width:"",height:""},n)},r))||this}return Object(l.__extends)(t,e),t}(Rs),xs=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.IMAGE,style:Object(l.__assign)({x:"",y:"",img:"",width:"",height:"",lineWidth:"0"},n)},r))||this}return Object(l.__extends)(t,e),t}(Rs),Ps=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.LINE,style:Object(l.__assign)({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0,lineWidth:1,isBillboard:!1},n)},r))||this}return Object(l.__extends)(t,e),t.prototype.getPoint=function(e){var t=this.parsedStyle,n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=$o.pointAt(n.value,r.value,i.value,o.value,e);return new Si(a.x,a.y)},t.prototype.getTotalLength=function(){var e=this.parsedStyle,t=e.x1,n=e.y1,r=e.x2,i=e.y2;return $o.length(t.value,n.value,r.value,i.value)},t}(Rs),Ns=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.PATH,style:Object(l.__assign)({path:"",lineWidth:1,miterLimit:4},n)},r))||this}return Object(l.__extends)(t,e),t.prototype.getTotalLength=function(){return this.parsedStyle.path.totalLength},t.prototype.getPoint=function(e){var t=0,n=0,r=this.parsedStyle.path.curve;if(!this.parsedStyle.path.curveSegments.length)return r?new Si(r[0][1],r[0][2]):null;this.parsedStyle.path.curveSegments.forEach((function(r,i){e>=r[0]&&e<=r[1]&&(t=(e-r[0])/(r[1]-r[0]),n=i)}));var i=r[n];if(Li(i)||Li(n))return null;var o=i.length,a=r[n+1],s=aa.pointAt(i[o-2],i[o-1],a[1],a[2],a[3],a[4],a[5],a[6],t),u=s.x,c=s.y;return new Si(u,c)},t.prototype.getStartTangent=function(){var e=this.parsedStyle.path.segments,t=[];if(e.length>1){var n=e[0].currentPoint,r=e[1].currentPoint,i=e[1].startTangent;t=[],i?(t.push([n[0]-i[0],n[1]-i[1]]),t.push([n[0],n[1]])):(t.push([r[0],r[1]]),t.push([n[0],n[1]]))}return t},t.prototype.getEndTangent=function(){var e=this.parsedStyle.path.segments,t=e.length,n=[];if(t>1){var r=e[t-2].currentPoint,i=e[t-1].currentPoint,o=e[t-1].endTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n},t}(Rs),Fs=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.POLYGON,style:Object(l.__assign)({points:"",miterLimit:4,lineWidth:1},n)},r))||this}return Object(l.__extends)(t,e),t}(Rs),Is=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.POLYLINE,style:Object(l.__assign)({points:"",lineWidth:1,miterLimit:4},n)},r))||this}return Object(l.__extends)(t,e),t.prototype.getTotalLength=function(){return this.parsedStyle.points.totalLength},t.prototype.getPoint=function(e){var t=this.parsedStyle.points,n=t.points,r=t.segments,i=0,o=0;r.forEach((function(t,n){e>=t[0]&&e<=t[1]&&(i=(e-t[0])/(t[1]-t[0]),o=n)}));var a=$o.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],i),s=a.x,u=a.y;return new Si(s,u)},t.prototype.getStartTangent=function(){var e=this.parsedStyle.points.points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t},t.prototype.getEndTangent=function(){var e=this.parsedStyle.points.points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n},t}(Rs),Ds=function(e){function t(t){void 0===t&&(t={});var n=t.style,r=Object(l.__rest)(t,["style"]);return e.call(this,Object(l.__assign)({type:ca.RECT,style:Object(l.__assign)({x:"",y:"",width:"",height:"",radius:"",lineWidth:"0"},n)},r))||this}return Object(l.__extends)(t,e),t}(Rs),Ls=function(e){function t(t){void 0===t&&(t={});var n=this,r=t.style,i=Object(l.__rest)(t,["style"]);return(n=e.call(this,Object(l.__assign)({type:ca.TEXT,style:Object(l.__assign)({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",stroke:"black",letterSpacing:0,lineHeight:0,lineWidth:0,miterLimit:10,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:0,leading:0,dx:0,dy:0},r)},i))||this).LENGTHADJUST_SPACING=1,n.LENGTHADJUST_SPACINGANDGLYPHS=2,n.LENGTHADJUST_UNKNOWN=0,n}return Object(l.__extends)(t,e),t.prototype.getCharNumAtPosition=function(e){throw new Error("Method not implemented.")},t.prototype.getComputedTextLength=function(){var e;return(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.maxLineWidth)||0},t.prototype.getEndPositionOfChar=function(e){throw new Error("Method not implemented.")},t.prototype.getExtentOfChar=function(e){throw new Error("Method not implemented.")},t.prototype.getNumberOfChars=function(){throw new Error("Method not implemented.")},t.prototype.getRotationOfChar=function(e){throw new Error("Method not implemented.")},t.prototype.getStartPositionOfChar=function(e){throw new Error("Method not implemented.")},t.prototype.getSubStringLength=function(e,t){throw new Error("Method not implemented.")},t.prototype.selectSubString=function(e,t){throw new Error("Method not implemented.")},t.prototype.getLineBoundingRects=function(){var e;return(null===(e=this.parsedStyle.metrics)||void 0===e?void 0:e.lineMetrics)||[]},t}(Rs),Bs=function(e){function t(t){void 0===t&&(t={});var n=this,r=t.style,i=Object(l.__rest)(t,["style"]);return(n=e.call(this,Object(l.__assign)({type:ca.HTML,style:Object(l.__assign)({x:"",y:"",width:"",height:"",innerHTML:""},r)},i))||this).cullable.enable=!1,n}return Object(l.__extends)(t,e),t.prototype.getDomElement=function(){return this.parsedStyle.$el},t.prototype.getBoundingClientRect=function(){return this.parsedStyle.$el.getBoundingClientRect()},t.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},t.prototype.getBounds=function(){var e,t,n=this.getBoundingClientRect(),r=null===(t=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView)||void 0===t?void 0:t.getContextService().getBoundingClientRect();if(r){var i=n.left-r.left,a=n.top-r.top,s=new fi;return s.setMinMax(o.fromValues(i,a,0),o.fromValues(i+n.width,a+n.height,0)),s}return null},t.prototype.getLocalBounds=function(){if(this.parentNode){var e=i.invert(i.create(),this.parentNode.getWorldTransform()),t=this.getBounds();if(!fi.isEmpty(t)){var n=new fi;return n.setFromTransformedAABB(t,e),n}}return this.getBounds()},t}(Rs);!function(e){e[e.kUnknown=0]="kUnknown",e[e.kNumber=1]="kNumber",e[e.kPercentage=2]="kPercentage",e[e.kEms=3]="kEms",e[e.kExs=4]="kExs",e[e.kPixels=5]="kPixels",e[e.kCentimeters=6]="kCentimeters",e[e.kMillimeters=7]="kMillimeters",e[e.kInches=8]="kInches",e[e.kPoints=9]="kPoints",e[e.kPicas=10]="kPicas",e[e.kQuarterMillimeters=11]="kQuarterMillimeters",e[e.kViewportWidth=12]="kViewportWidth",e[e.kViewportHeight=13]="kViewportHeight",e[e.kViewportInlineSize=14]="kViewportInlineSize",e[e.kViewportBlockSize=15]="kViewportBlockSize",e[e.kViewportMin=16]="kViewportMin",e[e.kViewportMax=17]="kViewportMax",e[e.kSmallViewportWidth=18]="kSmallViewportWidth",e[e.kSmallViewportHeight=19]="kSmallViewportHeight",e[e.kSmallViewportInlineSize=20]="kSmallViewportInlineSize",e[e.kSmallViewportBlockSize=21]="kSmallViewportBlockSize",e[e.kSmallViewportMin=22]="kSmallViewportMin",e[e.kSmallViewportMax=23]="kSmallViewportMax",e[e.kLargeViewportWidth=24]="kLargeViewportWidth",e[e.kLargeViewportHeight=25]="kLargeViewportHeight",e[e.kLargeViewportInlineSize=26]="kLargeViewportInlineSize",e[e.kLargeViewportBlockSize=27]="kLargeViewportBlockSize",e[e.kLargeViewportMin=28]="kLargeViewportMin",e[e.kLargeViewportMax=29]="kLargeViewportMax",e[e.kDynamicViewportWidth=30]="kDynamicViewportWidth",e[e.kDynamicViewportHeight=31]="kDynamicViewportHeight",e[e.kDynamicViewportInlineSize=32]="kDynamicViewportInlineSize",e[e.kDynamicViewportBlockSize=33]="kDynamicViewportBlockSize",e[e.kDynamicViewportMin=34]="kDynamicViewportMin",e[e.kDynamicViewportMax=35]="kDynamicViewportMax",e[e.kContainerWidth=36]="kContainerWidth",e[e.kContainerHeight=37]="kContainerHeight",e[e.kContainerInlineSize=38]="kContainerInlineSize",e[e.kContainerBlockSize=39]="kContainerBlockSize",e[e.kContainerMin=40]="kContainerMin",e[e.kContainerMax=41]="kContainerMax",e[e.kRems=42]="kRems",e[e.kChs=43]="kChs",e[e.kUserUnits=44]="kUserUnits",e[e.kDegrees=45]="kDegrees",e[e.kRadians=46]="kRadians",e[e.kGradians=47]="kGradians",e[e.kTurns=48]="kTurns",e[e.kMilliseconds=49]="kMilliseconds",e[e.kSeconds=50]="kSeconds",e[e.kHertz=51]="kHertz",e[e.kKilohertz=52]="kKilohertz",e[e.kDotsPerPixel=53]="kDotsPerPixel",e[e.kDotsPerInch=54]="kDotsPerInch",e[e.kDotsPerCentimeter=55]="kDotsPerCentimeter",e[e.kFraction=56]="kFraction",e[e.kInteger=57]="kInteger",e[e.kQuirkyEms=58]="kQuirkyEms"}(ms||(ms={})),function(e){e[e.kUNumber=0]="kUNumber",e[e.kUPercent=1]="kUPercent",e[e.kULength=2]="kULength",e[e.kUAngle=3]="kUAngle",e[e.kUTime=4]="kUTime",e[e.kUFrequency=5]="kUFrequency",e[e.kUResolution=6]="kUResolution",e[e.kUOther=7]="kUOther"}(_s||(_s={})),function(e){e[e.kAll=0]="kAll",e[e.kNonNegative=1]="kNonNegative",e[e.kInteger=2]="kInteger",e[e.kNonNegativeInteger=3]="kNonNegativeInteger",e[e.kPositiveInteger=4]="kPositiveInteger"}(gs||(gs={})),function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"}(Es||(Es={})),function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"}(Ts||(Ts={}));var ws,ks=[{name:"em",unit_type:ms.kEms},{name:"px",unit_type:ms.kPixels},{name:"deg",unit_type:ms.kDegrees},{name:"rad",unit_type:ms.kRadians},{name:"grad",unit_type:ms.kGradians},{name:"ms",unit_type:ms.kMilliseconds},{name:"s",unit_type:ms.kSeconds},{name:"rem",unit_type:ms.kRems},{name:"turn",unit_type:ms.kTurns}];!function(e){e[e.kUnknownType=0]="kUnknownType",e[e.kUnparsedType=1]="kUnparsedType",e[e.kKeywordType=2]="kKeywordType",e[e.kUnitType=3]="kUnitType",e[e.kSumType=4]="kSumType",e[e.kProductType=5]="kProductType",e[e.kNegateType=6]="kNegateType",e[e.kInvertType=7]="kInvertType",e[e.kMinType=8]="kMinType",e[e.kMaxType=9]="kMaxType",e[e.kClampType=10]="kClampType",e[e.kTransformType=11]="kTransformType",e[e.kPositionType=12]="kPositionType",e[e.kURLImageType=13]="kURLImageType",e[e.kColorType=14]="kColorType",e[e.kUnsupportedColorType=15]="kUnsupportedColorType"}(ws||(ws={}));var Us,Gs,js=function(){function e(){}return e.parse=function(e,t){return[][0]},e.parseAll=function(e,t){return[]},e.unitFromName=function(e){return e?"number"===e?ms.kNumber:"percent"===e||"%"===e?ms.kPercentage:this.stringToUnitType(e):ms.kUnknown},e.unitTypeToUnitCategory=function(e){switch(e){case ms.kNumber:case ms.kInteger:return _s.kUNumber;case ms.kPercentage:return _s.kUPercent;case ms.kPixels:case ms.kCentimeters:case ms.kMillimeters:case ms.kQuarterMillimeters:case ms.kInches:case ms.kPoints:case ms.kPicas:case ms.kUserUnits:return _s.kULength;case ms.kMilliseconds:case ms.kSeconds:return _s.kUTime;case ms.kDegrees:case ms.kRadians:case ms.kGradians:case ms.kTurns:return _s.kUAngle;case ms.kHertz:case ms.kKilohertz:return _s.kUFrequency;case ms.kDotsPerPixel:case ms.kDotsPerInch:case ms.kDotsPerCentimeter:return _s.kUResolution;default:return _s.kUOther}},e.unitTypeToString=function(e){switch(e){case ms.kNumber:case ms.kInteger:case ms.kUserUnits:return"";case ms.kPercentage:return"%";case ms.kEms:case ms.kQuirkyEms:return"em";case ms.kRems:return"rem";case ms.kPixels:return"px";case ms.kDegrees:return"deg";case ms.kRadians:return"rad";case ms.kGradians:return"grad";case ms.kMilliseconds:return"ms";case ms.kSeconds:return"s";case ms.kTurns:return"turn"}return""},e.stringToUnitType=function(e){return ks.find((function(t){return t.name===e})).unit_type},e.canonicalUnitTypeForCategory=function(e){switch(e){case _s.kUNumber:return ms.kNumber;case _s.kULength:return ms.kPixels;case _s.kUPercent:return ms.kUnknown;case _s.kUTime:return ms.kSeconds;case _s.kUAngle:return ms.kDegrees;case _s.kUFrequency:return ms.kHertz;case _s.kUResolution:return ms.kDotsPerPixel;default:return ms.kUnknown}},e.conversionToCanonicalUnitsScaleFactor=function(e){var t=1;switch(e){case ms.kPixels:case ms.kUserUnits:case ms.kDegrees:case ms.kSeconds:case ms.kHertz:break;case ms.kMilliseconds:t=.001;break;case ms.kCentimeters:case ms.kDotsPerCentimeter:case ms.kMillimeters:case ms.kQuarterMillimeters:case ms.kInches:case ms.kDotsPerInch:case ms.kPoints:case ms.kPicas:break;case ms.kRadians:t=180/Math.PI;break;case ms.kGradians:t=.9;break;case ms.kTurns:t=360;break;case ms.kKilohertz:t=1e3}return t},e.isAngle=function(e){return e===ms.kDegrees||e===ms.kRadians||e===ms.kGradians||e===ms.kTurns},e.isViewportPercentageLength=function(e){return e>=ms.kViewportWidth&&e<=ms.kDynamicViewportMax},e.isContainerPercentageLength=function(e){return e>=ms.kContainerWidth&&e<=ms.kContainerMax},e.isLength=function(e){return e>=ms.kEms&&e<=ms.kUserUnits||e==ms.kQuirkyEms},e.isRelativeUnit=function(e){return e===ms.kPercentage||e===ms.kEms||e===ms.kExs||e===ms.kRems||e===ms.kChs||this.isViewportPercentageLength(e)||this.isContainerPercentageLength(e)},e.isTime=function(e){return e===ms.kSeconds||e===ms.kMilliseconds},e.isFrequency=function(e){return e==ms.kHertz||e==ms.kKilohertz},e.isResolution=function(e){return e>=ms.kDotsPerPixel&&e<=ms.kDotsPerCentimeter},e.isFlex=function(e){return e===ms.kFraction},e.prototype.toString=function(){return this.buildCSSText(Es.kNo,Ts.kNo,"")},e.prototype.isNumericValue=function(){return this.getType()>=ws.kUnitType&&this.getType()<=ws.kClampType},e}(),Vs=function(e){function t(t){var n=e.call(this)||this;return n.colorSpace=t,n}return Object(l.__extends)(t,e),t.prototype.getType=function(){return ws.kColorType},t.prototype.to=function(e){return this},t}(js),Ws=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return Object(l.__extends)(t,e),t.prototype.clone=function(){return new t(this.value)},t.prototype.getType=function(){return ws.kKeywordType},t.prototype.buildCSSText=function(e,t,n){return n+this.value},t}(js);function Hs(e){return e===Us.kMin||e===Us.kMax||e===Us.kClamp}function Xs(e){switch(Ii(e,ms.kNumber),e){case ms.kEms:case ms.kExs:case ms.kPixels:case ms.kCentimeters:case ms.kMillimeters:case ms.kQuarterMillimeters:case ms.kInches:case ms.kPoints:case ms.kPicas:case ms.kUserUnits:case ms.kViewportWidth:case ms.kViewportHeight:case ms.kViewportInlineSize:case ms.kViewportBlockSize:case ms.kViewportMin:case ms.kViewportMax:case ms.kSmallViewportWidth:case ms.kSmallViewportHeight:case ms.kSmallViewportInlineSize:case ms.kSmallViewportBlockSize:case ms.kSmallViewportMin:case ms.kSmallViewportMax:case ms.kLargeViewportWidth:case ms.kLargeViewportHeight:case ms.kLargeViewportInlineSize:case ms.kLargeViewportBlockSize:case ms.kLargeViewportMin:case ms.kLargeViewportMax:case ms.kDynamicViewportWidth:case ms.kDynamicViewportHeight:case ms.kDynamicViewportInlineSize:case ms.kDynamicViewportBlockSize:case ms.kDynamicViewportMin:case ms.kDynamicViewportMax:case ms.kContainerWidth:case ms.kContainerHeight:case ms.kContainerInlineSize:case ms.kContainerBlockSize:case ms.kContainerMin:case ms.kContainerMax:case ms.kRems:case ms.kChs:return Gs.kLength;case ms.kMilliseconds:case ms.kSeconds:return Gs.kTime;case ms.kDegrees:case ms.kRadians:case ms.kGradians:case ms.kTurns:return Gs.kAngle;case ms.kHertz:case ms.kKilohertz:return Gs.kFrequency;case ms.kDotsPerPixel:case ms.kDotsPerInch:case ms.kDotsPerCentimeter:return Gs.kResolution;case ms.kFraction:return Gs.kFlex;case ms.kPercentage:return Gs.kPercent;default:return Gs.kLength}}function zs(e){switch(e){case Gs.kLength:return"length";case Gs.kAngle:return"angle";case Gs.kTime:return"time";case Gs.kFrequency:return"frequency";case Gs.kResolution:return"resolution";case Gs.kFlex:return"flex";case Gs.kPercent:return"percent"}return""}!function(e){e.kAdd="+",e.kSubtract="-",e.kMultiply="*",e.kDivide="/",e.kMin="min",e.kMax="max",e.kClamp="clamp",e.kInvalid=""}(Us||(Us={})),function(e){e[e.kLength=0]="kLength",e[e.kAngle=1]="kAngle",e[e.kTime=2]="kTime",e[e.kFrequency=3]="kFrequency",e[e.kResolution=4]="kResolution",e[e.kFlex=5]="kFlex",e[e.kPercent=6]="kPercent",e[e.kNumBaseTypes=7]="kNumBaseTypes"}(Gs||(Gs={}));var Ys=function(){function e(e,t){void 0===e&&(e=ms.kNumber),void 0===t&&(t=1),this.exponents=[],this.numNonZeroEntries=0,this.percentHint=Gs.kPercent,this.hasPercentHint=!1,this.exponents=new Array(Gs.kNumBaseTypes).fill(0),e!==ms.kNumber&&this.setExponent(Xs(e),t)}return e.prototype.applyPercentHint=function(e){Ii(e,Gs.kPercent),this.setExponent(e,this.exponent(e)+this.exponent(Gs.kPercent)),this.setExponent(Gs.kPercent,0),this.percentHint=e,this.hasPercentHint=!0},e.prototype.hasNonZeroEntries=function(){return this.numNonZeroEntries>0},e.prototype.isOnlyNonZeroEntry=function(e,t){return Ii(t,0),1===this.numNonZeroEntries&&this.exponent(e)===t},e.prototype.exponent=function(e){return this.exponents[e]},e.prototype.setExponent=function(e,t){var n=this.exponents[e];0==n&&0!==t?this.numNonZeroEntries++:0!==n&&0==t&&this.numNonZeroEntries--,this.exponents[e]=t},e.negateExponents=function(e){return e.exponents.forEach((function(e){return-1*e})),e},e.prototype.matchesBaseType=function(e){return Ii(e,Gs.kPercent),this.isOnlyNonZeroEntry(e,1)&&!this.hasPercentHint},e.prototype.matchesPercentage=function(){return this.isOnlyNonZeroEntry(Gs.kPercent,1)},e.prototype.matchesBaseTypePercentage=function(e){return Ii(e,Gs.kPercent),this.isOnlyNonZeroEntry(e,1)||this.isOnlyNonZeroEntry(Gs.kPercent,1)},e.prototype.matchesNumber=function(){return!this.hasNonZeroEntries()&&!this.hasPercentHint},e.prototype.matchesNumberPercentage=function(){return!this.hasNonZeroEntries()||this.isOnlyNonZeroEntry(Gs.kPercent,1)},e.add=function(e,t,n){if(e.hasPercentHint&&t.hasPercentHint&&e.percentHint!=t.percentHint)return!0,e;e.hasPercentHint?t.applyPercentHint(e.percentHint):t.hasPercentHint&&e.applyPercentHint(t.percentHint),Fi(e.percentHint,t.percentHint);for(var r=0;r<Gs.kNumBaseTypes;++r){var i=r;if(e.exponents[r]!==t.exponents[r]&&(i!==Gs.kPercent&&(e.applyPercentHint(i),t.applyPercentHint(i)),e.exponents[r]!==t.exponents[r]))return!0,e}return!1,e},e.multiply=function(e,t,n){if(e.hasPercentHint&&t.hasPercentHint&&e.percentHint!=t.percentHint)return!0,e;e.hasPercentHint?t.applyPercentHint(e.percentHint):t.hasPercentHint&&e.applyPercentHint(t.percentHint);for(var r=0;r<Gs.kNumBaseTypes;++r){var i=r;e.setExponent(i,e.exponent(i)+t.exponent(i))}return!1,e},e}(),Ks=function(e){function t(t){var n=e.call(this)||this;return n.type_=t,n}return Object(l.__extends)(t,e),t.fromNumberish=function(e){return"number"==typeof e?new eu(e,ms.kNumber):e},t.fromPercentish=function(e){return"number"==typeof e?new eu(100*e,ms.kPercentage):e},t.prototype.getType=function(){return ws.kUnknownType},t.prototype.equals=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=qs(t);return r.every((function(t){return e.equals(t)}))},t.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qs(e);Zs(ws.kSumType,n,this);var r=Qs(n,Us.kAdd);return r||cu.create(n)},t.prototype.sub=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qs(e);n=n.map((function(e){return e.negate()})),Zs(ws.kSumType,n,this);var r=Qs(n,Us.kAdd);return r||cu.create(n)},t.prototype.mul=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qs(e);Zs(ws.kProductType,n,this);var r=$s(n);return r||lu.create(n)},t.prototype.div=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qs(e);n=n.map((function(e){return e.invert()})),Zs(ws.kProductType,n,this);var r=$s(n);return r||lu.create(n)},t.prototype.min=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qs(e);Zs(ws.kMinType,n,this);var r=Qs(n,Us.kMin);return r||su.create(n)},t.prototype.max=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qs(e);Zs(ws.kMaxType,n,this);var r=Qs(n,Us.kMax);return r||uu.create(n)},t.prototype.to=function(e){var t=this.sumValue();if(0===t.length||1!==t.length)return null;var n,r=Js(t[0]);return r?(n="string"==typeof e?eu.unitFromName(e):e,r.convertTo(n)):null},t.prototype.toSum=function(){for(var e,n,r,i,o,a,s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];try{for(var c=Object(l.__values)(s),f=c.next();!f.done;f=c.next()){var h=f.value;if(!t.isValidUnit(t.unitFromName(h)))return null}}catch(R){e={error:R}}finally{try{f&&!f.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}var d=this.sumValue();if(!d.length)return null;var p=[];try{for(var v=Object(l.__values)(d),y=v.next();!y.done;y=v.next()){var m=y.value,_=Js(m);if(!_)return null;p.push(_)}}catch(A){r={error:A}}finally{try{y&&!y.done&&(i=v.return)&&i.call(v)}finally{if(r)throw r.error}}if(0===s.length){p.sort((function(e,t){return e.unit-t.unit}));var g=cu.create(p);return Ni(!!g),g}var E=[],T=function(e){var n=t.unitFromName(e);Ni(t.isValidUnit(n));var r=p.reduce((function(e,t,r){if(t){var i=t.convertTo(n);i&&(e+=i.value,p[r]=null)}return e}),0);E.push(new eu(r,n))};try{for(var b=Object(l.__values)(s),S=b.next();!S.done;S=b.next()){T(h=S.value)}}catch(O){o={error:O}}finally{try{S&&!S.done&&(a=b.return)&&a.call(b)}finally{if(o)throw o.error}}if(p.some((function(e){return!!e})))throw new Error("There were leftover terms that were not converted");return cu.create(E)},t.prototype.type=function(){var e={length:0,angle:0,time:0,frequency:0,resolution:0,flex:0,percent:0,percentHint:"length"},t=this.type_.exponent(Gs.kLength);return t&&(e.length=t),(t=this.type_.exponent(Gs.kAngle))&&(e.angle=t),(t=this.type_.exponent(Gs.kTime))&&(e.time=t),(t=this.type_.exponent(Gs.kFrequency))&&(e.frequency=t),(t=this.type_.exponent(Gs.kResolution))&&(e.resolution=t),(t=this.type_.exponent(Gs.kFlex))&&(e.flex=t),(t=this.type_.exponent(Gs.kPercent))&&(e.percent=t),this.type_.hasPercentHint&&(e.percentHint=zs(this.type_.percentHint)),e},t.isValidUnit=function(e){return e!==ms.kUserUnits&&!!(e===ms.kNumber||e==ms.kPercentage||this.isLength(e)||this.isAngle(e)||this.isTime(e)||this.isFrequency(e)||this.isResolution(e)||this.isFlex(e))},t.prototype.negate=function(){return ru.create(this)},t.prototype.invert=function(){return nu.create(this)},t}(js);function qs(e){return e.map(Ks.fromNumberish)}function Zs(e,t,n){Ni(!!n),n.getType()===e?t.unshift.apply(t,Object(l.__spreadArray)([],Object(l.__read)(n.numericValues()),!1)):t.unshift(n)}function Js(e){return 0===Object.keys(e.units).length?new eu(e.value):1===Object.keys(e.units).length&&1===e.units[Object.keys(e.units)[0]]?new eu(e.value,Number(Object.keys(e.units)[0])):null}function Qs(e,t){Ni(!!e.length);var n=e[0]instanceof eu?e[0]:null;if(!n)return null;for(var r=n.value,i=1;i<e.length;i++){var o=e[i]instanceof eu?e[i]:null;if(!o||o.unit!==n.unit)return null;t===Us.kAdd?r+=o.value:t===Us.kMax?r=Math.max(r,o.value):t===Us.kMin&&(r=Math.min(r,o.value))}return new eu(r,n.unit)}function $s(e){Ni(!!e.length);for(var t=ms.kNumber,n=1,r=0;r<e.length;r++){var i=e[r]instanceof eu?e[r]:null;if(!i)return null;if(i.unit!==ms.kNumber){if(t!==ms.kNumber)return null;t=i.unit}n*=i.value}return new eu(n,t)}var eu=function(e){function t(n,r){void 0===r&&(r=ms.kNumber);var i,o=this;return i="string"==typeof r?t.unitFromName(r):r,Ni(t.isValidUnit(i)),(o=e.call(this,new Ys(i))||this).unit=i,o.value=n,o}return Object(l.__extends)(t,e),t.toCanonicalUnit=function(e){return this.canonicalUnitTypeForCategory(this.unitTypeToUnitCategory(e))},t.toCanonicalUnitIfPossible=function(e){var t=this.toCanonicalUnit(e);return t===ms.kUnknown?e:t},t.formatInfinityOrNaN=function(e,t){void 0===t&&(t="");var n="";return Number.isFinite(e)?(Ni(Number.isNaN(e)),n="NaN"):n=e>0?"infinity":"-infinity",n+t},t.formatNumber=function(e,t){return void 0===t&&(t=""),e+t},t.prototype.clone=function(){return new t(this.value,this.unit)},t.prototype.convertTo=function(e){if(this.unit===e)return new t(this.value,this.unit);var n=t.toCanonicalUnit(this.unit);if(n!==t.toCanonicalUnit(e)||n===ms.kUnknown)return null;var r=js.conversionToCanonicalUnitsScaleFactor(this.unit)/js.conversionToCanonicalUnitsScaleFactor(e);return new t(this.value*r,e)},t.prototype.equals=function(e){var t=e;return this.value===t.value&&this.unit===t.unit},t.prototype.getType=function(){return ws.kUnitType},t.prototype.sumValue=function(){var e=[],n={};return this.unit!==ms.kNumber&&(n[t.toCanonicalUnitIfPossible(this.unit)]=1),e.push({value:this.value*js.conversionToCanonicalUnitsScaleFactor(this.unit),units:n}),e},t.prototype.negate=function(){return new t(-this.value,this.unit)},t.prototype.invert=function(){return this.unit===ms.kNumber?0===this.value?null:new t(1/this.value,this.unit):nu.create(this)},t.prototype.buildCSSText=function(e,n,r){var i;switch(this.unit){case ms.kUnknown:break;case ms.kInteger:i=Number(this.value).toFixed(0);break;case ms.kNumber:case ms.kPercentage:case ms.kEms:case ms.kQuirkyEms:case ms.kExs:case ms.kRems:case ms.kChs:case ms.kPixels:case ms.kCentimeters:case ms.kDotsPerPixel:case ms.kDotsPerInch:case ms.kDotsPerCentimeter:case ms.kMillimeters:case ms.kQuarterMillimeters:case ms.kInches:case ms.kPoints:case ms.kPicas:case ms.kUserUnits:case ms.kDegrees:case ms.kRadians:case ms.kGradians:case ms.kMilliseconds:case ms.kSeconds:case ms.kHertz:case ms.kKilohertz:case ms.kTurns:case ms.kFraction:case ms.kViewportWidth:case ms.kViewportHeight:case ms.kViewportInlineSize:case ms.kViewportBlockSize:case ms.kViewportMin:case ms.kViewportMax:case ms.kSmallViewportWidth:case ms.kSmallViewportHeight:case ms.kSmallViewportInlineSize:case ms.kSmallViewportBlockSize:case ms.kSmallViewportMin:case ms.kSmallViewportMax:case ms.kLargeViewportWidth:case ms.kLargeViewportHeight:case ms.kLargeViewportInlineSize:case ms.kLargeViewportBlockSize:case ms.kLargeViewportMin:case ms.kLargeViewportMax:case ms.kDynamicViewportWidth:case ms.kDynamicViewportHeight:case ms.kDynamicViewportInlineSize:case ms.kDynamicViewportBlockSize:case ms.kDynamicViewportMin:case ms.kDynamicViewportMax:case ms.kContainerWidth:case ms.kContainerHeight:case ms.kContainerInlineSize:case ms.kContainerBlockSize:case ms.kContainerMin:case ms.kContainerMax:var o=this.value,a=t.unitTypeToString(this.unit);if(o<-999999||o>999999){var s=t.unitTypeToString(this.unit);i=!Number.isFinite(o)||Number.isNaN(o)?t.formatInfinityOrNaN(o,s):t.formatNumber(o,s)}else i="".concat(o).concat(a)}return r+=i},t}(Ks),tu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.isUnitValue=function(){return!1},t}(Ks),nu=function(e){function t(t,n){var r=e.call(this,n)||this;return r.value=t,r.operator="invert",r}return Object(l.__extends)(t,e),t.create=function(e){return new t(e,Ys.negateExponents(e.type_))},t.prototype.clone=function(){return new t(this.value,this.type_)},t.prototype.getType=function(){return ws.kInvertType},t.prototype.equals=function(e){if(e.getType()!==ws.kInvertType)return!1;var t=e;return this.value.equals(t.value)},t.prototype.sumValue=function(){var e=this.value.sumValue();return 0===e.length||1!==e.length||0===e[0].value?null:(Object.keys(e[0].units).forEach((function(t){e[0].units[t]*=-1})),e[0].value=1/e[0].value,e)},t.prototype.buildCSSText=function(e,t,n){return t==Ts.kNo&&(n+=e===Es.kYes?"(":"calc("),n+="1 / ",n=this.value.buildCSSText(Es.kYes,Ts.kNo,n),t===Ts.kNo&&(n+=")"),n},t}(tu),ru=function(e){function t(t,n){var r=e.call(this,n)||this;return r.value=t,r.operator="negate",r}return Object(l.__extends)(t,e),t.create=function(e){return new t(e,e.type_)},t.prototype.clone=function(){return new t(this.value,this.type_)},t.prototype.getType=function(){return ws.kNegateType},t.prototype.equals=function(e){if(e.getType()!==ws.kNegateType)return!1;var t=e;return this.value.equals(t.value)},t.prototype.sumValue=function(){var e=this.value.sumValue();return 0===e.length?null:(e.forEach((function(e){e.value*=-1})),e)},t.prototype.buildCSSText=function(e,t,n){return t==Ts.kNo&&(n+=e===Es.kYes?"(":"calc("),n+="-",n=this.value.buildCSSText(Es.kYes,Ts.kNo,n),t===Ts.kNo&&(n+=")"),n},t}(tu);function iu(e,t,n){for(var r=e[0].type_,i=1;i<e.length;i++)r=t(r,e[i].type_,!1);return r}var ou,au=function(e){function t(t,n){var r=e.call(this,n)||this;return r.values=t,r}return Object(l.__extends)(t,e),t.prototype.numericValues=function(){return this.values},t.prototype.equals=function(e){return this.getType()===e.getType()&&this.values.every((function(t,n){return t.equals(e.values[n])}))},t}(tu),su=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.operator="min",t}return Object(l.__extends)(t,e),t.create=function(e){return new t(e,iu(e,Ys.add))},t.prototype.clone=function(){return new t(this.values,this.type_)},t.prototype.getType=function(){return ws.kMinType},t.prototype.sumValue=function(){var e,t,n=this.numericValues()[0].sumValue();if(!n.length)return null;try{for(var r=Object(l.__values)(this.numericValues()),i=r.next();!i.done;i=r.next()){var o=i.value.sumValue();if(!o.length||JSON.stringify(o[0].units)!==JSON.stringify(n[0].units))return null;o[0].value<n[0].value&&(n=o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.buildCSSText=function(e,t,n){var r,i;n+="min(";var o=!0;try{for(var a=Object(l.__values)(this.numericValues()),s=a.next();!s.done;s=a.next()){var u=s.value;o||(n+=", "),o=!1,n=u.buildCSSText(Es.kYes,Ts.kYes,n)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return n+=")"},t}(au),uu=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.operator="max",t}return Object(l.__extends)(t,e),t.create=function(e){return new t(e,iu(e,Ys.add))},t.prototype.clone=function(){return new t(this.values,this.type_)},t.prototype.getType=function(){return ws.kMaxType},t.prototype.sumValue=function(){var e,t,n=this.numericValues()[0].sumValue();if(!n.length)return null;try{for(var r=Object(l.__values)(this.numericValues()),i=r.next();!i.done;i=r.next()){var o=i.value.sumValue();if(!o.length||JSON.stringify(o[0].units)!==JSON.stringify(n[0].units))return null;o[0].value<n[0].value&&(n=o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.buildCSSText=function(e,t,n){var r,i;n+="max(";var o=!0;try{for(var a=Object(l.__values)(this.numericValues()),s=a.next();!s.done;s=a.next()){var u=s.value;o||(n+=", "),o=!1,n=u.buildCSSText(Es.kYes,Ts.kYes,n)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return n+=")"},t}(au),cu=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.operator="sum",t}return Object(l.__extends)(t,e),t.create=function(e){return new t(e,iu(e,Ys.add))},t.numericTypeFromUnitMap=function(e){var t=new Ys;return Object.keys(e).forEach((function(n){var r=e[n];t=Ys.multiply(t,new Ys(Number(n),r),!1),Ni(!0)})),t},t.canCreateNumericTypeFromSumValue=function(e){var t=this;Ni(!!e.length);var n=this.numericTypeFromUnitMap(e[0].units);return e.every((function(e){return Ys.add(n,t.numericTypeFromUnitMap(e.units),!1),!0}))},t.prototype.clone=function(){return new t(this.values,this.type_)},t.prototype.getType=function(){return ws.kSumType},t.prototype.sumValue=function(){var e=[];return this.numericValues().forEach((function(t){var n=t.sumValue();if(!n.length)return null;n.forEach((function(t){var n=e.findIndex((function(e){return JSON.stringify(e.units)===JSON.stringify(t.units)}));-1===n?e.push(Object(l.__assign)({},t)):e[n].value+=t.value}))})),t.canCreateNumericTypeFromSumValue(e)?e:null},t.prototype.buildCSSText=function(e,t,n){t==Ts.kNo&&(n+=e===Es.kYes?"(":"calc(");var r=this.numericValues();n=r[0].buildCSSText(Es.kYes,Ts.kNo,n);for(var i=1;i<r.length;i++){var o=r[i];o.getType()===ws.kNegateType?(n+=" - ",n=o.value.buildCSSText(Es.kYes,Ts.kNo,n)):(n+=" + ",n=o.buildCSSText(Es.kYes,Ts.kNo,n))}return t===Ts.kNo&&(n+=")"),n},t}(au),lu=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.operator="product",t}return Object(l.__extends)(t,e),t.create=function(e){return new t(e,iu(e,Ys.multiply))},t.multiplyUnitMaps=function(e,t){return Object.keys(t).forEach((function(n){Ii(t[n].value,0);var r=n in e?e[n].value:0;r+t[n].value===0?delete e[n]:e[n]=r+t[n].value})),e},t.prototype.clone=function(){return new t(this.values,this.type_)},t.prototype.getType=function(){return ws.kProductType},t.prototype.sumValue=function(){var e=[{value:1,units:{}}];return this.numericValues().forEach((function(n){var r=n.sumValue();if(!r.length)return null;var i=[];e.forEach((function(e){r.forEach((function(n){i.push({value:e.value*n.value,units:t.multiplyUnitMaps(e.units,n.units)})}))})),e=i})),e},t.prototype.buildCSSText=function(e,t,n){t==Ts.kNo&&(n+=e===Es.kYes?"(":"calc(");var r=this.numericValues();n=r[0].buildCSSText(Es.kYes,Ts.kNo,n);for(var i=1;i<r.length;i++){var o=r[i];o.getType()===ws.kInvertType?(n+=" / ",n=o.value.buildCSSText(Es.kYes,Ts.kNo,n)):(n+=" * ",n=o.buildCSSText(Es.kYes,Ts.kNo,n))}return t===Ts.kNo&&(n+=")"),n},t}(au),fu=new eu(0,"px"),hu=new eu(0,"deg"),du=function(e){function t(t,n,r,i,o){void 0===i&&(i=1),void 0===o&&(o=!1);var a=e.call(this,"rgb")||this;return a.r=t,a.g=n,a.b=r,a.alpha=i,a.isNone=o,a}return Object(l.__extends)(t,e),t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.alpha)},t.prototype.buildCSSText=function(e,t,n){return n+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},t}(Vs);!function(e){e[e.Constant=0]="Constant",e[e.LinearGradient=1]="LinearGradient",e[e.RadialGradient=2]="RadialGradient",e[e.Pattern=3]="Pattern"}(ou||(ou={}));var pu,vu=function(e){function t(t,n){var r=e.call(this)||this;return r.type=t,r.value=n,r}return Object(l.__extends)(t,e),t.prototype.clone=function(){return new t(this.type,this.value)},t.prototype.buildCSSText=function(e,t,n){var r="";return this.type===ou.LinearGradient?r="linear-gradient(".concat(this.value.steps.map((function(e){return e.join(",")})).join(","),")"):this.type===ou.RadialGradient?r="radial-gradient(".concat(this.value.steps.map((function(e){return e.join(",")})).join(","),")"):this.type===ou.Pattern&&(r="url(".concat(this.value.src,")")),n+r},t.prototype.getType=function(){return ws.kColorType},t}(js),yu=function(e){function t(t){var n=e.call(this)||this;return n.transforms=t,n.is2D=t.every((function(e){return e.is2D})),n.length=t.length,n}return Object(l.__extends)(t,e),t.prototype.clone=function(){return new t(this.transforms)},t.prototype.getType=function(){return ws.kTransformType},t.prototype.buildCSSText=function(e,t,n){return n+""},t.prototype.toMatrix=function(){},t}(js);!function(e){e[e.kMatrixType=0]="kMatrixType",e[e.kPerspectiveType=1]="kPerspectiveType",e[e.kRotationType=2]="kRotationType",e[e.kScaleType=3]="kScaleType",e[e.kSkewType=4]="kSkewType",e[e.kSkewXType=5]="kSkewXType",e[e.kSkewYType=6]="kSkewYType",e[e.kTranslationType=7]="kTranslationType"}(pu||(pu={}));var mu=function(e){function t(t,n,r,i){var o=e.call(this,i)||this;return o.x=t,o.y=n,o.z=r,o}return Object(l.__extends)(t,e),t.prototype.toMatrix=function(){return null},t}((function(e){this.is2D=e})),_u=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function gu(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Eu(){}var Tu="\\s*([+-]?\\d+)\\s*",bu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Su="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ru=/^#([0-9a-f]{3,8})$/,Au=new RegExp("^rgb\\("+[Tu,Tu,Tu]+"\\)$"),Ou=new RegExp("^rgb\\("+[Su,Su,Su]+"\\)$"),Cu=new RegExp("^rgba\\("+[Tu,Tu,Tu,bu]+"\\)$"),Mu=new RegExp("^rgba\\("+[Su,Su,Su,bu]+"\\)$"),xu=new RegExp("^hsl\\("+[bu,Su,Su]+"\\)$"),Pu=new RegExp("^hsla\\("+[bu,Su,Su,bu]+"\\)$"),Nu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Fu(){return this.rgb().formatHex()}function Iu(){return this.rgb().formatRgb()}function Du(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ru.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Lu(t):3===n?new ku(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Bu(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Bu(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Au.exec(e))?new ku(t[1],t[2],t[3],1):(t=Ou.exec(e))?new ku(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Cu.exec(e))?Bu(t[1],t[2],t[3],t[4]):(t=Mu.exec(e))?Bu(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=xu.exec(e))?Vu(t[1],t[2]/100,t[3]/100,1):(t=Pu.exec(e))?Vu(t[1],t[2]/100,t[3]/100,t[4]):Nu.hasOwnProperty(e)?Lu(Nu[e]):"transparent"===e?new ku(NaN,NaN,NaN,0):null}function Lu(e){return new ku(e>>16&255,e>>8&255,255&e,1)}function Bu(e,t,n,r){return r<=0&&(e=t=n=NaN),new ku(e,t,n,r)}function wu(e){return e instanceof Eu||(e=Du(e)),e?new ku((e=e.rgb()).r,e.g,e.b,e.opacity):new ku}function ku(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Uu(){return"#"+ju(this.r)+ju(this.g)+ju(this.b)}function Gu(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function ju(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Vu(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hu(e,t,n,r)}function Wu(e){if(e instanceof Hu)return new Hu(e.h,e.s,e.l,e.opacity);if(e instanceof Eu||(e=Du(e)),!e)return new Hu;if(e instanceof Hu)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Hu(a,s,u,e.opacity)}function Hu(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Xu(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}_u(Eu,Du,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Fu,formatHex:Fu,formatHsl:function(){return Wu(this).formatHsl()},formatRgb:Iu,toString:Iu}),_u(ku,(function(e,t,n,r){return 1===arguments.length?wu(e):new ku(e,t,n,null==r?1:r)}),gu(Eu,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new ku(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ku(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Uu,formatHex:Uu,formatRgb:Gu,toString:Gu})),_u(Hu,(function(e,t,n,r){return 1===arguments.length?Wu(e):new Hu(e,t,n,null==r?1:r)}),gu(Eu,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Hu(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Hu(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ku(Xu(e>=240?e-240:e+120,i,r),Xu(e,i,r),Xu(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var zu=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Yu=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Ku=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,qu=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function Zu(e){if(Li(e)&&(e=""),"transparent"===e)return new du(0,0,0,0);"currentColor"===e&&(e="black");var t=e[0];if("("===e[1]||"("===e[2])if("l"===t){var n=function(e){var t,n=zu.exec(e);if(n){var r=parseFloat(n[1])%360*(Math.PI/180),i=(null===(t=n[2].match(qu))||void 0===t?void 0:t.map((function(e){return e.split(":")})))||[],o=Object(l.__read)([1,1],2),a=o[0],s=o[1],u=Object(l.__read)([0,0],2),c=u[0],f=u[1],h=void 0,d=void 0;r>=0&&r<.5*Math.PI?(h={x:c,y:f},d={x:a,y:s}):.5*Math.PI<=r&&r<Math.PI?(h={x:a,y:f},d={x:c,y:s}):Math.PI<=r&&r<1.5*Math.PI?(h={x:a,y:s},d={x:c,y:f}):(h={x:c,y:s},d={x:a,y:f});var p=Math.tan(r),v=p*p,y=(d.x-h.x+p*(d.y-h.y))/(v+1)+h.x,m=p*(d.x-h.x+p*(d.y-h.y))/(v+1)+h.y;return{x0:h.x,y0:h.y,x1:y,y1:m,steps:i,hash:e}}return null}(e);if(n)return new vu(ou.LinearGradient,n)}else if("r"===t){var r=function(e){var t,n=Yu.exec(e);if(n){var r=parseFloat(n[1]),i=parseFloat(n[2]),o=parseFloat(n[3]),a=(null===(t=n[4].match(qu))||void 0===t?void 0:t.map((function(e){return e.split(":")})))||[];if(0===o){var s=n[4].match(qu);return s[s.length-1].split(":")[1]}return{x0:r,y0:i,r0:0,x1:.5,y1:.5,r1:o,steps:a,hash:e}}return null}(e);if(r){if(!Vo(r))return new vu(ou.RadialGradient,r);e=r}}else if("p"===t){var i=function(e){var t=Ku.exec(e);if(t){var n=t[1],r=t[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;case"n":n="no-repeat";break;default:n="no-repeat"}return{src:r,repetition:n,hash:e}}return null}(e);if(i)return new vu(ou.Pattern,i)}var o=Du(e),a=[0,0,0,0];return null!==o&&(a[0]=o.r||0,a[1]=o.g||0,a[2]=o.b||0,a[3]=o.opacity),new(du.bind.apply(du,Object(l.__spreadArray)([void 0],Object(l.__read)(a),!1)))}function Ju(e,t){if(e instanceof du&&t instanceof du)return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var t=e.slice();if(t[3])for(var n=0;n<3;n++)t[n]=Math.round(Gi(t[n],0,255));return t[3]=Gi(t[3],0,1),"rgba(".concat(t.join(","),")")}]}function Qu(e,t){if(Li(t))return new eu(0,"px");if(t="".concat(t).trim().toLowerCase(),isFinite(Number(t))&&"px".search(e)>=0)return new eu(Number(t),"px");var n=[];t=t.replace(e,(function(e){return n.push(e),"U"+e}));var r="U("+e.source+")";return n.map((function(e){return new eu(Number(t.replace(new RegExp("U"+e,"g"),"").replace(new RegExp(r,"g"),"*0")),e)}))[0]}var $u=Qu.bind(null,new RegExp("px","g")),ec=Qu.bind(null,new RegExp("%","g")),tc=Qu.bind(null,new RegExp("px|%|em","g")),nc=Qu.bind(null,new RegExp("deg|rad|grad|turn","g"));function rc(e,t,n,r,i){void 0===i&&(i=0);var o="",a=e.value||0,s=t.value||0;return(eu.isLength(e.unit)||eu.isLength(t.unit))&&(a=sc(e,i,n),s=sc(t,i,n),o="px"),(eu.isAngle(e.unit)||eu.isAngle(t.unit))&&(a=ic(e),s=ic(t),o="deg"),[a,s,function(e){return r&&(e=Math.max(e,0)),e+o}]}function ic(e){var t=0;return e.unit===ms.kDegrees?t=e.value:e.unit===ms.kRadians?t=Hi(Number(e.value)):e.unit===ms.kTurns&&(t=Yi(Number(e.value))),t}function oc(e){return Vo(e)?e.split(" ").map((function(e){return tc(e)})):e.map((function(e){return tc(e.toString())}))}function ac(e,t,n){if(e.length===t.length){var r=e[0].unit;return[e.map((function(e){return e.value})),t.map((function(e){return e.value})),function(e){return e.map((function(e){return new eu(e,r)})).join(" ")}]}}function sc(e,t,n){if(e.unit===ms.kPixels)return Number(e.value);if(e.unit===ms.kPercentage&&n){var r=n.getGeometryBounds(),i=0;return fi.isEmpty(r)||(i=2*r.halfExtents[t]),Number(e.value)/100*i}return 0}function uc(e){return e.toString()}function cc(e){return"number"==typeof e?new eu(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?new eu(Number(e)):new eu(0)}function lc(e){return Vo(e)?e.split(" ").map(cc):e.map(cc)}function fc(e,t){return[e.value,t.value,uc]}function hc(e,t){return function(n,r){return[n.value,r.value,function(n){return uc(Gi(n,e,t))}]}}function dc(e,t){if(e.length==t.length)return[e.map((function(e){return e.value})),t.map((function(e){return e.value})),function(e){return e}]}var pc="\t\n\v\f\r \u2028\u2029",vc=new RegExp("([a-z])["+pc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+pc+"]*,?["+pc+"]*)+)","ig"),yc=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+pc+"]*,?["+pc+"]*","ig");var mc=/[a-z]/;function _c(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function gc(e){var t=function(e){if(!e)return null;if(Array.isArray(e))return e;var t={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return String(e).replace(vc,(function(e,r,i){var o=[],a=r.toLowerCase();if(i.replace(yc,(function(e,t){t&&o.push(+t)})),"m"===a&&o.length>2&&(n.push([r].concat(o.splice(0,2))),a="l",r="m"===r?"l":"L"),"o"===a&&1===o.length&&n.push([r,o[0]]),"r"===a)n.push([r].concat(o));else for(;o.length>=t[a]&&(n.push([r].concat(o.splice(0,t[a]))),t[a]););return""})),n}(e);if(!t||!t.length)return[["M",0,0]];for(var n=!1,r=0;r<t.length;r++){var i=t[r][0];if(mc.test(i)||["V","H","T","S"].indexOf(i)>=0){n=!0;break}}if(!n)return t;var o=[],a=0,s=0,u=0,c=0,l=0,f=t[0];"M"!==f[0]&&"m"!==f[0]||(u=a=+f[1],c=s=+f[2],l++,o[0]=["M",a,s]);r=l;for(var h=t.length;r<h;r++){var d=t[r],p=o[r-1],v=[],y=(i=d[0]).toUpperCase();if(i!==y)switch(v[0]=y,y){case"A":v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v[6]=+d[6]+a,v[7]=+d[7]+s;break;case"V":v[1]=+d[1]+s;break;case"H":v[1]=+d[1]+a;break;case"M":u=+d[1]+a,c=+d[2]+s,v[1]=u,v[2]=c;break;default:for(var m=1,_=d.length;m<_;m++)v[m]=+d[m]+(m%2?a:s)}else v=t[r];switch(y){case"Z":a=+u,s=+c;break;case"H":v=["L",a=v[1],s];break;case"V":v=["L",a,s=v[1]];break;case"T":a=v[1],s=v[2];var g=_c([p[1],p[2]],[p[3],p[4]]);v=["Q",g[0],g[1],a,s];break;case"S":a=v[v.length-2],s=v[v.length-1];var E=p.length,T=_c([p[E-4],p[E-3]],[p[E-2],p[E-1]]);v=["C",T[0],T[1],v[1],v[2],a,s];break;case"M":u=v[v.length-2],c=v[v.length-1];break;default:a=v[v.length-2],s=v[v.length-1]}o.push(v)}return o}var Ec=2*Math.PI,Tc=function(e,t,n,r,i,o,a){var s=e.x,u=e.y;return{x:r*(s*=t)-i*(u*=n)+o,y:i*s+r*u+a}},bc=function(e,t){var n=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),r=Math.cos(e),i=Math.sin(e),o=Math.cos(e+t),a=Math.sin(e+t);return[{x:r-i*n,y:i+r*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]},Sc=function(e,t,n,r){var i=e*n+t*r;return i>1&&(i=1),i<-1&&(i=-1),(e*r-t*n<0?-1:1)*Math.acos(i)},Rc=function(e){var t=e.px,n=e.py,r=e.cx,i=e.cy,o=e.rx,a=e.ry,s=e.xAxisRotation,u=void 0===s?0:s,c=e.largeArcFlag,l=void 0===c?0:c,f=e.sweepFlag,h=void 0===f?0:f,d=[];if(0===o||0===a)return[{x1:0,y1:0,x2:0,y2:0,x:r,y:i}];var p=Math.sin(u*Ec/360),v=Math.cos(u*Ec/360),y=v*(t-r)/2+p*(n-i)/2,m=-p*(t-r)/2+v*(n-i)/2;if(0===y&&0===m)return[{x1:0,y1:0,x2:0,y2:0,x:r,y:i}];o=Math.abs(o),a=Math.abs(a);var _=Math.pow(y,2)/Math.pow(o,2)+Math.pow(m,2)/Math.pow(a,2);_>1&&(o*=Math.sqrt(_),a*=Math.sqrt(_));var g=function(e,t,n,r,i,o,a,s,u,c,l,f){var h=Math.pow(i,2),d=Math.pow(o,2),p=Math.pow(l,2),v=Math.pow(f,2),y=h*d-h*v-d*p;y<0&&(y=0),y/=h*v+d*p;var m=(y=Math.sqrt(y)*(a===s?-1:1))*i/o*f,_=y*-o/i*l,g=c*m-u*_+(e+n)/2,E=u*m+c*_+(t+r)/2,T=(l-m)/i,b=(f-_)/o,S=(-l-m)/i,R=(-f-_)/o,A=Sc(1,0,T,b),O=Sc(T,b,S,R);return 0===s&&O>0&&(O-=Ec),1===s&&O<0&&(O+=Ec),[g,E,A,O]}(t,n,r,i,o,a,l,h,p,v,y,m),E=g[0],T=g[1],b=g[2],S=g[3],R=Math.abs(S)/(Ec/4);Math.abs(1-R)<1e-7&&(R=1);var A=Math.max(Math.ceil(R),1);S/=A;for(var O=0;O<A;O++)d.push(bc(b,S)),b+=S;return d.map((function(e){var t=Tc(e[0],o,a,v,p,E,T),n=t.x,r=t.y,i=Tc(e[1],o,a,v,p,E,T),s=i.x,u=i.y,c=Tc(e[2],o,a,v,p,E,T);return{x1:n,y1:r,x2:s,y2:u,x:c.x,y:c.y}}))};function Ac(e,t,n,r,i,o,a,s,u){return Rc({px:e,py:t,cx:s,cy:u,rx:n,ry:r,xAxisRotation:i,largeArcFlag:o,sweepFlag:a}).reduce((function(e,t){var n=t.x1,r=t.y1,i=t.x2,o=t.y2,a=t.x,s=t.y;return e.push(n,r,i,o,a,s),e}),[])}function Oc(e,t,n,r,i,o){return[1/3*e+2/3*n,1/3*t+2/3*r,1/3*i+2/3*n,1/3*o+2/3*r,i,o]}function Cc(e,t,n,r){return[e,t,n,r,n,r]}function Mc(e,t){"TQ".indexOf(e[0])<0&&(t.qx=null,t.qy=null);var n=e.slice(1),r=n[0],i=n[1];switch(e[0]){case"M":return t.x=r,t.y=i,e;case"A":return["C"].concat(Ac.apply(0,[t.x1,t.y1].concat(e.slice(1))));case"Q":return t.qx=r,t.qy=i,["C"].concat(Oc.apply(0,[t.x1,t.y1].concat(e.slice(1))));case"L":return["C"].concat(Cc(t.x1,t.y1,e[1],e[2]));case"H":return["C"].concat(Cc(t.x1,t.y1,e[1],t.y1));case"V":return["C"].concat(Cc(t.x1,t.y1,t.x1,e[1]));case"Z":return["C"].concat(Cc(t.x1,t.y1,t.x,t.y))}return e}function xc(e,t,n){if(e[n].length>7){e[n].shift();for(var r=e[n],i=n;r.length;)t[n]="A",e.splice(i+=1,0,["C"].concat(r.splice(0,6)));e.splice(n,1)}}var Pc=Math.PI/180;function Nc(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Fc(e,t){return Nc(e)*Nc(t)?(e[0]*t[0]+e[1]*t[1])/(Nc(e)*Nc(t)):1}function Ic(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(Fc(e,t))}function Dc(e,t){return e[0]===t[0]&&e[1]===t[1]}function Lc(e,t){var n,r,i=t[1],o=t[2],a=(n=function(e){return Pc*e}(t[3]),r=2*Math.PI,(n%r+r)%r),s=t[4],u=t[5],c=e[0],l=e[1],f=t[6],h=t[7],d=Math.cos(a)*(c-f)/2+Math.sin(a)*(l-h)/2,p=-1*Math.sin(a)*(c-f)/2+Math.cos(a)*(l-h)/2,v=d*d/(i*i)+p*p/(o*o);v>1&&(i*=Math.sqrt(v),o*=Math.sqrt(v));var y=i*i*(p*p)+o*o*(d*d),m=y?Math.sqrt((i*i*(o*o)-y)/y):1;s===u&&(m*=-1),isNaN(m)&&(m=0);var _=o?m*i*p/o:0,g=i?m*-o*d/i:0,E=(c+f)/2+Math.cos(a)*_-Math.sin(a)*g,T=(l+h)/2+Math.sin(a)*_+Math.cos(a)*g,b=[(d-_)/i,(p-g)/o],S=[(-1*d-_)/i,(-1*p-g)/o],R=Ic([1,0],b),A=Ic(b,S);return Fc(b,S)<=-1&&(A=Math.PI),Fc(b,S)>=1&&(A=0),0===u&&A>0&&(A-=2*Math.PI),1===u&&A<0&&(A+=2*Math.PI),{cx:E,cy:T,rx:Dc(e,[f,h])?0:i,ry:Dc(e,[f,h])?0:o,startAngle:R,endAngle:R+A,xRotation:a,arcFlag:s,sweepFlag:u}}var Bc=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,wc=/[^\s,]+/gi;function kc(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}function Uc(e){for(var t=[],n=null,r=null,i=null,o=0,a=(e=function(e){var t=e||[];return Array.isArray(t)?t:"string"==typeof t?((t=t.match(Bc)).forEach((function(e,n){if((e=e.match(wc))[0].length>1){var r=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=r}e.forEach((function(t,n){isNaN(t)||(e[n]=+t)})),t[n]=e})),t):void 0}(e)).length,s=0;s<a;s++){var u=e[s];r=e[s+1];var c=u[0],l={command:c,prePoint:n,params:u,startTangent:null,endTangent:null};switch(c){case"M":i=[u[1],u[2]],o=s;break;case"A":var f=Lc(n,u);l.arcParams=f}if("Z"===c)n=i,r=e[o+1];else{var h=u.length;n=[u[h-2],u[h-1]]}r&&"Z"===r[0]&&(r=e[o],t[o]&&(t[o].prePoint=n)),l.currentPoint=n,t[o]&&Dc(n,t[o].currentPoint)&&(t[o].prePoint=l.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;l.nextPoint=d;var p=l.prePoint;if(["L","H","V"].includes(c))l.startTangent=[p[0]-n[0],p[1]-n[1]],l.endTangent=[n[0]-p[0],n[1]-p[1]];else if("Q"===c){var v=[u[1],u[2]];l.startTangent=[p[0]-v[0],p[1]-v[1]],l.endTangent=[n[0]-v[0],n[1]-v[1]]}else if("T"===c){v=kc((_=t[s-1]).currentPoint,p);"Q"===_.command?(l.command="Q",l.startTangent=[p[0]-v[0],p[1]-v[1]],l.endTangent=[n[0]-v[0],n[1]-v[1]]):(l.command="TL",l.startTangent=[p[0]-n[0],p[1]-n[1]],l.endTangent=[n[0]-p[0],n[1]-p[1]])}else if("C"===c){var y=[u[1],u[2]],m=[u[3],u[4]];l.startTangent=[p[0]-y[0],p[1]-y[1]],l.endTangent=[n[0]-m[0],n[1]-m[1]],0===l.startTangent[0]&&0===l.startTangent[1]&&(l.startTangent=[y[0]-m[0],y[1]-m[1]]),0===l.endTangent[0]&&0===l.endTangent[1]&&(l.endTangent=[m[0]-y[0],m[1]-y[1]])}else if("S"===c){var _;y=kc((_=t[s-1]).currentPoint,p),m=[u[1],u[2]];"C"===_.command?(l.command="C",l.startTangent=[p[0]-y[0],p[1]-y[1]],l.endTangent=[n[0]-m[0],n[1]-m[1]]):(l.command="SQ",l.startTangent=[p[0]-m[0],p[1]-m[1]],l.endTangent=[n[0]-m[0],n[1]-m[1]])}else if("A"===c){var g=.001,E=l.arcParams||{},T=E.cx,b=void 0===T?0:T,S=E.cy,R=void 0===S?0:S,A=E.rx,O=void 0===A?0:A,C=E.ry,M=void 0===C?0:C,x=E.sweepFlag,P=void 0===x?0:x,N=E.startAngle,F=void 0===N?0:N,I=E.endAngle,D=void 0===I?0:I;0===P&&(g*=-1);var L=O*Math.cos(F-g)+b,B=M*Math.sin(F-g)+R;l.startTangent=[L-i[0],B-i[1]];var w=O*Math.cos(F+D+g)+b,k=M*Math.sin(F+D-g)+R;l.endTangent=[p[0]-w,p[1]-k]}t.push(l)}return t}function Gc(e,t){var n=gc(e),r=function(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r][0];if("C"===i||"A"===i||"Q"===i){t=!0;break}}return t}(n),i=n.slice(),o=function(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var o=e[i],a=o[0];"M"===a?(r.length&&(n.push(r),r=[]),r.push([o[1],o[2]])):"Z"===a?r.length&&(t.push(r),r=[]):r.push([o[1],o[2]])}r.length>0&&n.push(r);return{polygons:t,polylines:n}}(i),a=o.polygons,s=o.polylines,u=Object(l.__read)(function(e,t){void 0===t&&(t=!1);for(var n,r,i=gc(e),o={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},a=[],s="",u=i.length,c=[],l=0;l<u;l+=1)i[l]&&(s=i[l][0]),a[l]=s,i[l]=Mc(i[l],o),xc(i,a,l),u=i.length,"Z"===s&&c.push(l),r=(n=i[l]).length,o.x1=+n[r-2],o.y1=+n[r-1],o.x2=+n[r-4]||o.x1,o.y2=+n[r-3]||o.y1;return t?[i,c]:i}(i,!0),2),c=u[0],f=u[1],h=Uc(i),d=function(e){var t,n,r,i,o=0,a=0,s=[];if(!e)return{curveSegments:[],totalLength:o};if(e.forEach((function(t,n){r=e[n+1],i=t.length,r&&(o+=aa.length(t[i-2],t[i-1],r[1],r[2],r[3],r[4],r[5],r[6])||0)})),0===o)return{curveSegments:[],totalLength:o};return e.forEach((function(u,c){r=e[c+1],i=u.length,r&&((t=[])[0]=a/o,n=aa.length(u[i-2],u[i-1],r[1],r[2],r[3],r[4],r[5],r[6]),a+=n||0,t[1]=a/o,s.push(t))})),{curveSegments:s,totalLength:o}}(c),p=d.totalLength,v=d.curveSegments,y=function(e){var t=0,n=0,r=[],i=[];e.forEach((function(e){var o=Object(l.__read)(e.slice(-2),2),a=o[0],s=o[1];if("M"===e[0])t=a,n=s,r.push(a),i.push(s);else if("C"===e[0]){var u=aa.box.apply(aa,Object(l.__spreadArray)([],Object(l.__read)([t,n].concat(e.slice(1))),!1));r=r.concat(u.x,u.x+u.width),i=i.concat(u.y,u.y+u.height),t=a,n=s}}));var o=Math.min.apply(0,r),a=Math.min.apply(0,i),s=Math.max.apply(0,r),u=Math.max.apply(0,i);return new Ri(o,a,s-o,u-a)}(c);return t&&(t.parsedStyle.defX=y.x,t.parsedStyle.defY=y.y),{absolutePath:n,hasArc:r,segments:h,polygons:a,polylines:s,curve:c,totalLength:p,curveSegments:v,zCommandIndexes:f,rect:y}}function jc(e,t,n){var r=e.curve,i=t.curve,o=[r,i];r.length!==i.length&&(o=ma(r,i));var a=_a(o[0])!==_a(o[1])?Ta(o[0]):ba(o[0]);return[a,Sa(o[1],a),function(e){return e}]}function Vc(e,t){var n;n=Vo(e)?e.split(" ").map((function(e){var t=Object(l.__read)(e.split(","),2),n=t[0],r=t[1];return[Number(n),Number(r)]})):e;var r,i,o=[],a=0,s=ua(n);n.forEach((function(e,t){n[t+1]&&((r=[0,0])[0]=a/s,i=$o.length(e[0],e[1],n[t+1][0],n[t+1][1]),a+=i,r[1]=a/s,o.push(r))}));var u=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(n.map((function(e){return e[0]}))),!1)),c=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(n.map((function(e){return e[1]}))),!1));return t&&(t.parsedStyle.defX=u,t.parsedStyle.defY=c),{points:n,totalLength:s,segments:o}}var Wc,Hc,Xc,zc,Yc=Qu.bind(null,/deg|rad|grad|turn|px|%/g),Kc=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function qc(e){if(void 0===e&&(e=""),"none"===(e=e.toLowerCase().trim()))return[];for(var t,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;t=n.exec(e);){if(t.index!==i)return[];if(i=t.index+t[0].length,Kc.indexOf(t[1])>-1&&r.push({name:t[1],params:t[2].split(" ").map((function(e){return Yc(e)||Zu(e)}))}),n.lastIndex===e.length)return r}return[]}!function(e){e.Layout="layout",e.IntrinsicSizes="intrinsic-sizes"}(Wc||(Wc={})),function(e){e[e.block=0]="block",e[e.normal=1]="normal"}(Hc||(Hc={})),function(e){e[e["block-like"]=0]="block-like",e[e.manual=1]="manual"}(Xc||(Xc={})),function(e){e.LAYOUT="display",e.LEFT="left",e.TOP="top",e.BOTTOM="bottom",e.RIGHT="right",e.WIDTH="width",e.HEIGHT="height",e.MIN_WIDTH="minWidth",e.MAX_WIDTH="maxWidth",e.MIN_HEIGHT="minHeight",e.MAX_HEIGHT="maxHeight",e.BOX_SIZING="boxSizing",e.PADDING="padding",e.PADDING_TOP="paddingTop",e.PADDING_BOTTOM="paddingBottom",e.PADDING_START="paddingLeft",e.PADDING_END="paddingRight",e.MARGIN="margin",e.MARGIN_TOP="marginTop",e.MARGIN_BOTTOM="marginBottom",e.MARGIN_START="marginLeft",e.MARGIN_END="marginRight",e.BORDER="border",e.BORDER_TOP="borderTop",e.BORDER_BOTTOM="borderBottom",e.BORDER_START="borderLeft",e.BORDER_END="borderRight",e.FLEX_DIRECTION="flexDirection",e.FLEX_WRAP="flexWrap",e.FLEX_FLOW="flexFlow",e.ALIGN_ITEMS="alignItems",e.ALIGN_CONTENT="alignContent",e.JUSTIFY_CONTENT="justifyContent",e.FLEX="flex",e.ALIGN_SELF="alignSelf",e.FLEX_SHRINK="flexShrink",e.FLEX_BASIS="flexBasis",e.FLEX_GROW="flexGrow",e.OFFSET_WIDTH="offsetWidth",e.OFFSET_HEIGHT="offsetHeight",e.ORDER="order"}(zc||(zc={}));var Zc=1,Jc=function(){function e(e){void 0===e&&(e=new Map),this.id=Zc++,this.style=e,this.parent=void 0,this.children=[],this.dirty=!1}return Object.defineProperty(e.prototype,"intrisicSizes",{get:function(){return this.internalIntrisicSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childCount",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),e.prototype.setMeasure=function(e){this.measureFn=e},e.prototype.setIntrisicSizes=function(e){this.internalIntrisicSizes=e},e.prototype.addChild=function(e){var t;null===(t=this.children)||void 0===t||t.push(e)},e.prototype.insertChild=function(e,t){this.children.splice(e,0,t)},e.prototype.removeChild=function(e){var t,n=null===(t=this.children)||void 0===t?void 0:t.findIndex((function(t){return t.id===e.id}));this.removeChildAtIndex(n)},e.prototype.removeChildAtIndex=function(e){this.children.splice(e,1)},e.prototype.replaceChildAtIndex=function(e,t){this.children.splice(e,1,t)},e.prototype.setStyle=function(e,t){this.style.set(e,t)},e.prototype.getStyle=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=new Map;return t.forEach((function(t){var n=e.style.get(t);n&&r.set(t,n)})),r},e.prototype.getAllStyle=function(){return this.style},e.prototype.markDirty=function(){this.dirty=!0},e.prototype.idDirty=function(){return this.dirty},e.prototype.getSize=function(){var e,t,n,r;return{width:null!==(t=null===(e=this.style.get(zc.WIDTH))||void 0===e?void 0:e.value)&&void 0!==t?t:0,height:null!==(r=null===(n=this.style.get(zc.HEIGHT))||void 0===n?void 0:n.value)&&void 0!==r?r:0}},e.prototype.computeLayout=function(){return Object(l.__awaiter)(this,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return e=this.getSize(),[4,nh.computeLayout(this,{availableInlineSize:e.width,availableBlockSize:e.height,fixedInlineSize:e.width,fixedBlockSize:e.height,percentageInlineSize:e.width,percentageBlockSize:e.height,data:void 0})];case 1:return t.sent(),[2]}}))}))},e.prototype.setComputedLayout=function(e){this.computedLayout=e},e.prototype.getComputedLayout=function(){return this.computedLayout},e.prototype.getAllComputedLayout=function(){},e.prototype.toString=function(){return"LayoutObject ".concat(this.id)},e}(),Qc=c.Syringe.defineToken("LayoutContextFactory"),$c=c.Syringe.defineToken("LayoutContextOptions"),el=0,tl=function(){function e(e){this.options=e,this.workQueue=[],this.contextId="".concat(el++),this.mode=e.mode,this.layoutChildrenFactory=e.layoutChildrenFactory,this.fragmentResultFactory=e.fragmentResultFactory,this.layoutFragmentFactory=e.layoutFragmentFactory}return e.prototype.appendWorkTask=function(e){this.workQueue.push(e)},e.prototype.clearWorkQueue=function(){this.workQueue=[]},e=Object(l.__decorate)([Object(c.singleton)(),Object(l.__param)(0,Object(c.inject)($c)),Object(l.__metadata)("design:paramtypes",[Object])],e)}(),nl=c.Syringe.defineToken("FragmentResultFactory"),rl=c.Syringe.defineToken("FragmentResultOptions"),il=c.Syringe.defineToken("contextNode"),ol=function(){function e(e,t,n){this._layoutContext=e,this._node=t,this.options=n,this.layoutContext=e,this.inlineSize=null==n?void 0:n.inlineSize,this.blockSize=null==n?void 0:n.blockSize,this.childFragments=null==n?void 0:n.childFragments,this.data=n.data,this.node=t}return e=Object(l.__decorate)([Object(c.injectable)(),Object(l.__param)(0,Object(c.inject)(tl)),Object(l.__param)(1,Object(c.inject)(il)),Object(l.__param)(2,Object(c.inject)(rl)),Object(l.__metadata)("design:paramtypes",[tl,Jc,Object])],e)}(),al=c.Syringe.defineToken("LayoutChildrenFactory"),sl=c.Syringe.defineToken("LayoutChildrenOptions"),ul=function(){function e(e,t){this._layoutContext=e,this.options=t,this.layoutContext=e,this.node=t.node,this.styleMap=t.node.getAllStyle()}return e.prototype.intrinsicSizes=function(){var e=new La;return this.layoutContext.appendWorkTask({layoutChild:this,taskType:Wc.IntrinsicSizes,deferred:e}),e.promise},e.prototype.layoutNextFragment=function(e){if(this.layoutContext.mode===Wc.IntrinsicSizes)throw new Error("Not Supported: cant call layoutNextFragment in intrinsicSizes");var t=new La;return this.layoutContext.appendWorkTask({layoutConstraints:e,layoutChild:this,taskType:Wc.Layout,deferred:t}),t.promise},e=Object(l.__decorate)([Object(c.injectable)(),Object(l.__param)(0,Object(c.inject)(tl)),Object(l.__param)(1,Object(c.inject)(sl)),Object(l.__metadata)("design:paramtypes",[tl,Object])],e)}(),cl=function(){},ll=c.Syringe.defineToken("LayoutEdgesFactory"),fl=c.Syringe.defineToken("LayoutEdgesOptions"),hl=[0,0,0,0],dl=function(){function e(e){var t,n,r,i,o,a,s,u,c,l,f,h,d,p,v,y;this.options=e;var m=e.node.getAllStyle(),_=null!==(n=null===(t=m.get(zc.PADDING_TOP))||void 0===t?void 0:t.value)&&void 0!==n?n:0,g=null!==(i=null===(r=m.get(zc.PADDING_END))||void 0===r?void 0:r.value)&&void 0!==i?i:0,E=null!==(a=null===(o=m.get(zc.PADDING_BOTTOM))||void 0===o?void 0:o.value)&&void 0!==a?a:0,T=null!==(u=null===(s=m.get(zc.PADDING_START))||void 0===s?void 0:s.value)&&void 0!==u?u:0,b=null!==(l=null===(c=m.get(zc.PADDING_TOP))||void 0===c?void 0:c.value)&&void 0!==l?l:0,S=null!==(h=null===(f=m.get(zc.PADDING_END))||void 0===f?void 0:f.value)&&void 0!==h?h:0,R=null!==(p=null===(d=m.get(zc.PADDING_BOTTOM))||void 0===d?void 0:d.value)&&void 0!==p?p:0,A=null!==(y=null===(v=m.get(zc.PADDING_START))||void 0===v?void 0:v.value)&&void 0!==y?y:0;this.blockStart=_+hl[0]+b,this.inlineStart=g+hl[1]+S,this.blockEnd=E+hl[2]+R,this.inlineEnd=T+hl[3]+A,this.block=this.blockStart+this.blockEnd,this.inline=this.inlineStart+this.inlineEnd}return e=Object(l.__decorate)([Object(c.injectable)(),Object(l.__param)(0,Object(c.inject)(fl)),Object(l.__metadata)("design:paramtypes",[Object])],e)}(),pl=function(){function e(){this.registry=new Map}var t;return t=e,Object.defineProperty(e.prototype,"size",{get:function(){return this.registry.size},enumerable:!1,configurable:!0}),e.prototype.hasLayout=function(e){return this.registry.has(e)},e.prototype.getLayout=function(e){if(void 0===e&&(e="absolute"),!this.hasLayout(e))throw new Error("invalid layout property: ".concat(e));return this.registry.get(e)},e.prototype.updateLayout=function(e,t){this.registry.set(e,t)},e.prototype.registerLayout=function(e,n){if(""===e)throw new TypeError("layout name cant't be empty");if(t.reservedLayout.includes(e))throw new Error("layout name '".concat(e,"' is a system reserved layout name, please use another name"));if(this.hasLayout(e))throw new Error("layout '".concat(e,"' already exist."));this.registry.set(e,n)},e.prototype.deleteLayout=function(e){this.registry.delete(e)},e.reservedLayout=[],e=t=Object(l.__decorate)([Object(c.singleton)()],e)}(),vl=function(e){return void 0===e&&(e=0),new Promise((function(t){setTimeout((function(){t()}),e)}))},yl=function(){function e(e,t,n){this._layoutRegistry=e,this._layoutContextFactory=t,this._layoutEdgesFactory=n,this.layoutRegistry=e,this.layoutContextFactory=t,this.layoutEdgesFactory=n}return e.prototype.computeLayout=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.determineIntrinsicSizes(e,e.children)];case 1:return n.sent(),[4,this.calculateLayout(e,e.children,t)];case 2:return n.sent(),[2]}}))}))},e.prototype.determineAllIntrinsicSizes=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(e){return[2]}))}))},e.prototype.getLayoutDefinitionName=function(e){var t=e.getAllStyle().get(zc.LAYOUT);if(!t)throw new Error("layout property not found");return t.value},e.prototype.determineIntrinsicSizes=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return n=this.getLayoutDefinitionName(e),[4,this.invokeIntrinsicSizesCallback(n,e,t)];case 1:return r.sent(),[2]}}))}))},e.prototype.invokeIntrinsicSizesCallback=function(e,t,n){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,f,h,d,p;return Object(l.__generator)(this,(function(v){switch(v.label){case 0:return r=this.layoutRegistry.getLayout(e),i=new r,o=this.layoutContextFactory({mode:Wc.IntrinsicSizes}),a=r.inputProperties,s=void 0===a?[]:a,u=[],n.forEach((function(e){var t=o.layoutChildrenFactory({node:e});u.push(t)})),c=this.layoutEdgesFactory({node:t}),f=t.getStyle.apply(t,Object(l.__spreadArray)([],Object(l.__read)(s),!1)),h=i.intrinsicSizes(u,c,f),(d=this.runWorkQueue(h,o.workQueue)).next(),[4,vl()];case 1:return v.sent(),p=d.next().value,o.clearWorkQueue(),t.setIntrisicSizes(p),[2]}}))}))},e.prototype.calculateLayout=function(e,t,n){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r;return Object(l.__generator)(this,(function(i){switch(i.label){case 0:return r=this.getLayoutDefinitionName(e),[4,this.invokeLayoutCallback(r,e,t,n)];case 1:return i.sent(),[2]}}))}))},e.prototype.invokeLayoutCallback=function(e,t,n,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,c,f,h,d,p,v,y,m;return Object(l.__generator)(this,(function(_){switch(_.label){case 0:return i=this.layoutRegistry.getLayout(e),o=new i,a=this.layoutContextFactory({mode:Wc.Layout}),s=i.inputProperties,u=void 0===s?[]:s,c=[],n.forEach((function(e){var t=a.layoutChildrenFactory({node:e});c.push(t)})),f=this.layoutEdgesFactory({node:t}),h=t.getStyle.apply(t,Object(l.__spreadArray)([],Object(l.__read)(u),!1)),d=o.layout(c,f,r,h),(p=this.runWorkQueue(d,a.workQueue)).next(),[4,vl()];case 1:return _.sent(),v=p.next().value,a.clearWorkQueue(),y=v instanceof ol?v:a.fragmentResultFactory(v),m=a.layoutFragmentFactory({inlineSize:y.inlineSize,blockSize:y.blockSize,data:y.data}),t.setComputedLayout(m),n.forEach((function(e,t){e.setComputedLayout(y.childFragments[t])})),[2]}}))}))},e.prototype.runWorkQueue=function(e,t){var n,r=this;return Object(l.__generator)(this,(function(i){switch(i.label){case 0:return n=Da(e),t.length>0&&n.isPending()&&t.forEach((function(e){if(e.taskType===Wc.IntrinsicSizes){var t=e.layoutChild,n=e.deferred,i=t.node;n.resolve(r.getNodeIntrisicSizes(i))}if(e.taskType===Wc.Layout){t=e.layoutChild,n=e.deferred;var o=e.layoutConstraints,a=(i=t.node,t.layoutContext),s=r.getNodeFragment(i,o);n.resolve(a.layoutFragmentFactory(s))}})),[4];case 1:if(i.sent(),!n.isFulfilled())throw new Error("promise not fullfilled!");return[2,n.getFullFilledValue()]}}))},e.prototype.getNodeIntrisicSizes=function(e){var t,n,r,i,o,a,s,u,c,l,f,h,d=e.getAllStyle();return{minContentInlineSize:(null===(t=d.get(zc.MIN_WIDTH))||void 0===t?void 0:t.value)||(null===(n=e.intrisicSizes)||void 0===n?void 0:n.minContentInlineSize)||(null===(r=d.get(zc.WIDTH))||void 0===r?void 0:r.value)||0,maxContentInlineSize:(null===(i=d.get(zc.MAX_WIDTH))||void 0===i?void 0:i.value)||(null===(o=e.intrisicSizes)||void 0===o?void 0:o.maxContentInlineSize)||(null===(a=d.get(zc.WIDTH))||void 0===a?void 0:a.value)||0,minContentBlockSize:(null===(s=d.get(zc.MIN_HEIGHT))||void 0===s?void 0:s.value)||(null===(u=e.intrisicSizes)||void 0===u?void 0:u.minContentBlockSize)||(null===(c=d.get(zc.HEIGHT))||void 0===c?void 0:c.value)||0,maxContentBlockSize:(null===(l=d.get(zc.MAX_HEIGHT))||void 0===l?void 0:l.value)||(null===(f=e.intrisicSizes)||void 0===f?void 0:f.maxContentBlockSize)||(null===(h=d.get(zc.HEIGHT))||void 0===h?void 0:h.value)||0}},e.prototype.getNodeFragment=function(e,t){var n,r,i,o,a,s;return{inlineSize:(null===(n=e.getComputedLayout())||void 0===n?void 0:n.inlineSize)||(null===(r=e.getAllStyle().get(zc.MIN_WIDTH))||void 0===r?void 0:r.value)||(null===(i=e.getAllStyle().get(zc.WIDTH))||void 0===i?void 0:i.value)||0,blockSize:(null===(o=e.getComputedLayout())||void 0===o?void 0:o.blockSize)||(null===(a=e.getAllStyle().get(zc.MIN_HEIGHT))||void 0===a?void 0:a.value)||(null===(s=e.getAllStyle().get(zc.HEIGHT))||void 0===s?void 0:s.value)||0,data:t.data}},e=Object(l.__decorate)([Object(c.singleton)(),Object(l.__param)(0,Object(c.inject)(pl)),Object(l.__param)(1,Object(c.inject)(Qc)),Object(l.__param)(2,Object(c.inject)(ll)),Object(l.__metadata)("design:paramtypes",[pl,Function,Function])],e)}(),ml=c.Syringe.defineToken("LayoutFragmentFactory"),_l=c.Syringe.defineToken("LayoutFragmentOptions"),gl=function(){function e(e,t){this._layoutContext=e,this.options=t,this.layoutContext=e,this.inlineSize=t.inlineSize,this.blockSize=t.blockSize,this.inlineOffset=0,this.blockOffset=0,this.data=t.data}return e=Object(l.__decorate)([Object(c.injectable)(),Object(l.__param)(0,Object(c.inject)(tl)),Object(l.__param)(1,Object(c.inject)(_l)),Object(l.__metadata)("design:paramtypes",[tl,Object])],e)}(),El={number:function(e){return new eu(e)},percent:function(e){return new eu(e,"%")},px:function(e){return new eu(e,"px")},em:function(e){return new eu(e,"em")},deg:function(e){return new eu(e,"deg")},grad:function(e){return new eu(e,"grad")},rad:function(e){return new eu(e,"rad")},turn:function(e){return new eu(e,"turn")},s:function(e){return new eu(e,"s")},ms:function(e){return new eu(e,"ms")},registerProperty:function(e){var t=e.name,n=e.inherits,r=e.initialValue;c.GlobalContainer.get(to).registerMetadata({name:t,inherited:n,defaultValue:r})},registerLayout:function(e,t){c.GlobalContainer.get(pl).registerLayout(e,t)}},Tl=null;function bl(e){return function(t){var n=0;return e.map((function(e){return e===Tl?t[n++]:e}))}}function Sl(e){return e}var Rl={rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],scale:["Nn",bl([Tl,Tl,El.number(1)]),Sl],scalex:["N",bl([Tl,El.number(1),El.number(1)]),bl([Tl,El.number(1)])],scaley:["N",bl([El.number(1),Tl,El.number(1)]),bl([El.number(1),Tl])],scalez:["N",bl([El.number(1),El.number(1),Tl])],scale3d:["NNN",Sl],translate:["Tt",bl([Tl,Tl,fu]),Sl],translatex:["T",bl([Tl,fu,fu]),bl([Tl,fu])],translatey:["T",bl([fu,Tl,fu]),bl([fu,Tl])],translatez:["L",bl([fu,fu,Tl])],translate3d:["TTL",Sl]};function Al(e){if("none"===(e=(e||"none").toLowerCase().trim()))return[];for(var t,n=/\s*(\w+)\(([^)]*)\)/g,r=[],i=0;t=n.exec(e);){if(t.index!==i)return[];i=t.index+t[0].length;var o=t[1],a=Rl[o];if(!a)return[];var s=t[2].split(","),u=a[0];if(u.length<s.length)return[];for(var c=[],l=0;l<u.length;l++){var f=s[l],h=u[l],d=void 0;if(void 0===(d=f?{A:function(e){return"0"===e.trim()?hu:nc(e)},N:cc,T:tc,L:$u}[h.toUpperCase()](f):{a:hu,n:c[0],t:fu}[h]))return[];c.push(d)}if(r.push({t:o,d:c}),n.lastIndex===e.length)return r}return[]}function Ol(e){return e.replace(/[xy]/,"")}function Cl(e){return e.replace(/(x|y|z|3d)?$/,"3d")}function Ml(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=function(n){var r=e[n],i=r.t,o=r.d,a="scale"===i.substr(0,5)?1:0;t.push({t:i,d:o.map((function(e){return"number"==typeof e?new eu(a):new eu(a,e.unit)}))})},o=0;o<e.length;o++)i(o)}var a,s,u=[],c=[],l=[];if(e.length!==t.length);else for(o=0;o<e.length;o++){var f=e[o].t,h=t[o].t,d=e[o].d,p=t[o].d,v=Rl[f],y=Rl[h],m=void 0;if(s=h,("perspective"!==(a=f)||"perspective"!==s)&&("matrix"!==a&&"matrix3d"!==a||"matrix"!==s&&"matrix3d"!==s)){if(f===h)m=f;else if(v[2]&&y[2]&&Ol(f)===Ol(h))m=Ol(f),d=v[2](d),p=y[2](p);else{if(!v[1]||!y[1]||Cl(f)!==Cl(h))break;m=Cl(f),d=v[1](d),p=y[1](p)}for(var _=[],g=[],E=[],T=0;T<d.length;T++){var b=(d[T].unit===ms.kNumber?fc:rc)(d[T],p[T],n,!1,T);_[T]=b[0],g[T]=b[1],E.push(b[2])}u.push(_),c.push(g),l.push([m,E])}}if(r){var S=u;u=c,c=S}return[u,c,function(e){return e.map((function(e,t){var n=e.map((function(e,n){return l[t][1][n](e)})).join(",");return"matrix"===l[t][0]&&16===n.split(",").length&&(l[t][0]="matrix3d"),l[t][0]+"("+n+")"})).join(" ")}]}function xl(e){if(Vo(e)){var t=e.split(" ");return 1===t.length&&("top"===t[0]||"bottom"===t[0]?(t[1]=t[0],t[0]="center"):t[1]="center"),2!==t.length?null:[tc(Pl(t[0])),tc(Pl(t[1]))]}return[new eu(e[0]||0,"px"),new eu(e[1]||0,"px")]}function Pl(e){return"center"===e?"50%":"left"===e||"top"===e?"0":"right"===e||"bottom"===e?"100%":e}var Nl,Fl,Il=function(){function e(){this.parser=tc,this.mixer=rc}return e.prototype.calculator=function(e,t,n,r,i){return eu.isRelativeUnit(n.unit)?n.unit===ms.kPercentage||n.unit===ms.kEms?new eu(0,"px"):void 0:n.clone()},e.prototype.nameToBoundsIndex=function(e){return"x"===e||"cx"===e||"width"===e?0:"y"===e||"cy"===e||"height"===e?1:2},e.prototype.calculateUsedValueWithParentBounds=function(e,t){var n=e.parentElement.getGeometryBounds(),r=e.computedStyle[t].value;return new eu(2*n.halfExtents[this.nameToBoundsIndex(t)]*r/100,"px")},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Dl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.prototype.postProcessor=function(e){var t,n,r;switch(e.nodeName){case ca.CIRCLE:case ca.ELLIPSE:var i=e.parsedStyle,o=i.cx,a=i.cy;Li(o)||(t=o.value),Li(a)||(n=a.value);break;case ca.LINE:var s=e.parsedStyle,u=s.x1,c=s.x2,f=s.y1,h=s.y2;t=Math.min(u.value,c.value),n=Math.min(f.value,h.value),r=0;break;default:Li(e.parsedStyle.x)||(t=e.parsedStyle.x.value),Li(e.parsedStyle.y)||(n=e.parsedStyle.y.value)}e.parsedStyle.defX=t||0,e.parsedStyle.defY=n||0;var d=Object(l.__read)(e.getLocalPosition(),3),p=d[0],v=d[1],y=d[2];e.setLocalPosition(Li(t)?p:t,Li(n)?v:n,Li(r)?y:r)},t=Object(l.__decorate)([Object(c.singleton)()],t)}(Il),Ll=function(){function e(){this.parser=cc,this.mixer=hc(0,1)}return e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Bl=function(){function e(){this.parser=Zu,this.mixer=Ju}return e.prototype.calculator=function(e,t,n,r,i){return n instanceof Ws?new du(0,0,0,0,"none"===n.value):n},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),wl=function(){function e(){this.parser=qc}return e=Object(l.__decorate)([Object(c.singleton)()],e)}(),kl=function(){function e(){this.parser=oc,this.mixer=ac}return e.prototype.calculator=function(e,t,n,r){return n&&1===n.length?[n[0],n[0]]:[n[0],n[1]]},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Ul=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mixer=hc(0,1/0),t}return Object(l.__extends)(t,e),t=Object(l.__decorate)([Object(c.singleton)()],t)}(Il),Gl=function(){function e(){}return e.prototype.calculator=function(e,t,n,r){if(t&&t!==n&&t.style.offsetPathTargets){var i=t.style.offsetPathTargets.indexOf(r);t.style.offsetPathTargets.splice(i,1)}return n&&(n.style.offsetPathTargets||(n.style.offsetPathTargets=[]),n.style.offsetPathTargets.push(r)),n},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),jl=function(){function e(){this.parser=cc,this.mixer=hc(0,1)}return e.prototype.postProcessor=function(e){if(e.attributes.offsetPath){var t=e.attributes.offsetPath.nodeName;if(t===ca.LINE||t===ca.PATH||t===ca.POLYLINE){var n=e.attributes.offsetPath.getPoint(e.parsedStyle.offsetDistance.value);n&&e.setLocalPosition(n.x,n.y)}}},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Vl=function(){function e(){this.parser=lc}return e.prototype.calculator=function(e,t,n,r){return 2===n.length?[n[0],n[1],new eu(0)]:n},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Wl=function(){function e(){this.parser=cc}return e.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,n=t.renderable,r=t.sortable;n&&(n.dirty=!0),r&&(r.dirty=!0)}},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Hl=function(){function e(){this.parser=Al,this.mixer=Ml}return e.prototype.postProcessor=function(e){var t=e.parsedStyle,n=t.transform,r=t.defX,i=t.defY;n&&n.length&&(e.resetLocalTransform(),e.setLocalPosition(r,i),n.forEach((function(t){var n=t.t,r=t.d;if("scale"===n){var i=r.map((function(e){return e.value}))||[1,1];e.scaleLocal(i[0],i[1],1)}else if("scalex"===n){i=r.map((function(e){return e.value}))||[1];e.scaleLocal(i[0],1,1)}else if("scaley"===n){i=r.map((function(e){return e.value}))||[1];e.scaleLocal(1,i[0],1)}else if("scalez"===n){i=r.map((function(e){return e.value}))||[1];e.scaleLocal(1,1,i[0])}else if("scale3d"===n){i=r.map((function(e){return e.value}))||[1,1,1];e.scaleLocal(i[0],i[1],i[2])}else if("translate"===n){var o=r||[fu,fu];e.translateLocal(o[0].value,o[1].value,0)}else if("translatex"===n){o=r||[fu];e.translateLocal(o[0].value,0,0)}else if("translatey"===n){o=r||[fu];e.translateLocal(0,o[0].value,0)}else if("translatez"===n){o=r||[fu];e.translateLocal(0,0,o[0].value)}else if("translate3d"===n){o=r||[fu,fu,fu];e.translateLocal(o[0].value,o[1].value,o[2].value)}else if("rotate"===n){var a=r||[hu];e.rotateLocal(0,0,a[0].value)}else if("rotatex"===n){a=r||[hu];e.rotateLocal(a[0].value,0,0)}else if("rotatey"===n){a=r||[hu];e.rotateLocal(0,a[0].value,0)}else if("rotatez"===n){a=r||[hu];e.rotateLocal(0,0,a[0].value)}})))},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Xl=function(){function e(){this.parser=xl}return e=Object(l.__decorate)([Object(c.singleton)()],e)}(),zl=function(){function e(){this.parser=Gc,this.mixer=jc}return e.prototype.calculator=function(e,t,n){return n instanceof Ws&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:[],totalLength:0,curveSegments:[],zCommandIndexes:[],rect:new Ri(0,0,0,0)}:n},e.prototype.postProcessor=function(e){var t=e.parsedStyle,n=t.defX,r=void 0===n?0:n,i=t.defY,o=void 0===i?0:i;e.setLocalPosition(r,o)},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Yl=function(){function e(){this.parser=Vc}return e.prototype.postProcessor=function(e){var t=e.parsedStyle,n=t.defX,r=t.defY;e.setLocalPosition(n,r)},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Kl=function(){function e(){}return e.prototype.calculator=function(e,t,n,r){if(n instanceof Ws&&(n=null),t&&t!==n&&t.style.clipPathTargets){var i=t.style.clipPathTargets.indexOf(r);t.style.clipPathTargets.splice(i,1)}return n&&(n.style.clipPathTargets||(n.style.clipPathTargets=[]),n.style.clipPathTargets.push(r)),Ga(r),n},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),ql=function(){function e(){}return e.prototype.calculator=function(e,t,n,r){return n instanceof Ws?"unset"===n.value?"":n.value:n},e.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Zl=function(){function e(){}return e.prototype.postProcessor=function(e){if(e.nodeName===ca.TEXT){var t=e,n=t.parsedStyle.textTransform.value;n===ha.CAPITALIZE?t.style.text=t.style.text.charAt(0).toUpperCase()+t.style.text.slice(1):n===ha.LOWERCASE?t.style.text=t.style.text.toLowerCase():n===ha.UPPERCASE&&(t.style.text=t.style.text.toUpperCase())}},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Jl=c.Syringe.defineToken("GeometryUpdaterFactory"),Ql=c.Syringe.defineToken("GeometryAABBUpdater"),$l={COLOR:"<color>",PAINT:"<paint>",NUMBER:"<number>",LENGTH:"<length>",PERCENTAGE:"<percentage>",LENGTH_PERCENTAGE:"<length> | <percentage>",LIST_OF_POINTS:"<list-of-points>"},ef=[{name:"display",keywords:["none"]},{name:"opacity",interpolable:!0,defaultValue:"1",syntax:$l.NUMBER,handler:Ll},{name:"fillOpacity",interpolable:!0,inherited:!0,defaultValue:"1",syntax:$l.NUMBER,handler:Ll},{name:"strokeOpacity",interpolable:!0,inherited:!0,defaultValue:"1",syntax:$l.NUMBER,handler:Ll},{name:"fill",interpolable:!0,keywords:["none"],defaultValue:"none",syntax:$l.PAINT,handler:Bl},{name:"stroke",interpolable:!0,keywords:["none"],defaultValue:"none",syntax:$l.PAINT,handler:Bl},{name:"shadowColor",interpolable:!0,syntax:$l.COLOR,handler:Bl},{name:"shadowOffsetX",interpolable:!0,layoutDependent:!0,syntax:$l.LENGTH_PERCENTAGE,handler:Il},{name:"shadowOffsetY",interpolable:!0,layoutDependent:!0,syntax:$l.LENGTH_PERCENTAGE,handler:Il},{name:"shadowBlur",interpolable:!0,layoutDependent:!0,handler:Ul},{name:"lineWidth",interpolable:!0,inherited:!0,defaultValue:"1",layoutDependent:!0,alias:["strokeWidth"],syntax:$l.LENGTH_PERCENTAGE,handler:Il},{name:"increasedLineWidthForHitTesting",inherited:!0,defaultValue:"0",layoutDependent:!0,syntax:$l.LENGTH_PERCENTAGE,handler:Il},{name:"lineJoin",inherited:!0,layoutDependent:!0,alias:["strokeLinejoin"],keywords:["miter","bevel","round"],defaultValue:"miter"},{name:"lineCap",inherited:!0,layoutDependent:!0,alias:["strokeLinecap"],keywords:["butt","round","square"],defaultValue:"butt"},{name:"lineDash",interpolable:!0,inherited:!0,keywords:["none"],alias:["strokeDasharray"],handler:kl},{name:"lineDashOffset",interpolable:!0,inherited:!0,defaultValue:"0",alias:["strokeDashoffset"],handler:Il},{name:"offsetPath",handler:Gl},{name:"offsetDistance",interpolable:!0,handler:jl},{name:"dx",interpolable:!0,layoutDependent:!0,defaultValue:"0",handler:Il},{name:"dy",interpolable:!0,layoutDependent:!0,defaultValue:"0",handler:Il},{name:"zIndex",independent:!0,interpolable:!0,defaultValue:"0",keywords:["auto"],handler:Wl},{name:"visibility",keywords:["visible","hidden"],independent:!0,inherited:!0,defaultValue:"visible"},{name:"pointerEvents",inherited:!0,keywords:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","bounding-box","all"],defaultValue:"auto"},{name:"filter",independent:!0,layoutDependent:!0,handler:wl},{name:"clipPath",handler:Kl},{name:"transform",parsePriority:100,interpolable:!0,keywords:["none"],defaultValue:"none",handler:Hl},{name:"transformOrigin",parsePriority:100,defaultValue:"left top",layoutDependent:!0,handler:Xl},{name:"anchor",parsePriority:99,layoutDependent:!0,handler:Vl},{name:"cx",interpolable:!0,defaultValue:"0",syntax:$l.LENGTH_PERCENTAGE,handler:Dl},{name:"cy",interpolable:!0,defaultValue:"0",syntax:$l.LENGTH_PERCENTAGE,handler:Dl},{name:"r",interpolable:!0,layoutDependent:!0,defaultValue:"0",handler:Il},{name:"rx",interpolable:!0,layoutDependent:!0,defaultValue:"auto",handler:Il},{name:"ry",interpolable:!0,layoutDependent:!0,defaultValue:"auto",handler:Il},{name:"x",interpolable:!0,defaultValue:"0",syntax:$l.LENGTH_PERCENTAGE,handler:Dl},{name:"y",interpolable:!0,defaultValue:"0",syntax:$l.LENGTH_PERCENTAGE,handler:Dl},{name:"z",interpolable:!0,defaultValue:"0",syntax:$l.LENGTH_PERCENTAGE,handler:Dl},{name:"width",interpolable:!0,layoutDependent:!0,keywords:["auto","fit-content","min-content","max-content"],defaultValue:"0",handler:Il},{name:"height",interpolable:!0,layoutDependent:!0,keywords:["auto","fit-content","min-content","max-content"],defaultValue:"0",handler:Il},{name:"radius",interpolable:!0,layoutDependent:!0,defaultValue:"0",handler:Il},{name:"x1",interpolable:!0,layoutDependent:!0,handler:Dl},{name:"y1",interpolable:!0,layoutDependent:!0,handler:Dl},{name:"z1",interpolable:!0,layoutDependent:!0,handler:Dl},{name:"x2",interpolable:!0,layoutDependent:!0,handler:Dl},{name:"y2",interpolable:!0,layoutDependent:!0,handler:Dl},{name:"z2",interpolable:!0,layoutDependent:!0,handler:Dl},{name:"path",interpolable:!0,layoutDependent:!0,defaultValue:"",alias:["d"],handler:zl},{name:"points",layoutDependent:!0,syntax:$l.LIST_OF_POINTS,handler:Yl},{name:"text",layoutDependent:!0,handler:ql,defaultValue:""},{name:"textTransform",layoutDependent:!0,inherited:!0,keywords:["capitalize","uppercase","lowercase","none"],defaultValue:"none",handler:Zl},{name:"font",layoutDependent:!0},{name:"fontSize",interpolable:!0,inherited:!0,defaultValue:"16px",layoutDependent:!0,handler:Il},{name:"fontFamily",layoutDependent:!0,inherited:!0,defaultValue:"sans-serif"},{name:"fontStyle",layoutDependent:!0,inherited:!0,keywords:["normal","italic","oblique"],defaultValue:"normal"},{name:"fontWeight",layoutDependent:!0,inherited:!0,keywords:["normal","bold","bolder","lighter"],defaultValue:"normal"},{name:"fontVariant",layoutDependent:!0,inherited:!0,keywords:["normal","small-caps"],defaultValue:"normal"},{name:"lineHeight",layoutDependent:!0},{name:"letterSpacing",layoutDependent:!0},{name:"wordWrap",layoutDependent:!0},{name:"wordWrapWidth",layoutDependent:!0},{name:"leading",layoutDependent:!0},{name:"textBaseline",layoutDependent:!0,inherited:!0,keywords:["top","hanging","middle","alphabetic","ideographic","bottom"],defaultValue:"alphabetic"},{name:"textAlign",layoutDependent:!0,inherited:!0,keywords:["start","center","end","left","right"],defaultValue:"start"},{name:"whiteSpace",layoutDependent:!0}],tf=function(){function e(){this.dirty=!1,this.cache={},this.unresolvedProperties={},this.cascadeProperties={}}return e.prototype.init=function(){var e=this;ef.forEach((function(t){e.registerMetadata(t)}))},e.prototype.registerMetadata=function(e){var t=this;Object(l.__spreadArray)([e.name],Object(l.__read)(e.alias||[]),!1).forEach((function(n){t.cache[n]=e}))},e.prototype.getMetadata=function(e){return this.cache[e]},e.prototype.processProperties=function(e,t,n){var r=this;void 0===n&&(n={skipUpdateAttribute:!1,skipParse:!1});var i=n.skipUpdateAttribute,o=n.skipParse,a=!1;Object.keys(t).forEach((function(n){var o,s=Object(l.__read)(Ko(n,t[n]),2),u=s[0],c=s[1];i||(e.attributes[u]=c),!a&&(null===(o=r.getMetadata(u))||void 0===o?void 0:o.layoutDependent)&&(a=!0)}));var s=Object.keys(t).sort((function(e,t){var n,i;return((null===(n=r.getMetadata(e))||void 0===n?void 0:n.parsePriority)||0)-((null===(i=r.getMetadata(t))||void 0===i?void 0:i.parsePriority)||0)}));o||s.forEach((function(t){e.computedStyle[t]=r.parseProperty(t,e.attributes[t],e)}));var u=!1;s.forEach((function(t){t in e.computedStyle&&(u=r.computeProperty(t,e.computedStyle[t],e))})),u?this.dirty=!0:(a&&this.updateGeometry(e),s.forEach((function(t){t in e.parsedStyle&&r.postProcessProperty(t,e)})),s.forEach((function(t){t in e.parsedStyle&&r.isPropertyInheritable(t)&&e.children.forEach((function(e){e.internalSetAttribute(t,null,{skipUpdateAttribute:!0,skipParse:!0})}))})))},e.prototype.parseProperty=function(e,t,n){var r=this.getMetadata(e),i=t;if((""===t||Li(t))&&(t="unset"),"unset"===t||"initial"===t||"inherit"===t)i=new Ws(t);else if(r){var o=r.keywords,a=r.handler;if(o&&o.indexOf(t)>-1)i=new Ws(t);else if(a){var s=c.GlobalContainer.get(a);s&&s.parser&&(i=s.parser(t,n))}}return i},e.prototype.computeProperty=function(e,t,n){var r=this.getMetadata(e),i="g-root"===n.id,o=t instanceof js?t.clone():t;if(r){var a=r.handler,s=r.inherited,u=r.defaultValue;if(t instanceof Ws){var l=t.value;if("unset"===l&&(l=s&&!i?"inherit":"initial"),"initial"===l)Li(u)||(t=this.parseProperty(e,u,n));else if("inherit"===l){var f=this.tryToResolveProperty(n,e,{inherited:!0});return f?(n.parsedStyle[e]=f,!1):(this.addUnresolveProperty(n,e),!0)}}if(a){var h=c.GlobalContainer.get(a);if(h&&h.calculator){var d=n.parsedStyle[e];o=h.calculator(e,d,t,n,this)}else o=t}else o=t}return n.parsedStyle[e]=o,!1},e.prototype.postProcessProperty=function(e,t){var n=this.getMetadata(e);if(n&&n.handler){var r=c.GlobalContainer.get(n.handler);r&&r.postProcessor&&r.postProcessor(t)}},e.prototype.isPropertyResolved=function(e,t){return!this.unresolvedProperties[e.entity]||0===this.unresolvedProperties[e.entity].length||this.unresolvedProperties[e.entity].includes(t)},e.prototype.addUnresolveProperty=function(e,t){this.unresolvedProperties[e.entity]||(this.unresolvedProperties[e.entity]=[]),-1===this.unresolvedProperties[e.entity].indexOf(t)&&this.unresolvedProperties[e.entity].push(t)},e.prototype.tryToResolveProperty=function(e,t,n){if(void 0===n&&(n={}),n.inherited&&e.parentElement&&this.isPropertyResolved(e.parentElement,t)){var r=e.parentElement.parsedStyle[t];return(!(r instanceof Ws)||"unset"!==r.value&&"initial"!==r.value&&"inherit"!==r.value)&&(!(r instanceof eu&&eu.isRelativeUnit(r.unit))&&r)}return!1},e.prototype.recalc=function(e){var t=this.unresolvedProperties[e.entity];if(t&&t.length){var n={};t.forEach((function(t){n[t]=e.attributes[t]})),this.processProperties(e,n),delete this.unresolvedProperties[e.entity]}},e.prototype.updateGeometry=function(e){var t,n=c.GlobalContainer.get(Jl)(e.nodeName);if(n){var r=e.geometry;r.contentBounds||(r.contentBounds=new fi),r.renderBounds||(r.renderBounds=new fi);var i=e.parsedStyle,a=n.update(i,e),s=a.width,u=a.height,l=a.depth,f=void 0===l?0:l,h=a.offsetX,d=void 0===h?0:h,p=a.offsetY,v=void 0===p?0:p,y=a.offsetZ,m=void 0===y?0:y,_=o.fromValues(s/2,u/2,f/2),g=i,E=g.lineWidth,T=g.increasedLineWidthForHitTesting,b=g.shadowColor,S=g.filter,R=void 0===S?[]:S,A=g.transformOrigin,O=i.anchor;e.nodeName===ca.TEXT&&delete i.anchor;var C=o.fromValues((1-2*(O&&O[0].value||0))*_[0]+d,(1-2*(O&&O[1].value||0))*_[1]+v,(1-2*(O&&(null===(t=O[2])||void 0===t?void 0:t.value)||0))*_[2]+m);r.contentBounds.update(C,_);var M=(((null==E?void 0:E.value)||0)+((null==T?void 0:T.value)||0))/2;if(o.add(_,_,o.fromValues(M,M,0)),r.renderBounds.update(C,_),b){var x=r.renderBounds,P=x.min,N=x.max,F=i,I=F.shadowBlur,D=F.shadowOffsetX,L=F.shadowOffsetY,B=I&&I.value||0,w=D&&D.value||0,k=L&&L.value||0,U=P[0]-B+w,G=N[0]+B+w,j=P[1]-B+k,V=N[1]+B+k;P[0]=Math.min(P[0],U),N[0]=Math.max(N[0],G),P[1]=Math.min(P[1],j),N[1]=Math.max(N[1],V),r.renderBounds.setMinMax(P,N)}R.forEach((function(e){var t=e.name,n=e.params;if("blur"===t){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,o.add(r.renderBounds.halfExtents,r.renderBounds.halfExtents,o.fromValues(i,i,0)))}else if("drop-shadow"===t){var a=n[0].value,s=n[1].value,u=n[2].value,c=r.renderBounds,l=c.min,f=c.max,h=l[0]-u+a,d=f[0]+u+a,p=l[1]-u+s,v=f[1]+u+s;l[0]=Math.min(l[0],h),f[0]=Math.max(f[0],d),l[1]=Math.min(l[1],p),f[1]=Math.max(f[1],v),r.renderBounds.setMinMax(l,f)}})),O=i.anchor;var W=sc(A[0],0,e),H=sc(A[1],1,e);W-=(O&&O[0].value||0)*r.contentBounds.halfExtents[0]*2,H-=(O&&O[1].value||0)*r.contentBounds.halfExtents[1]*2,e.setOrigin(W,H),e.emit(vi.GEOMETRY_BOUNDS_CHANGED,{}),Ga(e)}},e.prototype.isPropertyInheritable=function(e){var t=this.getMetadata(e);return!!t&&t.inherited},Object(l.__decorate)([Object(c.postConstruct)(),Object(l.__metadata)("design:type",Function),Object(l.__metadata)("design:paramtypes",[]),Object(l.__metadata)("design:returntype",void 0)],e.prototype,"init",null),e=Object(l.__decorate)([Object(c.singleton)({token:to})],e)}(),nf=function(e){function t(){var t=e.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document",t.timeline=new cs(t);var n={};return ef.forEach((function(e){var t=e.name,r=e.inherited,i=e.defaultValue;r&&i&&(n[t]=i)})),t.documentElement=new Ms({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),t.prototype.createElement=function(e,t){var n=this.defaultView.customElements.get(e);return n||(console.warn("Unsupported tagName: ",e),n="tspan"===e?Ls:Ms),new n(t)},t.prototype.createElementNS=function(e,t,n){return this.createElement(t,n)},t.prototype.cloneNode=function(e){throw new Error("Method not implemented.")},t.prototype.destroy=function(){try{this.documentElement.destroy()}catch(e){}this.timeline.destroy()},t.prototype.elementFromPoint=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,f,h;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return n=this.defaultView.canvas2Viewport({x:e,y:t}),r=n.x,i=n.y,o=this.defaultView.getConfig(),a=o.width,s=o.height,r<0||i<0||r>a||i>s?[2,null]:(u=this.defaultView.viewport2Client({x:r,y:i}),c=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:t,viewportX:r,viewportY:i,clientX:c,clientY:f},picked:[]})]);case 1:return[2,(h=l.sent().picked)&&h[0]||this.documentElement]}}))}))},t.prototype.elementsFromPoint=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,f,h;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return n=this.defaultView.canvas2Viewport({x:e,y:t}),r=n.x,i=n.y,o=this.defaultView.getConfig(),a=o.width,s=o.height,r<0||i<0||r>a||i>s?[2,[]]:(u=this.defaultView.viewport2Client({x:r,y:i}),c=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:t,viewportX:r,viewportY:i,clientX:c,clientY:f},picked:[]})]);case 1:return(h=l.sent().picked)[h.length-1]!==this.documentElement&&h.push(this.documentElement),[2,h]}}))}))},t.prototype.appendChild=function(e,t){throw new Error("Use document.documentElement instead.")},t.prototype.insertBefore=function(e,t){throw new Error("Use document.documentElement instead.")},t.prototype.removeChild=function(e,t){throw new Error("Use document.documentElement instead.")},t.prototype.replaceChild=function(e,t,n){throw new Error("Use document.documentElement instead.")},t.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Use document.documentElement instead.")},t.prototype.prepend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("Use document.documentElement instead.")},t.prototype.getElementById=function(e){return this.documentElement.getElementById(e)},t.prototype.getElementsByName=function(e){return this.documentElement.getElementsByName(e)},t.prototype.getElementsByTagName=function(e){return this.documentElement.getElementsByTagName(e)},t.prototype.getElementsByClassName=function(e){return this.documentElement.getElementsByClassName(e)},t.prototype.querySelector=function(e){return this.documentElement.querySelector(e)},t.prototype.querySelectorAll=function(e){return this.documentElement.querySelectorAll(e)},t.prototype.find=function(e){return this.documentElement.find(e)},t.prototype.findAll=function(e){return this.documentElement.findAll(e)},t}(Ja),rf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.client=new Si,t.movement=new Si,t.offset=new Si,t.global=new Si,t.screen=new Si,t}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),t.prototype.getModifierState=function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)},t.prototype.initMouseEvent=function(){throw new Error("Method not implemented.")},t}(xi),of=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return Object(l.__extends)(t,e),t.prototype.getCoalescedEvents=function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]},t.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},t}(rf),af=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.DOM_DELTA_LINE=0,t.DOM_DELTA_PAGE=1,t.DOM_DELTA_PIXEL=2,t}return Object(l.__extends)(t,e),t}(rf),sf=(n(62),function(){function e(e,t){this.type=e,this.target=t,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return e.copy=function(t){var n=new e(t.type,t.target);return n.addedNodes=t.addedNodes.slice(),n.removedNodes=t.removedNodes.slice(),n.previousSibling=t.previousSibling,n.nextSibling=t.nextSibling,n.attributeName=t.attributeName,n.attributeNamespace=t.attributeNamespace,n.oldValue=t.oldValue,n},e}()),uf=0,cf=new WeakMap,lf=function(){function e(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}return e.prototype.enqueue=function(e){var t,n=this.observer.records,r=n.length;if(n.length>0){var i=function(e,t){return e===t?e:Fl&&function(e){return e===Fl||e===Nl}(e)?Fl:null}(n[r-1],e);if(i)return void(n[r-1]=i)}else t=this.observer,vf.push(t),pf||(pf=!0,"undefined"!=typeof globalThis?globalThis.setTimeout(yf):yf());n[r]=e},e.prototype.addListeners=function(){this.addListeners_(this.target)},e.prototype.addListeners_=function(e){var t=this.options;t.attributes&&e.addEventListener(vi.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(vi.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(vi.REMOVED,this,!0)},e.prototype.removeListeners=function(){this.removeListeners_(this.target)},e.prototype.removeListeners_=function(e){var t=this.options;t.attributes&&e.removeEventListener(vi.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(vi.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(vi.REMOVED,this,!0)},e.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach((function(e){this.removeListeners_(e);for(var t=cf.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break}}),this)},e.prototype.handleEvent=function(e){var t,n;switch(e.stopImmediatePropagation(),e.type){case vi.ATTR_MODIFIED:var r=e.attrName,i=e.relatedNode.namespaceURI;n=e.target,(t=hf("attributes",n)).attributeName=r,t.attributeNamespace=i;var o=e.attrChange===Pi.ADDITION?null:e.prevValue;df(n,(function(e){var n;if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(r)||-1!==e.attributeFilter.indexOf(i)))return e.attributeOldValue?(n=o,Fl||((Fl=sf.copy(Nl)).oldValue=n,Fl)):t}));break;case vi.REMOVED:case vi.INSERTED:n=e.relatedNode;var a=e.target,s=void 0,u=void 0;e.type===vi.INSERTED?(s=[a],u=[]):(s=[],u=[a]);var c=a.previousSibling,l=a.nextSibling;(t=hf("childList",n)).addedNodes=s,t.removedNodes=u,t.previousSibling=c,t.nextSibling=l,df(n,(function(e){if(e.childList)return t}))}Nl=Fl=void 0},e}(),ff=function(){function e(e){this.callback=e,this.nodes=[],this.records=[],this.uid=uf++}return e.prototype.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var n,r=cf.get(e);r||cf.set(e,r=[]);for(var i=0;i<r.length;i++)if(r[i].observer===this){(n=r[i]).removeListeners(),n.options=t;break}n||(n=new lf(this,e,t),r.push(n),this.nodes.push(e)),n.addListeners()},e.prototype.disconnect=function(){var e=this;this.nodes.forEach((function(t){for(var n=cf.get(t),r=0;r<n.length;r++){var i=n[r];if(i.observer===e){i.removeListeners(),n.splice(r,1);break}}}),this),this.records=[]},e.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},e}();function hf(e,t){return Nl=new sf(e,t)}function df(e,t){for(var n=e;n;n=n.parentNode){var r=cf.get(n);if(r)for(var i=0;i<r.length;i++){var o=r[i],a=o.options;if(n===e||a.subtree){var s=t(a);s&&o.enqueue(s)}}}}var pf=!1,vf=[];function yf(){pf=!1;var e=vf;vf=[],e.sort((function(e,t){return e.uid-t.uid}));var t=!1;e.forEach((function(e){var n=e.takeRecords();!function(e){e.nodes.forEach((function(t){var n=cf.get(t);n&&n.forEach((function(t){t.observer===e&&t.removeTransientObservers()}))}))}(e),n.length&&(e.callback(n,e),t=!0)})),t&&yf()}var mf,_f,gf,Ef=function(){function e(){this.registry={},this.define(ca.CIRCLE,Os),this.define(ca.ELLIPSE,Cs),this.define(ca.RECT,Ds),this.define(ca.IMAGE,xs),this.define(ca.LINE,Ps),this.define(ca.GROUP,Ms),this.define(ca.PATH,Ns),this.define(ca.POLYGON,Fs),this.define(ca.POLYLINE,Is),this.define(ca.TEXT,Ls),this.define(ca.HTML,Bs)}return e.prototype.define=function(e,t){this.registry[e]=t},e.prototype.get=function(e){return this.registry[e]},e}(),Tf=c.Syringe.defineToken("RenderingPluginContribution"),bf=function(){function e(){this.inited=!1,this.stats={total:0,rendered:0,renderedOnscreen:0},this.zIndexCounter=0,this.hooks={init:new Ya.AsyncParallelHook,dirtycheck:new Ya.SyncWaterfallHook(["object"]),cull:new Ya.SyncWaterfallHook(["object"]),beginFrame:new Ya.SyncHook([]),beforeRender:new Ya.SyncHook(["objectToRender"]),render:new Ya.SyncHook(["objectToRender"]),afterRender:new Ya.SyncHook(["objectToRender"]),endFrame:new Ya.SyncHook([]),destroy:new Ya.SyncHook([]),pick:new Ya.AsyncSeriesWaterfallHook(["result"]),pointerDown:new Ya.SyncHook(["event"]),pointerUp:new Ya.SyncHook(["event"]),pointerMove:new Ya.SyncHook(["event"]),pointerOut:new Ya.SyncHook(["event"]),pointerOver:new Ya.SyncHook(["event"]),pointerWheel:new Ya.SyncHook(["event"]),pointerCancel:new Ya.SyncHook(["event"])}}return e.prototype.init=function(){return Object(l.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return this.renderingPluginProvider.getContributions({cache:!1}).forEach((function(t){t.apply(e)})),[4,this.hooks.init.promise()];case 1:return t.sent(),this.inited=!0,[2]}}))}))},e.prototype.getStats=function(){return this.stats},e.prototype.render=function(e){this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.sceneGraphService.syncHierarchy(this.renderingContext.root),this.renderingContext.renderReasons.size&&this.inited&&(this.renderDisplayObject(this.renderingContext.root),(this.renderingContext.dirty||e.renderer.getConfig().enableDirtyRectangleRendering&&1===this.stats.total)&&(this.renderingContext.dirty||this.hooks.beginFrame.call(),this.stats.renderedOnscreen=this.stats.rendered,this.hooks.endFrame.call(),this.renderingContext.dirty=!1),this.renderingContext.renderReasons.clear())},e.prototype.renderDisplayObject=function(e){var t=this;this.styleValueRegistry.recalc(e);var n=this.hooks.dirtycheck.call(e);n&&(this.hooks.cull.call(n),this.stats.rendered++,this.renderingContext.dirty||(this.renderingContext.dirty=!0,this.hooks.beginFrame.call()),this.hooks.beforeRender.call(n),this.hooks.render.call(n),this.hooks.afterRender.call(n),e.renderable.dirty=!1),e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var r=e.sortable,i=!1;r.dirty&&(r.sorted=e.childNodes.slice().sort(Ua),i=!0,r.dirty=!1),(r.sorted||e.childNodes).forEach((function(e){t.renderDisplayObject(e)})),i&&e.forEach((function(e){e.emit(vi.RENDER_ORDER_CHANGED,{renderOrder:e.sortable.renderOrder})}))},e.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call()},e.prototype.dirtify=function(){this.renderingContext.renderReasons.add(ja.DISPLAY_OBJECT_CHANGED)},Object(l.__decorate)([Object(c.contrib)(Tf),Object(l.__metadata)("design:type",Object)],e.prototype,"renderingPluginProvider",void 0),Object(l.__decorate)([Object(c.inject)(za),Object(l.__metadata)("design:type",Object)],e.prototype,"renderingContext",void 0),Object(l.__decorate)([Object(c.inject)(Va),Object(l.__metadata)("design:type",Object)],e.prototype,"sceneGraphService",void 0),Object(l.__decorate)([Object(c.inject)(to),Object(l.__metadata)("design:type",Object)],e.prototype,"styleValueRegistry",void 0),e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Sf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t}(xi),Rf=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cursor="default",t.mappingTable={},t.mappingState={trackingData:{}},t.eventPool=new Map,t.handleTouchEvent=function(e,n){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,r,i,o,a,s,u,c,f,h,d,p,v,y;return Object(l.__generator)(this,(function(m){switch(m.label){case 0:return[4,this.createTouchEvent(e)];case 1:t=m.sent(),r=[];try{for(i=Object(l.__values)(t.changedTouches),o=i.next();!o.done;o=i.next())a=o.value,-1===r.indexOf(a.target)&&r.push(a.target)}catch(_){d={error:_}}finally{try{o&&!o.done&&(p=i.return)&&p.call(i)}finally{if(d)throw d.error}}s=function(e){t.target=e,t.targetTouches=t.touches.filter((function(t){return t.target===e})),u.dispatchEvent(t,n),u.freeEvent(t)},u=this;try{for(c=Object(l.__values)(r),f=c.next();!f.done;f=c.next())h=f.value,s(h)}catch(g){v={error:g}}finally{try{f&&!f.done&&(y=c.return)&&y.call(c)}finally{if(v)throw v.error}}return[2]}}))}))},t.onTouchStart=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return e instanceof of?(this.handleTouchEvent(e,"touchstart"),[2]):[2]}))}))},t.onTouchMove=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return e instanceof of?(this.handleTouchEvent(e,"touchmove"),[2]):[2]}))}))},t.onTouchEnd=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return e instanceof of?(this.handleTouchEvent(e,"touchend"),[2]):[2]}))}))},t.onTouchCancel=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return e instanceof of?(this.handleTouchEvent(e,"touchcancel"),[2]):[2]}))}))},t.onPointerDown=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return e instanceof of?[4,this.createPointerEvent(e)]:[2];case 1:return t=r.sent(),this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType||"mouse"!==t.pointerType&&"pen"!==t.pointerType||(n=2===t.button,this.dispatchEvent(t,n?"rightdown":"mousedown")),this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t),[2]}}))}))},t.onPointerUp=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return e instanceof of?(t=performance.now(),[4,this.createPointerEvent(e)]):[2];case 1:if(n=l.sent(),this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType||"mouse"!==n.pointerType&&"pen"!==n.pointerType||(s=2===n.button,this.dispatchEvent(n,s?"rightup":"mouseup")),r=this.trackingData(e.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[e.button]),o=i,i&&!n.composedPath().includes(i)){for(a=i;a&&!n.composedPath().includes(a);)n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(s=2===n.button,this.notifyTarget(n,s?"rightupoutside":"mouseupoutside")),Ja.isNode(a)&&(a=a.parentNode);delete r.pressTargetsByButton[e.button],o=a}return o&&((u=this.clonePointerEvent(n,"click")).target=o,u.path=[],r.clicksByButton[e.button]||(r.clicksByButton[e.button]={clickCount:0,target:u.target,timeStamp:t}),(c=r.clicksByButton[e.button]).target===u.target&&t-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=u.target,c.timeStamp=t,u.detail=c.clickCount,"mouse"===u.pointerType||"touch"===u.pointerType?this.dispatchEvent(u,"click"):this.dispatchEvent(u,"pointertap"),this.freeEvent(u)),this.freeEvent(n),[2]}}))}))},t.onPointerMove=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,f,h;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return e instanceof of?[4,this.createPointerEvent(e)]:[2];case 1:return t=l.sent(),n="mouse"===t.pointerType||"pen"===t.pointerType,r=this.trackingData(e.pointerId),i=this.findMountedTarget(r.overTargets),r.overTargets&&i!==t.target?(o="mousemove"===e.type?"mouseout":"pointerout",[4,this.createPointerEvent(e,o,i||void 0)]):[3,5];case 2:return a=l.sent(),this.dispatchEvent(a,"pointerout"),n&&this.dispatchEvent(a,"mouseout"),t.composedPath().includes(i)?[3,4]:[4,this.createPointerEvent(e,"pointerleave",i||void 0)];case 3:for((s=l.sent()).eventPhase=s.AT_TARGET;s.target&&!t.composedPath().includes(s.target);)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseleave"),Ja.isNode(s.target)&&(s.target=s.target.parentNode);this.freeEvent(s),l.label=4;case 4:this.freeEvent(a),l.label=5;case 5:if(i!==t.target){for(u="mousemove"===e.type?"mouseover":"pointerover",c=this.clonePointerEvent(t,u),this.dispatchEvent(c,"pointerover"),n&&this.dispatchEvent(c,"mouseover"),f=i&&Ja.isNode(i)&&i.parentNode;f&&f!==(Ja.isNode(this.rootTarget)&&this.rootTarget.parentNode)&&f!==t.target;)f=f.parentNode;if(!f||f===(Ja.isNode(this.rootTarget)&&this.rootTarget.parentNode)){for((h=this.clonePointerEvent(t,"pointerenter")).eventPhase=h.AT_TARGET;h.target&&h.target!==i&&h.target!==(Ja.isNode(this.rootTarget)&&this.rootTarget.parentNode);)h.currentTarget=h.target,this.notifyTarget(h),n&&this.notifyTarget(h,"mouseenter"),Ja.isNode(h.target)&&(h.target=h.target.parentNode);this.freeEvent(h)}this.freeEvent(c)}return this.dispatchEvent(t,"pointermove"),n&&(this.dispatchEvent(t,"mousemove"),this.cursor=this.getCursor(t.target)),r.overTargets=t.composedPath(),this.freeEvent(t),[2]}}))}))},t.onPointerOut=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,n,r,i,o;return Object(l.__generator)(this,(function(a){switch(a.label){case 0:return e instanceof of?(t=this.trackingData(e.pointerId)).overTargets?(n="mouse"===e.pointerType||"pen"===e.pointerType,r=this.findMountedTarget(t.overTargets),[4,this.createPointerEvent(e,"pointerout",r||void 0)]):[3,3]:[2];case 1:return i=a.sent(),this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout"),[4,this.createPointerEvent(e,"pointerleave",r||void 0)];case 2:for((o=a.sent()).eventPhase=o.AT_TARGET;o.target&&o.target!==(Ja.isNode(this.rootTarget)&&this.rootTarget.parentNode);)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),Ja.isNode(o.target)&&(o.target=o.target.parentNode);t.overTargets=null,this.freeEvent(i),this.freeEvent(o),a.label=3;case 3:return this.cursor=null,[2]}}))}))},t.onPointerOver=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,n,r,i;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return e instanceof of?(t=this.trackingData(e.pointerId),[4,this.createPointerEvent(e)]):[2];case 1:for(n=o.sent(),r="mouse"===n.pointerType||"pen"===n.pointerType,this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(this.cursor=this.getCursor(n.target)),(i=this.clonePointerEvent(n,"pointerenter")).eventPhase=i.AT_TARGET;i.target&&i.target!==(Ja.isNode(this.rootTarget)&&this.rootTarget.parentNode);)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseenter"),Ja.isNode(i.target)&&(i.target=i.target.parentNode);return t.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(i),[2]}}))}))},t.onPointerUpOutside=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t,n,r,i;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return e instanceof of?(t=this.trackingData(e.pointerId),n=this.findMountedTarget(t.pressTargetsByButton[e.button]),[4,this.createPointerEvent(e)]):[2];case 1:if(r=o.sent(),n){for(i=n;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType||"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),Ja.isNode(i)&&(i=i.parentNode);delete t.pressTargetsByButton[e.button]}return this.freeEvent(r),[2]}}))}))},t.onWheel=function(e){return Object(l.__awaiter)(t,void 0,void 0,(function(){var t;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return e instanceof af?[4,this.createWheelEvent(e)]:[2];case 1:return t=n.sent(),this.dispatchEvent(t),this.freeEvent(t),[2]}}))}))},t}return Object(l.__extends)(t,e),t.prototype.init=function(){this.rootTarget=this.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("touchstart",this.onTouchStart),this.addEventMapping("touchmove",this.onTouchMove),this.addEventMapping("touchend",this.onTouchEnd),this.addEventMapping("touchcancel",this.onTouchCancel)},t.prototype.client2Viewport=function(e){var t=this.contextService.getBoundingClientRect();return new Si(e.x-((null==t?void 0:t.left)||0),e.y-((null==t?void 0:t.top)||0))},t.prototype.viewport2Client=function(e){var t=this.contextService.getBoundingClientRect();return new Si(e.x+((null==t?void 0:t.left)||0),e.y+((null==t?void 0:t.top)||0))},t.prototype.viewport2Canvas=function(e){var t=e.x,n=e.y,r=this.rootTarget.defaultView.getCamera(),a=this.canvasConfig,s=a.width,u=a.height,c=r.getPerspectiveInverse(),l=r.getWorldTransform(),f=i.multiply(i.create(),l,c),h=o.fromValues(t/s*2-1,2*(1-n/u)-1,0);return o.transformMat4(h,h,f),new Si(h[0],h[1])},t.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView.getCamera(),n=t.getPerspective(),r=t.getViewTransform(),a=i.multiply(i.create(),n,r),s=o.fromValues(e.x,e.y,0);o.transformMat4(s,s,a);var u=this.canvasConfig,c=u.width,l=u.height;return new Si((s[0]+1)/2*c,(1-(s[1]+1)/2)*l)},t.prototype.setPickHandler=function(e){this.pickHandler=e},t.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((function(e,t){return e.priority-t.priority}))},t.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,r=t.length;n<r;n++)t[n].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},t.prototype.dispatchEvent=function(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.emit(t||e.type,e)},t.prototype.propagate=function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){var i=n.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(r=i+1;r<n.length;r++)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},t.prototype.propagationPath=function(e){var t=[e],n=this.rootTarget.defaultView||null;if(n&&n===e)return t.unshift(n.document),t;for(var r=0;r<2048&&e!==this.rootTarget;r++)Ja.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return n&&t.push(n),t},t.prototype.hitTest=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o;return Object(l.__generator)(this,(function(a){switch(a.label){case 0:return t=e.viewportX,n=e.viewportY,r=this.canvasConfig,i=r.width,o=r.height,t<0||n<0||t>i||n>o?[2,null]:[4,this.pickHandler(e)];case 1:return[2,a.sent()||this.rootTarget||null]}}))}))},t.prototype.isNativeEventFromCanvas=function(e){var t,n=this.contextService.getDomElement(),r=null===(t=e.nativeEvent)||void 0===t?void 0:t.target;if(r){if(r===n)return!0;if(n&&n.contains)return n.contains(r)}return!!e.nativeEvent.composedPath&&e.nativeEvent.composedPath().indexOf(n)>-1},t.prototype.pickTarget=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){return[2,this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})]}))}))},t.prototype.createPointerEvent=function(e,t,n){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return Object(l.__generator)(this,(function(u){switch(u.label){case 0:return r=this.allocateEvent(of),this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,i=this.isNativeEventFromCanvas(r),r.originalEvent=e,o=r,null==n?[3,1]:(a=n,[3,4]);case 1:return(s=i)?[4,this.pickTarget(r)]:[3,3];case 2:s=u.sent(),u.label=3;case 3:a=s,u.label=4;case 4:return o.target=a,"string"==typeof t&&(r.type=t),[2,r]}}))}))},t.prototype.createTouchEvent=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u;return Object(l.__generator)(this,(function(c){switch(c.label){case 0:(t=this.allocateEvent(Sf)).isTrusted=e.isTrusted,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.nativeEvent=e.nativeEvent,t.originalEvent=e,this.copyTouchData(e,t),i=0,c.label=1;case 1:return i<e.changedTouches.length?(o=e.changedTouches[i],a=this.isNativeEventFromCanvas(e),n=o,(r=a)?[4,this.pickTarget(o)]:[3,3]):[3,5];case 2:r=c.sent(),c.label=3;case 3:n.target=r,c.label=4;case 4:return i++,[3,1];case 5:i=0,c.label=6;case 6:return i<e.touches.length?(o=e.touches[i],a=this.isNativeEventFromCanvas(e),s=o,(u=a)?[4,this.pickTarget(o)]:[3,8]):[3,10];case 7:u=c.sent(),c.label=8;case 8:s.target=u,c.label=9;case 9:return i++,[3,6];case 10:return t.touches=e.touches,t.changedTouches=e.changedTouches,[2,t]}}))}))},t.prototype.createWheelEvent=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(l.__generator)(this,(function(o){switch(o.label){case 0:return t=this.allocateEvent(af),this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,n=this.isNativeEventFromCanvas(t),r=t,(i=n)?[4,this.pickTarget(t)]:[3,2];case 1:i=o.sent(),o.label=2;case 2:return r.target=i,[2,t]}}))}))},t.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},t.prototype.clonePointerEvent=function(e,t){var n=this.allocateEvent(of);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=null!=t?t:n.type,n},t.prototype.copyPointerData=function(e,t){e instanceof of&&t instanceof of&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)},t.prototype.copyMouseData=function(e,t){e instanceof rf&&t instanceof rf&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset))},t.prototype.copyTouchData=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){return Object(l.__generator)(this,(function(n){return t.altKey=e.altKey,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,[2]}))}))},t.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},t.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},t.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},t.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},t.prototype.notifyTarget=function(e,t){t=null!=t?t:e.type;var n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},t.prototype.notifyListeners=function(e,t){var n=e.currentTarget.emitter,r=n._events[t];if(r)if("fn"in r)r.once&&n.removeListener(t,r.fn,void 0,!0),r.fn.call(e.currentTarget||r.context,e);else for(var i=0;i<r.length&&!e.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(e.currentTarget||r[i].context,e)},t.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],n=e.length-2;n>=0;n--){var r=e[n];if(!(r===this.rootTarget||Ja.isNode(r)&&r.parentNode===t))break;t=e[n]}return t},t.prototype.getCursor=function(e){for(var t=e;t;){var n=is.isElement(t)&&t.getAttribute("cursor");if(n)return n;t=Ja.isNode(t)&&t.parentNode}},Object(l.__decorate)([Object(c.inject)(za),Object(l.__metadata)("design:type",Object)],t.prototype,"renderingContext",void 0),Object(l.__decorate)([Object(c.inject)(Ha),Object(l.__metadata)("design:type",Object)],t.prototype,"contextService",void 0),Object(l.__decorate)([Object(c.inject)(pa),Object(l.__metadata)("design:type",Object)],t.prototype,"canvasConfig",void 0),Object(l.__decorate)([Object(c.postConstruct)(),Object(l.__metadata)("design:type",Function),Object(l.__metadata)("design:paramtypes",[]),Object(l.__metadata)("design:returntype",void 0)],t.prototype,"init",null),t=Object(l.__decorate)([Object(c.singleton)()],t)}(f.EventEmitter),Af=function(){function e(){}return e.prototype.getOrCreateCanvas=function(e){if(this.canvas)return this.canvas;if(e)this.canvas=e,this.context=this.canvas.getContext("2d");else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d"),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")}return this.canvas.width=10,this.canvas.height=10,this.canvas},e.prototype.getOrCreateContext=function(e){return this.context||this.getOrCreateCanvas(e),this.context},e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Of={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Cf=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,Mf=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),xf=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),Pf=function(){function e(){var e=this;this.cache={},this.shouldBreakByKinsokuShorui=function(t,n){return!e.isBreakingSpace(n)&&!(!t||!xf.exec(n)&&!Mf.exec(t))},this.trimByKinsokuShorui=function(e){var t=Object(l.__spreadArray)([],Object(l.__read)(e),!1),n=t[t.length-2];if(!n)return e;var r=n[n.length-1];return t[t.length-2]=n.slice(0,-1),t[t.length-1]=r+t[t.length-1],t}}return e.prototype.measureFont=function(e,t){if(this.cache[e])return this.cache[e];var n={ascent:0,descent:0,fontSize:0},r=this.offscreenCanvas.getOrCreateCanvas(t),i=this.offscreenCanvas.getOrCreateContext(t);i.font=e;var o=Of.MetricsString+Of.BaselineSymbol,a=Math.ceil(i.measureText(o).width),s=Math.ceil(i.measureText(Of.BaselineSymbol).width),u=Of.HeightMultiplier*s;s=s*Of.BaselineMultiplier|0,r.width=a,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(o,0,s);var c=i.getImageData(0,0,a||1,u||1).data,l=c.length,f=4*a,h=0,d=0,p=!1;for(h=0;h<s;++h){for(var v=0;v<f;v+=4)if(255!==c[d+v]){p=!0;break}if(p)break;d+=f}for(n.ascent=s-h,d=l-f,p=!1,h=u;h>s;--h){for(v=0;v<f;v+=4)if(255!==c[d+v]){p=!0;break}if(p)break;d-=f}return n.descent=h-s,n.fontSize=n.ascent+n.descent,this.cache[e]=n,n},e.prototype.measureText=function(e,t,n){var r=t.fontSize,i=t.wordWrap,o=t.lineHeight,a=void 0===o?0:o,s=t.lineWidth,u=t.textBaseline,c=t.textAlign,l=t.letterSpacing,f=void 0===l?0:l,h=t.leading,d=void 0===h?0:h,p=Ca(t),v=this.measureFont(p,n);0===v.fontSize&&(v.fontSize=r.value,v.ascent=r.value);var y=this.offscreenCanvas.getOrCreateContext(n);y.font=p;for(var m=(i?this.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),_=new Array(m.length),g=0,E=0;E<m.length;E++){var T=y.measureText(m[E]).width+(m[E].length-1)*f;_[E]=T,g=Math.max(g,T)}var b=g+s.value,S=a||v.fontSize+s.value,R=Math.max(S,v.fontSize+s.value)+(m.length-1)*(S+d);S+=d;var A=0;return"middle"===u.value?A=-R/2:"bottom"===u.value||"alphabetic"===u.value||"ideographic"===u.value?A=-R:"top"!==u.value&&"hanging"!==u.value||(A=0),{font:p,width:b,height:R,lines:m,lineWidths:_,lineHeight:S,maxLineWidth:g,fontProperties:v,lineMetrics:_.map((function(e,t){var n=0;return"center"===c.value?n-=e/2:"right"!==c.value&&"end"!==c.value||(n-=e),new Ri(n-s.value/2,A+t*S,e+s.value,S)}))}},e.prototype.wordWrap=function(e,t,n){var r=this,i=t.wordWrapWidth,o=void 0===i?0:i,a=t.letterSpacing,s=void 0===a?0:a,u=this.offscreenCanvas.getOrCreateContext(n),c=o+s,l=[],f=0,h=0,d={},p=function(e){return r.getFromCache(e,s,d,u)};return Array.from(e).forEach((function(t,n){var i=e[n-1],o=e[n+1],a=p(t);if(r.isNewline(t))return f++,h=0,void(l[f]="");if(h>0&&h+a>c){if(f++,h=0,l[f]="",r.isBreakingSpace(t))return;r.canBreakInLastChar(t)||(l=r.trimToBreakable(l),h=r.sumTextWidthByCache(l[f]||"",d)),r.shouldBreakByKinsokuShorui(t,o)&&(l=r.trimByKinsokuShorui(l),h+=p(i||""))}h+=a,l[f]=(l[f]||"")+t})),l.join("\n")},e.prototype.isBreakingSpace=function(e){return"string"==typeof e&&Of.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},e.prototype.isNewline=function(e){return"string"==typeof e&&Of.Newlines.indexOf(e.charCodeAt(0))>=0},e.prototype.trimToBreakable=function(e){var t=Object(l.__spreadArray)([],Object(l.__read)(e),!1),n=t[t.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return t;var i=n.slice(r,r+1),o=r+1,a=r+(this.isBreakingSpace(i)?0:1);return t[t.length-1]+=n.slice(o,n.length),t[t.length-2]=n.slice(0,a),t},e.prototype.canBreakInLastChar=function(e){return!e||!Cf.test(e)},e.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce((function(e,n){if(!t[n])throw Error("cannot count the word without cache");return e+t[n]}),0)},e.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!Cf.test(e[t]))return t;return-1},e.prototype.getFromCache=function(e,t,n,r){var i=n[e];if("number"!=typeof i){var o=e.length*t;i=r.measureText(e).width+o,n[e]=i}return i},Object(l.__decorate)([Object(c.inject)(Af),Object(l.__metadata)("design:type",Af)],e.prototype,"offscreenCanvas",void 0),e=Object(l.__decorate)([Object(c.singleton)()],e)}(),Nf=function(){function e(){}return e.prototype.update=function(e,t){var n=e.r;return{width:2*n.value,height:2*n.value}},e=Object(l.__decorate)([Object(c.singleton)({token:{token:Ql,named:ca.CIRCLE}})],e)}(),Ff=function(){function e(){}return e.prototype.update=function(e,t){var n=e.rx,r=e.ry;return{width:2*n.value,height:2*r.value}},e=Object(l.__decorate)([Object(c.singleton)({token:{token:Ql,named:ca.ELLIPSE}})],e)}(),If=function(){function e(){}return e.prototype.update=function(e,t){var n=e.img,r=e.width,i=e.height,o=0,a=0;return r instanceof eu&&r.unit===ms.kPixels&&(o=r.value),i instanceof eu&&i.unit===ms.kPixels&&(a=i.value),n&&!Vo(n)&&(o||(o=n.width),a||(a=n.height)),r instanceof eu&&(r.value=o),i instanceof eu&&(i.value=a),{width:o,height:a}},e=Object(l.__decorate)([Object(c.singleton)({token:[{token:Ql,named:ca.RECT},{token:Ql,named:ca.IMAGE},{token:Ql,named:ca.GROUP}]})],e)}(),Df=function(){function e(){}return e.prototype.isReadyToMeasure=function(e,t){var n=e.text,r=e.textAlign,i=e.textBaseline,o=e.fontSize,a=e.fontStyle,s=e.fontWeight,u=e.fontVariant;return n&&o&&a&&s&&u&&r&&i},e.prototype.update=function(e,t){var n,r,i=e.text,a=e.textAlign,s=e.lineWidth,u=e.textBaseline,c=e.dx,l=e.dy,f=((null===(r=null===(n=null==t?void 0:t.ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===r?void 0:r.getConfig())||{}).offscreenCanvas;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{width:0,height:0,x:0,y:0,offsetX:0,offsetY:0};var h=this.textService.measureText(i,e,f);e.metrics=h;var d=h.width,p=h.height,v=h.lineHeight,y=h.fontProperties,m=o.fromValues(d/2,p/2,0),_=[0,1],g=0;"center"===a.value?(g=s.value/2,_=[.5,1]):"right"!==a.value&&"end"!==a.value||(g=s.value,_=[1,1]);var E=0;return"middle"===u.value?E=m[1]:"top"===u.value||"hanging"===u.value?E=2*m[1]:"alphabetic"===u.value?E=v-y.ascent:"bottom"!==u.value&&"ideographic"!==u.value||(E=0),c&&(g+=c.value),l&&(E+=l.value),e.anchor=[new eu(_[0]),new eu(_[1]),new eu(0)],{width:2*m[0],height:2*m[1],offsetX:g,offsetY:E}},Object(l.__decorate)([Object(c.inject)(Pf),Object(l.__metadata)("design:type",Pf)],e.prototype,"textService",void 0),e=Object(l.__decorate)([Object(c.singleton)({token:{token:Ql,named:ca.TEXT}})],e)}(),Lf=function(){function e(){}return e.prototype.update=function(e){var t=e.x1,n=e.y1,r=e.x2,i=e.y2,o=Math.min(t.value,r.value),a=Math.max(t.value,r.value),s=Math.min(n.value,i.value);return{width:a-o,height:Math.max(n.value,i.value)-s}},e=Object(l.__decorate)([Object(c.singleton)({token:{token:Ql,named:ca.LINE}})],e)}(),Bf=function(){function e(){}return e.prototype.update=function(e){var t=e.points.points,n=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(t.map((function(e){return e[0]}))),!1)),r=Math.max.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(t.map((function(e){return e[0]}))),!1)),i=Math.min.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(t.map((function(e){return e[1]}))),!1));return{width:r-n,height:Math.max.apply(Math,Object(l.__spreadArray)([],Object(l.__read)(t.map((function(e){return e[1]}))),!1))-i}},e=Object(l.__decorate)([Object(c.singleton)({token:[{token:Ql,named:ca.POLYLINE},{token:Ql,named:ca.POLYGON}]})],e)}(),wf=function(){function e(){}return e.prototype.update=function(e){var t=e.path.rect;return{width:t.width,height:t.height}},e=Object(l.__decorate)([Object(c.singleton)({token:{token:Ql,named:ca.PATH}})],e)}(),kf=Object(c.Module)((function(e){Object(c.decorate)(Object(c.injectable)(),f.EventEmitter),e(h),e(Mi),e({token:Ai,useFactory:function(e){return function(){return e.container.get(Oi)}}}),e(Wa),e(Af),e(Pf),e(Nf),e(Ff),e(If),e(Df),e(Lf),e(Bf),e(wf),e({token:Jl,useFactory:function(e){var t={};return function(n){return t[n]||e.container.isBoundNamed(Ql,n)&&(t[n]=e.container.getNamed(Ql,n)),t[n]}}}),e(pl),e(tf),e(Il),e(Dl),e(Ll),e(Bl),e(wl),e(kl),e(Ul),e(Gl),e(jl),e(Vl),e(Wl),e(Hl),e(Xl),e(zl),e(Yl),e(Kl),e(ql),e(Zl),e(yl),e(dl),e({token:ll,useFactory:function(e){return function(t){var n=e.container.createChild();return n.register({token:fl,useValue:t}),n.get(dl)}}}),e({token:Qc,useFactory:function(e){return function(t){var n=e.container.createChild();n.register(tl),n.register(ul),n.register({token:al,useFactory:function(e){return function(t){var n=e.container.createChild();return n.register({token:sl,useValue:t}),n.get(ul)}}}),n.register(ol),n.register({token:nl,useFactory:function(e){return function(t,n){var r=e.container.createChild();return r.register({token:rl,useValue:t}),r.register({token:il,useValue:n}),r.get(ol)}}}),n.register(gl),n.register({token:ml,useFactory:function(e){return function(t){var n=e.container.createChild();return n.register({token:_l,useValue:t}),n.get(gl)}}});var r=n.get(al),i=n.get(ml),o=n.get(nl);return n.register({token:$c,useValue:Object(l.__assign)(Object(l.__assign)({},t),{layoutChildrenFactory:r,layoutFragmentFactory:i,fragmentResultFactory:o})}),n.get(tl)}}})})),Uf=c.Syringe.defineToken("DefaultCamera");!function(e){e[e.ORBITING=0]="ORBITING",e[e.EXPLORING=1]="EXPLORING",e[e.TRACKING=2]="TRACKING"}(mf||(mf={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.ROTATIONAL=1]="ROTATIONAL",e[e.TRANSLATIONAL=2]="TRANSLATIONAL",e[e.CINEMATIC=3]="CINEMATIC"}(_f||(_f={})),function(e){e[e.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",e[e.PERSPECTIVE=1]="PERSPECTIVE"}(gf||(gf={}));var Gf,jf={UPDATED:"updated"},Vf=Math.PI/180,Wf=180/Math.PI,Hf=function(e){function t(t,n){void 0===t&&(t=mf.EXPLORING),void 0===n&&(n=_f.DEFAULT);var r=e.call(this)||this;return r.matrix=i.create(),r.right=o.fromValues(1,0,0),r.up=o.fromValues(0,1,0),r.forward=o.fromValues(0,0,1),r.position=o.fromValues(0,0,1),r.focalPoint=o.fromValues(0,0,0),r.distanceVector=o.fromValues(0,0,-1),r.distance=1,r.azimuth=0,r.elevation=0,r.roll=0,r.relAzimuth=0,r.relElevation=0,r.relRoll=0,r.dollyingStep=0,r.maxDistance=1/0,r.minDistance=-1/0,r.zoom=1,r.rotateWorld=!1,r.fov=30,r.near=.1,r.far=1e3,r.aspect=1,r.projectionMatrix=i.create(),r.projectionMatrixInverse=i.create(),r.jitteredProjectionMatrix=void 0,r.enableUpdate=!0,r.type=mf.EXPLORING,r.trackingMode=_f.DEFAULT,r.projectionMode=gf.PERSPECTIVE,r.frustum=new yi,r.landmarks=[],r.orthoMatrix=i.create(),r.setType(t,n),r}return Object(l.__extends)(t,e),t.prototype.isOrtho=function(){return this.projectionMode===gf.ORTHOGRAPHIC},t.prototype.getProjectionMode=function(){return this.projectionMode},t.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},t.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},t.prototype.getFrustum=function(){return this.frustum},t.prototype.getPosition=function(){return this.position},t.prototype.getFocalPoint=function(){return this.focalPoint},t.prototype.getDollyingStep=function(){return this.dollyingStep},t.prototype.getNear=function(){return this.near},t.prototype.getFar=function(){return this.far},t.prototype.getZoom=function(){return this.zoom},t.prototype.getOrthoMatrix=function(){return this.orthoMatrix},t.prototype.getView=function(){return this.view},t.prototype.setEnableUpdate=function(e){this.enableUpdate=e},t.prototype.setType=function(e,t){return this.type=e,this.type===mf.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===mf.TRACKING&&void 0!==t&&this.setTrackingMode(t),this},t.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},t.prototype.setTrackingMode=function(e){if(this.type!==mf.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},t.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},t.prototype.getViewTransform=function(){return i.invert(i.create(),this.matrix)},t.prototype.getWorldTransform=function(){return this.matrix},t.prototype.jitterProjectionMatrix=function(e,t){var n=i.fromTranslation(i.create(),[e,t,0]);this.jitteredProjectionMatrix=i.multiply(i.create(),n,this.projectionMatrix)},t.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},t.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},t.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},t.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},t.prototype.setNear=function(e){return this.projectionMode===gf.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},t.prototype.setFar=function(e){return this.projectionMode===gf.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},t.prototype.setViewOffset=function(e,t,n,r,i,o){return this.aspect=e/t,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===gf.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.clearViewOffset=function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===gf.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===gf.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===gf.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},t.prototype.setPerspective=function(e,t,n,r){var a;this.projectionMode=gf.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=r;var s=this.near*Math.tan(.5*Vf*this.fov)/this.zoom,u=2*s,c=this.aspect*u,l=-.5*c;if(null===(a=this.view)||void 0===a?void 0:a.enabled){var f=this.view.fullWidth,h=this.view.fullHeight;l+=this.view.offsetX*c/f,s-=this.view.offsetY*u/h,c*=this.view.width/f,u*=this.view.height/h}return $i(this.projectionMatrix,l,l+c,s,s-u,e,this.far),i.scale(this.projectionMatrix,this.projectionMatrix,o.fromValues(1,-1,1)),i.invert(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},t.prototype.setOrthographic=function(e,t,n,r,a,s){var u;this.projectionMode=gf.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=r,this.near=a,this.far=s;var c=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),f=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,d=f-c,p=f+c,v=h+l,y=h-l;if(null===(u=this.view)||void 0===u?void 0:u.enabled){var m=(this.rright-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;p=(d+=m*this.view.offsetX)+m*this.view.width,y=(v-=_*this.view.offsetY)-_*this.view.height}return i.ortho(this.projectionMatrix,d,p,y,v,a,s),i.scale(this.projectionMatrix,this.projectionMatrix,o.fromValues(1,-1,1)),i.invert(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},t.prototype.setPosition=function(e,t,n){void 0===t&&(t=this.position[1]),void 0===n&&(n=this.position[2]);var r=Vi(e,t,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},t.prototype.setFocalPoint=function(e,t,n){void 0===t&&(t=this.focalPoint[1]),void 0===n&&(n=this.focalPoint[2]);var r=o.fromValues(0,1,0);if(this.focalPoint=Vi(e,t,n),this.trackingMode===_f.CINEMATIC){var a=o.subtract(o.create(),this.focalPoint,this.position);e=a[0],t=a[1],n=a[2];var s=o.length(a),u=Math.asin(t/s)*Wf,c=90+Math.atan2(n,e)*Wf,l=i.create();i.rotateY(l,l,c*Vf),i.rotateX(l,l,u*Vf),r=o.transformMat4(o.create(),[0,1,0],l)}return i.invert(this.matrix,i.lookAt(i.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},t.prototype.getDistance=function(){return this.distance},t.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var t=o.create();e=this.distance;var n=this.forward,r=this.focalPoint;return t[0]=e*n[0]+r[0],t[1]=e*n[1]+r[1],t[2]=e*n[2]+r[2],this._setPosition(t),this.triggerUpdate(),this},t.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},t.prototype.setMinDistance=function(e){return this.minDistance=e,this},t.prototype.setAzimuth=function(e){return this.azimuth=ji(e),this.computeMatrix(),this._getAxes(),this.type===mf.ORBITING||this.type===mf.EXPLORING?this._getPosition():this.type===mf.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getAzimuth=function(){return this.azimuth},t.prototype.setElevation=function(e){return this.elevation=ji(e),this.computeMatrix(),this._getAxes(),this.type===mf.ORBITING||this.type===mf.EXPLORING?this._getPosition():this.type===mf.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getElevation=function(){return this.elevation},t.prototype.setRoll=function(e){return this.roll=ji(e),this.computeMatrix(),this._getAxes(),this.type===mf.ORBITING||this.type===mf.EXPLORING?this._getPosition():this.type===mf.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getRoll=function(){return this.roll},t.prototype.rotate=function(e,t,n){if(this.relElevation=ji(t),this.relAzimuth=ji(e),this.relRoll=ji(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===mf.EXPLORING){var r=s.setAxisAngle(s.create(),[1,0,0],(this.rotateWorld?1:-1)*this.relElevation*Vf),o=s.setAxisAngle(s.create(),[0,1,0],(this.rotateWorld?1:-1)*this.relAzimuth*Vf),a=s.setAxisAngle(s.create(),[0,0,1],this.relRoll*Vf),u=s.multiply(s.create(),o,r);u=s.multiply(s.create(),u,a);var c=i.fromQuat(i.create(),u);i.translate(this.matrix,this.matrix,[0,0,-this.distance]),i.multiply(this.matrix,this.matrix,c),i.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===mf.ORBITING||this.type===mf.EXPLORING?this._getPosition():this.type===mf.TRACKING&&this._getFocalPoint(),this._update(),this},t.prototype.pan=function(e,t){var n=Vi(e,t,0),r=o.clone(this.position);return o.add(r,r,o.scale(o.create(),this.right,n[0])),o.add(r,r,o.scale(o.create(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this},t.prototype.dolly=function(e){var t=this.forward,n=o.clone(this.position),r=this.dollyingStep,i=this.distance+e*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*t[0],n[1]+=r*t[1],n[2]+=r*t[2],this._setPosition(n),this.type===mf.ORBITING||this.type===mf.EXPLORING?this._getDistance():this.type===mf.TRACKING&&o.add(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this},t.prototype.createLandmark=function(e,n){void 0===n&&(n={});var r=n.position,a=void 0===r?this.position:r,s=n.focalPoint,u=void 0===s?this.focalPoint:s,c=n.roll,l=n.zoom,f=new t;f.setType(this.type,void 0),f.setPosition(a[0],a[1]||this.position[1],a[2]||this.position[2]),f.setFocalPoint(u[0],u[1]||this.focalPoint[1],u[2]||this.focalPoint[2]),f.setRoll(c||this.roll),f.setZoom(l||this.zoom);var h={name:e,matrix:i.clone(f.matrix),right:o.clone(f.right),up:o.clone(f.up),forward:o.clone(f.forward),position:o.clone(f.position),focalPoint:o.clone(f.focalPoint),distanceVector:o.clone(f.distanceVector),distance:f.distance,dollyingStep:f.dollyingStep,azimuth:f.azimuth,elevation:f.elevation,roll:f.roll,relAzimuth:f.relAzimuth,relElevation:f.relElevation,relRoll:f.relRoll,zoom:f.zoom};return this.landmarks.push(h),h},t.prototype.gotoLandmark=function(e,t){var n=this;void 0===t&&(t={});var r=Vo(e)?this.landmarks.find((function(t){return t.name===e})):e;if(r){var i=Bi(t)?{duration:t}:t,a=i.easing,s=void 0===a?"linear":a,u=i.duration,c=void 0===u?100:u,l=i.easingFunction,f=void 0===l?void 0:l,h=i.onfinish,d=void 0===h?void 0:h;if(0===c)return this.syncFromLandmark(r),void(d&&d());void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID);var p,v=r.position,y=r.focalPoint,m=r.zoom,_=r.roll,g=f||wo(s),E=function(){n.setFocalPoint(y),n.setPosition(v),n.setRoll(_),n.setZoom(m),n.computeMatrix(),n.triggerUpdate(),d&&d()};this.canvas.requestAnimationFrame((function e(t){void 0===p&&(p=t);var r=t-p;if(r>c)E();else{var i,a,s=g(r/c),u=o.create(),l=o.create();o.lerp(u,n.focalPoint,y,s),o.lerp(l,n.position,v,s),a=n.roll*(1-s)+_*s,i=n.zoom*(1-s)+m*s,n.setFocalPoint(u),n.setPosition(l),n.setRoll(a),n.setZoom(i),o.dist(u,y)+o.dist(l,v)<=.01?E():(n.computeMatrix(),n.triggerUpdate(),r<c&&(n.landmarkAnimationID=n.canvas.requestAnimationFrame(e)))}}))}},t.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},t.prototype.computeMatrix=function(){var e=s.setAxisAngle(s.create(),[0,0,1],this.roll*Vf);i.identity(this.matrix);var t=s.setAxisAngle(s.create(),[1,0,0],(this.rotateWorld&&this.type!==mf.TRACKING||this.type===mf.TRACKING?1:-1)*this.elevation*Vf),n=s.setAxisAngle(s.create(),[0,1,0],(this.rotateWorld&&this.type!==mf.TRACKING||this.type===mf.TRACKING?1:-1)*this.azimuth*Vf),r=s.multiply(s.create(),n,t);r=s.multiply(s.create(),r,e);var o=i.fromQuat(i.create(),r);this.type===mf.ORBITING||this.type===mf.EXPLORING?(i.translate(this.matrix,this.matrix,this.focalPoint),i.multiply(this.matrix,this.matrix,o),i.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===mf.TRACKING&&(i.translate(this.matrix,this.matrix,this.position),i.multiply(this.matrix,this.matrix,o))},t.prototype._setPosition=function(e,t,n){this.position=Vi(e,t,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()},t.prototype._getAxes=function(){o.copy(this.right,Vi(a.transformMat4(a.create(),[1,0,0,0],this.matrix))),o.copy(this.up,Vi(a.transformMat4(a.create(),[0,1,0,0],this.matrix))),o.copy(this.forward,Vi(a.transformMat4(a.create(),[0,0,1,0],this.matrix))),o.normalize(this.right,this.right),o.normalize(this.up,this.up),o.normalize(this.forward,this.forward)},t.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],r=o.length(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===mf.TRACKING||this.rotateWorld?(this.elevation=Math.asin(t/r)*Wf,this.azimuth=Math.atan2(-e,-n)*Wf):(this.elevation=-Math.asin(t/r)*Wf,this.azimuth=-Math.atan2(-e,-n)*Wf)},t.prototype._getPosition=function(){o.copy(this.position,Vi(a.transformMat4(a.create(),[0,0,0,1],this.matrix))),this._getDistance()},t.prototype._getFocalPoint=function(){o.transformMat3(this.distanceVector,[0,0,-this.distance],r.fromMat4(r.create(),this.matrix)),o.add(this.focalPoint,this.position,this.distanceVector),this._getDistance()},t.prototype._getDistance=function(){this.distanceVector=o.subtract(o.create(),this.focalPoint,this.position),this.distance=o.length(this.distanceVector),this.dollyingStep=this.distance/100},t.prototype._getOrthoMatrix=function(){if(this.projectionMode===gf.ORTHOGRAPHIC){var e=this.position,t=s.setAxisAngle(s.create(),[0,0,1],-this.roll*Math.PI/180);i.fromRotationTranslationScaleOrigin(this.orthoMatrix,t,o.fromValues((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),o.fromValues(this.zoom,this.zoom,1),e)}},t.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=i.multiply(i.create(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.emit(jf.UPDATED)}},t.prototype.syncFromLandmark=function(e){this.matrix=i.copy(this.matrix,e.matrix),this.right=o.copy(this.right,e.right),this.up=o.copy(this.up,e.up),this.forward=o.copy(this.forward,e.forward),this.position=o.copy(this.position,e.position),this.focalPoint=o.copy(this.focalPoint,e.focalPoint),this.distanceVector=o.copy(this.distanceVector,e.distanceVector),this.azimuth=e.azimuth,this.elevation=e.elevation,this.roll=e.roll,this.relAzimuth=e.relAzimuth,this.relElevation=e.relElevation,this.relRoll=e.relRoll,this.dollyingStep=e.dollyingStep,this.distance=e.distance,this.zoom=e.zoom},t}(f.EventEmitter),Xf=function(){function e(e){this.plugins=[],this.config=Object(l.__assign)({enableDirtyCheck:!0,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1},e)}return e.prototype.registerPlugin=function(e){this.plugins.push(e)},e.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex((function(t){return t===e}));t>-1&&this.plugins.splice(t,1)},e.prototype.getPlugins=function(){return this.plugins},e.prototype.getPlugin=function(e){return this.plugins.find((function(t){return t.name===e}))},e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){Object.assign(this.config,e)},e}(),zf=n(181),Yf=function(){function e(){}var t;return t=e,e.prototype.apply=function(e){var n=this;e.hooks.dirtycheck.tap(t.tag,(function(e){if(e){var t=n.canvasConfig.renderer.getConfig().enableDirtyCheck,r=e.renderable,i=n.renderingContext.renderReasons.has(ja.CAMERA_CHANGED),o=n.renderingContext.dirty;return r.dirty||i||!t&&o?e:null}return e}))},e.tag="DirtyCheck",Object(l.__decorate)([Object(c.inject)(pa),Object(l.__metadata)("design:type",Object)],e.prototype,"canvasConfig",void 0),Object(l.__decorate)([Object(c.inject)(za),Object(l.__metadata)("design:type",Object)],e.prototype,"renderingContext",void 0),e=t=Object(l.__decorate)([Object(c.singleton)({contrib:Tf})],e)}(),Kf=c.Syringe.defineToken("CullingStrategyContribution"),qf=function(){function e(){}var t;return t=e,e.prototype.apply=function(e){var n=this.strategyProvider.getContributions();e.hooks.cull.tap(t.tag,(function(e){if(e){var t=e.cullable;return 0===n.length?t.visible=!0:t.visible=n.every((function(t){return t.isVisible(e)})),!t.isCulled()&&e.isVisible()?e:null}return e})),e.hooks.afterRender.tap(t.tag,(function(e){e.cullable.visibilityPlaneMask=-1}))},e.tag="Culling",Object(l.__decorate)([Object(c.contrib)(Kf),Object(l.__metadata)("design:type",Object)],e.prototype,"strategyProvider",void 0),e=t=Object(l.__decorate)([Object(c.singleton)({contrib:Tf})],e)}(),Zf=function(){function e(){}var t;return t=e,e.prototype.apply=function(e){var n=this,r=function(t){t.target.renderable.dirty=!0,e.dirtify()},i=function(){e.dirtify()},o=function(t){var r=t.target;n.styleValueRegistry.recalc(r),Ga(r),e.dirtify()},a=function(t){Ga(t.target),e.dirtify()};e.hooks.init.tapPromise(t.tag,(function(){return Object(l.__awaiter)(n,void 0,void 0,(function(){return Object(l.__generator)(this,(function(e){return this.renderingContext.root.addEventListener(vi.MOUNTED,o),this.renderingContext.root.addEventListener(vi.UNMOUNTED,a),this.renderingContext.root.addEventListener(vi.ATTR_MODIFIED,r),this.renderingContext.root.addEventListener(vi.BOUNDS_CHANGED,i),[2]}))}))})),e.hooks.destroy.tap(t.tag,(function(){n.renderingContext.root.removeEventListener(vi.MOUNTED,o),n.renderingContext.root.removeEventListener(vi.UNMOUNTED,a),n.renderingContext.root.removeEventListener(vi.ATTR_MODIFIED,r),n.renderingContext.root.removeEventListener(vi.BOUNDS_CHANGED,i)}))},e.tag="Prepare",Object(l.__decorate)([Object(c.inject)(za),Object(l.__metadata)("design:type",Object)],e.prototype,"renderingContext",void 0),Object(l.__decorate)([Object(c.inject)(to),Object(l.__metadata)("design:type",Object)],e.prototype,"styleValueRegistry",void 0),e=t=Object(l.__decorate)([Object(c.singleton)({contrib:Tf})],e)}(),Jf=[ca.CIRCLE,ca.ELLIPSE,ca.IMAGE,ca.RECT,ca.LINE,ca.POLYLINE,ca.POLYGON,ca.TEXT,ca.PATH,ca.HTML],Qf=function(){function e(){}return e.prototype.isVisible=function(e){var t,n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(fi.isEmpty(i))return!1;var o=this.camera.getFrustum(),a=null===(n=null===(t=e.parentNode)||void 0===t?void 0:t.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,a||ni.INDETERMINATE,o.planes),r.visible=r.visibilityPlaneMask!==ni.OUTSIDE,r.visible},e.prototype.computeVisibilityWithPlaneMask=function(e,t,n,r){if(n===ni.OUTSIDE||n===ni.INSIDE)return n;for(var i=ni.INSIDE,a=Jf.indexOf(e.nodeName)>-1,s=0,u=r.length;s<u;++s){var c=1<<s;if(0!=(n&c)&&(!a||4!==s&&5!==s)){var l=r[s],f=l.normal,h=l.distance;if(o.dot(f,t.getPositiveFarPoint(r[s]))+h<0)return ni.OUTSIDE;o.dot(f,t.getNegativeFarPoint(r[s]))+h<0&&(i|=c)}}return i},Object(l.__decorate)([Object(c.inject)(Uf),Object(l.__metadata)("design:type",Hf)],e.prototype,"camera",void 0),e=Object(l.__decorate)([Object(c.singleton)({contrib:Kf})],e)}(),$f=function(){function e(){var e=this;this.autoPreventDefault=!0,this.rootPointerEvent=new of(null),this.rootWheelEvent=new af(null),this.onPointerMove=function(t){var n,r,i=null===(r=null===(n=e.renderingContext.root)||void 0===n?void 0:n.ownerDocument)||void 0===r?void 0:r.defaultView;if(!i.supportTouchEvent||"touch"!==t.pointerType){var o=e.normalizeToPointerEvent(t,i),a=e.bootstrapEvent(e.rootPointerEvent,o,i);e.eventService.mapEvent(a),e.setCursor(e.eventService.cursor)}}}var t;return t=e,e.prototype.apply=function(e){var n=this,r=this.renderingContext.root.ownerDocument.defaultView;this.eventService.setPickHandler((function(e){return Object(l.__awaiter)(n,void 0,void 0,(function(){return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.renderingService.hooks.pick.promise({position:e,picked:[],topmost:!0})];case 1:return[2,t.sent().picked[0]||null]}}))}))})),e.hooks.pointerWheel.tap(t.tag,(function(e){var t=n.normalizeWheelEvent(e);n.eventService.mapEvent(t)})),e.hooks.pointerDown.tap(t.tag,(function(e){if(!r.supportTouchEvent||"touch"!==e.pointerType){var t=n.normalizeToPointerEvent(e,r);if(n.autoPreventDefault&&t.isNormalized)(e.cancelable||!("cancelable"in e))&&e.preventDefault();var i=n.bootstrapEvent(n.rootPointerEvent,t,r);n.eventService.mapEvent(i),n.setCursor(n.eventService.cursor)}})),e.hooks.pointerUp.tap(t.tag,(function(e){if(!r.supportTouchEvent||"touch"!==e.pointerType){var t=n.contextService.getDomElement(),i=t&&e.target&&e.target!==t&&t.contains&&!t.contains(e.target)?"outside":"",o=n.normalizeToPointerEvent(e,r),a=n.bootstrapEvent(n.rootPointerEvent,o,r);a.type+=i,n.eventService.mapEvent(a),n.setCursor(n.eventService.cursor)}})),e.hooks.pointerMove.tap(t.tag,this.onPointerMove),e.hooks.pointerOver.tap(t.tag,this.onPointerMove),e.hooks.pointerOut.tap(t.tag,this.onPointerMove),e.hooks.pointerCancel.tap(t.tag,(function(e){if(!r.supportTouchEvent||"touch"!==e.pointerType){var t=n.normalizeToPointerEvent(e,r);if(n.autoPreventDefault&&t.isNormalized)(e.cancelable||!("cancelable"in e))&&e.preventDefault();var i=n.bootstrapEvent(n.rootPointerEvent,t,r);n.eventService.mapEvent(i),n.setCursor(n.eventService.cursor)}}))},e.prototype.formatTouch=function(e){var t={nativeTouch:e,clientX:e.clientX,clientY:e.clientY,screenX:e.screenX,screenY:e.screenY,viewportX:0,viewportY:0,canvasX:0,canvasY:0,x:0,y:0,target:void 0,force:e.force,identifier:e.identifier,pageX:e.pageX,pageY:e.pageY,radiusX:e.radiusX,radiusY:e.radiusY,rotationAngle:e.rotationAngle},n=this.eventService.client2Viewport(new Si(e.clientX,e.clientY)),r=n.x,i=n.y;t.viewportX=r,t.viewportY=i;var o=this.eventService.viewport2Canvas({x:r,y:i}),a=o.x,s=o.y;return t.canvasX=a,t.canvasY=s,t.x=a,t.y=s,t},e.prototype.bootstrapEvent=function(e,t,n){if(e.pointerType=t.pointerType,"touch"!==e.pointerType){var r=e;r.view=n,r.originalEvent=null,r.nativeEvent=t,r.pointerId=t.pointerId,r.width=t.width,r.height=t.height,r.isPrimary=t.isPrimary,r.pressure=t.pressure,r.tangentialPressure=t.tangentialPressure,r.tiltX=t.tiltX,r.tiltY=t.tiltY,r.twist=t.twist,this.transferMouseData(r,t);var i=this.eventService.client2Viewport(new Si(t.clientX,t.clientY)),o=i.x,a=i.y;r.viewport.x=o,r.viewport.y=a;var s=this.eventService.viewport2Canvas(r.viewport),u=s.x,c=s.y;r.canvas.x=u,r.canvas.y=c,r.global.copyFrom(r.canvas),r.offset.copyFrom(r.canvas),r.isTrusted=t.isTrusted,"pointerleave"===r.type&&(r.type="pointerout"),r.type.startsWith("mouse")&&(r.type=r.type.replace("mouse","pointer"))}else{var l=e,f=t,h=[],d=[];if(f.changedTouches)for(var p=0;p<f.changedTouches.length;p++)h.push(this.formatTouch(f.changedTouches[p]));if(f.touches)for(p=0;p<f.touches.length;p++)d.push(this.formatTouch(f.touches[p]));l.nativeEvent=t,l.isTrusted=t.isTrusted,l.timeStamp=performance.now(),l.type=t.type,l.altKey=t.altKey,l.metaKey=t.metaKey,l.shiftKey=t.shiftKey,l.ctrlKey=t.ctrlKey,l.changedTouches=h,l.touches=d,l.targetTouches=[]}return e},e.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var n=this.eventService.client2Viewport(new Si(e.clientX,e.clientY)),r=n.x,i=n.y;t.viewport.x=r,t.viewport.y=i;var o=this.eventService.viewport2Canvas(t.viewport),a=o.x,s=o.y;return t.canvas.x=a,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},e.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},e.prototype.setCursor=function(e){this.contextService.applyCursorStyle(e||this.canvasConfig.cursor||"default")},e.prototype.normalizeToPointerEvent=function(e,t){if(t.isTouchEvent(e))return e.isNormalized=!0,e.pointerType="touch",e;if(t.isMouseEvent(e)){var n=e;return Di(n.isPrimary)&&(n.isPrimary=!0),Di(n.width)&&(n.width=1),Di(n.height)&&(n.height=1),Di(n.tiltX)&&(n.tiltX=0),Di(n.tiltY)&&(n.tiltY=0),Di(n.pointerType)&&(n.pointerType="mouse"),Di(n.pointerId)&&(n.pointerId=Ma),Di(n.pressure)&&(n.pressure=.5),Di(n.twist)&&(n.twist=0),Di(n.tangentialPressure)&&(n.tangentialPressure=0),n.isNormalized=!0,n}return e},e.tag="Event",Object(l.__decorate)([Object(c.inject)(pa),Object(l.__metadata)("design:type",Object)],e.prototype,"canvasConfig",void 0),Object(l.__decorate)([Object(c.inject)(Ha),Object(l.__metadata)("design:type",Object)],e.prototype,"contextService",void 0),Object(l.__decorate)([Object(c.inject)(bf),Object(l.__metadata)("design:type",bf)],e.prototype,"renderingService",void 0),Object(l.__decorate)([Object(c.inject)(za),Object(l.__metadata)("design:type",Object)],e.prototype,"renderingContext",void 0),Object(l.__decorate)([Object(c.inject)(Rf),Object(l.__metadata)("design:type",Rf)],e.prototype,"eventService",void 0),e=t=Object(l.__decorate)([Object(c.singleton)({contrib:Tf})],e)}(),eh=Object(c.Module)((function(e){c.Contribution.register(e,Tf,{cache:!1}),c.Contribution.register(e,Kf,{cache:!1}),e(bf),e(Rf),e($f),e(Zf),e(Yf),e(qf),e(Qf)}));!function(e){e.READY="ready",e.BEFORE_RENDER="beforerender",e.AFTER_RENDER="afterrender",e.BEFORE_DESTROY="beforedestroy",e.AFTER_DESTROY="afterdestroy",e.RESIZE="resize"}(Gf||(Gf={}));var th=function(e){function t(t){var n=e.call(this)||this;n.container=c.GlobalContainer.createChild(),n.Element=Rs,n.inited=!1,n.document=new nf,n.document.defaultView=n,n.customElements=new Ef;var r=t.container,i=t.canvas,o=t.offscreenCanvas,a=t.width,s=t.height,u=t.devicePixelRatio,l=t.renderer,f=t.background,h=t.requestAnimationFrame,d=t.cancelAnimationFrame,p=t.createImage,v=t.supportPointerEvent,y=t.supportTouchEvent,m=t.isTouchEvent,_=t.isMouseEvent;Fa(r,n);var g=a,E=s,T=u;return i&&(T=(T=u||Ia&&window.devicePixelRatio||1)>=1?Math.ceil(T):1,g=a||i.width/T,E=s||i.height/T),n.devicePixelRatio=T,n.requestAnimationFrame=null!=h?h:zf.b.bind(globalThis),n.cancelAnimationFrame=null!=d?d:zf.a.bind(globalThis),n.supportTouchEvent=null!=y?y:"ontouchstart"in globalThis,n.supportPointerEvent=null!=v?v:!!globalThis.PointerEvent,n.isTouchEvent=null!=m?m:function(e){return n.supportTouchEvent&&e instanceof globalThis.TouchEvent},n.isMouseEvent=null!=_?_:function(e){return!globalThis.MouseEvent||e instanceof globalThis.MouseEvent&&(!n.supportPointerEvent||!(e instanceof globalThis.PointerEvent))},n.initRenderingContext({container:r,canvas:i,width:g,height:E,renderer:l,offscreenCanvas:o,devicePixelRatio:T,cursor:"default",background:f,createImage:p}),n.initDefaultCamera(g,E),n.initRenderer(l),n}return Object(l.__extends)(t,e),t.prototype.initRenderingContext=function(e){var t=this;this.container.register({token:pa,useValue:e}),this.container.register({token:za,useValue:{root:this.document.documentElement,renderReasons:new Set,force:!1,dirty:!1}}),this.document.documentElement.addEventListener(vi.CHILD_INSERTED,(function(e){t.mountChildren(e.detail.child)})),this.document.documentElement.addEventListener(vi.CHILD_REMOVED,(function(e){t.unmountChildren(e.detail.child)}))},t.prototype.initDefaultCamera=function(e,t){var n=(new Hf).setPosition(e/2,t/2,500).setFocalPoint(e/2,t/2,0).setOrthographic(e/-2,e/2,t/2,t/-2,.1,1e3);n.canvas=this;var r=this.container.get(za);n.on(jf.UPDATED,(function(){r.renderReasons.add(ja.CAMERA_CHANGED)})),this.container.register({token:Uf,useValue:n})},t.prototype.getConfig=function(){return this.container.get(pa)},t.prototype.getContainer=function(){return this.container},t.prototype.getRoot=function(){return this.document.documentElement},t.prototype.getCamera=function(){return this.container.get(Uf)},t.prototype.getContextService=function(){return this.container.get(Ha)},t.prototype.getEventService=function(){return this.eventService},t.prototype.getRenderingService=function(){return this.renderingService},t.prototype.getRenderingContext=function(){return this.container.get(za)},t.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(t.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.readyPromise=new Promise((function(t){e.resolveReadyPromise=function(){t(e)}})),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e){(void 0===e&&(e=!0),this.emit(Gf.BEFORE_DESTROY,(function(){})),this.frameId)&&(this.getConfig().cancelAnimationFrame||cancelAnimationFrame)(this.frameId);var t=this.getRoot();this.unmountChildren(t),e&&this.document.destroy(),this.getContextService().destroy(),this.getRenderingService().destroy(),this.emit(Gf.AFTER_DESTROY,{})},t.prototype.changeSize=function(e,t){this.resize(e,t)},t.prototype.resize=function(e,t){var n=this.container.get(pa);n.width=e,n.height=t,this.getContextService().resize(e,t);var r=this.container.get(Uf),i=r.getProjectionMode();r.setPosition(e/2,t/2,500).setFocalPoint(e/2,t/2,0),i===gf.ORTHOGRAPHIC?r.setOrthographic(e/-2,e/2,t/2,t/-2,r.getNear(),r.getFar()):r.setAspect(e/t),this.emit(Gf.RESIZE,{width:e,height:t})},t.prototype.appendChild=function(e,t){return this.document.documentElement.appendChild(e,t)},t.prototype.insertBefore=function(e,t){return this.document.documentElement.insertBefore(e,t)},t.prototype.removeChild=function(e,t){return void 0===t&&(t=!0),this.document.documentElement.removeChild(e,t)},t.prototype.removeChildren=function(e){void 0===e&&(e=!0),this.document.documentElement.removeChildren(e)},t.prototype.render=function(){(this.emit(Gf.BEFORE_RENDER,{}),this.container.isBound(bf))&&this.container.get(bf).render(this.getConfig());this.emit(Gf.AFTER_RENDER,{})},t.prototype.run=function(){var e=this;!function t(){e.render(),e.frameId=requestAnimationFrame(t)}()},t.prototype.initRenderer=function(e){var t=this;if(!e)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.loadCommonContainerModule(),this.loadRendererContainerModule(e);var n=this.container.get(Ha);this.renderingService=this.container.get(bf),this.eventService=this.container.get(Rf),n.init(),this.renderingService.init().then((function(){t.emit(Gf.READY,{}),t.readyPromise&&t.resolveReadyPromise(),t.inited=!0})),e.getConfig().enableAutoRendering&&this.run(),this.getRoot().forEach((function(e){var t=e.renderable;t&&(t.renderBoundsDirty=!0,t.boundsDirty=!0,t.dirty=!0)})),this.mountChildren(this.getRoot())},t.prototype.loadCommonContainerModule=function(){this.container.unload(eh),this.container.load(eh,!0)},t.prototype.loadRendererContainerModule=function(e){var t=this;e.getPlugins().forEach((function(e){e.init(t.container)}))},t.prototype.setRenderer=function(e){var t=this,n=this.getConfig();if(n.renderer!==e){var r=n.renderer;n.renderer=e,this.destroy(!1),null==r||r.getPlugins().reverse().forEach((function(e){e.destroy(t.container)})),this.initRenderer(e)}},t.prototype.setCursor=function(e){this.getContextService().applyCursorStyle(e)},t.prototype.unmountChildren=function(e){var t=this,n=[];e.forEach((function(e){e.isConnected&&n.push(e)})),n.reverse().forEach((function(e){e.emit(vi.UNMOUNTED,{}),e!==t.document.documentElement&&(e.ownerDocument=null),e.isConnected=!1}))},t.prototype.mountChildren=function(e){var t=this;e.forEach((function(e){e.isConnected||(e.ownerDocument=t.document,e.isConnected=!0,e.emit(vi.MOUNTED,{}))}))},t.prototype.client2Viewport=function(e){return this.getEventService().client2Viewport(e)},t.prototype.viewport2Client=function(e){return this.getEventService().viewport2Client(e)},t.prototype.viewport2Canvas=function(e){return this.getEventService().viewport2Canvas(e)},t.prototype.canvas2Viewport=function(e){return this.getEventService().canvas2Viewport(e)},t.prototype.getPointByClient=function(e,t){return this.client2Viewport({x:e,y:t})},t.prototype.getClientByPoint=function(e,t){return this.viewport2Client({x:e,y:t})},t}(Za);c.GlobalContainer.load(kf);var nh=c.GlobalContainer.get(yl)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=n(3),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=i},function(e,t,n){"use strict";var r=n(38),i=n(6),o=n(37),a=n(30),s=n(28),u=n(151),c=n(9),l=n(76),f=n(84),h=n(78),d=n(79),p=n(42),v=n(80),y=[],m=i(y.sort),_=i(y.push),g=c((function(){y.sort(void 0)})),E=c((function(){y.sort(null)})),T=f("sort"),b=!c((function(){if(p)return p<70;if(!(h&&h>3)){if(d)return!0;if(v)return v<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)y.push({k:t+r,v:n})}for(y.sort((function(e,t){return t.v-e.v})),r=0;r<y.length;r++)t=y[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:g||!E||!T||!b},{sort:function(e){void 0!==e&&o(e);var t=a(this);if(b)return void 0===e?m(t):m(t,e);var n,r,i=[],c=s(t);for(r=0;r<c;r++)r in t&&_(i,t[r]);for(l(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<c;)delete t[r++];return t}})},function(e,t,n){"use strict";var r=n(7),i=n(8);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=n(92).deprecate((function(){}),"Hook.context is deprecated and will be removed"),u=function(){return this.call=this._createCall("sync"),this.call.apply(this,arguments)},c=function(){return this.callAsync=this._createCall("async"),this.callAsync.apply(this,arguments)},l=function(){return this.promise=this._createCall("promise"),this.promise.apply(this,arguments)},f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;r(this,e),this._args=t,this.name=n,this.taps=[],this.interceptors=[],this._call=u,this.call=u,this._callAsync=c,this.callAsync=c,this._promise=l,this.promise=l,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}return i(e,[{key:"compile",value:function(e){throw new Error("Abstract: should be overridden")}},{key:"_createCall",value:function(e){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:e})}},{key:"_tap",value:function(e,t,n){if("string"==typeof t)t={name:t.trim()};else if("object"!=typeof t||null===t)throw new Error("Invalid tap options");if("string"!=typeof t.name||""===t.name)throw new Error("Missing name for tap");void 0!==t.context&&s(),t=Object.assign({type:e,fn:n},t),t=this._runRegisterInterceptors(t),this._insert(t)}},{key:"tap",value:function(e,t){this._tap("sync",e,t)}},{key:"tapAsync",value:function(e,t){this._tap("async",e,t)}},{key:"tapPromise",value:function(e,t){this._tap("promise",e,t)}},{key:"_runRegisterInterceptors",value:function(e){var t,n=o(this.interceptors);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.register){var i=r.register(e);void 0!==i&&(e=i)}}}catch(a){n.e(a)}finally{n.f()}return e}},{key:"withOptions",value:function(e){var t=this,n=function(t){return Object.assign({},e,"string"==typeof t?{name:t}:t)};return{name:this.name,tap:function(e,r){return t.tap(n(e),r)},tapAsync:function(e,r){return t.tapAsync(n(e),r)},tapPromise:function(e,r){return t.tapPromise(n(e),r)},intercept:function(e){return t.intercept(e)},isUsed:function(){return t.isUsed()},withOptions:function(e){return t.withOptions(n(e))}}}},{key:"isUsed",value:function(){return this.taps.length>0||this.interceptors.length>0}},{key:"intercept",value:function(e){if(this._resetCompilation(),this.interceptors.push(Object.assign({},e)),e.register)for(var t=0;t<this.taps.length;t++)this.taps[t]=e.register(this.taps[t])}},{key:"_resetCompilation",value:function(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}},{key:"_insert",value:function(e){var t;this._resetCompilation(),"string"==typeof e.before?t=new Set([e.before]):Array.isArray(e.before)&&(t=new Set(e.before));var n=0;"number"==typeof e.stage&&(n=e.stage);for(var r=this.taps.length;r>0;){r--;var i=this.taps[r];this.taps[r+1]=i;var o=i.stage||0;if(t){if(t.has(i.name)){t.delete(i.name);continue}if(t.size>0)continue}if(!(o>n)){r++;break}}this.taps[r]=e}}]),e}();Object.setPrototypeOf(f.prototype,null),e.exports=f},function(e,t,n){var r=n(166);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(167).default,i=n(168);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r=n(7),i=n(8);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(){function e(t){r(this,e),this.config=t,this.options=void 0,this._args=void 0}return i(e,[{key:"create",value:function(e){var t;switch(this.init(e),this.options.type){case"sync":t=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(e){return"throw ".concat(e,";\n")},onResult:function(e){return"return ".concat(e,";\n")},resultReturns:!0,onDone:function(){return""},rethrowIfPossible:!0}));break;case"async":t=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(e){return"_callback(".concat(e,");\n")},onResult:function(e){return"_callback(null, ".concat(e,");\n")},onDone:function(){return"_callback();\n"}}));break;case"promise":var n=!1,r=this.contentWithInterceptors({onError:function(e){return n=!0,"_error(".concat(e,");\n")},onResult:function(e){return"_resolve(".concat(e,");\n")},onDone:function(){return"_resolve();\n"}}),i="";i+='"use strict";\n',i+=this.header(),i+="return new Promise((function(_resolve, _reject) {\n",n&&(i+="var _sync = true;\n",i+="function _error(_err) {\n",i+="if(_sync)\n",i+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",i+="else\n",i+="_reject(_err);\n",i+="};\n"),i+=r,n&&(i+="_sync = false;\n"),i+="}));\n",t=new Function(this.args(),i)}return this.deinit(),t}},{key:"setup",value:function(e,t){e._x=t.taps.map((function(e){return e.fn}))}},{key:"init",value:function(e){this.options=e,this._args=e.args.slice()}},{key:"deinit",value:function(){this.options=void 0,this._args=void 0}},{key:"contentWithInterceptors",value:function(e){var t=this;if(this.options.interceptors.length>0){for(var n=e.onError,r=e.onResult,i=e.onDone,o="",a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.call&&(o+="".concat(this.getInterceptor(a),".call(").concat(this.args({before:s.context?"_context":void 0}),");\n"))}return o+=this.content(Object.assign(e,{onError:n&&function(e){for(var r="",i=0;i<t.options.interceptors.length;i++){t.options.interceptors[i].error&&(r+="".concat(t.getInterceptor(i),".error(").concat(e,");\n"))}return r+=n(e)},onResult:r&&function(e){for(var n="",i=0;i<t.options.interceptors.length;i++){t.options.interceptors[i].result&&(n+="".concat(t.getInterceptor(i),".result(").concat(e,");\n"))}return n+=r(e)},onDone:i&&function(){for(var e="",n=0;n<t.options.interceptors.length;n++){t.options.interceptors[n].done&&(e+="".concat(t.getInterceptor(n),".done();\n"))}return e+=i()}}))}return this.content(e)}},{key:"header",value:function(){var e="";return this.needContext()?e+="var _context = {};\n":e+="var _context;\n",e+="var _x = this._x;\n",this.options.interceptors.length>0&&(e+="var _taps = this.taps;\n",e+="var _interceptors = this.interceptors;\n"),e}},{key:"needContext",value:function(){var e,t=o(this.options.taps);try{for(t.s();!(e=t.n()).done;){if(e.value.context)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"callTap",value:function(e,t){for(var n=t.onError,r=t.onResult,i=t.onDone,o=t.rethrowIfPossible,a="",s=!1,u=0;u<this.options.interceptors.length;u++){var c=this.options.interceptors[u];c.tap&&(s||(a+="var _tap".concat(e," = ").concat(this.getTap(e),";\n"),s=!0),a+="".concat(this.getInterceptor(u),".tap(").concat(c.context?"_context, ":"","_tap").concat(e,");\n"))}a+="var _fn".concat(e," = ").concat(this.getTapFn(e),";\n");var l=this.options.taps[e];switch(l.type){case"sync":o||(a+="var _hasError".concat(e," = false;\n"),a+="try {\n"),a+=r?"var _result".concat(e," = _fn").concat(e,"(").concat(this.args({before:l.context?"_context":void 0}),");\n"):"_fn".concat(e,"(").concat(this.args({before:l.context?"_context":void 0}),");\n"),o||(a+="} catch(_err) {\n",a+="_hasError".concat(e," = true;\n"),a+=n("_err"),a+="}\n",a+="if(!_hasError".concat(e,") {\n")),r&&(a+=r("_result".concat(e))),i&&(a+=i()),o||(a+="}\n");break;case"async":var f="";f+=r?"(function(_err".concat(e,", _result").concat(e,") {\n"):"(function(_err".concat(e,") {\n"),f+="if(_err".concat(e,") {\n"),f+=n("_err".concat(e)),f+="} else {\n",r&&(f+=r("_result".concat(e))),i&&(f+=i()),f+="}\n",f+="})",a+="_fn".concat(e,"(").concat(this.args({before:l.context?"_context":void 0,after:f}),");\n");break;case"promise":a+="var _hasResult".concat(e," = false;\n"),a+="var _promise".concat(e," = _fn").concat(e,"(").concat(this.args({before:l.context?"_context":void 0}),");\n"),a+="if (!_promise".concat(e," || !_promise").concat(e,".then)\n"),a+="  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise".concat(e," + ')');\n"),a+="_promise".concat(e,".then((function(_result").concat(e,") {\n"),a+="_hasResult".concat(e," = true;\n"),r&&(a+=r("_result".concat(e))),i&&(a+=i()),a+="}), function(_err".concat(e,") {\n"),a+="if(_hasResult".concat(e,") throw _err").concat(e,";\n"),a+=n("_err".concat(e)),a+="});\n"}return a}},{key:"callTapsSeries",value:function(e){var t=this,n=e.onError,r=e.onResult,i=e.resultReturns,o=e.onDone,a=e.doneReturns,s=e.rethrowIfPossible;if(0===this.options.taps.length)return o();for(var u=this.options.taps.findIndex((function(e){return"sync"!==e.type})),c=i||a,l="",f=o,h=0,d=function(e){var i=e;f!==o&&("sync"!==t.options.taps[i].type||h++>20)&&(h=0,l+="function _next".concat(i,"() {\n"),l+=f(),l+="}\n",f=function(){return"".concat(c?"return ":"","_next").concat(i,"();\n")});var a=f,d=function(e){return e?"":o()},p=t.callTap(i,{onError:function(e){return n(i,e,a,d)},onResult:r&&function(e){return r(i,e,a,d)},onDone:!r&&a,rethrowIfPossible:s&&(u<0||i<u)});f=function(){return p}},p=this.options.taps.length-1;p>=0;p--)d(p);return l+=f()}},{key:"callTapsLooping",value:function(e){var t=e.onError,n=e.onDone,r=e.rethrowIfPossible;if(0===this.options.taps.length)return n();var i=this.options.taps.every((function(e){return"sync"===e.type})),o="";i||(o+="var _looper = (function() {\n",o+="var _loopAsync = false;\n"),o+="var _loop;\n",o+="do {\n",o+="_loop = false;\n";for(var a=0;a<this.options.interceptors.length;a++){var s=this.options.interceptors[a];s.loop&&(o+="".concat(this.getInterceptor(a),".loop(").concat(this.args({before:s.context?"_context":void 0}),");\n"))}return o+=this.callTapsSeries({onError:t,onResult:function(e,t,n,r){var o="";return o+="if(".concat(t," !== undefined) {\n"),o+="_loop = true;\n",i||(o+="if(_loopAsync) _looper();\n"),o+=r(!0),o+="} else {\n",o+=n(),o+="}\n"},onDone:n&&function(){var e="";return e+="if(!_loop) {\n",e+=n(),e+="}\n"},rethrowIfPossible:r&&i}),o+="} while(_loop);\n",i||(o+="_loopAsync = true;\n",o+="});\n",o+="_looper();\n"),o}},{key:"callTapsParallel",value:function(e){var t=this,n=e.onError,r=e.onResult,i=e.onDone,o=e.rethrowIfPossible,a=e.onTap,s=void 0===a?function(e,t){return t()}:a;if(this.options.taps.length<=1)return this.callTapsSeries({onError:n,onResult:r,onDone:i,rethrowIfPossible:o});var u="";u+="do {\n",u+="var _counter = ".concat(this.options.taps.length,";\n"),i&&(u+="var _done = (function() {\n",u+=i(),u+="});\n");for(var c=function(e){var a=function(){return i?"if(--_counter === 0) _done();\n":"--_counter;"},c=function(e){return e||!i?"_counter = 0;\n":"_counter = 0;\n_done();\n"};u+="if(_counter <= 0) break;\n",u+=s(e,(function(){return t.callTap(e,{onError:function(t){var r="";return r+="if(_counter > 0) {\n",r+=n(e,t,a,c),r+="}\n"},onResult:r&&function(t){var n="";return n+="if(_counter > 0) {\n",n+=r(e,t,a,c),n+="}\n"},onDone:!r&&function(){return a()},rethrowIfPossible:o})}),a,c)},l=0;l<this.options.taps.length;l++)c(l);return u+="} while(false);\n"}},{key:"args",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.before,n=e.after,r=this._args;return t&&(r=[t].concat(r)),n&&(r=r.concat(n)),0===r.length?"":r.join(", ")}},{key:"getTapFn",value:function(e){return"_x[".concat(e,"]")}},{key:"getTap",value:function(e){return"_taps[".concat(e,"]")}},{key:"getInterceptor",value:function(e){return"_interceptors[".concat(e,"]")}}]),e}();e.exports=s},function(e,t,n){var r=n(6),i=n(30),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=t.getServiceIdentifierAsString=t.typeConstraint=t.namedConstraint=t.taggedConstraint=t.traverseAncerstors=t.decorate=t.id=t.MetadataReader=t.postConstruct=t.targetName=t.multiInject=t.unmanaged=t.optional=t.LazyServiceIdentifer=t.inject=t.named=t.tagged=t.injectable=t.ContainerModule=t.AsyncContainerModule=t.TargetTypeEnum=t.BindingTypeEnum=t.BindingScopeEnum=t.Container=t.METADATA_KEY=void 0;var r=n(3);t.METADATA_KEY=r;var i=n(116);Object.defineProperty(t,"Container",{enumerable:!0,get:function(){return i.Container}});var o=n(23);Object.defineProperty(t,"BindingScopeEnum",{enumerable:!0,get:function(){return o.BindingScopeEnum}}),Object.defineProperty(t,"BindingTypeEnum",{enumerable:!0,get:function(){return o.BindingTypeEnum}}),Object.defineProperty(t,"TargetTypeEnum",{enumerable:!0,get:function(){return o.TargetTypeEnum}});var a=n(141);Object.defineProperty(t,"AsyncContainerModule",{enumerable:!0,get:function(){return a.AsyncContainerModule}}),Object.defineProperty(t,"ContainerModule",{enumerable:!0,get:function(){return a.ContainerModule}});var s=n(142);Object.defineProperty(t,"injectable",{enumerable:!0,get:function(){return s.injectable}});var u=n(143);Object.defineProperty(t,"tagged",{enumerable:!0,get:function(){return u.tagged}});var c=n(144);Object.defineProperty(t,"named",{enumerable:!0,get:function(){return c.named}});var l=n(87);Object.defineProperty(t,"inject",{enumerable:!0,get:function(){return l.inject}}),Object.defineProperty(t,"LazyServiceIdentifer",{enumerable:!0,get:function(){return l.LazyServiceIdentifer}});var f=n(145);Object.defineProperty(t,"optional",{enumerable:!0,get:function(){return f.optional}});var h=n(146);Object.defineProperty(t,"unmanaged",{enumerable:!0,get:function(){return h.unmanaged}});var d=n(147);Object.defineProperty(t,"multiInject",{enumerable:!0,get:function(){return d.multiInject}});var p=n(148);Object.defineProperty(t,"targetName",{enumerable:!0,get:function(){return p.targetName}});var v=n(149);Object.defineProperty(t,"postConstruct",{enumerable:!0,get:function(){return v.postConstruct}});var y=n(85);Object.defineProperty(t,"MetadataReader",{enumerable:!0,get:function(){return y.MetadataReader}});var m=n(29);Object.defineProperty(t,"id",{enumerable:!0,get:function(){return m.id}});var _=n(26);Object.defineProperty(t,"decorate",{enumerable:!0,get:function(){return _.decorate}});var g=n(90);Object.defineProperty(t,"traverseAncerstors",{enumerable:!0,get:function(){return g.traverseAncerstors}}),Object.defineProperty(t,"taggedConstraint",{enumerable:!0,get:function(){return g.taggedConstraint}}),Object.defineProperty(t,"namedConstraint",{enumerable:!0,get:function(){return g.namedConstraint}}),Object.defineProperty(t,"typeConstraint",{enumerable:!0,get:function(){return g.typeConstraint}});var E=n(39);Object.defineProperty(t,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return E.getServiceIdentifierAsString}});var T=n(150);Object.defineProperty(t,"multiBindToService",{enumerable:!0,get:function(){return T.multiBindToService}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TargetTypeEnum=t.BindingTypeEnum=t.BindingScopeEnum=void 0;t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(e,t,n){var r=n(38),i=Math.hypot,o=Math.abs,a=Math.sqrt;r({target:"Math",stat:!0,forced:!!i&&i(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,r,i=0,s=0,u=arguments.length,c=0;s<u;)c<(n=o(arguments[s++]))?(i=i*(r=c/n)*r+1,c=n):i+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*a(i)}})},function(e,t,n){var r=n(9);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tagProperty=t.tagParameter=t.decorate=void 0;var r=n(10),i=n(3);function o(e,t,n,i,o){var a={},s="number"==typeof o,u=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var c=a[u];if(Array.isArray(c))for(var l=0,f=c;l<f.length;l++){var h=f[l];if(h.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+h.key.toString())}else c=[];c.push(i),a[u]=c,Reflect.defineMetadata(e,a,t)}function a(e,t){Reflect.decorate(e,t)}function s(e,t){return function(n,r){t(n,r,e)}}t.tagParameter=function(e,t,n,r){o(i.TAGGED,e,t,r,n)},t.tagProperty=function(e,t,n){o(i.TAGGED_PROP,e.constructor,t,n)},t.decorate=function(e,t,n){"number"==typeof n?a([s(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):a([e],t)}},function(e,t,n){var r=n(5);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},function(e,t,n){var r=n(111);e.exports=function(e){return r(e.length)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.id=void 0;var r=0;t.id=function(){return r++}},function(e,t,n){var r=n(2),i=n(65),o=r.Object;e.exports=function(e){return o(i(e))}},function(e,t,n){var r=n(2),i=n(66),o=n(21),a=n(53),s=n(67),u=n(68),c=i("wks"),l=r.Symbol,f=l&&l.for,h=u?l:l&&l.withoutSetter||a;e.exports=function(e){if(!o(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&o(l,e)?c[e]=l[e]:c[e]=u&&f?f(t):h(t)}return c[e]}},function(e,t,n){var r=n(2),i=n(25),o=n(70),a=n(72),s=n(36),u=n(54),c=r.TypeError,l=Object.defineProperty,f=Object.getOwnPropertyDescriptor;t.f=i?a?function(e,t,n){if(s(e),t=u(t),s(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=f(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(s(e),t=u(t),s(n),o)try{return l(e,t,n)}catch(r){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var r=n(38),i=n(124).left,o=n(84),a=n(42),s=n(125);r({target:"Array",proto:!0,forced:!o("reduce")||!s&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return i(this,e,t,t>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),u=i?i+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},c.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,r);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&u(this,t)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,e.exports=c},function(e,t,n){var r=n(2),i=n(5),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},function(e,t,n){var r=n(2),i=n(27),o=r.String,a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not an object")}},function(e,t,n){var r=n(2),i=n(5),o=n(69),a=r.TypeError;e.exports=function(e){if(i(e))return e;throw a(o(e)+" is not a function")}},function(e,t,n){var r=n(2),i=n(81).f,o=n(45),a=n(75),s=n(52),u=n(118),c=n(123);e.exports=function(e,t){var n,l,f,h,d,p=e.target,v=e.global,y=e.stat;if(n=v?r:y?r[p]||s(p,{}):(r[p]||{}).prototype)for(l in t){if(h=t[l],f=e.noTargetGet?(d=i(n,l))&&d.value:n[l],!c(v?l:p+(y?".":"#")+l,e.forced)&&void 0!==f){if(typeof h==typeof f)continue;u(h,f)}(e.sham||f&&f.sham)&&o(h,"sham",!0),a(n,l,h,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.circularDependencyToException=t.listMetadataForTarget=t.listRegisteredBindingsForServiceIdentifier=t.getServiceIdentifierAsString=t.getFunctionName=void 0;var r=n(10);function i(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function o(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=i,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=o(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r},t.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(function e(t,n){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===n||e(t.parentRequest,n))}(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var r=i(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},t.getFunctionName=o},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(49),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},function(e,t,n){var r,i,o=n(2),a=n(43),s=o.process,u=o.Deno,c=s&&s.versions||u&&u.version,l=c&&c.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},function(e,t,n){var r=n(35);e.exports=r("navigator","userAgent")||""},function(e,t,n){var r=n(6),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},function(e,t,n){var r=n(25),i=n(32),o=n(55);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){var t=+e;return t!=t||0===t?0:(t>0?r:n)(t)}},function(e,t,n){var r=n(82),i=n(65);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));r();function r(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}}).call(this,n(40))},function(e,t,n){var r=n(9);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,t,n){var r=n(2),i=n(99),o=n(5),a=n(44),s=n(31)("toStringTag"),u=r.Object,c="Arguments"==a(function(){return arguments}());e.exports=i?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=u(e),s))?n:c?a(t):"Object"==(r=a(t))&&o(t.callee)?"Arguments":r}},function(e,t,n){var r=n(2),i=n(52),o=r["__core-js_shared__"]||i("__core-js_shared__",{});e.exports=o},function(e,t,n){var r=n(2),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(6),i=0,o=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},function(e,t,n){var r=n(101),i=n(73);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(6),i=n(5),o=n(51),a=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},function(e,t,n){var r=n(66),i=n(53),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports={}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingOnSyntax=void 0;var r=n(61),i=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new r.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingWhenSyntax=void 0;var r=n(60),i=n(90),o=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=i.namedConstraint(e),new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=i.taggedConstraint(e)(t),new r.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return i.typeConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return i.namedConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return i.taggedConstraint(e)(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=o},function(e,t,n){n(180)},function(e,t,n){(function(e,t){var r;n(11),n(12),function(n){!function(r){var i="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=a(n);function a(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===i.Reflect?i.Reflect=n:o=a(i.Reflect,o),function(t){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,u=!a&&!s,c={create:a?function(){return I(Object.create(null))}:s?function(){return I({__proto__:null})}:function(){return I({})},has:u?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),f="object"==typeof e&&{}&&"true"==={}.REFLECT_METADATA_USE_MAP_POLYFILL,h=f||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}():Map,d=f||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}():Set,p=new(f||"function"!=typeof WeakMap?function(){var e=c.create(),t=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var t;do{t="@@WeakMap@@"+a()}while(c.has(e,t));return e[t]=!0,t}function i(e,r){if(!n.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:c.create()})}return e[t]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function a(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<16;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function v(e,t,n){var r=p.get(e);if(T(r)){if(!n)return;r=new h,p.set(e,r)}var i=r.get(t);if(T(i)){if(!n)return;i=new h,r.set(t,i)}return i}function y(e,t,n){var r=v(t,n,!1);return!T(r)&&!!r.has(e)}function m(e,t,n){var r=v(t,n,!1);if(!T(r))return r.get(e)}function _(e,t,n,r){v(n,r,!0).set(e,t)}function g(e,t){var n=[],r=v(e,t,!1);if(T(r))return n;for(var i=function(e){var t=x(e,o);if(!C(t))throw new TypeError;var n=t.call(e);if(!S(n))throw new TypeError;return n}(r.keys()),a=0;;){var s=P(i);if(!s)return n.length=a,n;var u=s.value;try{n[a]=u}catch(c){try{N(i)}finally{throw c}}a++}}function E(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function T(e){return void 0===e}function b(e){return null===e}function S(e){return"object"==typeof e?null!==e:"function"==typeof e}function R(e,t){switch(E(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=x(e,i);if(void 0!==r){var o=r.call(e,n);if(S(o))throw new TypeError;return o}return function(e,t){if("string"===t){var n=e.toString;if(C(n))if(!S(i=n.call(e)))return i;if(C(r=e.valueOf))if(!S(i=r.call(e)))return i}else{var r;if(C(r=e.valueOf))if(!S(i=r.call(e)))return i;var i,o=e.toString;if(C(o))if(!S(i=o.call(e)))return i}throw new TypeError}(e,"default"===n?"number":n)}function A(e){var t=R(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function O(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function C(e){return"function"==typeof e}function M(e){return"function"==typeof e}function x(e,t){var n=e[t];if(null!=n){if(!C(n))throw new TypeError;return n}}function P(e){var t=e.next();return!t.done&&t}function N(e){var t=e.return;t&&t.call(e)}function F(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function I(e){return e.__=void 0,delete e.__,e}t("decorate",(function(e,t,n,r){if(T(n)){if(!O(e))throw new TypeError;if(!M(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!T(r)&&!b(r)){if(!M(r))throw new TypeError;t=r}}return t}(e,t)}if(!O(e))throw new TypeError;if(!S(t))throw new TypeError;if(!S(r)&&!T(r)&&!b(r))throw new TypeError;return b(r)&&(r=void 0),function(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!T(o)&&!b(o)){if(!S(o))throw new TypeError;r=o}}return r}(e,t,n=A(n),r)})),t("metadata",(function(e,t){return function(n,r){if(!S(n))throw new TypeError;if(!T(r)&&!function(e){switch(E(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;_(e,t,n,r)}})),t("defineMetadata",(function(e,t,n,r){if(!S(n))throw new TypeError;return T(r)||(r=A(r)),_(e,t,n,r)})),t("hasMetadata",(function(e,t,n){if(!S(t))throw new TypeError;return T(n)||(n=A(n)),function e(t,n,r){if(y(t,n,r))return!0;var i=F(n);return!b(i)&&e(t,i,r)}(e,t,n)})),t("hasOwnMetadata",(function(e,t,n){if(!S(t))throw new TypeError;return T(n)||(n=A(n)),y(e,t,n)})),t("getMetadata",(function(e,t,n){if(!S(t))throw new TypeError;return T(n)||(n=A(n)),function e(t,n,r){if(y(t,n,r))return m(t,n,r);var i=F(n);return b(i)?void 0:e(t,i,r)}(e,t,n)})),t("getOwnMetadata",(function(e,t,n){if(!S(t))throw new TypeError;return T(n)||(n=A(n)),m(e,t,n)})),t("getMetadataKeys",(function(e,t){if(!S(e))throw new TypeError;return T(t)||(t=A(t)),function e(t,n){var r=g(t,n),i=F(t);if(null===i)return r;var o=e(i,n);if(o.length<=0)return r;if(r.length<=0)return o;for(var a=new d,s=[],u=0,c=r;u<c.length;u++){var l=c[u];a.has(l)||(a.add(l),s.push(l))}for(var f=0,h=o;f<h.length;f++){l=h[f];a.has(l)||(a.add(l),s.push(l))}return s}(e,t)})),t("getOwnMetadataKeys",(function(e,t){if(!S(e))throw new TypeError;return T(t)||(t=A(t)),g(e,t)})),t("deleteMetadata",(function(e,t,n){if(!S(t))throw new TypeError;T(n)||(n=A(n));var r=v(t,n,!1);if(T(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=p.get(t);return i.delete(n),i.size>0||p.delete(t),!0}))}(o)}()}(r||(r={}))}).call(this,n(97),n(40))},function(e,t,n){"use strict";var r,i,o,a=n(98),s=n(25),u=n(2),c=n(5),l=n(27),f=n(21),h=n(50),d=n(69),p=n(45),v=n(75),y=n(32).f,m=n(74),_=n(107),g=n(109),E=n(31),T=n(53),b=u.Int8Array,S=b&&b.prototype,R=u.Uint8ClampedArray,A=R&&R.prototype,O=b&&_(b),C=S&&_(S),M=Object.prototype,x=u.TypeError,P=E("toStringTag"),N=T("TYPED_ARRAY_TAG"),F=T("TYPED_ARRAY_CONSTRUCTOR"),I=a&&!!g&&"Opera"!==h(u.opera),D=!1,L={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},B={BigInt64Array:8,BigUint64Array:8},w=function(e){if(!l(e))return!1;var t=h(e);return f(L,t)||f(B,t)};for(r in L)(o=(i=u[r])&&i.prototype)?p(o,F,i):I=!1;for(r in B)(o=(i=u[r])&&i.prototype)&&p(o,F,i);if((!I||!c(O)||O===Function.prototype)&&(O=function(){throw x("Incorrect invocation")},I))for(r in L)u[r]&&g(u[r],O);if((!I||!C||C===M)&&(C=O.prototype,I))for(r in L)u[r]&&g(u[r].prototype,C);if(I&&_(A)!==C&&g(A,C),s&&!f(C,P))for(r in D=!0,y(C,P,{get:function(){return l(this)?this[N]:void 0}}),L)u[r]&&p(u[r],N,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:I,TYPED_ARRAY_CONSTRUCTOR:F,TYPED_ARRAY_TAG:D&&N,aTypedArray:function(e){if(w(e))return e;throw x("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!g||m(O,e)))return e;throw x(d(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(s){if(n)for(var i in L){var o=u[i];if(o&&f(o.prototype,e))try{delete o.prototype[e]}catch(a){try{o.prototype[e]=t}catch(c){}}}C[e]&&!n||v(C,e,n?t:I&&S[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(s){if(g){if(n)for(r in L)if((i=u[r])&&f(i,e))try{delete i[e]}catch(o){}if(O[e]&&!n)return;try{return v(O,e,n?t:I&&O[e]||t)}catch(o){}}for(r in L)!(i=u[r])||i[e]&&!n||v(i,e,t)}},isView:function(e){if(!l(e))return!1;var t=h(e);return"DataView"===t||f(L,t)||f(B,t)},isTypedArray:w,TypedArray:O,TypedArrayPrototype:C}},function(e,t,n){var r=n(2).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},function(e,t,n){var r=n(100),i=n(51);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.1",mode:r?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,n){var r=n(42),i=n(9);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(e,t,n){var r=n(67);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(2).String;e.exports=function(e){try{return r(e)}catch(t){return"Object"}}},function(e,t,n){var r=n(25),i=n(9),o=n(71);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(2),i=n(27),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(25),i=n(9);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,t,n){var r=n(2),i=n(35),o=n(5),a=n(74),s=n(68),u=r.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&a(t.prototype,u(e))}},function(e,t,n){var r=n(6);e.exports=r({}.isPrototypeOf)},function(e,t,n){var r=n(2),i=n(5),o=n(21),a=n(45),s=n(52),u=n(56),c=n(104),l=n(106).CONFIGURABLE,f=c.get,h=c.enforce,d=String(String).split("String");(e.exports=function(e,t,n,u){var c,f=!!u&&!!u.unsafe,p=!!u&&!!u.enumerable,v=!!u&&!!u.noTargetGet,y=u&&void 0!==u.name?u.name:t;i(n)&&("Symbol("===String(y).slice(0,7)&&(y="["+String(y).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||l&&n.name!==y)&&a(n,"name",y),(c=h(n)).source||(c.source=d.join("string"==typeof y?y:""))),e!==r?(f?!v&&e[t]&&(p=!0):delete e[t],p?e[t]=n:a(e,t,n)):p?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return i(this)&&f(this).source||u(this)}))},function(e,t,n){var r=n(114),i=Math.floor,o=function(e,t){var n=e.length,u=i(n/2);return n<8?a(e,t):s(e,o(r(e,0,u),t),o(r(e,u),t),t)},a=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},s=function(e,t,n,r){for(var i=t.length,o=n.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?r(t[a],n[s])<=0?t[a++]:n[s++]:a<i?t[a++]:n[s++];return e};e.exports=o},function(e,t,n){var r=n(46),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t,n){var r=n(43).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},function(e,t,n){var r=n(43);e.exports=/MSIE|Trident/.test(r)},function(e,t,n){var r=n(43).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},function(e,t,n){var r=n(25),i=n(41),o=n(117),a=n(55),s=n(47),u=n(54),c=n(21),l=n(70),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=s(e),t=u(t),l)try{return f(e,t)}catch(n){}if(c(e,t))return a(!i(o.f,e,t),e[t])}},function(e,t,n){var r=n(2),i=n(6),o=n(9),a=n(44),s=r.Object,u=i("".split);e.exports=o((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?u(e,""):s(e)}:s},function(e,t,n){var r=n(6),i=n(21),o=n(47),a=n(121).indexOf,s=n(58),u=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,l=[];for(n in r)!i(s,n)&&i(r,n)&&u(l,n);for(;t.length>c;)i(r,n=t[c++])&&(~a(l,n)||u(l,n));return l}},function(e,t,n){"use strict";var r=n(9);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataReader=void 0;var r=n(3),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(r.TAGGED_PROP,e)||[]},e}();t.MetadataReader=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStackOverflowExeption=void 0;var r=n(10);t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===r.STACK_OVERFLOW}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inject=t.LazyServiceIdentifer=void 0;var r=n(10),i=n(3),o=n(14),a=n(26),s=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=s,t.inject=function(e){return function(t,n,s){if(void 0===e)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(t.name));var u=new o.Metadata(i.INJECT_TAG,e);"number"==typeof s?a.tagParameter(t,n,s,u):a.tagProperty(t,n,u)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Target=void 0;var r=n(3),i=n(29),o=n(14),a=n(132),s=function(){function e(e,t,n,s){this.id=i.id(),this.type=e,this.serviceIdentifier=n,this.name=new a.QueryableString(t||""),this.metadata=new Array;var u=null;"string"==typeof s?u=new o.Metadata(r.NAMED_TAG,s):s instanceof o.Metadata&&(u=s),null!==u&&this.metadata.push(u)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(r.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return r.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===r.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return r.NON_CUSTOM_TAG_KEYS.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(r.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}();t.Target=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingWhenOnSyntax=void 0;var r=n(60),i=n(61),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeConstraint=t.namedConstraint=t.taggedConstraint=t.traverseAncerstors=void 0;var r=n(3),i=n(14);t.traverseAncerstors=function e(t,n){var r=t.parentRequest;return null!==r&&(!!n(r)||e(r,n))};var o=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new i.Metadata(e,t),n}};t.taggedConstraint=o;var a=o(r.NAMED_TAG);t.namedConstraint=a;t.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}}},function(e,t,n){var r=n(44);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";t.deprecate=function(e,t){var n=!0;return function(){return n&&(console.warn("DeprecationWarning: "+t),n=!1),e.apply(this,arguments)}}},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(O){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof f?t:f,o=Object.create(i.prototype),a=new S(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(O){return{type:"throw",arg:O}}}e.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};s(p,i,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(R([])));y&&y!==t&&n.call(y,i)&&(p=y);var m=d.prototype=f.prototype=Object.create(p);function _(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function g(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function R(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:A}}function A(){return{value:void 0,done:!0}}return h.prototype=d,s(m,"constructor",d),s(d,"constructor",h),h.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},_(g.prototype),s(g.prototype,o,(function(){return this})),e.AsyncIterator=g,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new g(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(m),s(m,a,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;b(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=r}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},,,,function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=s(h);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(e,t,n){var r={};r[n(31)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t){e.exports=!1},function(e,t,n){var r=n(2),i=n(41),o=n(27),a=n(73),s=n(102),u=n(103),c=n(31),l=r.TypeError,f=c("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,r=s(e,f);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||a(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),u(e,t)}},function(e,t,n){var r=n(37);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},function(e,t,n){var r=n(2),i=n(41),o=n(5),a=n(27),s=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!a(r=i(n,e)))return r;if(o(n=e.valueOf)&&!a(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!a(r=i(n,e)))return r;throw s("Can't convert object to primitive value")}},function(e,t,n){var r,i,o,a=n(105),s=n(2),u=n(6),c=n(27),l=n(45),f=n(21),h=n(51),d=n(57),p=n(58),v=s.TypeError,y=s.WeakMap;if(a||h.state){var m=h.state||(h.state=new y),_=u(m.get),g=u(m.has),E=u(m.set);r=function(e,t){if(g(m,e))throw new v("Object already initialized");return t.facade=e,E(m,e,t),t},i=function(e){return _(m,e)||{}},o=function(e){return g(m,e)}}else{var T=d("state");p[T]=!0,r=function(e,t){if(f(e,T))throw new v("Object already initialized");return t.facade=e,l(e,T,t),t},i=function(e){return f(e,T)?e[T]:{}},o=function(e){return f(e,T)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(2),i=n(5),o=n(56),a=r.WeakMap;e.exports=i(a)&&/native code/.test(o(a))},function(e,t,n){var r=n(25),i=n(21),o=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,s=i(o,"name"),u=s&&"something"===function(){}.name,c=s&&(!r||r&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:u,CONFIGURABLE:c}},function(e,t,n){var r=n(2),i=n(21),o=n(5),a=n(30),s=n(57),u=n(108),c=s("IE_PROTO"),l=r.Object,f=l.prototype;e.exports=u?l.getPrototypeOf:function(e){var t=a(e);if(i(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?f:null}},function(e,t,n){var r=n(9);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(6),i=n(36),o=n(110);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(a){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},function(e,t,n){var r=n(2),i=n(5),o=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw a("Can't set "+o(e)+" as a prototype")}},function(e,t,n){var r=n(46),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(2),i=n(113),o=r.RangeError;e.exports=function(e,t){var n=i(e);if(n%t)throw o("Wrong offset");return n}},function(e,t,n){var r=n(2),i=n(46),o=r.RangeError;e.exports=function(e){var t=i(e);if(t<0)throw o("The argument can't be less than 0");return t}},function(e,t,n){var r=n(2),i=n(77),o=n(28),a=n(115),s=r.Array,u=Math.max;e.exports=function(e,t,n){for(var r=o(e),c=i(t,r),l=i(void 0===n?r:n,r),f=s(u(l-c,0)),h=0;c<l;c++,h++)a(f,h,e[c]);return f.length=h,f}},function(e,t,n){"use strict";var r=n(54),i=n(32),o=n(55);e.exports=function(e,t,n){var a=r(t);a in e?i.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){"use strict";n(33);var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;var a=n(126),s=n(10),u=n(23),c=n(3),l=n(85),f=n(127),h=n(134),d=n(136),p=n(29),v=n(39),y=n(139),m=n(140),_=function(){function e(e){this._appliedMiddleware=[];var t=e||{};if("object"!=typeof t)throw new Error(""+s.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=u.BindingScopeEnum.Transient;else if(t.defaultScope!==u.BindingScopeEnum.Singleton&&t.defaultScope!==u.BindingScopeEnum.Transient&&t.defaultScope!==u.BindingScopeEnum.Request)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=p.id(),this._bindingDictionary=new m.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new l.MetadataReader}return e.merge=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=new e,s=o([t,n],r).map((function(e){return f.getBindingDictionary(e)})),u=f.getBindingDictionary(a);function c(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s.forEach((function(e){c(e,u)})),a},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(this,void 0,void 0,(function(){var t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,i.label=1;case 1:return n<r.length?(o=r[n],a=t(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||u.BindingScopeEnum.Transient,n=new a.Binding(e,t);return this._bindingDictionary.add(e,n),new d.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(s.CANNOT_UNBIND+" "+v.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new m.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,c.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=f.createMockRequest(this,e,t,n);r=i.some((function(e){return e.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(y.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(s.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,u.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,u.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,c.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,u.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,u.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,c.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach((function(e){t.applyMiddleware(e)})),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind.bind(e)(r);return t(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=e.bind.bind(e)(n);return t(r,i),r}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(r),unbindFunction:function(t){e.unbind.bind(e)(t)}};var i}},e.prototype._get=function(e,t,n,r,i,o){var a=null,u={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(u)))throw new Error(s.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(u);return a},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=f.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),h.resolve(n)}},e}();t.Container=_},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(21),i=n(119),o=n(81),a=n(32);e.exports=function(e,t,n){for(var s=i(t),u=a.f,c=o.f,l=0;l<s.length;l++){var f=s[l];r(e,f)||n&&r(n,f)||u(e,f,c(t,f))}}},function(e,t,n){var r=n(35),i=n(6),o=n(120),a=n(122),s=n(36),u=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(s(e)),n=a.f;return n?u(t,n(e)):t}},function(e,t,n){var r=n(83),i=n(59).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(47),i=n(77),o=n(28),a=function(e){return function(t,n,a){var s,u=r(t),c=o(u),l=i(a,c);if(e&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(9),i=n(5),o=/#|\.prototype\./,a=function(e,t){var n=u[s(e)];return n==l||n!=c&&(i(t)?r(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},u=a.data={},c=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},function(e,t,n){var r=n(2),i=n(37),o=n(30),a=n(82),s=n(28),u=r.TypeError,c=function(e){return function(t,n,r,c){i(n);var l=o(t),f=a(l),h=s(l),d=e?h-1:0,p=e?-1:1;if(r<2)for(;;){if(d in f){c=f[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw u("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in f&&(c=n(c,f[d],d,l));return c}};e.exports={left:c(!1),right:c(!0)}},function(e,t,n){var r=n(44),i=n(2);e.exports="process"==r(i.process)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Binding=void 0;var r=n(23),i=n(29),o=function(){function e(e,t){this.id=i.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===r.BindingScopeEnum.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBindingDictionary=t.createMockRequest=t.plan=void 0;var r=n(128),i=n(10),o=n(23),a=n(3),s=n(86),u=n(39),c=n(129),l=n(14),f=n(130),h=n(131),d=n(133),p=n(88);function v(e){return e._bindingDictionary}function y(e,t,n,o,a){var s=m(n.container,a.serviceIdentifier),c=[];return s.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&e.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),s=m(n.container,a.serviceIdentifier)),c=t?s:s.filter((function(e){var t=new d.Request(e.serviceIdentifier,n,o,e,a);return e.constraint(t)})),function(e,t,n,o){switch(t.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var a=u.getServiceIdentifierAsString(e),s=i.NOT_REGISTERED;throw s+=u.listMetadataForTarget(a,n),s+=u.listRegisteredBindingsForServiceIdentifier(o,a,m),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;a=u.getServiceIdentifierAsString(e),s=i.AMBIGUOUS_MATCH+" "+a;throw s+=u.listRegisteredBindingsForServiceIdentifier(o,a,m),new Error(s)}}(a.serviceIdentifier,c,a,n.container),c}function m(e,t){var n=[],r=v(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=m(e.parent,t)),n}t.getBindingDictionary=v,t.plan=function(e,t,n,r,v,m,_,g){void 0===g&&(g=!1);var E=new c.Context(t),T=function(e,t,n,r,i,o){var s=e?a.MULTI_INJECT_TAG:a.INJECT_TAG,u=new l.Metadata(s,n),c=new p.Target(t,r,n,u);if(void 0!==i){var f=new l.Metadata(i,o);c.metadata.push(f)}return c}(n,r,v,"",m,_);try{return function e(t,n,r,a,s,u){var c,l;if(null===s){c=y(t,n,a,null,u),l=new d.Request(r,a,null,c,u);var p=new f.Plan(a,l);a.addPlan(p)}else c=y(t,n,a,s,u),l=s.addChildRequest(u.serviceIdentifier,c,u);c.forEach((function(n){var r=null;if(u.isArray())r=l.addChildRequest(n.serviceIdentifier,n,u);else{if(n.cache)return;r=l}if(n.type===o.BindingTypeEnum.Instance&&null!==n.implementationType){var s=h.getDependencies(t,n.implementationType);if(!a.container.options.skipBaseClassChecks){var c=h.getBaseClassDependencyCount(t,n.implementationType);if(s.length<c){var f=i.ARGUMENTS_LENGTH_MISMATCH(h.getFunctionName(n.implementationType));throw new Error(f)}}s.forEach((function(n){e(t,!1,n.serviceIdentifier,a,r,n)}))}}))}(e,g,v,E,null,T),E}catch(b){throw s.isStackOverflowExeption(b)&&E.plan&&u.circularDependencyToException(E.plan.rootRequest),b}},t.createMockRequest=function(e,t,n,r){var i=new p.Target(o.TargetTypeEnum.Variable,"",t,new l.Metadata(n,r)),a=new c.Context(e);return new d.Request(t,a,null,[],i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingCount=void 0;t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var r=n(29),i=function(){function e(e){this.id=r.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Plan=void 0;var r=function(e,t){this.parentContext=e,this.rootRequest=t};t.Plan=r},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionName=t.getBaseClassDependencyCount=t.getDependencies=void 0;var i=n(87),o=n(10),a=n(23),s=n(3),u=n(39);Object.defineProperty(t,"getFunctionName",{enumerable:!0,get:function(){return u.getFunctionName}});var c=n(88);function l(e,t,n,i){var s=e.getConstructorMetadata(n),u=s.compilerGeneratedMetadata;if(void 0===u){var l=o.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(l)}var d=s.userGeneratedMetadata,p=Object.keys(d),v=0===n.length&&p.length>0,y=p.length>n.length,m=function(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var s=f(a,e,t,n,r);null!==s&&o.push(s)}return o}(i,t,u,d,v||y?p.length:n.length),_=function e(t,n){for(var i=t.getPropertiesMetadata(n),o=[],s=Object.keys(i),u=0,l=s;u<l.length;u++){var f=l[u],d=i[f],p=h(i[f]),v=p.targetName||f,y=p.inject||p.multiInject,m=new c.Target(a.TargetTypeEnum.ClassProperty,v,y);m.metadata=d,o.push(m)}var _=Object.getPrototypeOf(n.prototype).constructor;if(_!==Object){var g=e(t,_);o=r(r([],o),g)}return o}(e,n);return r(r([],m),_)}function f(e,t,n,r,s){var u=s[e.toString()]||[],l=h(u),f=!0!==l.unmanaged,d=r[e],p=l.inject||l.multiInject;if((d=p||d)instanceof i.LazyServiceIdentifer&&(d=d.unwrap()),f){if(!t&&(d===Object||d===Function||void 0===d)){var v=o.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".";throw new Error(v)}var y=new c.Target(a.TargetTypeEnum.ConstructorArgument,l.targetName,d);return y.metadata=u,y}return null}function h(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[s.INJECT_TAG],multiInject:t[s.MULTI_INJECT_TAG],targetName:t[s.NAME_TAG],unmanaged:t[s.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return l(e,u.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=l(t,u.getFunctionName(r),r,!0),o=i.map((function(e){return e.metadata.filter((function(e){return e.key===s.UNMANAGED_TAG}))})),a=[].concat.apply([],o).length,c=i.length-a;return c>0?c:e(t,r)}return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryableString=void 0;var r=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Request=void 0;var r=n(29),i=function(){function e(e,t,n,i,o){this.id=r.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();t.Request=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolve=void 0;var r=n(10),i=n(23),o=n(86),a=n(39),s=n(135),u=function(e,t,n){try{return n()}catch(i){throw o.isStackOverflowExeption(i)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):i}};t.resolve=function(e){return function e(t){return function(n){n.parentContext.setCurrentRequest(n);var o=n.bindings,c=n.childRequests,l=n.target&&n.target.isArray(),f=!(n.parentRequest&&n.parentRequest.target&&n.target&&n.parentRequest.target.matchesArray(n.target.serviceIdentifier));if(l&&f)return c.map((function(n){return e(t)(n)}));var h=null;if(!n.target.isOptional()||0!==o.length){var d=o[0],p=d.scope===i.BindingScopeEnum.Singleton,v=d.scope===i.BindingScopeEnum.Request;if(p&&d.activated)return d.cache;if(v&&null!==t&&t.has(d.id))return t.get(d.id);if(d.type===i.BindingTypeEnum.ConstantValue)h=d.cache,d.activated=!0;else if(d.type===i.BindingTypeEnum.Function)h=d.cache,d.activated=!0;else if(d.type===i.BindingTypeEnum.Constructor)h=d.implementationType;else if(d.type===i.BindingTypeEnum.DynamicValue&&null!==d.dynamicValue)h=u("toDynamicValue",d.serviceIdentifier,(function(){return d.dynamicValue(n.parentContext)}));else if(d.type===i.BindingTypeEnum.Factory&&null!==d.factory)h=u("toFactory",d.serviceIdentifier,(function(){return d.factory(n.parentContext)}));else if(d.type===i.BindingTypeEnum.Provider&&null!==d.provider)h=u("toProvider",d.serviceIdentifier,(function(){return d.provider(n.parentContext)}));else{if(d.type!==i.BindingTypeEnum.Instance||null===d.implementationType){var y=a.getServiceIdentifierAsString(n.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+y)}h=s.resolveInstance(d.implementationType,c,e(t))}return"function"==typeof d.onActivation&&(h=d.onActivation(n.parentContext,h)),p&&(d.cache=h,d.activated=!0),v&&null!==t&&!t.has(d.id)&&t.set(d.id,h),h}}}(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveInstance=void 0;var i=n(10),o=n(23),a=n(3);t.resolveInstance=function(e,t,n){var s,u,c=null;if(t.length>0){var l=t.filter((function(e){return null!==e.target&&e.target.type===o.TargetTypeEnum.ConstructorArgument})).map(n);u=l,c=function(e,t,n){var r=t.filter((function(e){return null!==e.target&&e.target.type===o.TargetTypeEnum.ClassProperty})),i=r.map(n);return r.forEach((function(t,n){var r;r=t.target.name.value();var o=i[n];e[r]=o})),e}(c=new((s=e).bind.apply(s,r([void 0],u))),t,n)}else c=new e;return function(e,t){if(Reflect.hasMetadata(a.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(a.POST_CONSTRUCT,e);try{t[n.value]()}catch(r){throw new Error(i.POST_CONSTRUCT_ERROR(e.name,r.message))}}}(e,c),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingToSyntax=void 0;var r=n(10),i=n(23),o=n(137),a=n(89),s=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=e,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(r.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=i.BindingTypeEnum.Function,this._binding.scope=i.BindingScopeEnum.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingInWhenOnSyntax=void 0;var r=n(138),i=n(60),o=n(61),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BindingInSyntax=void 0;var r=n(23),i=n(89),o=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerSnapshot=void 0;var r=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}();t.ContainerSnapshot=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lookup=void 0;var r=n(10),i=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(r.NULL_ARGUMENT);if(null==t)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(r.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(r.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,r){var i=n.filter((function(t){return!e(t)}));i.length>0?t._map.set(r,i):t._map.delete(r)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(r.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();t.Lookup=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncContainerModule=t.ContainerModule=void 0;var r=n(29),i=function(e){this.id=r.id(),this.registry=e};t.ContainerModule=i;var o=function(e){this.id=r.id(),this.registry=e};t.AsyncContainerModule=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectable=void 0;var r=n(10),i=n(3);t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,e))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(i.PARAM_TYPES,t,e),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tagged=void 0;var r=n(14),i=n(26);t.tagged=function(e,t){return function(n,o,a){var s=new r.Metadata(e,t);"number"==typeof a?i.tagParameter(n,o,a,s):i.tagProperty(n,o,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.named=void 0;var r=n(3),i=n(14),o=n(26);t.named=function(e){return function(t,n,a){var s=new i.Metadata(r.NAMED_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.optional=void 0;var r=n(3),i=n(14),o=n(26);t.optional=function(){return function(e,t,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(e,t,n,a):o.tagProperty(e,t,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unmanaged=void 0;var r=n(3),i=n(14),o=n(26);t.unmanaged=function(){return function(e,t,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(e,t,n,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiInject=void 0;var r=n(3),i=n(14),o=n(26);t.multiInject=function(e){return function(t,n,a){var s=new i.Metadata(r.MULTI_INJECT_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.targetName=void 0;var r=n(3),i=n(14),o=n(26);t.targetName=function(e){return function(t,n,a){var s=new i.Metadata(r.NAME_TAG,e);o.tagParameter(t,n,a,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postConstruct=void 0;var r=n(10),i=n(3),o=n(14);t.postConstruct=function(){return function(e,t,n){var a=new o.Metadata(i.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,e.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,e.constructor)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=void 0;t.multiBindToService=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return e.bind(n).toService(t)}))}}}},function(e,t,n){var r=n(2),i=n(50),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},function(e,t,n){"use strict";var r=n(38),i=n(153),o=n(30),a=n(28),s=n(46),u=n(155);r({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),n=a(t),r=u(t,0);return r.length=i(r,t,t,n,0,void 0===e?1:s(e)),r}})},function(e,t,n){"use strict";var r=n(2),i=n(91),o=n(28),a=n(154),s=r.TypeError,u=function(e,t,n,r,c,l,f,h){for(var d,p,v=c,y=0,m=!!f&&a(f,h);y<r;){if(y in n){if(d=m?m(n[y],y,t):n[y],l>0&&i(d))p=o(d),v=u(e,t,d,p,v,l-1)-1;else{if(v>=9007199254740991)throw s("Exceed the acceptable array length");e[v]=d}v++}y++}return v};e.exports=u},function(e,t,n){var r=n(6),i=n(37),o=n(49),a=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(156);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},function(e,t,n){var r=n(2),i=n(91),o=n(157),a=n(27),s=n(31)("species"),u=r.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(o(t)&&(t===u||i(t.prototype))||a(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?u:t}},function(e,t,n){var r=n(6),i=n(9),o=n(5),a=n(50),s=n(35),u=n(56),c=function(){},l=[],f=s("Reflect","construct"),h=/^\s*(?:class|function)\b/,d=r(h.exec),p=!h.exec(c),v=function(e){if(!o(e))return!1;try{return f(c,l,e),!0}catch(t){return!1}},y=function(e){if(!o(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return p||!!d(h,u(e))}catch(t){return!0}};y.sham=!0,e.exports=!f||i((function(){var e;return v(v.call)||!v(Object)||!v((function(){e=!0}))||e}))?y:v},function(e,t,n){n(159)("flat")},function(e,t,n){var r=n(31),i=n(160),o=n(32),a=r("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),e.exports=function(e){s[a][e]=!0}},function(e,t,n){var r,i=n(36),o=n(161),a=n(59),s=n(58),u=n(163),c=n(71),l=n(57),f=l("IE_PROTO"),h=function(){},d=function(e){return"<script>"+e+"<\/script>"},p=function(e){e.write(d("")),e.close();var t=e.parentWindow.Object;return e=null,t},v=function(){try{r=new ActiveXObject("htmlfile")}catch(i){}var e,t;v="undefined"!=typeof document?document.domain&&r?p(r):((t=c("iframe")).style.display="none",u.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F):p(r);for(var n=a.length;n--;)delete v.prototype[a[n]];return v()};s[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(h.prototype=i(e),n=new h,h.prototype=null,n[f]=e):n=v(),void 0===t?n:o.f(n,t)}},function(e,t,n){var r=n(25),i=n(72),o=n(32),a=n(36),s=n(47),u=n(162);t.f=r&&!i?Object.defineProperties:function(e,t){a(e);for(var n,r=s(t),i=u(t),c=i.length,l=0;c>l;)o.f(e,n=i[l++],r[n]);return e}},function(e,t,n){var r=n(83),i=n(59);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(35);e.exports=r("document","documentElement")},function(e,t,n){"use strict";t.__esModule=!0,t.SyncHook=n(165),t.SyncBailHook=n(169),t.SyncWaterfallHook=n(170),t.SyncLoopHook=n(171),t.AsyncParallelHook=n(172),t.AsyncParallelBailHook=n(173),t.AsyncSeriesHook=n(174),t.AsyncSeriesBailHook=n(175),t.AsyncSeriesLoopHook=n(176),t.AsyncSeriesWaterfallHook=n(177),t.HookMap=n(178),t.MultiHook=n(179)},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onDone,r=e.rethrowIfPossible;return this.callTapsSeries({onError:function(e,n){return t(n)},onDone:n,rethrowIfPossible:r})}}]),n}(n(20))),f=function(){throw new Error("tapAsync is not supported on a SyncHook")},h=function(){throw new Error("tapPromise is not supported on a SyncHook")},d=function(e){return l.setup(this,e),l.create(e)};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=p,n.tapAsync=f,n.tapPromise=h,n.compile=d,n}p.prototype=null,e.exports=p},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onResult,r=e.resultReturns,i=e.onDone,o=e.rethrowIfPossible;return this.callTapsSeries({onError:function(e,n){return t(n)},onResult:function(e,t,r){return"if(".concat(t," !== undefined) {\n").concat(n(t),";\n} else {\n").concat(r(),"}\n")},resultReturns:r,onDone:i,rethrowIfPossible:o})}}]),n}(n(20))),f=function(){throw new Error("tapAsync is not supported on a SyncBailHook")},h=function(){throw new Error("tapPromise is not supported on a SyncBailHook")},d=function(e){return l.setup(this,e),l.create(e)};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=p,n.tapAsync=f,n.tapPromise=h,n.compile=d,n}p.prototype=null,e.exports=p},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=this,n=e.onError,r=e.onResult,i=e.resultReturns,o=e.rethrowIfPossible;return this.callTapsSeries({onError:function(e,t){return n(t)},onResult:function(e,n,r){var i="";return i+="if(".concat(n," !== undefined) {\n"),i+="".concat(t._args[0]," = ").concat(n,";\n"),i+="}\n",i+=r()},onDone:function(){return r(t._args[0])},doneReturns:i,rethrowIfPossible:o})}}]),n}(n(20))),f=function(){throw new Error("tapAsync is not supported on a SyncWaterfallHook")},h=function(){throw new Error("tapPromise is not supported on a SyncWaterfallHook")},d=function(e){return l.setup(this,e),l.create(e)};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(e.length<1)throw new Error("Waterfall hooks must have at least one argument");var n=new c(e,t);return n.constructor=p,n.tapAsync=f,n.tapPromise=h,n.compile=d,n}p.prototype=null,e.exports=p},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onDone,r=e.rethrowIfPossible;return this.callTapsLooping({onError:function(e,n){return t(n)},onDone:n,rethrowIfPossible:r})}}]),n}(n(20))),f=function(){throw new Error("tapAsync is not supported on a SyncLoopHook")},h=function(){throw new Error("tapPromise is not supported on a SyncLoopHook")},d=function(e){return l.setup(this,e),l.create(e)};function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=p,n.tapAsync=f,n.tapPromise=h,n.compile=d,n}p.prototype=null,e.exports=p},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onDone;return this.callTapsParallel({onError:function(e,n,r,i){return t(n)+i(!0)},onDone:n})}}]),n}(n(20))),f=function(e){return l.setup(this,e),l.create(e)};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=h,n.compile=f,n._call=void 0,n.call=void 0,n}h.prototype=null,e.exports=h},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onResult,r=e.onDone,i="";return i+="var _results = new Array(".concat(this.options.taps.length,");\n"),i+="var _checkDone = function() {\n",i+="for(var i = 0; i < _results.length; i++) {\n",i+="var item = _results[i];\n",i+="if(item === undefined) return false;\n",i+="if(item.result !== undefined) {\n",i+=n("item.result"),i+="return true;\n",i+="}\n",i+="if(item.error) {\n",i+=t("item.error"),i+="return true;\n",i+="}\n",i+="}\n",i+="return false;\n",i+="}\n",i+=this.callTapsParallel({onError:function(e,t,n,r){var i="";return i+="if(".concat(e," < _results.length && ((_results.length = ").concat(e+1,"), (_results[").concat(e,"] = { error: ").concat(t," }), _checkDone())) {\n"),i+=r(!0),i+="} else {\n",i+=n(),i+="}\n"},onResult:function(e,t,n,r){var i="";return i+="if(".concat(e," < _results.length && (").concat(t," !== undefined && (_results.length = ").concat(e+1,"), (_results[").concat(e,"] = { result: ").concat(t," }), _checkDone())) {\n"),i+=r(!0),i+="} else {\n",i+=n(),i+="}\n"},onTap:function(e,t,n,r){var i="";return e>0&&(i+="if(".concat(e," >= _results.length) {\n"),i+=n(),i+="} else {\n"),i+=t(),e>0&&(i+="}\n"),i},onDone:r})}}]),n}(n(20))),f=function(e){return l.setup(this,e),l.create(e)};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=h,n.compile=f,n._call=void 0,n.call=void 0,n}h.prototype=null,e.exports=h},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onDone;return this.callTapsSeries({onError:function(e,n,r,i){return t(n)+i(!0)},onDone:n})}}]),n}(n(20))),f=function(e){return l.setup(this,e),l.create(e)};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=h,n.compile=f,n._call=void 0,n.call=void 0,n}h.prototype=null,e.exports=h},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onResult,r=e.resultReturns,i=e.onDone;return this.callTapsSeries({onError:function(e,n,r,i){return t(n)+i(!0)},onResult:function(e,t,r){return"if(".concat(t," !== undefined) {\n").concat(n(t),"\n} else {\n").concat(r(),"}\n")},resultReturns:r,onDone:i})}}]),n}(n(20))),f=function(e){return l.setup(this,e),l.create(e)};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=h,n.compile=f,n._call=void 0,n.call=void 0,n}h.prototype=null,e.exports=h},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=e.onError,n=e.onDone;return this.callTapsLooping({onError:function(e,n,r,i){return t(n)+i(!0)},onDone:n})}}]),n}(n(20))),f=function(e){return l.setup(this,e),l.create(e)};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new c(e,t);return n.constructor=h,n.compile=f,n._call=void 0,n.call=void 0,n}h.prototype=null,e.exports=h},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(17),a=n(18),s=n(19);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}var c=n(16),l=new(function(e){o(n,e);var t=u(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"content",value:function(e){var t=this,n=e.onError,r=e.onResult;e.onDone;return this.callTapsSeries({onError:function(e,t,r,i){return n(t)+i(!0)},onResult:function(e,n,r){var i="";return i+="if(".concat(n," !== undefined) {\n"),i+="".concat(t._args[0]," = ").concat(n,";\n"),i+="}\n",i+=r()},onDone:function(){return r(t._args[0])}})}}]),n}(n(20))),f=function(e){return l.setup(this,e),l.create(e)};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(e.length<1)throw new Error("Waterfall hooks must have at least one argument");var n=new c(e,t);return n.constructor=h,n.compile=f,n._call=void 0,n.call=void 0,n}h.prototype=null,e.exports=h},function(e,t,n){"use strict";var r=n(7),i=n(8),o=n(92),a=function(e,t){return t},s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;r(this,e),this._map=new Map,this.name=n,this._factory=t,this._interceptors=[]}return i(e,[{key:"get",value:function(e){return this._map.get(e)}},{key:"for",value:function(e){var t=this.get(e);if(void 0!==t)return t;for(var n=this._factory(e),r=this._interceptors,i=0;i<r.length;i++)n=r[i].factory(e,n);return this._map.set(e,n),n}},{key:"intercept",value:function(e){this._interceptors.push(Object.assign({factory:a},e))}}]),e}();s.prototype.tap=o.deprecate((function(e,t,n){return this.for(e).tap(t,n)}),"HookMap#tap(key,) is deprecated. Use HookMap#for(key).tap() instead."),s.prototype.tapAsync=o.deprecate((function(e,t,n){return this.for(e).tapAsync(t,n)}),"HookMap#tapAsync(key,) is deprecated. Use HookMap#for(key).tapAsync() instead."),s.prototype.tapPromise=o.deprecate((function(e,t,n){return this.for(e).tapPromise(t,n)}),"HookMap#tapPromise(key,) is deprecated. Use HookMap#for(key).tapPromise() instead."),e.exports=s},function(e,t,n){"use strict";var r=n(7),i=n(8);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(16);var s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;r(this,e),this.hooks=t,this.name=n}return i(e,[{key:"tap",value:function(e,t){var n,r=o(this.hooks);try{for(r.s();!(n=r.n()).done;){n.value.tap(e,t)}}catch(i){r.e(i)}finally{r.f()}}},{key:"tapAsync",value:function(e,t){var n,r=o(this.hooks);try{for(r.s();!(n=r.n()).done;){n.value.tapAsync(e,t)}}catch(i){r.e(i)}finally{r.f()}}},{key:"tapPromise",value:function(e,t){var n,r=o(this.hooks);try{for(r.s();!(n=r.n()).done;){n.value.tapPromise(e,t)}}catch(i){r.e(i)}finally{r.f()}}},{key:"isUsed",value:function(){var e,t=o(this.hooks);try{for(t.s();!(e=t.n()).done;){if(e.value.isUsed())return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"intercept",value:function(e){var t,n=o(this.hooks);try{for(n.s();!(t=n.n()).done;){t.value.intercept(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"withOptions",value:function(t){return new e(this.hooks.map((function(e){return e.withOptions(t)})),this.name)}}]),e}();e.exports=s},function(e,t,n){n(38)({global:!0},{globalThis:n(2)})},function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return p}));var i,o=1,a="object"==typeof self&&self.self==self?self:"object"==typeof e&&e.global==e?e:{},s=Date.now(),u={},c=Date.now(),l=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");var t=Date.now(),n=t-c,r=n>16?0:16-n,i=o++;return u[i]=e,Object.keys(u).length>1||setTimeout((function(){c=t;var e=u;u={},Object.keys(e).forEach((function(t){return e[t](a.performance&&"function"==typeof a.performance.now?a.performance.now():Date.now()-s)}))}),r),i},f=function(e){delete u[e]},h=function(e){return"string"!=typeof e?l:""===e?a.requestAnimationFrame:a[e+"RequestAnimationFrame"]},d=function(e,t){for(var n=0;void 0!==e[n];){if(t(e[n]))return e[n];n+=1}}(["","webkit","moz","ms","o"],(function(e){return!!h(e)})),p=h(d),v="string"!=typeof(i=d)?f:""===i?a.cancelAnimationFrame:a[i+"CancelAnimationFrame"]||a[i+"CancelRequestAnimationFrame"];a.requestAnimationFrame=p,a.cancelAnimationFrame=v,r.exports&&(r.exports={requestAnimationFrame:p,cancelAnimationFrame:v})}).call(this,n(40),n(182)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){e.exports=n(93)},function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r,s,u,c,l,d,p,y=t&&t.length,m=y?t[0]*n:e.length,_=i(e,0,m,n,!0),g=[];if(!_||_.next===_.prev)return g;if(y&&(_=function(e,t,n,r){var a,s,u,c,l,d=[];for(a=0,s=t.length;a<s;a++)u=t[a]*r,c=a<s-1?t[a+1]*r:e.length,(l=i(e,u,c,r,!1))===l.next&&(l.steiner=!0),d.push(v(l));for(d.sort(f),a=0;a<d.length;a++)n=o(n=h(d[a],n),n.next);return n}(e,t,_,n)),e.length>80*n){r=u=e[0],s=c=e[1];for(var E=n;E<m;E+=n)(l=e[E])<r&&(r=l),(d=e[E+1])<s&&(s=d),l>u&&(u=l),d>c&&(c=d);p=0!==(p=Math.max(u-r,c-s))?1/p:0}return a(_,g,n,r,s,p),g}function i(e,t,n,r,i){var o,a;if(i===M(e,t,n,r)>0)for(o=t;o<n;o+=r)a=A(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=A(o,e[o],e[o+1],a);return a&&g(a,a.next)&&(O(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!g(r,r.next)&&0!==_(r.prev,r,r.next))r=r.next;else{if(O(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,i,f,h){if(e){!h&&f&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=p(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(e,r,i,f);for(var d,v,y=e;e.prev!==e.next;)if(d=e.prev,v=e.next,f?u(e,r,i,f):s(e))t.push(d.i/n),t.push(e.i/n),t.push(v.i/n),O(e),e=v.next,y=v.next;else if((e=v)===y){h?1===h?a(e=c(o(e),t,n),t,n,r,i,f,2):2===h&&l(e,t,n,r,i,f):a(o(e),t,n,r,i,f,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(_(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(y(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&_(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(e,t,n,r){var i=e.prev,o=e,a=e.next;if(_(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=p(s,u,t,n,r),h=p(c,l,t,n,r),d=e.prevZ,v=e.nextZ;d&&d.z>=f&&v&&v.z<=h;){if(d!==e.prev&&d!==e.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&_(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==e.prev&&v!==e.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&_(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&_(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=h;){if(v!==e.prev&&v!==e.next&&y(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&_(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function c(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!g(i,a)&&E(i,r,r.next,a)&&S(i,a)&&S(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),O(r),O(r.next),r=e=a),r=r.next}while(r!==e);return o(r)}function l(e,t,n,r,i,s){var u=e;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&m(u,c)){var l=R(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,t,n,r,i,s),void a(l,t,n,r,i,s)}c=c.next}u=u.next}while(u!==e)}function f(e,t){return e.x-t.x}function h(e,t){var n=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,f=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&y(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),S(r,e)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&d(n,r)))&&(n=r,h=u)),r=r.next}while(r!==c);return n}(e,t);if(!n)return t;var r=R(n,e),i=o(n,n.next);return o(r,r.next),t===n?i:t}function d(e,t){return _(e.prev,e,t.prev)<0&&_(t.next,e,e.next)<0}function p(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function v(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function y(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&E(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(_(e.prev,e,t.prev)||_(e,t.prev,t))||g(e,t)&&_(e.prev,e,e.next)>0&&_(t.prev,t,t.next)>0)}function _(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function g(e,t){return e.x===t.x&&e.y===t.y}function E(e,t,n,r){var i=b(_(e,t,n)),o=b(_(e,t,r)),a=b(_(n,r,e)),s=b(_(n,r,t));return i!==o&&a!==s||(!(0!==i||!T(e,n,t))||(!(0!==o||!T(e,r,t))||(!(0!==a||!T(n,e,r))||!(0!==s||!T(n,t,r)))))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function b(e){return e>0?1:e<0?-1:0}function S(e,t){return _(e.prev,e,e.next)<0?_(e,t,e.next)>=0&&_(e,e.prev,t)>=0:_(e,t,e.prev)<0||_(e,e.next,t)<0}function R(e,t){var n=new C(e.i,e.x,e.y),r=new C(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function A(e,t,n,r){var i=new C(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function O(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}n(15),e.exports=r,e.exports.default=r,r.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(M(e,0,o,n));if(i)for(var s=0,u=t.length;s<u;s++){var c=t[s]*n,l=s<u-1?t[s+1]*n:e.length;a-=Math.abs(M(e,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;f+=Math.abs((e[h]-e[p])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[p+1]-e[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},function(e,t,n){"use strict";n.r(t),n.d(t,"render",(function(){return re})),n.d(t,"triggerEvent",(function(){return ie}));function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=n(48);var a=n(13),s=n(0),u=n(1),c=(n(62),/mobile|tablet|ip(ad|hone|od)|android/i),l=function(){function e(){}var t;return t=e,e.prototype.apply=function(e){var n=this,r=this.renderingContext.root.ownerDocument.defaultView,i=r.supportTouchEvent&&c.test(navigator.userAgent),o=function(t){e.hooks.pointerMove.call(t)},a=function(t){e.hooks.pointerUp.call(t)},u=function(t){e.hooks.pointerDown.call(t)},l=function(t){e.hooks.pointerOver.call(t)},f=function(t){e.hooks.pointerOut.call(t)},h=function(t){e.hooks.pointerCancel.call(t)},d=function(t){e.hooks.pointerWheel.call(t)},p=function(e){e.addEventListener("touchstart",u,!0),e.addEventListener("touchend",a,!0),e.addEventListener("touchmove",o,!0),e.addEventListener("touchcancel",h,!0)},v=function(e){globalThis.document.addEventListener("mousemove",o,!0),e.addEventListener("mousedown",u,!0),e.addEventListener("mouseout",f,!0),e.addEventListener("mouseover",l,!0),globalThis.addEventListener("mouseup",a,!0)},y=function(e){e.removeEventListener("touchstart",u,!0),e.removeEventListener("touchend",a,!0),e.removeEventListener("touchmove",o,!0)},m=function(e){globalThis.document.removeEventListener("mousemove",o,!0),e.removeEventListener("mousedown",u,!0),e.removeEventListener("mouseout",f,!0),e.removeEventListener("mouseover",l,!0),globalThis.removeEventListener("mouseup",a,!0)};e.hooks.init.tapPromise(t.tag,(function(){return Object(s.__awaiter)(n,void 0,void 0,(function(){var e;return Object(s.__generator)(this,(function(t){return e=this.contextService.getDomElement(),r.supportPointerEvent&&function(e){globalThis.document.addEventListener("pointermove",o,!0),e.addEventListener("pointerdown",u,!0),e.addEventListener("pointerleave",f,!0),e.addEventListener("pointerover",l,!0),globalThis.addEventListener("pointerup",a,!0)}(e),i?p(e):r.supportTouchEvent?(p(e),r.supportPointerEvent||v(e)):r.supportPointerEvent||v(e),e.addEventListener("wheel",d,{passive:!0,capture:!0}),[2]}))}))})),e.hooks.destroy.tap(t.tag,(function(){var e=n.contextService.getDomElement();r.supportPointerEvent&&function(e){globalThis.document.removeEventListener("pointermove",o,!0),e.removeEventListener("pointerdown",u,!0),e.removeEventListener("pointerleave",f,!0),e.removeEventListener("pointerover",l,!0),globalThis.removeEventListener("pointerup",a,!0)}(e),i?y(e):r.supportTouchEvent?(y(e),r.supportPointerEvent||m(e)):r.supportPointerEvent||m(e),e.removeEventListener("wheel",d,!0)}))},e.tag="DOMInteraction",Object(s.__decorate)([Object(u.inject)(a.ContextService),Object(s.__metadata)("design:type",Object)],e.prototype,"contextService",void 0),Object(s.__decorate)([Object(u.inject)(a.RenderingContext),Object(s.__metadata)("design:type",Object)],e.prototype,"renderingContext",void 0),e=t=Object(s.__decorate)([Object(u.singleton)({contrib:a.RenderingPluginContribution})],e)}(),f=Object(u.Module)((function(e){e(l)})),h=function(){function e(){this.name="dom-interaction"}return e.prototype.init=function(e){e.load(f,!0)},e.prototype.destroy=function(e){e.unload(f)},e}(),d=n(4),p=u.Syringe.defineToken("WebGLRendererPluginOptions"),v=(n(11),n(12),n(15),function(e){function t(t){var n=t.id,r=t.device,i=e.call(this)||this;return i.id=n,i.device=r,null!==i.device.resourceCreationTracker&&i.device.resourceCreationTracker.trackResourceCreated(i),i}return Object(s.__extends)(t,e),t.prototype.destroy=function(){null!==this.device.resourceCreationTracker&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},t}(n(34).EventEmitter)),y=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;o.type=d.ResourceType.Bindings;var a=i.bindingLayout,s=i.uniformBufferBindings,u=i.samplerBindings;Object(d.assert)(s.length>=a.numUniformBuffers),Object(d.assert)(u.length>=a.numSamplers);for(var c=0;c<a.numUniformBuffers;c++)Object(d.assert)(s[c].wordCount>0);return o.uniformBufferBindings=i.uniformBufferBindings,o.samplerBindings=i.samplerBindings,o}return Object(s.__extends)(t,e),t}(v);function m(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}function _(e){if(Object(d.getFormatFlags)(e)&d.FormatFlags.Normalized)return!1;var t=Object(d.getFormatTypeFlags)(e);return t===d.FormatTypeFlags.S8||t===d.FormatTypeFlags.S16||t===d.FormatTypeFlags.S32||(t===d.FormatTypeFlags.U8||t===d.FormatTypeFlags.U16||t===d.FormatTypeFlags.U32)}function g(e){return e&d.BufferUsage.INDEX?d.GL.ELEMENT_ARRAY_BUFFER:e&d.BufferUsage.VERTEX?d.GL.ARRAY_BUFFER:e&d.BufferUsage.UNIFORM?d.GL.UNIFORM_BUFFER:void 0}function E(e){var t=Object(d.getFormatTypeFlags)(e),n=Object(d.getFormatCompFlags)(e),r=Object(d.getFormatFlags)(e),i=function(e){switch(e){case d.FormatTypeFlags.U8:return d.GL.UNSIGNED_BYTE;case d.FormatTypeFlags.U16:return d.GL.UNSIGNED_SHORT;case d.FormatTypeFlags.U32:return d.GL.UNSIGNED_INT;case d.FormatTypeFlags.S8:return d.GL.BYTE;case d.FormatTypeFlags.S16:return d.GL.SHORT;case d.FormatTypeFlags.S32:return d.GL.INT;case d.FormatTypeFlags.F16:return d.GL.HALF_FLOAT;case d.FormatTypeFlags.F32:return d.GL.FLOAT;default:throw new Error("whoops")}}(t);return{size:function(e){switch(e){case d.FormatCompFlags.R:return 1;case d.FormatCompFlags.RG:return 2;case d.FormatCompFlags.RGB:return 3;case d.FormatCompFlags.RGBA:return 4;default:return 1}}(n),type:i,normalized:!!(r&d.FormatFlags.Normalized)}}function T(e){switch(e){case d.WrapMode.Clamp:return d.GL.CLAMP_TO_EDGE;case d.WrapMode.Repeat:return d.GL.REPEAT;case d.WrapMode.Mirror:return d.GL.MIRRORED_REPEAT;default:throw new Error("whoops")}}function b(e,t){if(t===d.MipFilterMode.Linear&&e===d.TexFilterMode.Bilinear)return d.GL.LINEAR_MIPMAP_LINEAR;if(t===d.MipFilterMode.Linear&&e===d.TexFilterMode.Point)return d.GL.NEAREST_MIPMAP_LINEAR;if(t===d.MipFilterMode.Nearest&&e===d.TexFilterMode.Bilinear)return d.GL.LINEAR_MIPMAP_NEAREST;if(t===d.MipFilterMode.Nearest&&e===d.TexFilterMode.Point)return d.GL.NEAREST_MIPMAP_NEAREST;if(t===d.MipFilterMode.NoMip&&e===d.TexFilterMode.Bilinear)return d.GL.LINEAR;if(t===d.MipFilterMode.NoMip&&e===d.TexFilterMode.Point)return d.GL.NEAREST;throw new Error("Unknown texture filter mode")}function S(e,t){void 0===t&&(t=0);var n=e;return n.gl_buffer_pages[t/n.pageByteSize|0]}function R(e){return e.gl_texture}function A(e){return e.gl_sampler}function O(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function C(e,t){for(var n=[];;){var r=t.exec(e);if(!r)break;n.push(r)}return n}function M(e){return e.blendMode==d.BlendMode.Add&&e.blendSrcFactor==d.BlendFactor.One&&e.blendDstFactor===d.BlendFactor.Zero}function x(e){if(e===d.TextureDimension.n2D)return d.GL.TEXTURE_2D;if(e===d.TextureDimension.n2DArray)return d.GL.TEXTURE_2D_ARRAY;if(e===d.TextureDimension.Cube)return d.GL.TEXTURE_CUBE_MAP;if(e===d.TextureDimension.n3D)return d.GL.TEXTURE_3D;throw new Error("whoops")}function P(e,t,n,r){return e%n==0&&t%r==0}var N,F=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;o.type=d.ResourceType.Buffer;var s=i.viewOrSize,u=i.usage,c=i.hint,l=r.uniformBufferMaxPageByteSize,f=r.gl,h=u&d.BufferUsage.UNIFORM;h||(m(f)?f.bindVertexArray(null):r.OES_vertex_array_object.bindVertexArrayOES(null));var p,v=Object(a.isNumber)(s)?4*s:4*s.byteLength;if(o.gl_buffer_pages=[],h){Object(d.assert)(v%l==0);for(var y=v;y>0;)o.gl_buffer_pages.push(o.createBufferPage(Math.min(y,l),u,c)),y-=l;p=l}else o.gl_buffer_pages.push(o.createBufferPage(v,u,c)),p=v;return o.pageByteSize=p,o.byteSize=v,o.usage=u,o.gl_target=g(u),h||(m(f)?f.bindVertexArray(o.device.currentBoundVAO):r.OES_vertex_array_object.bindVertexArrayOES(o.device.currentBoundVAO)),o}return Object(s.__extends)(t,e),t.prototype.setSubData=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=t.byteLength-n);var i=this.device.gl,o=this.gl_target,a=this.byteSize,s=this.pageByteSize;if(!(e+r<=a))throw new Error("Assert fail: (dstByteOffset [".concat(e,"] + byteSize [").concat(r,"]) <= dstByteSize [").concat(a,"], gl_target ").concat(o));for(var u=e+r,c=e,l=e%s;c<u;){var f=m(i)?i.COPY_WRITE_BUFFER:this.gl_target;i.bindBuffer(f,S(this,c)),m(i)?i.bufferSubData(f,l,t,n,Math.min(u-c,s)):i.bufferSubData(f,l,t),c+=s,l=0,n+=s,this.device.debugGroupStatisticsBufferUpload()}},t.prototype.destroy=function(){e.prototype.destroy.call(this);for(var t=0;t<this.gl_buffer_pages.length;t++)this.gl_buffer_pages[t].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[t])},t.prototype.createBufferPage=function(e,t,n){var r=this.device.gl,i=t&d.BufferUsage.UNIFORM;if(!m(r)&&i)return{ubo:!0};var o=this.device.ensureResourceExists(r.createBuffer()),a=g(t),s=function(e){switch(e){case d.BufferFrequencyHint.Static:return d.GL.STATIC_DRAW;case d.BufferFrequencyHint.Dynamic:return d.GL.DYNAMIC_DRAW}}(n);return r.bindBuffer(a,o),r.bufferData(a,e,s),o},t}(v),I=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;o.type=d.ResourceType.InputLayout;var a=i.vertexAttributeDescriptors,s=i.vertexBufferDescriptors,u=i.indexBufferFormat;return Object(d.assert)(u===d.Format.U16_R||u===d.Format.U32_R||null===u),o.vertexAttributeDescriptors=a,o.vertexBufferDescriptors=s,o.indexBufferFormat=u,o}return Object(s.__extends)(t,e),t}(v),D=function(e){function t(t){var n,r=t.id,i=t.device,o=t.inputLayout,s=t.vertexBuffers,u=t.indexBufferBinding,c=t.program,l=this;(l=e.call(this,{id:r,device:i})||this).type=d.ResourceType.InputState;var f=l.device.gl,h=l.device.ensureResourceExists(m(f)?f.createVertexArray():i.OES_vertex_array_object.createVertexArrayOES());m(f)?f.bindVertexArray(h):i.OES_vertex_array_object.bindVertexArrayOES(h),i.currentBoundVAO=h;for(var p=0;p<o.vertexAttributeDescriptors.length;p++){var v=o.vertexAttributeDescriptors[p],y=v.format,g=v.divisor,T=void 0===g?1:g,b=v.byteStride,R=v.bufferByteOffset,A=v.bufferIndex,O=m(f)?v.location:null===(n=c.attributes[v.location])||void 0===n?void 0:n.location;if(!Object(a.isNil)(O)){_(y);var C=E(y),M=C.size,x=C.type,P=C.normalized,N=s[A];if(null===N)continue;var F=Object(d.assertExists)(o.vertexBufferDescriptors[A]),I=N.buffer;Object(d.assert)(!!(I.usage&d.BufferUsage.VERTEX)),f.bindBuffer(f.ARRAY_BUFFER,S(N.buffer));var D=N.byteOffset+R;f.vertexAttribPointer(O,M,x,P,b||F.byteStride,D),F.frequency===d.VertexBufferFrequency.PerInstance&&(m(f)?f.vertexAttribDivisor(O,T):i.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(O,T)),f.enableVertexAttribArray(O)}}var L=null,B=null,w=null;if(null!==u){I=u.buffer;Object(d.assert)(!!(I.usage&d.BufferUsage.INDEX)),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,S(u.buffer)),L=function(e){switch(e){case d.Format.U8_R:return d.GL.UNSIGNED_BYTE;case d.Format.U16_R:return d.GL.UNSIGNED_SHORT;case d.Format.U32_R:return d.GL.UNSIGNED_INT;default:throw new Error("whoops")}}(Object(d.assertExists)(o.indexBufferFormat)),B=Object(d.getFormatCompByteSize)(o.indexBufferFormat),w=u.byteOffset}return m(f)?f.bindVertexArray(null):i.OES_vertex_array_object.bindVertexArrayOES(null),i.currentBoundVAO=null,l.vao=h,l.indexBufferByteOffset=w,l.indexBufferType=L,l.indexBufferCompByteSize=B,l.inputLayout=o,l.vertexBuffers=s,l}return Object(s.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(m(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},t}(v),L=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=t.fake,a=e.call(this,{id:n,device:r})||this;a.type=d.ResourceType.Texture;var s,u,c=a.device.gl,l=a.clampNumLevels(i);if(a.immutable=!!i.immutable,a.pixelStore=i.pixelStore,a.pixelFormat=i.pixelFormat,a.formatKind=Object(d.getFormatSamplerKind)(i.pixelFormat),a.width=i.width,a.height=i.height,a.depth=i.depth,a.mipmaps=l>=1,!o){u=a.device.ensureResourceExists(c.createTexture());var f=a.device.translateTextureType(i.pixelFormat),h=a.device.translateTextureInternalFormat(i.pixelFormat);if(a.device.setActiveTexture(c.TEXTURE0),a.device.currentTextures[0]=null,a.preprocessImage(),i.dimension===d.TextureDimension.n2D){if(s=d.GL.TEXTURE_2D,c.bindTexture(s,u),a.immutable)if(m(c))c.texStorage2D(s,l,h,i.width,i.height);else{var p=(h===d.GL.DEPTH_COMPONENT||a.isNPOT(),0);c.texImage2D(s,p,h,i.width,i.height,0,h,f,null),a.mipmaps&&a.isNPOT()&&(a.mipmaps=!1,c.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_MIN_FILTER,d.GL.LINEAR),c.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_WRAP_S,d.GL.CLAMP_TO_EDGE),c.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_WRAP_T,d.GL.CLAMP_TO_EDGE))}Object(d.assert)(1===i.depth)}else if(i.dimension===d.TextureDimension.n2DArray)s=d.GL.TEXTURE_2D_ARRAY,c.bindTexture(s,u),m(c)&&c.texStorage3D(s,l,h,i.width,i.height,i.depth);else if(i.dimension===d.TextureDimension.n3D)s=d.GL.TEXTURE_3D,c.bindTexture(s,u),m(c)&&c.texStorage3D(s,l,h,i.width,i.height,i.depth);else{if(i.dimension!==d.TextureDimension.Cube)throw new Error("whoops");s=d.GL.TEXTURE_CUBE_MAP,c.bindTexture(s,u),m(c)&&c.texStorage2D(s,l,h,i.width,i.height),Object(d.assert)(6===i.depth)}}return a.gl_texture=u,a.gl_target=s,a.numLevels=l,a}return Object(s.__extends)(t,e),t.prototype.setImageData=function(e,t){var n,r,i=this.device.gl,o=Array.isArray(e);this.device.setActiveTexture(i.TEXTURE0),this.device.currentTextures[0]=null,o?(n=this.width,r=this.height):(n=e.width,r=e.height,this.width=n,this.height=r),i.bindTexture(this.gl_target,this.gl_texture);var a=this.device.translateTextureFormat(this.pixelFormat),s=this.device.translateTextureType(this.pixelFormat);this.preprocessImage(),this.immutable?i.texSubImage2D(this.gl_target,0,0,0,n,r,a,s,o?e[0]:e):m(i)?i.texImage2D(this.gl_target,0,a,n,r,0,a,s,o?e[0]:e):o?i.texImage2D(this.gl_target,0,a,n,r,0,a,s,e[0]):i.texImage2D(this.gl_target,0,a,a,s,e),this.mipmaps&&this.generateMipmap()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteTexture(R(this))},t.prototype.clampNumLevels=function(e){if(e.dimension===d.TextureDimension.n2DArray&&e.depth>1&&Object(d.getFormatTypeFlags)(e.pixelFormat)===d.FormatTypeFlags.BC1)for(var t=e.width,n=e.height,r=0;r<e.numLevels;r++){if(t<=2||n<=2)return r-1;t=Math.max(t/2|0,1),n=Math.max(n/2|0,1)}return e.numLevels},t.prototype.preprocessImage=function(){var e=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&e.pixelStorei(d.GL.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&e.pixelStorei(d.GL.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&e.pixelStorei(d.GL.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},t.prototype.generateMipmap=function(){var e=this.device.gl;return!m(e)&&this.isNPOT()||this.gl_texture&&this.gl_target&&(e.bindTexture(this.gl_target,this.gl_texture),e.generateMipmap(this.gl_target),e.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_MIN_FILTER,d.GL.NEAREST_MIPMAP_LINEAR),e.bindTexture(this.gl_target,null)),this},t.prototype.isNPOT=function(){return!m(this.device.gl)&&(!Object(d.isPowerOfTwo)(this.width)||!Object(d.isPowerOfTwo)(this.height))},t}(v);!function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"}(N||(N={}));var B,w,k=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;o.type=d.ResourceType.Program,o.uniformSetters={},o.attributes=[];var a=o.device.gl;return o.descriptor=i,o.gl_program=o.device.ensureResourceExists(a.createProgram()),o.gl_shader_vert=null,o.gl_shader_frag=null,o.compileState=N.NeedsCompile,o.tryCompileProgram(),o}return Object(s.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},t.prototype.tryCompileProgram=function(){Object(d.assert)(this.compileState===N.NeedsCompile);var e=this.descriptor,t=this.device.gl;null!==this.gl_shader_vert&&t.deleteShader(this.gl_shader_vert),null!==this.gl_shader_frag&&t.deleteShader(this.gl_shader_frag),this.gl_shader_vert=this.compileShader(e.preprocessedVert,t.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(e.preprocessedFrag,t.FRAGMENT_SHADER),t.attachShader(this.gl_program,this.gl_shader_vert),t.attachShader(this.gl_program,this.gl_shader_frag),t.linkProgram(this.gl_program),this.compileState=N.Compiling,m(t)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram())},t.prototype.readAttributesFromLinkedProgram=function(){for(var e,t=this.device.gl,n=t.getProgramParameter(this.gl_program,t.ACTIVE_ATTRIBUTES),r=Object(d.getDefines)(this.descriptor.preprocessedVert),i=Object(d.getAttributeLocations)(this.descriptor.vert,r),o=function(n){var r=t.getActiveAttrib(s.gl_program,n),o=r.name,u=r.type,c=r.size,l=t.getAttribLocation(s.gl_program,o),f=null===(e=i.find((function(e){return e.name===o})))||void 0===e?void 0:e.location;l>=0&&!Object(a.isNil)(f)&&(s.attributes[f]={name:o,location:l,type:u,size:c})},s=this,u=0;u<n;u++)o(u)},t.prototype.readUniformLocationsFromLinkedProgram=function(){for(var e=this.device.gl,t=e.getProgramParameter(this.gl_program,e.ACTIVE_UNIFORMS),n=0;n<t;n++){var r=e.getActiveUniform(this.gl_program,n),i=Object(d.parseUniformName)(r.name).name,o=e.getUniformLocation(this.gl_program,i);if(this.uniformSetters[i]=Object(d.getUniformSetter)(e,o,r),r&&r.size>1)for(var a=0;a<r.size;a++)o=e.getUniformLocation(this.gl_program,"".concat(i,"[").concat(a,"]")),this.uniformSetters["".concat(i,"[").concat(a,"]")]=Object(d.getUniformSetter)(e,o,r)}},t.prototype.compileShader=function(e,t){var n=this.device.gl,r=this.device.ensureResourceExists(n.createShader(t));return n.shaderSource(r,e),n.compileShader(r),r},t.prototype.setUniforms=function(e){void 0===e&&(e={});var t=this.device.gl;if(!m(t)){var n=!1;for(var r in e){n||(t.useProgram(this.gl_program),n=!0);var i=e[r],o=this.uniformSetters[r];if(o){var a=i;a instanceof L&&(a=a.textureIndex),o(a)}}}return this},t}(v),U=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;o.type=d.ResourceType.QueryPool;var a=o.device.gl;if(m(a)){var s=i.elemCount,u=i.type;o.gl_query=Object(d.nArray)(s,(function(){return o.device.ensureResourceExists(a.createQuery())})),o.gl_query_type=function(e){switch(e){case d.QueryPoolType.OcclusionConservative:return d.GL.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}(u)}return o}return Object(s.__extends)(t,e),t.prototype.queryResultOcclusion=function(e){var t=this.device.gl;if(m(t)){var n=this.gl_query[e];return t.getQueryParameter(n,t.QUERY_RESULT_AVAILABLE)?!!t.getQueryParameter(n,t.QUERY_RESULT):null}return null},t.prototype.destroy=function(){e.prototype.destroy.call(this);var t=this.device.gl;if(m(t))for(var n=0;n<this.gl_query.length;n++)t.deleteQuery(this.gl_query[n])},t}(v),G=function(e){function t(t){var n=t.id,r=t.device,i=e.call(this,{id:n,device:r})||this;return i.type=d.ResourceType.Readback,i.gl_pbo=null,i.gl_sync=null,i}return Object(s.__extends)(t,e),t.prototype.clientWaitAsync=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=10);var r=this.device.gl;return new Promise((function(i,o){!function s(){var u=r.clientWaitSync(e,t,0);u!=r.WAIT_FAILED?u!=r.TIMEOUT_EXPIRED?i():setTimeout(s,Object(a.clamp)(n,0,r.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)):o()}()}))},t.prototype.getBufferSubDataAsync=function(e,t,n,r,i,o){return void 0===i&&(i=0),void 0===o&&(o=r.byteLength||0),Object(s.__awaiter)(this,void 0,void 0,(function(){var a;return Object(s.__generator)(this,(function(s){switch(s.label){case 0:return m(a=this.device.gl)?(this.gl_sync=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0),a.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return s.sent(),a.bindBuffer(e,t),a.getBufferSubData(e,n,r,i,o),a.bindBuffer(e,null),[2,r];case 2:return[2]}}))}))},t.prototype.readTexture=function(e,t,n,r,i,o,a,u){return void 0===a&&(a=0),void 0===u&&(u=o.byteLength||0),Object(s.__awaiter)(this,void 0,void 0,(function(){var c,l,f,h,p;return Object(s.__generator)(this,(function(s){return c=this.device.gl,l=e,f=this.device.translateTextureFormat(l.pixelFormat),h=this.device.translateTextureType(l.pixelFormat),p=Object(d.getFormatByteSize)(l.pixelFormat),m(c)?(this.gl_pbo=this.device.ensureResourceExists(c.createBuffer()),c.bindBuffer(c.PIXEL_PACK_BUFFER,this.gl_pbo),c.bufferData(c.PIXEL_PACK_BUFFER,u,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),c.bindFramebuffer(d.GL.READ_FRAMEBUFFER,this.device.readbackFramebuffer),c.framebufferTexture2D(d.GL.READ_FRAMEBUFFER,d.GL.COLOR_ATTACHMENT0,d.GL.TEXTURE_2D,l.gl_texture,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,this.gl_pbo),c.readPixels(t,n,r,i,f,h,a*p),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(c.PIXEL_PACK_BUFFER,this.gl_pbo,0,o,a,u)]):(c.bindFramebuffer(d.GL.FRAMEBUFFER,this.device.readbackFramebuffer),c.framebufferTexture2D(d.GL.FRAMEBUFFER,d.GL.COLOR_ATTACHMENT0,d.GL.TEXTURE_2D,l.gl_texture,0),c.pixelStorei(c.PACK_ALIGNMENT,4),c.readPixels(t,n,r,i,c.RGBA,h,o),[2,Promise.resolve(o)])}))}))},t.prototype.readBuffer=function(e,t,n,r,i){return Object(s.__awaiter)(this,void 0,void 0,(function(){var o;return Object(s.__generator)(this,(function(a){return m(o=this.device.gl)?[2,this.getBufferSubDataAsync(o.ARRAY_BUFFER,S(e,t),t,n,r,i)]:[2,Promise.reject()]}))}))},t.prototype.destroy=function(){e.prototype.destroy.call(this),m(this.device.gl)&&(null!==this.gl_sync&&this.device.gl.deleteSync(this.gl_sync),null!==this.gl_pbo&&this.device.gl.deleteBuffer(this.gl_pbo))},t}(v),j=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;return o.type=d.ResourceType.RenderPipeline,o.bindingLayouts=o.createBindingLayouts(i.bindingLayouts),o.drawMode=function(e){switch(e){case d.PrimitiveTopology.Triangles:return d.GL.TRIANGLES;case d.PrimitiveTopology.Points:return d.GL.POINTS;case d.PrimitiveTopology.TriangleStrip:return d.GL.TRIANGLE_STRIP;case d.PrimitiveTopology.Lines:return d.GL.LINES;case d.PrimitiveTopology.LineStrip:return d.GL.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}(i.topology),o.program=i.program,o.inputLayout=i.inputLayout,o.megaState=i.megaStateDescriptor,o.colorAttachmentFormats=i.colorAttachmentFormats.slice(),o.depthStencilAttachmentFormat=i.depthStencilAttachmentFormat,o.sampleCount=i.sampleCount,o}return Object(s.__extends)(t,e),t.prototype.createBindingLayouts=function(e){for(var t=0,n=0,r=[],i=0;i<e.length;i++){var o=e[i],a=o.numUniformBuffers,s=o.numSamplers,u=o.samplerEntries,c=[];void 0!==u&&Object(d.assert)(u.length===s);for(var l=0;l<s;l++){var f=void 0!==u?u[l]:d.defaultBindingLayoutSamplerDescriptor,h=f.dimension,p=f.formatKind;c.push({gl_target:x(h),formatKind:p})}r.push({firstUniformBuffer:t,numUniformBuffers:a,firstSampler:n,numSamplers:s,samplerEntries:c}),t+=a,n+=s}return{numUniformBuffers:t,numSamplers:n,bindingLayoutTables:r}},t}(v),V=function(e){function t(t){var n=t.id,r=t.device,i=t.descriptor,o=e.call(this,{id:n,device:r})||this;o.type=d.ResourceType.RenderTarget,o.gl_renderbuffer=null,o.texture=null;var a=o.device.gl,s=i.pixelFormat,u=i.width,c=i.height,l=i.texture,f=i.sampleCount;if(l)o.texture=l;else{o.gl_renderbuffer=o.device.ensureResourceExists(a.createRenderbuffer()),a.bindRenderbuffer(a.RENDERBUFFER,o.gl_renderbuffer);var h=o.device.translateTextureInternalFormat(s);m(a)?a.renderbufferStorageMultisample(d.GL.RENDERBUFFER,f,h,u,c):a.renderbufferStorage(d.GL.RENDERBUFFER,h,u,c)}return o.pixelFormat=s,o.width=u,o.height=c,o.sampleCount=f,o}return Object(s.__extends)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),null!==this.gl_renderbuffer&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer)},t}(v),W=function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(e){this.creationStacks.set(e,(new Error).stack),this.liveObjects.add(e)},e.prototype.trackResourceDestroyed=function(e){this.deletionStacks.has(e)&&console.warn("Object double freed:",e,"\n\nCreation stack: ",this.creationStacks.get(e),"\n\nDeletion stack: ",this.deletionStacks.get(e),"\n\nThis stack: ",(new Error).stack),this.deletionStacks.set(e,(new Error).stack),this.liveObjects.delete(e)},e.prototype.checkForLeaks=function(){var e,t;try{for(var n=Object(s.__values)(this.liveObjects.values()),r=n.next();!r.done;r=n.next()){var i=r.value;console.warn("Object leaked:",i,"Creation stack:",this.creationStacks.get(i))}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.setResourceLeakCheck=function(e,t){t?this.liveObjects.add(e):this.liveObjects.delete(e)},e}(),H=function(e){function t(t){var n,r,i=t.id,o=t.device,a=t.descriptor,s=this;(s=e.call(this,{id:i,device:o})||this).type=d.ResourceType.Sampler;var u=s.device.gl;if(m(u)){var c=s.device.ensureResourceExists(u.createSampler());u.samplerParameteri(c,d.GL.TEXTURE_WRAP_S,T(a.wrapS)),u.samplerParameteri(c,d.GL.TEXTURE_WRAP_T,T(a.wrapT)),u.samplerParameteri(c,d.GL.TEXTURE_WRAP_R,T(null!==(n=a.wrapQ)&&void 0!==n?n:a.wrapS)),u.samplerParameteri(c,d.GL.TEXTURE_MIN_FILTER,b(a.minFilter,a.mipFilter)),u.samplerParameteri(c,d.GL.TEXTURE_MAG_FILTER,b(a.magFilter,d.MipFilterMode.NoMip)),void 0!==a.minLOD&&u.samplerParameterf(c,d.GL.TEXTURE_MIN_LOD,a.minLOD),void 0!==a.maxLOD&&u.samplerParameterf(c,d.GL.TEXTURE_MAX_LOD,a.maxLOD),void 0!==a.compareMode&&(u.samplerParameteri(c,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE),u.samplerParameteri(c,u.TEXTURE_COMPARE_FUNC,a.compareMode));var l=null!==(r=a.maxAnisotropy)&&void 0!==r?r:1;l>1&&null!==s.device.EXT_texture_filter_anisotropic&&(Object(d.assert)(a.minFilter===d.TexFilterMode.Bilinear&&a.magFilter===d.TexFilterMode.Bilinear&&a.mipFilter===d.MipFilterMode.Linear),u.samplerParameterf(c,s.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l)),s.gl_sampler=c}else s.descriptor=a;return s}return Object(s.__extends)(t,e),t.prototype.setTextureParameters=function(e,t,n){var r,i=this.device.gl,o=this.descriptor;this.isNPOT(t,n)?i.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_MIN_FILTER,d.GL.LINEAR):i.texParameteri(e,d.GL.TEXTURE_MIN_FILTER,b(o.minFilter,o.mipFilter)),i.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_WRAP_S,T(o.wrapS)),i.texParameteri(d.GL.TEXTURE_2D,d.GL.TEXTURE_WRAP_T,T(o.wrapT)),i.texParameteri(e,d.GL.TEXTURE_MAG_FILTER,b(o.magFilter,d.MipFilterMode.NoMip));var a=null!==(r=o.maxAnisotropy)&&void 0!==r?r:1;a>1&&null!==this.device.EXT_texture_filter_anisotropic&&(Object(d.assert)(o.minFilter===d.TexFilterMode.Bilinear&&o.magFilter===d.TexFilterMode.Bilinear&&o.mipFilter===d.MipFilterMode.Linear),i.texParameteri(e,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a))},t.prototype.destroy=function(){e.prototype.destroy.call(this),m(this.device.gl)&&this.device.gl.deleteSampler(A(this))},t.prototype.isNPOT=function(e,t){return!Object(d.isPowerOfTwo)(e)||!Object(d.isPowerOfTwo)(t)},t}(v),X=function(){function e(e,t){this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_depth_texture=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorResolveTos=[],this.currentDepthStencilResolveTo=null,this.currentSampleCount=-1,this.currentMegaState=Object(d.copyMegaState)(d.defaultMegaState),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=d.ViewportOrigin.LowerLeft,this.clipSpaceNearZ=d.ClipSpaceNearZ.NegativeOne,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.gl=e,this.contextAttributes=Object(d.assertExists)(e.getContextAttributes()),m(e)?this.EXT_texture_norm16=e.getExtension("EXT_texture_norm16"):(this.OES_vertex_array_object=e.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=e.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=e.getExtension("OES_texture_float"),this.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture"),e.getExtension("EXT_frag_depth"),e.getExtension("OES_element_index_uint"),e.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=e.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=e.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=e.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=e.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=e.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=e.getExtension("KHR_parallel_shader_compile"),m(e)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new L({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depth:1,dimension:d.TextureDimension.n2D,numLevels:1,usage:d.TextureUsage.RenderTarget,pixelFormat:!1===this.contextAttributes.alpha?d.Format.U8_RGB_RT:d.Format.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=d.SamplerFormatKind.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(e.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(d.TextureDimension.n2D,d.SamplerFormatKind.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(d.TextureDimension.n2D,d.SamplerFormatKind.Depth),m(e),this.currentMegaState.depthCompare=d.CompareMode.Less,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=d.ChannelWriteMask.AllChannels,e.enable(e.DEPTH_TEST),e.enable(e.STENCIL_TEST),this.checkLimits(),t.shaderDebug&&(this.shaderDebug=!0),t.trackResources&&(this.resourceCreationTracker=new W)}return e.prototype.createFallbackTexture=function(e,t){var n=e===d.TextureDimension.Cube?6:1,r=t===d.SamplerFormatKind.Depth?d.Format.D32F:d.Format.U8_RGBA_NORM,i=this.createTexture({dimension:e,pixelFormat:r,usage:d.TextureUsage.Sampled,width:1,height:1,depth:n,numLevels:1,immutable:!0});return t===d.SamplerFormatKind.Float&&i.setImageData([new Uint8Array(4*n)],0),R(i)},e.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},e.prototype.checkLimits=function(){var e=this.gl;if(this.maxVertexAttribs=e.getParameter(d.GL.MAX_VERTEX_ATTRIBS),m(e)){this.uniformBufferMaxPageByteSize=Math.min(e.getParameter(d.GL.MAX_UNIFORM_BLOCK_SIZE),65536),this.uniformBufferWordAlignment=e.getParameter(e.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var t=e.getInternalformatParameter(e.RENDERBUFFER,e.DEPTH32F_STENCIL8,e.SAMPLES);this.supportedSampleCounts=t?Object(s.__spreadArray)([],Object(s.__read)(t),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=65536;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort((function(e,t){return e-t}))},e.prototype.configureSwapChain=function(e,t,n){var r=this.scTexture;r.width=e,r.height=t,this.scPlatformFramebuffer=Object(d.nullify)(n)},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.gl.canvas},e.prototype.getOnscreenTexture=function(){return this.scTexture},e.prototype.present=function(){var e=this.gl;this.currentMegaState.attachmentsState[0].channelWriteMask!==d.ChannelWriteMask.Alpha&&(e.colorMask(!1,!1,!1,!0),this.currentMegaState.attachmentsState[0].channelWriteMask=d.ChannelWriteMask.Alpha);var t=d.OpaqueWhite.r,n=d.OpaqueWhite.g,r=d.OpaqueWhite.b,i=d.OpaqueWhite.a;m(e)?e.clearBufferfv(e.COLOR,0,[t,n,r,i]):(e.clearColor(t,n,r,i),e.clear(e.COLOR_BUFFER_BIT))},e.prototype.translateTextureInternalFormat=function(e){switch(e){case d.Format.ALPHA:return d.GL.ALPHA;case d.Format.F16_R:return d.GL.R16F;case d.Format.F16_RG:return d.GL.RG16F;case d.Format.F16_RGB:return d.GL.RGB16F;case d.Format.F16_RGBA:return d.GL.RGBA16F;case d.Format.F32_R:return d.GL.R32F;case d.Format.F32_RG:return d.GL.RG32F;case d.Format.F32_RGB:return d.GL.RGB32F;case d.Format.F32_RGBA:return d.GL.RGBA32F;case d.Format.U8_R_NORM:return d.GL.R8;case d.Format.U8_RG_NORM:return d.GL.RG8;case d.Format.U8_RGB_NORM:case d.Format.U8_RGB_RT:return d.GL.RGB8;case d.Format.U8_RGB_SRGB:return d.GL.SRGB8;case d.Format.U8_RGBA_NORM:case d.Format.U8_RGBA_RT:return m(this.gl)?d.GL.RGBA8:d.GL.RGBA;case d.Format.U8_RGBA_SRGB:case d.Format.U8_RGBA_RT_SRGB:return d.GL.SRGB8_ALPHA8;case d.Format.U16_R:return d.GL.R16UI;case d.Format.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case d.Format.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case d.Format.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case d.Format.U16_RGBA_5551:return d.GL.RGB5_A1;case d.Format.U32_R:return d.GL.R32UI;case d.Format.S8_RGBA_NORM:return d.GL.RGBA8_SNORM;case d.Format.S8_RG_NORM:return d.GL.RG8_SNORM;case d.Format.U16_RGBA_5551:return d.GL.UNSIGNED_SHORT_5_5_5_1;case d.Format.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case d.Format.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case d.Format.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case d.Format.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case d.Format.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case d.Format.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case d.Format.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case d.Format.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case d.Format.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case d.Format.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case d.Format.D32F_S8:return m(this.gl)?d.GL.DEPTH32F_STENCIL8:d.GL.DEPTH_STENCIL;case d.Format.D24_S8:return m(this.gl)?d.GL.DEPTH24_STENCIL8:d.GL.DEPTH_STENCIL;case d.Format.D32F:return m(this.gl)?d.GL.DEPTH_COMPONENT32F:d.GL.DEPTH_COMPONENT;case d.Format.D24:return m(this.gl)?d.GL.DEPTH_COMPONENT24:d.GL.DEPTH_COMPONENT;default:throw new Error("whoops")}},e.prototype.translateTextureType=function(e){switch(Object(d.getFormatTypeFlags)(e)){case d.FormatTypeFlags.U8:return d.GL.UNSIGNED_BYTE;case d.FormatTypeFlags.U16:return d.GL.UNSIGNED_SHORT;case d.FormatTypeFlags.U32:return d.GL.UNSIGNED_INT;case d.FormatTypeFlags.S8:return d.GL.BYTE;case d.FormatTypeFlags.F16:return d.GL.HALF_FLOAT;case d.FormatTypeFlags.F32:return d.GL.FLOAT;case d.FormatTypeFlags.U16_PACKED_5551:return d.GL.UNSIGNED_SHORT_5_5_5_1;case d.FormatTypeFlags.D32F:return m(this.gl)?d.GL.FLOAT:d.GL.UNSIGNED_INT;case d.FormatTypeFlags.D24:return m(this.gl)?d.GL.UNSIGNED_INT_24_8:d.GL.UNSIGNED_SHORT;case d.FormatTypeFlags.D24S8:return m(this.gl)?d.GL.UNSIGNED_INT_24_8:d.GL.UNSIGNED_INT_24_8_WEBGL;case d.FormatTypeFlags.D32FS8:return d.GL.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.prototype.translateTextureFormat=function(e){if(function(e){switch(Object(d.getFormatTypeFlags)(e)){case d.FormatTypeFlags.BC1:case d.FormatTypeFlags.BC2:case d.FormatTypeFlags.BC3:case d.FormatTypeFlags.BC4_UNORM:case d.FormatTypeFlags.BC4_SNORM:case d.FormatTypeFlags.BC5_UNORM:case d.FormatTypeFlags.BC5_SNORM:return!0;default:return!1}}(e))return this.translateTextureInternalFormat(e);switch(e){case d.Format.D24_S8:case d.Format.D32F_S8:return d.GL.DEPTH_STENCIL;case d.Format.D24:case d.Format.D32F:return d.GL.DEPTH_COMPONENT}var t=_(e);switch(Object(d.getFormatCompFlags)(e)){case d.FormatCompFlags.A:return d.GL.ALPHA;case d.FormatCompFlags.R:return t?d.GL.RED_INTEGER:d.GL.RED;case d.FormatCompFlags.RG:return t?d.GL.RG_INTEGER:d.GL.RG;case d.FormatCompFlags.RGB:return t?d.GL.RGB_INTEGER:d.GL.RGB;case d.FormatCompFlags.RGBA:return d.GL.RGBA}},e.prototype.setActiveTexture=function(e){this.currentActiveTexture!==e&&(this.gl.activeTexture(e),this.currentActiveTexture=e)},e.prototype.bindVAO=function(e){this.currentBoundVAO!==e&&(m(this.gl)?this.gl.bindVertexArray(e):this.OES_vertex_array_object.bindVertexArrayOES(e),this.currentBoundVAO=e)},e.prototype.programCompiled=function(e){Object(d.assert)(e.compileState!==N.NeedsCompile),e.compileState===N.Compiling&&(e.compileState=N.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(e))},e.prototype.useProgram=function(e){this.currentProgram!==e&&(this.programCompiled(e),this.gl.useProgram(e.gl_program),this.currentProgram=e)},e.prototype.ensureResourceExists=function(e){if(null===e){var t=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(t))}return e},e.prototype.createBuffer=function(e){return new F({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createTexture=function(e){return new L({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createSampler=function(e){return new H({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createRenderTarget=function(e){return new V({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createRenderTargetFromTexture=function(e){var t=e,n=t.pixelFormat,r=t.width,i=t.height,o=t.numLevels;return Object(d.assert)(1===o),this.createRenderTarget({pixelFormat:n,width:r,height:i,sampleCount:1,texture:e})},e.prototype.createProgram=function(e){return e.ensurePreprocessed(this.queryVendorInfo()),this.createProgramSimple(e)},e.prototype.createProgramSimple=function(e){return new k({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createBindings=function(e){return new y({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createInputLayout=function(e){return new I({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createInputState=function(e,t,n,r){var i=e;return new D({id:this.getNextUniqueId(),device:this,inputLayout:i,vertexBuffers:t,indexBufferBinding:n,program:r})},e.prototype.createRenderPipeline=function(e){return new j({id:this.getNextUniqueId(),device:this,descriptor:e})},e.prototype.createComputePass=function(e){throw new Error("Method not implemented.")},e.prototype.createComputePipeline=function(e){throw new Error("Method not implemented.")},e.prototype.createReadback=function(){return new G({id:this.getNextUniqueId(),device:this})},e.prototype.createQueryPool=function(e,t){return new U({id:this.getNextUniqueId(),device:this,descriptor:{type:e,elemCount:t}})},e.prototype.createRenderPass=function(e){Object(d.assert)(null===this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=e;var t=e.colorAttachment,n=e.colorClearColor,r=e.colorResolveTo,i=e.depthStencilAttachment,o=e.depthClearValue,a=e.stencilClearValue,s=e.depthStencilResolveTo;this.setRenderPassParametersBegin(t.length);for(var u=0;u<t.length;u++)this.setRenderPassParametersColor(u,t[u],r[u]);this.setRenderPassParametersDepthStencil(i,s),this.validateCurrentAttachments();for(u=0;u<t.length;u++){var c=n[u];"load"!==c&&this.setRenderPassParametersClearColor(u,c.r,c.g,c.b,c.a)}return this.setRenderPassParametersClearDepthStencil(o,a),this},e.prototype.submitPass=function(e){Object(d.assert)(null!==this.currentRenderPassDescriptor),this.endPass(),this.currentRenderPassDescriptor=null},e.prototype.copySubTexture2D=function(e,t,n,r,i,o){var a=this.gl,s=e,u=r;Object(d.assert)(1===u.numLevels),Object(d.assert)(1===s.numLevels),m(a)&&(s===this.scTexture?a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,s)),a.bindFramebuffer(a.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,u),a.blitFramebuffer(i,o,i+u.width,o+u.height,t,n,t+u.width,n+u.height,a.COLOR_BUFFER_BIT,a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null))},e.prototype.queryLimits=function(){return this},e.prototype.queryTextureFormatSupported=function(e,t,n){switch(e){case d.Format.BC1_SRGB:case d.Format.BC2_SRGB:case d.Format.BC3_SRGB:return null!==this.WEBGL_compressed_texture_s3tc_srgb&&P(t,n,4,4);case d.Format.BC1:case d.Format.BC2:case d.Format.BC3:return null!==this.WEBGL_compressed_texture_s3tc&&P(t,n,4,4);case d.Format.BC4_UNORM:case d.Format.BC4_SNORM:case d.Format.BC5_UNORM:case d.Format.BC5_SNORM:return null!==this.EXT_texture_compression_rgtc&&P(t,n,4,4);case d.Format.U16_R_NORM:case d.Format.U16_RG_NORM:case d.Format.U16_RGBA_NORM:return null!==this.EXT_texture_norm16;case d.Format.F32_R:case d.Format.F32_RG:case d.Format.F32_RGB:case d.Format.F32_RGBA:return null!==this.OES_texture_float_linear;case d.Format.F16_R:case d.Format.F16_RG:case d.Format.F16_RGB:case d.Format.F16_RGBA:return null!==this.OES_texture_half_float_linear;default:return!0}},e.prototype.queryProgramReady=function(e){var t=this.gl;if(e.compileState===N.NeedsCompile)throw new Error("whoops");if(e.compileState===N.Compiling){var n=void 0;return(n=null===this.KHR_parallel_shader_compile||t.getProgramParameter(e.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR))&&this.programCompiled(e),n}return e.compileState===N.NeedsBind||e.compileState===N.ReadyToUse},e.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(e){return this.currentRenderPassDescriptor},e.prototype.queryRenderTarget=function(e){return e},e.prototype.setResourceName=function(e,t){if(e.name=t,e.type===d.ResourceType.Buffer)for(var n=e.gl_buffer_pages,r=0;r<n.length;r++)O(n[r],"".concat(t," Page ").concat(r));else if(e.type===d.ResourceType.Texture)O(R(e),t);else if(e.type===d.ResourceType.Sampler)O(A(e),t);else if(e.type===d.ResourceType.RenderTarget){var i=e.gl_renderbuffer;null!==i&&O(i,t)}else e.type===d.ResourceType.InputState&&O(e.vao,t)},e.prototype.setResourceLeakCheck=function(e,t){null!==this.resourceCreationTracker&&this.resourceCreationTracker.setResourceLeakCheck(e,t)},e.prototype.checkForLeaks=function(){null!==this.resourceCreationTracker&&this.resourceCreationTracker.checkForLeaks()},e.prototype.pushDebugGroup=function(e){this.debugGroupStack.push(e)},e.prototype.popDebugGroup=function(){this.debugGroupStack.pop()},e.prototype.programPatched=function(e,t){Object(d.assert)(this.shaderDebug)},e.prototype.getBufferData=function(e,t,n){void 0===n&&(n=0);var r=this.gl;m(r)&&(r.bindBuffer(r.COPY_READ_BUFFER,S(e,4*n)),r.getBufferSubData(r.COPY_READ_BUFFER,4*n,t))},e.prototype.debugGroupStatisticsDrawCall=function(e){void 0===e&&(e=1);for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].drawCallCount+=e},e.prototype.debugGroupStatisticsBufferUpload=function(e){void 0===e&&(e=1);for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].bufferUploadCount+=e},e.prototype.debugGroupStatisticsTextureBind=function(e){void 0===e&&(e=1);for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].textureBindCount+=e},e.prototype.debugGroupStatisticsTriangles=function(e){for(var t=this.debugGroupStack.length-1;t>=0;t--)this.debugGroupStack[t].triangleCount+=e},e.prototype.reportShaderError=function(e,t){var n=this.gl,r=n.getShaderParameter(e,n.COMPILE_STATUS);if(!r){console.error(Object(d.prependLineNo)(t));var i=n.getExtension("WEBGL_debug_shaders");i&&console.error(i.getTranslatedShaderSource(e)),console.error(n.getShaderInfoLog(e))}return r},e.prototype.checkProgramCompilationForErrors=function(e){var t=this.gl,n=e.gl_program;if(!t.getProgramParameter(n,t.LINK_STATUS)){var r=e.descriptor;if(!this.reportShaderError(e.gl_shader_vert,r.preprocessedVert))return;if(!this.reportShaderError(e.gl_shader_frag,r.preprocessedFrag))return;console.error(t.getProgramInfoLog(e.gl_program))}},e.prototype.bindFramebufferAttachment=function(e,t,n){var r=this.gl;null===n?r.framebufferRenderbuffer(e,t,r.RENDERBUFFER,null):n.type===d.ResourceType.RenderTarget?null!==n.gl_renderbuffer?r.framebufferRenderbuffer(e,t,r.RENDERBUFFER,n.gl_renderbuffer):null!==n.texture&&r.framebufferTexture2D(e,t,d.GL.TEXTURE_2D,R(n.texture),0):n.type===d.ResourceType.Texture&&r.framebufferTexture2D(e,t,d.GL.TEXTURE_2D,R(n),0)},e.prototype.bindFramebufferDepthStencilAttachment=function(e,t){var n=this.gl,r=null!==t?Object(d.getFormatFlags)(t.pixelFormat):d.FormatFlags.Depth|d.FormatFlags.Stencil,i=!!(r&d.FormatFlags.Depth),o=!!(r&d.FormatFlags.Stencil);i&&o?this.bindFramebufferAttachment(e,n.DEPTH_STENCIL_ATTACHMENT,t):i?(this.bindFramebufferAttachment(e,n.DEPTH_ATTACHMENT,t),this.bindFramebufferAttachment(e,n.STENCIL_ATTACHMENT,null)):o&&(this.bindFramebufferAttachment(e,n.STENCIL_ATTACHMENT,t),this.bindFramebufferAttachment(e,n.DEPTH_ATTACHMENT,null))},e.prototype.validateCurrentAttachments=function(){for(var e=-1,t=-1,n=-1,r=0;r<this.currentColorAttachments.length;r++){var i=this.currentColorAttachments[r];null!==i&&(-1===e?(e=i.sampleCount,t=i.width,n=i.height):(Object(d.assert)(e===i.sampleCount),Object(d.assert)(t===i.width),Object(d.assert)(n===i.height)))}null!==this.currentDepthStencilAttachment&&(-1===e?(e=this.currentDepthStencilAttachment.sampleCount,t=this.currentDepthStencilAttachment.width,n=this.currentDepthStencilAttachment.height):(Object(d.assert)(e===this.currentDepthStencilAttachment.sampleCount),Object(d.assert)(t===this.currentDepthStencilAttachment.width),Object(d.assert)(n===this.currentDepthStencilAttachment.height))),this.currentSampleCount=e},e.prototype.setRenderPassParametersBegin=function(e){var t=this.gl;if(m(t)?t.bindFramebuffer(d.GL.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||t.bindFramebuffer(d.GL.FRAMEBUFFER,this.renderPassDrawFramebuffer),!this.inBlitRenderPass)for(var n=e;n<this.currentColorAttachments.length;n++){var r=m(t)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,i=m(t)?d.GL.COLOR_ATTACHMENT0:d.GL.COLOR_ATTACHMENT0_WEBGL;t.framebufferRenderbuffer(r,i+n,d.GL.RENDERBUFFER,null),t.framebufferTexture2D(r,i+n,d.GL.TEXTURE_2D,null,0)}this.currentColorAttachments.length=e},e.prototype.setRenderPassParametersColor=function(e,t,n){var r=this.gl;this.currentColorAttachments[e]!==t&&(this.currentColorAttachments[e]=t,(m(r)||0===e)&&this.bindFramebufferAttachment(m(r)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,(m(r)?d.GL.COLOR_ATTACHMENT0:d.GL.COLOR_ATTACHMENT0_WEBGL)+e,t),this.resolveColorAttachmentsChanged=!0),this.currentColorResolveTos[e]!==n&&(this.currentColorResolveTos[e]=n,null!==n&&(this.resolveColorAttachmentsChanged=!0))},e.prototype.setRenderPassParametersDepthStencil=function(e,t){var n=this.gl;this.currentDepthStencilAttachment!==e&&(this.currentDepthStencilAttachment=e,this.inBlitRenderPass||this.bindFramebufferDepthStencilAttachment(m(n)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==t&&(this.currentDepthStencilResolveTo=t,null!==t&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.prototype.setRenderPassParametersClearColor=function(e,t,n,r,i){var o,a=this.gl;null!==this.OES_draw_buffers_indexed?(o=this.currentMegaState.attachmentsState[e])&&o.channelWriteMask!==d.ChannelWriteMask.AllChannels&&(this.OES_draw_buffers_indexed.colorMaskiOES(e,!0,!0,!0,!0),o.channelWriteMask=d.ChannelWriteMask.AllChannels):(o=this.currentMegaState.attachmentsState[0])&&o.channelWriteMask!==d.ChannelWriteMask.AllChannels&&(a.colorMask(!0,!0,!0,!0),o.channelWriteMask=d.ChannelWriteMask.AllChannels);this.setScissorEnabled(!1),m(a)?a.clearBufferfv(a.COLOR,e,[t,n,r,i]):(a.clearColor(t,n,r,i),a.clear(a.COLOR_BUFFER_BIT))},e.prototype.setRenderPassParametersClearDepthStencil=function(e,t){var n=this.gl;"load"!==e&&(Object(d.assert)(null!==this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(n.depthMask(!0),this.currentMegaState.depthWrite=!0),m(n)?n.clearBufferfv(n.DEPTH,0,[e]):(n.clearDepth(e),n.clear(n.DEPTH_BUFFER_BIT))),"load"!==t&&(Object(d.assert)(null!==this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(n.enable(n.STENCIL_TEST),n.stencilMask(255),this.currentMegaState.stencilWrite=!0),m(n)?n.clearBufferiv(n.STENCIL,0,[t]):(n.clearStencil(t),n.clear(n.STENCIL_BUFFER_BIT)))},e.prototype.setBindings=function(e,t,n){var r,i=this.gl;Object(d.assert)(e<this.currentPipeline.bindingLayouts.bindingLayoutTables.length);var o=this.currentPipeline.bindingLayouts.bindingLayoutTables[e],a=t,s=a.uniformBufferBindings,u=a.samplerBindings;Object(d.assert)(s.length>=o.numUniformBuffers),Object(d.assert)(u.length>=o.numSamplers),Object(d.assert)(n.length>=s.length);for(var c=0;c<s.length;c++){if(0!==(_=s[c]).wordCount){var l=o.firstUniformBuffer+c,f=_.buffer,h=n[c],p=4*_.wordCount;if(f!==this.currentUniformBuffers[l]||h!==this.currentUniformBufferByteOffsets[l]||p!==this.currentUniformBufferByteSizes[l]){var v=h%f.pageByteSize,y=f.gl_buffer_pages[h/f.pageByteSize|0];Object(d.assert)(v+p<=f.pageByteSize),m(i)&&i.bindBufferRange(i.UNIFORM_BUFFER,l,y,v,p),this.currentUniformBuffers[l]=f,this.currentUniformBufferByteOffsets[l]=h,this.currentUniformBufferByteSizes[l]=p}}}for(c=0;c<o.numSamplers;c++){var _=u[c],g=o.firstSampler+c,E=o.samplerEntries[c],T=null!==_&&null!==_.sampler?A(_.sampler):null,b=null!==_&&null!==_.texture?R(_.texture):null;if(this.currentSamplers[g]!==T&&(m(i)&&i.bindSampler(g,T),this.currentSamplers[g]=T),this.currentTextures[g]!==b){if(this.setActiveTexture(i.TEXTURE0+g),null!==b){_.texture.textureIndex=g;var S=Object(d.assertExists)(_).texture,O=S.gl_target,C=S.width,M=S.height;i.bindTexture(O,b),m(i)||null===(r=_.sampler)||void 0===r||r.setTextureParameters(O,C,M),this.debugGroupStatisticsTextureBind(),Object(d.assert)(E.gl_target===O)}else i.bindTexture(E.gl_target,this.getFallbackTexture(E));this.currentTextures[g]=b}}},e.prototype.setViewport=function(e,t,n,r){this.gl.viewport(e,t,n,r)},e.prototype.setScissor=function(e,t,n,r){var i=this.gl;this.setScissorEnabled(!0),i.scissor(e,t,n,r)},e.prototype.applyAttachmentStateIndexed=function(e,t,n){var r=this.gl,i=this.OES_draw_buffers_indexed;t.channelWriteMask!==n.channelWriteMask&&(i.colorMaskiOES(e,!!(n.channelWriteMask&d.ChannelWriteMask.Red),!!(n.channelWriteMask&d.ChannelWriteMask.Green),!!(n.channelWriteMask&d.ChannelWriteMask.Blue),!!(n.channelWriteMask&d.ChannelWriteMask.Alpha)),t.channelWriteMask=n.channelWriteMask);var o=t.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,a=t.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(a||o)&&(M(t.rgbBlendState)&&M(t.alphaBlendState)?i.enableiOES(e,r.BLEND):M(n.rgbBlendState)&&M(n.alphaBlendState)&&i.disableiOES(e,r.BLEND)),o&&(i.blendEquationSeparateiOES(e,n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),t.rgbBlendState.blendMode=n.rgbBlendState.blendMode,t.alphaBlendState.blendMode=n.alphaBlendState.blendMode),a&&(i.blendFuncSeparateiOES(e,n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.prototype.applyAttachmentState=function(e,t){var n=this.gl;e.channelWriteMask!==t.channelWriteMask&&(n.colorMask(!!(t.channelWriteMask&d.ChannelWriteMask.Red),!!(t.channelWriteMask&d.ChannelWriteMask.Green),!!(t.channelWriteMask&d.ChannelWriteMask.Blue),!!(t.channelWriteMask&d.ChannelWriteMask.Alpha)),e.channelWriteMask=t.channelWriteMask);var r=e.rgbBlendState.blendMode!==t.rgbBlendState.blendMode||e.alphaBlendState.blendMode!==t.alphaBlendState.blendMode,i=e.rgbBlendState.blendSrcFactor!==t.rgbBlendState.blendSrcFactor||e.alphaBlendState.blendSrcFactor!==t.alphaBlendState.blendSrcFactor||e.rgbBlendState.blendDstFactor!==t.rgbBlendState.blendDstFactor||e.alphaBlendState.blendDstFactor!==t.alphaBlendState.blendDstFactor;(i||r)&&(M(e.rgbBlendState)&&M(e.alphaBlendState)?n.enable(n.BLEND):M(t.rgbBlendState)&&M(t.alphaBlendState)&&n.disable(n.BLEND)),r&&(n.blendEquationSeparate(t.rgbBlendState.blendMode,t.alphaBlendState.blendMode),e.rgbBlendState.blendMode=t.rgbBlendState.blendMode,e.alphaBlendState.blendMode=t.alphaBlendState.blendMode),i&&(n.blendFuncSeparate(t.rgbBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor,t.alphaBlendState.blendSrcFactor,t.alphaBlendState.blendDstFactor),e.rgbBlendState.blendSrcFactor=t.rgbBlendState.blendSrcFactor,e.alphaBlendState.blendSrcFactor=t.alphaBlendState.blendSrcFactor,e.rgbBlendState.blendDstFactor=t.rgbBlendState.blendDstFactor,e.alphaBlendState.blendDstFactor=t.alphaBlendState.blendDstFactor)},e.prototype.setMegaState=function(e){var t=this.gl,n=this.currentMegaState;if(null!==this.OES_draw_buffers_indexed)for(var r=0;r<e.attachmentsState.length;r++)this.applyAttachmentStateIndexed(r,n.attachmentsState[0],e.attachmentsState[0]);else Object(d.assert)(1===e.attachmentsState.length),this.applyAttachmentState(n.attachmentsState[0],e.attachmentsState[0]);Object(d.colorEqual)(n.blendConstant,e.blendConstant)||(t.blendColor(e.blendConstant.r,e.blendConstant.g,e.blendConstant.b,e.blendConstant.a),Object(d.colorCopy)(n.blendConstant,e.blendConstant)),n.depthCompare!==e.depthCompare&&(t.depthFunc(e.depthCompare),n.depthCompare=e.depthCompare),n.depthWrite!==e.depthWrite&&(t.depthMask(e.depthWrite),n.depthWrite=e.depthWrite),n.stencilWrite!==e.stencilWrite&&(t.stencilMask(e.stencilWrite?255:0),n.stencilWrite=e.stencilWrite),n.stencilPassOp!==e.stencilPassOp&&(t.stencilOp(t.KEEP,t.KEEP,e.stencilPassOp),n.stencilPassOp=e.stencilPassOp),n.stencilRef===e.stencilRef&&n.stencilCompare===e.stencilCompare||(n.stencilCompare=e.stencilCompare,this.setStencilRef(e.stencilRef)),n.cullMode!==e.cullMode&&(n.cullMode===d.CullMode.None?t.enable(t.CULL_FACE):e.cullMode===d.CullMode.None&&t.disable(t.CULL_FACE),e.cullMode===d.CullMode.Back?t.cullFace(t.BACK):e.cullMode===d.CullMode.Front?t.cullFace(t.FRONT):e.cullMode===d.CullMode.FrontAndBack&&t.cullFace(t.FRONT_AND_BACK),n.cullMode=e.cullMode),n.frontFace!==e.frontFace&&(t.frontFace(e.frontFace),n.frontFace=e.frontFace),n.polygonOffset!==e.polygonOffset&&(e.polygonOffset?(t.polygonOffset(1,1),t.enable(t.POLYGON_OFFSET_FILL)):t.disable(t.POLYGON_OFFSET_FILL),n.polygonOffset=e.polygonOffset)},e.prototype.validatePipelineFormats=function(e){for(var t=0;t<this.currentColorAttachments.length;t++){var n=this.currentColorAttachments[t];null!==n&&Object(d.assert)(n.pixelFormat===e.colorAttachmentFormats[t])}null!==this.currentDepthStencilAttachment&&Object(d.assert)(this.currentDepthStencilAttachment.pixelFormat===e.depthStencilAttachmentFormat),-1!==this.currentSampleCount&&Object(d.assert)(this.currentSampleCount===e.sampleCount)},e.prototype.setPipeline=function(e){this.currentPipeline=e,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var t=this.currentPipeline.program;if(this.useProgram(t),t.compileState===N.NeedsBind){var n=this.gl,r=t.gl_program,i=t.descriptor,o=C(i.preprocessedVert,/uniform (\w+) {([^]*?)}/g);if(m(n))for(var a=0;a<o.length;a++){var u=Object(s.__read)(o[a],3),c=(u[0],u[1]),l=(u[2],n.getUniformBlockIndex(r,c));-1!==l&&4294967295!==l&&n.uniformBlockBinding(r,l,a)}var f=C(i.preprocessedVert,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm);for(a=0;a<f.length;a++){var h=Object(s.__read)(f[a],3),d=(h[0],h[1]),p=h[2],v=n.getUniformLocation(r,d);n.uniform1i(v,parseInt(p))}t.compileState=N.ReadyToUse}},e.prototype.setInputState=function(e){var t=e;this.currentInputState=t,null!==this.currentInputState?(Object(d.assert)(this.currentPipeline.inputLayout===this.currentInputState.inputLayout),this.bindVAO(this.currentInputState.vao)):(Object(d.assert)(null===this.currentPipeline.inputLayout),this.bindVAO(null))},e.prototype.setStencilRef=function(e){this.currentStencilRef!==e&&(this.currentStencilRef=e,this.applyStencil())},e.prototype.draw=function(e,t){var n=this.gl,r=this.currentPipeline;n.drawArrays(r.drawMode,t,e),this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3)},e.prototype.drawIndexed=function(e,t){var n=this.gl,r=this.currentPipeline,i=this.currentInputState,o=Object(d.assertExists)(i.indexBufferByteOffset)+t*Object(d.assertExists)(i.indexBufferCompByteSize);n.drawElements(r.drawMode,e,Object(d.assertExists)(i.indexBufferType),o),this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3)},e.prototype.drawIndexedInstanced=function(e,t,n){var r,i=this.gl,o=this.currentPipeline,a=this.currentInputState,u=Object(d.assertExists)(a.indexBufferByteOffset)+t*Object(d.assertExists)(a.indexBufferCompByteSize),c=[o.drawMode,e,Object(d.assertExists)(a.indexBufferType),u,n];m(i)?i.drawElementsInstanced.apply(i,Object(s.__spreadArray)([],Object(s.__read)(c),!1)):(r=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(r,Object(s.__spreadArray)([],Object(s.__read)(c),!1)),this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(e/3*n)},e.prototype.beginOcclusionQuery=function(e){var t=this.gl;if(m(t)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;t.beginQuery(n.gl_query_type,n.gl_query[e])}},e.prototype.endOcclusionQuery=function(e){var t=this.gl;if(m(t)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;t.endQuery(n.gl_query_type)}},e.prototype.beginDebugGroup=function(e){},e.prototype.endDebugGroup=function(){},e.prototype.pipelineQueryReady=function(e){var t=e;return this.queryProgramReady(t.program)},e.prototype.pipelineForceReady=function(e){},e.prototype.endPass=function(){for(var e=this.gl,t=!1,n=0;n<this.currentColorAttachments.length;n++){var r=this.currentColorAttachments[n];if(null!==r){var i=this.currentColorResolveTos[n],o=!1;null!==i&&(Object(d.assert)(r.width===i.width&&r.height===i.height),Object(d.assert)(r.pixelFormat===i.pixelFormat),this.setScissorEnabled(!1),m(e)&&e.bindFramebuffer(e.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&m(e)&&this.bindFramebufferAttachment(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,r),o=!0,i===this.scTexture?e.bindFramebuffer(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.scPlatformFramebuffer):(e.bindFramebuffer(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&e.framebufferTexture2D(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i.gl_texture,0)),m(e)?(e.blitFramebuffer(0,0,r.width,r.height,0,0,i.width,i.height,e.COLOR_BUFFER_BIT,e.LINEAR),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(r,i),t=!0),this.currentRenderPassDescriptor.colorStore[n]||(o||(e.bindFramebuffer(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,e.COLOR_ATTACHMENT0,r)),m(e)&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[e.COLOR_ATTACHMENT0])),e.bindFramebuffer(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var a=this.currentDepthStencilAttachment;if(null!==a){var s=this.currentDepthStencilResolveTo;o=!1;null!==s&&(Object(d.assert)(a.width===s.width&&a.height===s.height),this.setScissorEnabled(!1),e.bindFramebuffer(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),e.bindFramebuffer(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,a),this.bindFramebufferDepthStencilAttachment(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,s)),o=!0,m(e)&&e.blitFramebuffer(0,0,a.width,a.height,0,0,s.width,s.height,e.DEPTH_BUFFER_BIT,e.NEAREST),e.bindFramebuffer(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,null),t=!0),this.currentRenderPassDescriptor.depthStencilStore||(o||(e.bindFramebuffer(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,a),o=!0),m(e)&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[e.DEPTH_STENCIL_ATTACHMENT])),o&&e.bindFramebuffer(m(e)?d.GL.READ_FRAMEBUFFER:d.GL.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}t||e.bindFramebuffer(m(e)?d.GL.DRAW_FRAMEBUFFER:d.GL.FRAMEBUFFER,null)},e.prototype.setScissorEnabled=function(e){if(this.currentScissorEnabled!==e){var t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST),this.currentScissorEnabled=e}},e.prototype.applyStencil=function(){null!==this.currentStencilRef&&this.gl.stencilFunc(this.currentMegaState.stencilCompare,this.currentStencilRef,255)},e.prototype.getFallbackTexture=function(e){var t=e.gl_target,n=e.formatKind;if(t===d.GL.TEXTURE_2D)return n===d.SamplerFormatKind.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(t===d.GL.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(t===d.GL.TEXTURE_3D)return this.fallbackTexture3D;if(t===d.GL.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.submitBlitRenderPass=function(e,t){if(!this.blitRenderPipeline){var n=Object(d.makeStaticDataBuffer)(this,d.BufferUsage.VERTEX|d.BufferUsage.COPY_DST,new Float32Array([-4,-4,4,-4,0,4]).buffer),r=this.createInputLayout({vertexBufferDescriptors:[{byteStride:8,frequency:d.VertexBufferFrequency.PerVertex}],vertexAttributeDescriptors:[{format:d.Format.F32_RG,bufferIndex:0,bufferByteOffset:0,location:0}],indexBufferFormat:null}),i=[{numSamplers:1,numUniformBuffers:0}],o=this.createProgram(Object(s.__assign)(Object(s.__assign)({},Object(d.preprocessProgramObj_GLSL)(this,new d.CopyProgram)),{ensurePreprocessed:function(){},associate:function(){}}));this.blitInputState=this.createInputState(r,[{buffer:n,byteOffset:0}],null,o),this.blitRenderPipeline=this.createRenderPipeline({topology:d.PrimitiveTopology.Triangles,sampleCount:1,program:o,bindingLayouts:i,colorAttachmentFormats:[d.Format.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:r,megaStateDescriptor:Object(d.copyMegaState)(d.defaultMegaState)}),this.blitBindings=this.createBindings({bindingLayout:i[0],samplerBindings:[{sampler:null,texture:e.texture,lateBinding:null}],uniformBufferBindings:[]}),o.setUniforms({u_Texture:e})}var a=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var u=this.createRenderPass({colorAttachment:[e],colorResolveTo:[t],colorClearColor:[d.OpaqueBlack],colorStore:[!0],depthStencilAttachment:null,depthStencilResolveTo:null,depthStencilStore:!0,depthClearValue:"load",stencilClearValue:"load",occlusionQueryPool:null}),c=this.getCanvas(),l=c.width,f=c.height;u.setPipeline(this.blitRenderPipeline),u.setBindings(0,this.blitBindings,[0]),u.setInputState(this.blitInputState),u.setViewport(0,0,l,f),u.draw(3,0),this.currentRenderPassDescriptor=a,this.inBlitRenderPass=!1},e}(),z=function(){function e(){}return e.prototype.createSwapChain=function(e){return Object(s.__awaiter)(this,void 0,void 0,(function(){var t,n,r;return Object(s.__generator)(this,(function(i){return t={antialias:!1,preserveDrawingBuffer:!1,stencil:!0},(n=this.pluginOptions.targets).includes("webgl2")&&(r=e.getContext("webgl2",t)||e.getContext("experimental-webgl2",t)),!r&&n.includes("webgl1")&&(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)),[2,new X(r,{shaderDebug:!0,trackResources:!0})]}))}))},Object(s.__decorate)([Object(u.inject)(p),Object(s.__metadata)("design:type",Object)],e.prototype,"pluginOptions",void 0),e=Object(s.__decorate)([Object(u.singleton)({token:d.DeviceContribution})],e)}(),Y=Object(u.Module)((function(e){e(z)})),K=function(){function e(e){this.options=e,this.name="webgl-device"}return e.prototype.init=function(e){e.register(p,{useValue:Object(s.__assign)({},this.options)}),e.load(Y,!0)},e.prototype.destroy=function(e){e.remove(p),e.unload(Y)},e}(),q=function(){function e(){}var t;return t=e,e.prototype.apply=function(e){var n=this,r=function(e){var t=e.target;if(t.nodeName===a.Shape.HTML){var r=n.getOrCreateEl(t),i=t.ownerDocument.documentElement.attributes;Object.keys(i).forEach((function(e){r.style[e]=i[e]})),Object.keys(t.attributes).forEach((function(e){n.updateAttribute(e,t)}))}},i=function(e){var t=e.target;if(t.nodeName===a.Shape.HTML){var r=n.getId(t),i=n.contextService.getDomElement().parentNode;if(i){var o=i.querySelector("#"+r);o&&i.removeChild(o)}}},o=function(e){var t=e.target;if(t.nodeName===a.Shape.HTML){var r=e.attrName;n.updateAttribute(r,t)}};e.hooks.init.tapPromise(t.tag,(function(){return Object(s.__awaiter)(n,void 0,void 0,(function(){return Object(s.__generator)(this,(function(e){return this.renderingContext.root.addEventListener(a.ElementEvent.MOUNTED,r),this.renderingContext.root.addEventListener(a.ElementEvent.UNMOUNTED,i),this.renderingContext.root.addEventListener(a.ElementEvent.ATTR_MODIFIED,o),[2]}))}))})),e.hooks.destroy.tap(t.tag,(function(){n.renderingContext.root.removeEventListener(a.ElementEvent.MOUNTED,r),n.renderingContext.root.removeEventListener(a.ElementEvent.UNMOUNTED,i),n.renderingContext.root.removeEventListener(a.ElementEvent.ATTR_MODIFIED,o)}))},e.prototype.getId=function(e){return e.id||"g-html-"+e.entity},e.prototype.getOrCreateEl=function(e){var t=this.getId(e),n=this.contextService.getDomElement().parentNode;if(n){var r=n.querySelector("#"+t);if(!r){r=document.createElement("div"),e.parsedStyle.$el=r,r.id=t,e.name&&r.setAttribute("name",e.name),e.className&&r.setAttribute("className",e.className),n.appendChild(r),r.style.position="absolute",r.style.left="0",r.style.top="0",r.style["will-change"]="transform";var i=e.getWorldTransform();r.style.transform="matrix(".concat([i[0],i[1],i[4],i[5],i[12],i[13]].join(","),")")}return r}return null},e.prototype.updateAttribute=function(e,t){var n=this.getOrCreateEl(t);switch(e){case"innerHTML":var r=t.parsedStyle.innerHTML;Object(a.isString)(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"modelMatrix":case"transformOrigin":var i=t.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(i[0].value," ").concat(i[1].value);var o=t.getWorldTransform();n.style.transform="matrix(".concat([o[0],o[1],o[4],o[5],o[12],o[13]].join(","),")");break;case"width":var s=t.parsedStyle.width;n.style.width="".concat((null==s?void 0:s.value)||0,"px");break;case"height":var u=t.parsedStyle.height;n.style.height="".concat((null==u?void 0:u.value)||0,"px");break;case"zIndex":var c=t.parsedStyle.zIndex;n.style["z-index"]="".concat(c.value);break;case"visibility":var l=t.parsedStyle.visibility;n.style.visibility=l.value;break;case"pointerEvents":var f=t.parsedStyle.pointerEvents;n.style.pointerEvents=f.value;break;case"opacity":var h=t.parsedStyle.opacity;n.style.opacity="".concat(h.value);break;case"fill":var d=t.parsedStyle.fill,p="";if(d instanceof a.CSSRGB)p=d.toString();else if(d instanceof a.CSSGradientValue&&d.type===a.GradientPatternType.LinearGradient){var v=d.value.steps.map((function(e){return"".concat(e[1]," ").concat(100*Number(e[0]),"%")})).join(",");p="linear-gradient(to right, ".concat(v,");")}n.style.background=p;break;case"stroke":var y=t.parsedStyle.stroke;n.style["border-color"]=y.toString(),n.style["border-style"]="solid";break;case"lineWidth":var m=t.parsedStyle.lineWidth;n.style["border-width"]="".concat(m.value||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var _=t.parsedStyle.filter;n.style.filter=_}},e.tag="HTMLRendering",Object(s.__decorate)([Object(u.inject)(a.ContextService),Object(s.__metadata)("design:type",Object)],e.prototype,"contextService",void 0),Object(s.__decorate)([Object(u.inject)(a.RenderingContext),Object(s.__metadata)("design:type",Object)],e.prototype,"renderingContext",void 0),e=t=Object(s.__decorate)([Object(u.singleton)({contrib:a.RenderingPluginContribution})],e)}(),Z=Object(u.Module)((function(e){e(q)})),J=function(){function e(){this.name="html-renderer"}return e.prototype.init=function(e){e.load(Z,!0)},e.prototype.destroy=function(e){e.unload(Z)},e}(),Q=function(){function e(){}return e.prototype.init=function(){var e=this.canvasConfig,t=e.container,n=e.canvas,r=e.devicePixelRatio;if(n)this.$canvas=n,t&&n.parentElement!==t&&t.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(t&&(this.$container=Object(a.isString)(t)?document.getElementById(t):t,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}var o=r||a.isBrowser&&window.devicePixelRatio||1;o=o>=1?Math.ceil(o):1,this.dpr=o},e.prototype.getDomElement=function(){return this.$canvas},e.prototype.getContext=function(){return this.context},e.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},e.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},e.prototype.resize=function(e,t){if(this.$canvas){var n=this.getDPR();this.$canvas.width=n*e,this.$canvas.height=n*t,Object(a.setDOMSize)(this.$canvas,e,t)}},e.prototype.getDPR=function(){return this.dpr},e.prototype.applyCursorStyle=function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)},Object(s.__decorate)([Object(u.inject)(a.CanvasConfig),Object(s.__metadata)("design:type",Object)],e.prototype,"canvasConfig",void 0),e=Object(s.__decorate)([Object(u.singleton)({token:a.ContextService})],e)}(),$=Object(u.Module)((function(e){e(Q)})),ee=function(){function e(){this.name="webgl-context-register"}return e.prototype.init=function(e){e.load($,!0)},e.prototype.destroy=function(e){e.unload($)},e}(),te=function(e){function t(t){var n=e.call(this,t)||this;return n.registerPlugin(new ee),n.registerPlugin(new K((null==t?void 0:t.targets)?{targets:t.targets}:{targets:["webgl2","webgl1"]})),n.registerPlugin(new d.Plugin),n.registerPlugin(new h),n.registerPlugin(new J),n}return Object(s.__extends)(t,e),t}(a.AbstractRenderer);let ne;function re(e,t){const n=new te({targets:["webgl1"]});n.unregisterPlugin("dom-interaction"),ne=new a.Canvas({canvas:e,devicePixelRatio:t,renderer:n});const r=new a.Circle({style:{cx:300,cy:200,r:50,fill:"#1890FF",stroke:"#F04864",lineWidth:4}});ne.appendChild(r),r.animate([{transform:"scale(1)",fill:"#1890FF",stroke:"#F04864",opacity:1,shadowColor:"black",shadowBlur:30},{transform:"scale(2)",fill:"red",stroke:"#1890FF",opacity:.8,shadowColor:"red",shadowBlur:0}],{duration:1500,iterations:1/0,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)"}),r.addEventListener("mouseenter",()=>{r.style.lineWidth=20}),r.addEventListener("mouseleave",()=>{r.style.lineWidth=4})}function ie(e,t){t.preventDefault=()=>{},t.composedPath=()=>[ne.getContextService().getDomElement()],"pointermove"===e?ne.getRenderingService().hooks.pointerMove.call(t):"pointerdown"===e?ne.getRenderingService().hooks.pointerDown.call(t):"pointerleave"===e?ne.getRenderingService().hooks.pointerOut.call(t):"pointerover"===e?ne.getRenderingService().hooks.pointerOver.call(t):"pointerup"===e&&ne.getRenderingService().hooks.pointerUp.call(t)}B={render:{fn:re},triggerEvent:{fn:ie}},(w=Object(o.a)()).addEventListener("message",(function(e){var t,n=e.data,r=n.type,o=n.method,a=n.id,s=n.params;"RPC_transferable"===r&&o&&((t=B[o])?Promise.resolve().then((function(){var e;return(e=t).fn.apply(e,i(s))})):Promise.reject("No such method")).then((function(e){w.postMessage({type:"RPC_transferable",id:a,result:e},t.pickTransferablesFromResult?t.pickTransferablesFromResult(e):[])})).catch((function(e){var t;try{t=e.message.toString()}catch(r){t=null}var n={message:t};e.stack&&(n.stack=e.stack,n.name=e.name),e.status&&(n.status=e.status,n.responseJson=e.responseJson),w.postMessage({type:"RPC_transferable",id:a,error:n})}))})),addEventListener("message",(function(e){var n,r=e.data,i=r.type,o=r.method,a=r.id,s=r.params;"RPC"===i&&o&&((n=t[o])?Promise.resolve().then((function(){return n.apply(t,s)})):Promise.reject("No such method")).then((function(e){postMessage({type:"RPC",id:a,result:e})})).catch((function(e){var t={message:e};e.stack&&(t.message=e.message,t.stack=e.stack,t.name=e.name),postMessage({type:"RPC",id:a,error:t})}))})),postMessage({type:"RPC",method:"ready"})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",(function(){return a}));n(11),n(12);var o=1e20,a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.fontSize,i=void 0===n?24:n,o=t.buffer,a=void 0===o?3:o,s=t.radius,u=void 0===s?8:s,c=t.cutoff,l=void 0===c?.25:c,f=t.fontFamily,h=void 0===f?"sans-serif":f,d=t.fontWeight,p=void 0===d?"normal":d,v=t.fontStyle,y=void 0===v?"normal":v;r(this,e),this.buffer=a,this.cutoff=l,this.radius=u;var m=this.size=i+4*a,_=this._createCanvas(m),g=this.ctx=_.getContext("2d",{willReadFrequently:!0});g.font="".concat(y," ").concat(p," ").concat(i,"px ").concat(h),g.textBaseline="alphabetic",g.textAlign="left",g.fillStyle="black",this.gridOuter=new Float64Array(m*m),this.gridInner=new Float64Array(m*m),this.f=new Float64Array(m),this.z=new Float64Array(m+1),this.v=new Uint16Array(m)}var t,n,a;return t=e,(n=[{key:"_createCanvas",value:function(e){var t=document.createElement("canvas");return t.width=t.height=e,t}},{key:"draw",value:function(e){var t=this.ctx.measureText(e),n=t.width,r=t.actualBoundingBoxAscent,i=t.actualBoundingBoxDescent,a=t.actualBoundingBoxLeft,u=t.actualBoundingBoxRight,c=Math.ceil(r),l=Math.min(this.size-this.buffer,Math.ceil(u-a)),f=Math.min(this.size-this.buffer,c+Math.ceil(i)),h=l+2*this.buffer,d=f+2*this.buffer,p=Math.max(h*d,0),v=new Uint8ClampedArray(p),y={data:v,width:h,height:d,glyphWidth:l,glyphHeight:f,glyphTop:c,glyphLeft:0,glyphAdvance:n};if(0===l||0===f)return y;var m=this.ctx,_=this.buffer,g=this.gridInner,E=this.gridOuter;m.clearRect(_,_,l,f),m.fillText(e,_,_+c);var T=m.getImageData(_,_,l,f);E.fill(o,0,p),g.fill(0,0,p);for(var b=0;b<f;b++)for(var S=0;S<l;S++){var R=T.data[4*(b*l+S)+3]/255;if(0!==R){var A=(b+_)*h+S+_;if(1===R)E[A]=0,g[A]=o;else{var O=.5-R;E[A]=O>0?O*O:0,g[A]=O<0?O*O:0}}}s(E,0,0,h,d,h,this.f,this.v,this.z),s(g,_,_,l,f,h,this.f,this.v,this.z);for(var C=0;C<p;C++){var M=Math.sqrt(E[C])-Math.sqrt(g[C]);v[C]=Math.round(255-255*(M/this.radius+this.cutoff))}return y}}])&&i(t.prototype,n),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e,t,n,r,i,o,a,s,c){for(var l=t;l<t+r;l++)u(e,n*o+l,o,i,a,s,c);for(var f=n;f<n+i;f++)u(e,f*o+t,1,r,a,s,c)}function u(e,t,n,r,i,a,s){a[0]=0,s[0]=-o,s[1]=o,i[0]=e[t];for(var u=1,c=0,l=0;u<r;u++){i[u]=e[t+u*n];var f=u*u;do{var h=a[c];l=(i[u]-i[h]+f-h*h)/(u-h)/2}while(l<=s[c]&&--c>-1);a[++c]=u,s[c]=l,s[c+1]=o}for(var d=0,p=0;d<r;d++){for(;s[p+1]<d;)p++;var v=a[p],y=d-v;e[t+d*n]=i[v]+y*y}}}]);